---
title: Nesnelerdeki desenleri kullanma-C# öğreticisi
description: Bu öğretici, nesne davranışına yönelik daha iyi modeller oluşturmak için sınıf üyelerinde model eşleştirmeyi kullanma tekniklerini öğretir
ms.date: 11/05/2020
ms.openlocfilehash: 072f6f57696504c2d691473e3a43c1cda53f227f
ms.sourcegitcommit: c7f0beaa2bd66ebca86362ca17d673f7e8256ca6
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/23/2021
ms.locfileid: "104879125"
---
# <a name="use-pattern-matching-to-build-your-class-behavior-for-better-code"></a><span data-ttu-id="70d67-103">Daha iyi kod için sınıf davranışınızı derlemek için model eşleştirmeyi kullanın</span><span class="sxs-lookup"><span data-stu-id="70d67-103">Use pattern matching to build your class behavior for better code</span></span>

<span data-ttu-id="70d67-104">C# ' deki model eşleştirme özellikleri, algoritmalarınızı ifade etmek için sözdizimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="70d67-104">The pattern matching features in C# provide syntax to express your algorithms.</span></span> <span data-ttu-id="70d67-105">Sınıflarınızda davranışı uygulamak için bu teknikleri kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-105">You can use these techniques to implement the behavior in your classes.</span></span> <span data-ttu-id="70d67-106">Gerçek dünyada nesneleri modellemesi sırasında kısa kod sağlamak için, veri odaklı bir uygulamayla nesne yönelimli sınıf tasarımını birleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-106">You can combine object-oriented class design with a data-oriented implementation to provide concise code while modeling real-world objects.</span></span>

<span data-ttu-id="70d67-107">Bu öğreticide aşağıdakilerin nasıl yapılacağını öğreneceksiniz:</span><span class="sxs-lookup"><span data-stu-id="70d67-107">In this tutorial, you'll learn how to:</span></span>

> [!div class="checklist"]
>
> - <span data-ttu-id="70d67-108">Veri desenleri kullanarak nesne yönelimli sınıflarınızı hızlı bir şekilde ifade edin.</span><span class="sxs-lookup"><span data-stu-id="70d67-108">Express your object oriented classes using data patterns.</span></span>
> - <span data-ttu-id="70d67-109">C# ' nin desen eşleştirme özelliklerini kullanarak bu desenleri uygulayın.</span><span class="sxs-lookup"><span data-stu-id="70d67-109">Implement those patterns using C#'s pattern matching features.</span></span>
> - <span data-ttu-id="70d67-110">Uygulamanızı doğrulamak için derleyici tanılarından yararlanın.</span><span class="sxs-lookup"><span data-stu-id="70d67-110">Leverage compiler diagnostics to validate your implementation.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="70d67-111">Önkoşullar</span><span class="sxs-lookup"><span data-stu-id="70d67-111">Prerequisites</span></span>

<span data-ttu-id="70d67-112">C# 9,0 derleyicisi dahil olmak üzere, makinenizi .NET 5 çalıştıracak şekilde ayarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="70d67-112">You’ll need to set up your machine to run .NET 5, including the C# 9.0 compiler.</span></span> <span data-ttu-id="70d67-113">C# 9,0 derleyicisi, [Visual Studio 2019 sürüm 16,8 Preview](https://visualstudio.microsoft.com/vs/preview/) veya [.NET 5,0 SDK Preview](https://dotnet.microsoft.com/download/dotnet/5.0)ile başlayarak kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="70d67-113">The C# 9.0 compiler is available starting with [Visual Studio 2019 version 16.8 preview](https://visualstudio.microsoft.com/vs/preview/) or the [.NET 5.0 SDK preview](https://dotnet.microsoft.com/download/dotnet/5.0).</span></span>

## <a name="build-a-simulation-of-a-canal-lock"></a><span data-ttu-id="70d67-114">Canal kilidi benzetimi oluşturma</span><span class="sxs-lookup"><span data-stu-id="70d67-114">Build a simulation of a canal lock</span></span>

<span data-ttu-id="70d67-115">Bu öğreticide, bir [Canal kilisini](https://en.wikipedia.org/wiki/Lock_(water_navigation))taklit eden bir C# sınıfı oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="70d67-115">In this tutorial, you'll build a C# class that simulates a [canal lock](https://en.wikipedia.org/wiki/Lock_(water_navigation)).</span></span> <span data-ttu-id="70d67-116">Kısaca, Canal kilidi, farklı düzeylerde iki su arasında hareket eden Boats çıkaran ve alçalmış bir cihazdır.</span><span class="sxs-lookup"><span data-stu-id="70d67-116">Briefly, a canal lock is a device that raises and lowers boats as they travel between two stretches of water at different levels.</span></span> <span data-ttu-id="70d67-117">Bir kilidin iki kapısı ve su düzeyini değiştirmek için bazı mekanizması vardır.</span><span class="sxs-lookup"><span data-stu-id="70d67-117">A lock has two gates and some mechanism to change the water level.</span></span>

<span data-ttu-id="70d67-118">Normal işleminde, bir bot bir kapıdan birine girdiğinde, kilit içindeki su düzeyi, bot 'ın girdiği taraftaki su düzeyiyle eşleşir.</span><span class="sxs-lookup"><span data-stu-id="70d67-118">In its normal operation, a boat enters one of the gates while the water level in the lock matches the water level on the side the boat enters.</span></span> <span data-ttu-id="70d67-119">Kilitte bir kez, su düzeyi, bot 'un kilidi bırakacağı su düzeyiyle eşleşecek şekilde değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="70d67-119">Once in the lock, the water level is changed to match the water level where the boat will leave the lock.</span></span> <span data-ttu-id="70d67-120">Su düzeyi bu kenar ile eşleştiğinde, çıkış tarafındaki kapı açılır.</span><span class="sxs-lookup"><span data-stu-id="70d67-120">Once the water level matches that side, the gate on the exit side opens.</span></span> <span data-ttu-id="70d67-121">Güvenlik önlemleri, bir işlecin Canal içinde tehlikeli bir durum oluşturmadığından emin olun.</span><span class="sxs-lookup"><span data-stu-id="70d67-121">Safety measures make sure an operator can't create a dangerous situation in the canal.</span></span> <span data-ttu-id="70d67-122">Su düzeyi yalnızca her iki kapı da kapalı olduğunda değiştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="70d67-122">The water level can be changed only when both gates are closed.</span></span> <span data-ttu-id="70d67-123">En fazla bir kapı açık olabilir.</span><span class="sxs-lookup"><span data-stu-id="70d67-123">At most one gate can be open.</span></span> <span data-ttu-id="70d67-124">Bir kapısı açmak için, kilit içindeki su düzeyi, açılmakta olan kapı dışında su düzeyiyle eşleşmelidir.</span><span class="sxs-lookup"><span data-stu-id="70d67-124">To open a gate, the water level in the lock must match the water level outside the gate being opened.</span></span>

<span data-ttu-id="70d67-125">Bu davranışı modellemek için bir C# sınıfı derleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-125">You can build a C# class to model this behavior.</span></span> <span data-ttu-id="70d67-126">Bir `CanalLock` sınıf, iki ağ geçidini açmak veya kapatmak için komutları destekler.</span><span class="sxs-lookup"><span data-stu-id="70d67-126">A `CanalLock` class would support commands to open or close either gate.</span></span> <span data-ttu-id="70d67-127">Su oluşturmak veya azaltmak için başka komutlara sahip olur.</span><span class="sxs-lookup"><span data-stu-id="70d67-127">It would have other commands to raise or lower the water.</span></span> <span data-ttu-id="70d67-128">Sınıfı ayrıca, her iki kapıların ve su düzeyinin geçerli durumunu okumak için özellikleri desteklemelidir.</span><span class="sxs-lookup"><span data-stu-id="70d67-128">The class should also support properties to read the current state of both gates and the water level.</span></span> <span data-ttu-id="70d67-129">Yöntemleriniz, güvenlik önlemlerini uygular.</span><span class="sxs-lookup"><span data-stu-id="70d67-129">Your methods implement the safety measures.</span></span>

## <a name="define-a-class"></a><span data-ttu-id="70d67-130">Sınıf tanımlama</span><span class="sxs-lookup"><span data-stu-id="70d67-130">Define a class</span></span>

<span data-ttu-id="70d67-131">Sınıfınızı test etmek için bir konsol uygulaması oluşturacaksınız `CanalLock` .</span><span class="sxs-lookup"><span data-stu-id="70d67-131">You'll build a console application to test your `CanalLock` class.</span></span> <span data-ttu-id="70d67-132">Visual Studio veya .NET CLı kullanarak .NET 5 için yeni bir konsol projesi oluşturun.</span><span class="sxs-lookup"><span data-stu-id="70d67-132">Create a new console project for .NET 5 using either Visual Studio or the .NET CLI.</span></span> <span data-ttu-id="70d67-133">Ardından, yeni bir sınıf ekleyin ve bunu adlandırın `CanalLock` .</span><span class="sxs-lookup"><span data-stu-id="70d67-133">Then, add a new class and name it `CanalLock`.</span></span> <span data-ttu-id="70d67-134">Sonra, genel API 'nizi tasarlayın, ancak uygulanmamış yöntemleri bırakın:</span><span class="sxs-lookup"><span data-stu-id="70d67-134">Next, design your public API, but leave the methods not implemented:</span></span>

:::code language="csharp" source="snippets/pattern-objects/InterimSteps.cs" ID="APIDesign":::

<span data-ttu-id="70d67-135">Yukarıdaki kod, her iki kapı da kapalı olacak şekilde nesneyi başlatır ve su düzeyi düşüktür.</span><span class="sxs-lookup"><span data-stu-id="70d67-135">The preceding code initializes the object so both gates are closed, and the water level is low.</span></span> <span data-ttu-id="70d67-136">Ardından, `Main` sınıfının ilk uygulamasını oluştururken size rehberlik etmek için aşağıdaki test kodunu yöntemine yazın:</span><span class="sxs-lookup"><span data-stu-id="70d67-136">Next, write the following test code in your `Main` method to guide you as you create a first implementation of the class:</span></span>

:::code language="csharp" source="snippets/pattern-objects/Program.cs" ID="HappyTests":::

<span data-ttu-id="70d67-137">Sonra, sınıfındaki her yöntemin ilk bir uygulamasını ekleyin `CanalLock` .</span><span class="sxs-lookup"><span data-stu-id="70d67-137">Next, add a first implementation of each method in the `CanalLock` class.</span></span> <span data-ttu-id="70d67-138">Aşağıdaki kod, güvenlik kurallarına gerek kalmadan sınıfının yöntemlerini uygular.</span><span class="sxs-lookup"><span data-stu-id="70d67-138">The following code implements the methods of the class without concern to the safety rules.</span></span> <span data-ttu-id="70d67-139">Güvenlik testlerini daha sonra ekleyeceksiniz:</span><span class="sxs-lookup"><span data-stu-id="70d67-139">You'll add safety tests later:</span></span>

:::code language="csharp" source="snippets/pattern-objects/InterimSteps.cs" ID="FirstImplementation":::

<span data-ttu-id="70d67-140">Şimdiye kadar yazdığınız testler.</span><span class="sxs-lookup"><span data-stu-id="70d67-140">The tests you've written so far pass.</span></span> <span data-ttu-id="70d67-141">Temel bilgileri uyguladık.</span><span class="sxs-lookup"><span data-stu-id="70d67-141">You've implemented the basics.</span></span> <span data-ttu-id="70d67-142">Şimdi, ilk başarısızlık koşulu için bir test yazın.</span><span class="sxs-lookup"><span data-stu-id="70d67-142">Now, write a test for the first failure condition.</span></span> <span data-ttu-id="70d67-143">Önceki testlerin sonunda, her iki kapı da kapalıdır ve su düzeyi Low olarak ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="70d67-143">At the end of the previous tests, both gates are closed, and the water level is set to low.</span></span> <span data-ttu-id="70d67-144">Üst ağ geçidini açmayı denemek için bir test ekleyin:</span><span class="sxs-lookup"><span data-stu-id="70d67-144">Add a test to try opening the upper gate:</span></span>

:::code language="csharp" source="snippets/pattern-objects/Program.cs" ID="HighGateSafetyTest":::

<span data-ttu-id="70d67-145">Ağ Geçidi açıldığı için bu test başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="70d67-145">This test fails because the gate opens.</span></span> <span data-ttu-id="70d67-146">İlk uygulama olarak, aşağıdaki kodla bu hatayı çözebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="70d67-146">As a first implementation, you could fix it with the following code:</span></span>

:::code language="csharp" source="snippets/pattern-objects/InterimSteps.cs" ID="SecondImplementation":::

<span data-ttu-id="70d67-147">Testleriniz başarılı.</span><span class="sxs-lookup"><span data-stu-id="70d67-147">Your tests pass.</span></span> <span data-ttu-id="70d67-148">Ancak, daha fazla test eklediğinizde daha fazla ve daha fazla `if` yan tümce ekleyecek ve farklı özellikleri test edeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-148">But, as you add more tests, you'll add more and more `if` clauses and test different properties.</span></span> <span data-ttu-id="70d67-149">Yakında, bu yöntemler daha fazla koşul eklerken çok karmaşık hale gelir.</span><span class="sxs-lookup"><span data-stu-id="70d67-149">Soon, these methods will get too complicated as you add more conditionals.</span></span>

## <a name="implement-the-commands-with-patterns"></a><span data-ttu-id="70d67-150">Komutları desenlerle uygulama</span><span class="sxs-lookup"><span data-stu-id="70d67-150">Implement the commands with patterns</span></span>

<span data-ttu-id="70d67-151">Daha iyi bir yol, nesnenin bir komutu yürütmek için geçerli bir durumda olup olmadığını belirleme *alışkanlıkları* kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="70d67-151">A better way is to use *patterns* to determine if the object is in a valid state to execute a command.</span></span> <span data-ttu-id="70d67-152">Üç değişkenin işlevi olarak bir komuta izin verilip verilmeyeceğini ifade edebilirsiniz: kapı durumu, su düzeyi ve yeni ayar:</span><span class="sxs-lookup"><span data-stu-id="70d67-152">You can express if a command is allowed as a function of three variables: the state of the gate, the level of the water, and the new setting:</span></span>

| <span data-ttu-id="70d67-153">Yeni ayar</span><span class="sxs-lookup"><span data-stu-id="70d67-153">New setting</span></span> | <span data-ttu-id="70d67-154">Kapı durumu</span><span class="sxs-lookup"><span data-stu-id="70d67-154">Gate state</span></span> | <span data-ttu-id="70d67-155">Su düzeyi</span><span class="sxs-lookup"><span data-stu-id="70d67-155">Water Level</span></span> | <span data-ttu-id="70d67-156">Sonuç</span><span class="sxs-lookup"><span data-stu-id="70d67-156">Result</span></span>             |
| ----------- | ---------- | ----------- | ------------------ |
| <span data-ttu-id="70d67-157">Kapatıldı</span><span class="sxs-lookup"><span data-stu-id="70d67-157">Closed</span></span>      | <span data-ttu-id="70d67-158">Kapatıldı</span><span class="sxs-lookup"><span data-stu-id="70d67-158">Closed</span></span>     | <span data-ttu-id="70d67-159">Yüksek</span><span class="sxs-lookup"><span data-stu-id="70d67-159">High</span></span>        | <span data-ttu-id="70d67-160">Kapatıldı</span><span class="sxs-lookup"><span data-stu-id="70d67-160">Closed</span></span>             |
| <span data-ttu-id="70d67-161">Kapatıldı</span><span class="sxs-lookup"><span data-stu-id="70d67-161">Closed</span></span>      | <span data-ttu-id="70d67-162">Kapatıldı</span><span class="sxs-lookup"><span data-stu-id="70d67-162">Closed</span></span>     | <span data-ttu-id="70d67-163">Düşük</span><span class="sxs-lookup"><span data-stu-id="70d67-163">Low</span></span>         | <span data-ttu-id="70d67-164">Kapatıldı</span><span class="sxs-lookup"><span data-stu-id="70d67-164">Closed</span></span>             |
| <span data-ttu-id="70d67-165">Kapatıldı</span><span class="sxs-lookup"><span data-stu-id="70d67-165">Closed</span></span>      | <span data-ttu-id="70d67-166">Aç</span><span class="sxs-lookup"><span data-stu-id="70d67-166">Open</span></span>       | <span data-ttu-id="70d67-167">Yüksek</span><span class="sxs-lookup"><span data-stu-id="70d67-167">High</span></span>        | <span data-ttu-id="70d67-168">Aç</span><span class="sxs-lookup"><span data-stu-id="70d67-168">Open</span></span>               |
| <span data-ttu-id="70d67-169">~~Kapatıldı~~</span><span class="sxs-lookup"><span data-stu-id="70d67-169">~~Closed~~</span></span>  | <span data-ttu-id="70d67-170">~~Aç~~</span><span class="sxs-lookup"><span data-stu-id="70d67-170">~~Open~~</span></span>   | <span data-ttu-id="70d67-171">~~Düşük~~</span><span class="sxs-lookup"><span data-stu-id="70d67-171">~~Low~~</span></span>     | <span data-ttu-id="70d67-172">~~Kapatıldı~~</span><span class="sxs-lookup"><span data-stu-id="70d67-172">~~Closed~~</span></span>         |
| <span data-ttu-id="70d67-173">Aç</span><span class="sxs-lookup"><span data-stu-id="70d67-173">Open</span></span>        | <span data-ttu-id="70d67-174">Kapatıldı</span><span class="sxs-lookup"><span data-stu-id="70d67-174">Closed</span></span>     | <span data-ttu-id="70d67-175">Yüksek</span><span class="sxs-lookup"><span data-stu-id="70d67-175">High</span></span>        | <span data-ttu-id="70d67-176">Aç</span><span class="sxs-lookup"><span data-stu-id="70d67-176">Open</span></span>               |
| <span data-ttu-id="70d67-177">Aç</span><span class="sxs-lookup"><span data-stu-id="70d67-177">Open</span></span>        | <span data-ttu-id="70d67-178">Kapatıldı</span><span class="sxs-lookup"><span data-stu-id="70d67-178">Closed</span></span>     | <span data-ttu-id="70d67-179">Düşük</span><span class="sxs-lookup"><span data-stu-id="70d67-179">Low</span></span>         | <span data-ttu-id="70d67-180">Kapalı (hata)</span><span class="sxs-lookup"><span data-stu-id="70d67-180">Closed (Error)</span></span>     |
| <span data-ttu-id="70d67-181">Aç</span><span class="sxs-lookup"><span data-stu-id="70d67-181">Open</span></span>        | <span data-ttu-id="70d67-182">Aç</span><span class="sxs-lookup"><span data-stu-id="70d67-182">Open</span></span>       | <span data-ttu-id="70d67-183">Yüksek</span><span class="sxs-lookup"><span data-stu-id="70d67-183">High</span></span>        | <span data-ttu-id="70d67-184">Aç</span><span class="sxs-lookup"><span data-stu-id="70d67-184">Open</span></span>               |
| <span data-ttu-id="70d67-185">~~Aç~~</span><span class="sxs-lookup"><span data-stu-id="70d67-185">~~Open~~</span></span>    | <span data-ttu-id="70d67-186">~~Aç~~</span><span class="sxs-lookup"><span data-stu-id="70d67-186">~~Open~~</span></span>   | <span data-ttu-id="70d67-187">~~Düşük~~</span><span class="sxs-lookup"><span data-stu-id="70d67-187">~~Low~~</span></span>     | <span data-ttu-id="70d67-188">~~Kapalı (hata)~~</span><span class="sxs-lookup"><span data-stu-id="70d67-188">~~Closed (Error)~~</span></span> |

<span data-ttu-id="70d67-189">Tablodaki dördüncü ve son satırlar, geçersiz oldukları için metnin üzerine çizili olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="70d67-189">The fourth and last rows in the table have strike through text because they're invalid.</span></span> <span data-ttu-id="70d67-190">Şimdi eklemekte olduğunuz kod, su düşük olduğunda yüksek su kapılı kapı olmadığından emin olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="70d67-190">The code you're adding now should make sure the high water gate is never opened when the water is low.</span></span>  <span data-ttu-id="70d67-191">Bu durumlar tek bir anahtar ifadesi olarak kodlanabilir ( `false` "Closed" olduğunu unutmayın):</span><span class="sxs-lookup"><span data-stu-id="70d67-191">Those states can be coded as a single switch expression (remember that `false` indicates "Closed"):</span></span>

:::code language="csharp" source="snippets/pattern-objects/InterimSteps.cs" ID="ThirdImplementation":::

<span data-ttu-id="70d67-192">Bu sürümü deneyin.</span><span class="sxs-lookup"><span data-stu-id="70d67-192">Try this version.</span></span> <span data-ttu-id="70d67-193">Testler, kodu doğrulayarak geçer.</span><span class="sxs-lookup"><span data-stu-id="70d67-193">Your tests pass, validating the code.</span></span> <span data-ttu-id="70d67-194">Tam tablo, girişlerin ve sonuçların olası birleşimlerini gösterir.</span><span class="sxs-lookup"><span data-stu-id="70d67-194">The full table shows the possible combinations of inputs and results.</span></span> <span data-ttu-id="70d67-195">Diğer bir deyişle, sizin ve diğer geliştiriciler tabloya hızlı bir şekilde bakabilir ve tüm olası girişleri kapsadığınızı görebilirler.</span><span class="sxs-lookup"><span data-stu-id="70d67-195">That means you and other developers can quickly look at the table and see that you've covered all the possible inputs.</span></span> <span data-ttu-id="70d67-196">Daha da kolay olsa da, derleyici de yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="70d67-196">Even easier, the compiler can help as well.</span></span> <span data-ttu-id="70d67-197">Önceki kodu ekledikten sonra, derleyicinin bir uyarı üretdiğini görebilirsiniz: *CS8524* , switch ifadesinin tüm olası girişleri kapsamadığını gösterir.</span><span class="sxs-lookup"><span data-stu-id="70d67-197">After you add the previous code, you can see that the compiler generates a warning: *CS8524* indicates the switch expression doesn't cover all possible inputs.</span></span> <span data-ttu-id="70d67-198">Bu uyarının nedeni girdilerden birinin bir tür olmasının nedenidir `enum` .</span><span class="sxs-lookup"><span data-stu-id="70d67-198">The reason for that warning is that one of the inputs is an `enum` type.</span></span> <span data-ttu-id="70d67-199">Derleyici, temel alınan türden tüm girişler olarak "tüm olası girişleri" Yorumlar, genellikle bir `int` .</span><span class="sxs-lookup"><span data-stu-id="70d67-199">The compiler interprets "all possible inputs" as all inputs from the underlying type, typically an `int`.</span></span> <span data-ttu-id="70d67-200">Bu `switch` ifade yalnızca içinde belirtilen değerleri denetler `enum` .</span><span class="sxs-lookup"><span data-stu-id="70d67-200">This `switch` expression only checks the values declared in the `enum`.</span></span> <span data-ttu-id="70d67-201">Uyarıyı kaldırmak için, ifadenin son ARM için bir catch-all atma kalıbı ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-201">To remove the warning, you can add a catch-all discard pattern for the last arm of the expression.</span></span> <span data-ttu-id="70d67-202">Bu durum geçersiz girişi gösterdiği için bir özel durum oluşturur:</span><span class="sxs-lookup"><span data-stu-id="70d67-202">This condition throws an exception, because it indicates invalid input:</span></span>

```csharp
_  => throw new InvalidOperationException("Invalid internal state"),
```

<span data-ttu-id="70d67-203">Önceki anahtar ARM, `switch` tüm girişlerle eşleştiğinden deyiminizdeki en son bir olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="70d67-203">The preceding switch arm must be last in your `switch` expression because it matches all inputs.</span></span> <span data-ttu-id="70d67-204">Daha önce sırayla taşıyarak deneyin.</span><span class="sxs-lookup"><span data-stu-id="70d67-204">Experiment by moving it earlier in the order.</span></span> <span data-ttu-id="70d67-205">Bu, bir düzende erişilemeyen kod için derleyici hatası *CS8510* neden olur.</span><span class="sxs-lookup"><span data-stu-id="70d67-205">That causes a compiler error *CS8510* for unreachable code in a pattern.</span></span>  <span data-ttu-id="70d67-206">Anahtar ifadelerinin doğal yapısı, derleyicinin olası hatalara karşı hata ve uyarı oluşturmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="70d67-206">The natural structure of switch expressions enables the compiler to generate errors and warnings for possible mistakes.</span></span> <span data-ttu-id="70d67-207">"Güvenlik ağı" derleyicisi, daha az yinelemede doğru kod oluşturmanızı ve anahtar kolları joker karakterlerle birleştirme özgürlüğünü kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="70d67-207">The compiler "safety net" makes it easier for you to create correct code in fewer iterations, and the freedom to combine switch arms with wildcards.</span></span> <span data-ttu-id="70d67-208">Eğer kombinasyonunuzu beklemediğiniz şekilde sonuçlanırsa, derleyici hatalara neden olur ve gerekli olan bir ARM 'yi kaldırırsanız uyarılar oluşur.</span><span class="sxs-lookup"><span data-stu-id="70d67-208">The compiler will issue errors if your combination results in unreachable arms you didn't expect, and warnings if you remove an arm that's needed.</span></span>

<span data-ttu-id="70d67-209">İlk değişiklik, komutun ağ geçidini kapatan tüm kolları birleştirmek olur; Bu her zaman izin verilir.</span><span class="sxs-lookup"><span data-stu-id="70d67-209">The first change is to combine all the arms where the command is to close the gate; that's always allowed.</span></span> <span data-ttu-id="70d67-210">Aşağıdaki kodu, anahtar ifadenizde ilk ARM olarak ekleyin:</span><span class="sxs-lookup"><span data-stu-id="70d67-210">Add the following code as the first arm in your switch expression:</span></span>

```csharp
(false, _, _) => false,
```

<span data-ttu-id="70d67-211">Önceki anahtar ARM 'yi ekledikten sonra, komutun olduğu her bir kolun üzerinde olmak üzere dört derleyici hatası alırsınız `false` .</span><span class="sxs-lookup"><span data-stu-id="70d67-211">After you add the previous switch arm, you'll get four compiler errors, one on each of the arms where the command is `false`.</span></span> <span data-ttu-id="70d67-212">Bu kollar zaten yeni eklenen ARM tarafından kapsanıyor.</span><span class="sxs-lookup"><span data-stu-id="70d67-212">Those arms are already covered by the newly added arm.</span></span> <span data-ttu-id="70d67-213">Bu dört satırı güvenle kaldırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-213">You can safely remove those four lines.</span></span> <span data-ttu-id="70d67-214">Bu koşulların yerini alacak bu yeni anahtar Kolonu hedeflenmiştir.</span><span class="sxs-lookup"><span data-stu-id="70d67-214">You intended this new switch arm to replace those conditions.</span></span>

<span data-ttu-id="70d67-215">Sonra, komutun ağ geçidini açmak için olduğu dört Kolonu basitleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-215">Next, you can simplify the four arms where the command is to open the gate.</span></span> <span data-ttu-id="70d67-216">Su düzeyi yüksek olan her iki durumda da ağ geçidi açılabilir.</span><span class="sxs-lookup"><span data-stu-id="70d67-216">In both cases where the water level is high, the gate can be opened.</span></span> <span data-ttu-id="70d67-217">(Bir arada zaten açıktır.) Su düzeyi düşük olan bir durum özel durum oluşturur ve diğeri gerçekleşmemelidir.</span><span class="sxs-lookup"><span data-stu-id="70d67-217">(In one, it's already open.) One case where the water level is low throws an exception, and the other shouldn't happen.</span></span> <span data-ttu-id="70d67-218">Su kilidi zaten geçersiz durumdaysa aynı özel durumu oluşturması güvenli olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="70d67-218">It should be safe to throw the same exception if the water lock is already in an invalid state.</span></span> <span data-ttu-id="70d67-219">Bu Koller için aşağıdaki basitleştirmeleri yapabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="70d67-219">You can make the following simplifications for those arms:</span></span>

```csharp
(true, _, WaterLevel.High) => true,
(true, false, WaterLevel.Low) => throw new InvalidOperationException("Cannot open high gate when the water is low"),
_ => throw new InvalidOperationException("Invalid internal state"),
```

<span data-ttu-id="70d67-220">Testlerinizi yeniden çalıştırın ve başarılı olurlar.</span><span class="sxs-lookup"><span data-stu-id="70d67-220">Run your tests again, and they pass.</span></span> <span data-ttu-id="70d67-221">Metodun son sürümü aşağıda verilmiştir `SetHighGate` :</span><span class="sxs-lookup"><span data-stu-id="70d67-221">Here's the final version of the `SetHighGate` method:</span></span>

:::code language="csharp" source="snippets/pattern-objects/CanalLock.cs" ID="FinalImplementaton":::

## <a name="implement-patterns-yourself"></a><span data-ttu-id="70d67-222">Desenleri kendiniz uygulayın</span><span class="sxs-lookup"><span data-stu-id="70d67-222">Implement patterns yourself</span></span>

<span data-ttu-id="70d67-223">Tekniği gördüğünüze göre, `SetLowGate` ve `SetWaterLevel` yöntemlerini kendiniz doldurmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="70d67-223">Now that you've seen the technique, fill in the `SetLowGate` and `SetWaterLevel` methods yourself.</span></span>  <span data-ttu-id="70d67-224">Bu yöntemlerde geçersiz işlemleri test etmek için aşağıdaki kodu ekleyerek başlayın:</span><span class="sxs-lookup"><span data-stu-id="70d67-224">Start by adding the following code to test invalid operations on those methods:</span></span>

:::code language="csharp" source="snippets/pattern-objects/Program.cs" ID="FinalTestCode":::

<span data-ttu-id="70d67-225">Uygulamanızı yeniden çalıştırın.</span><span class="sxs-lookup"><span data-stu-id="70d67-225">Run your application again.</span></span> <span data-ttu-id="70d67-226">Yeni testlerin başarısız olduğunu ve Canal kilidinin geçersiz bir duruma sahip olduğunu görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-226">You can see the new tests fail, and the canal lock gets into an invalid state.</span></span> <span data-ttu-id="70d67-227">Kalan yöntemleri kendiniz uygulamayı deneyin.</span><span class="sxs-lookup"><span data-stu-id="70d67-227">Try to implement the remaining methods yourself.</span></span> <span data-ttu-id="70d67-228">Alt ağ geçidini ayarlama yöntemi, üst ağ geçidini ayarlamak için yönteme benzer olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="70d67-228">The method to set the lower gate should be similar to the method to set the upper gate.</span></span> <span data-ttu-id="70d67-229">Su düzeyini değiştiren yöntemin farklı denetimleri vardır ancak benzer bir yapıyı izlemelidir.</span><span class="sxs-lookup"><span data-stu-id="70d67-229">The method that changes the water level has different checks, but should follow a similar structure.</span></span> <span data-ttu-id="70d67-230">Su düzeyini ayarlayan yöntemi için aynı işlemi kullanmayı yararlı bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-230">You may find it helpful to use the same process for the method that sets the water level.</span></span> <span data-ttu-id="70d67-231">Dört girişin tümü ile başlayın: her iki kapıların durumu, su düzeyinin geçerli durumu ve istenen yeni su düzeyi.</span><span class="sxs-lookup"><span data-stu-id="70d67-231">Start with all four inputs: The state of both gates, the current state of the water level, and the requested new water level.</span></span> <span data-ttu-id="70d67-232">Switch ifadesinin başlaması gerekir:</span><span class="sxs-lookup"><span data-stu-id="70d67-232">The switch expression should start with:</span></span>

```csharp
CanalLockWaterLevel = (newLevel, CanalLockWaterLevel, LowWaterGateOpen, HighWaterGateOpen) switch
{
    // elided
};
```

<span data-ttu-id="70d67-233">Doldurmanız gereken 16 toplam anahtar Kolonu olacak.</span><span class="sxs-lookup"><span data-stu-id="70d67-233">You'll have 16 total switch arms to fill in.</span></span> <span data-ttu-id="70d67-234">Ardından, test edin ve basitleştirir.</span><span class="sxs-lookup"><span data-stu-id="70d67-234">Then, test and simplify.</span></span>

<span data-ttu-id="70d67-235">Yöntem şöyle bir şey yaptınız mı?</span><span class="sxs-lookup"><span data-stu-id="70d67-235">Did you make methods something like this?</span></span>

:::code language="csharp" source="snippets/pattern-objects/CanalLock.cs" ID="FinalExercise":::

<span data-ttu-id="70d67-236">Testlerinizin geçmesi gerekir ve Canal kilidi güvenli bir şekilde çalışır.</span><span class="sxs-lookup"><span data-stu-id="70d67-236">Your tests should pass, and the canal lock should operate safely.</span></span>

## <a name="summary"></a><span data-ttu-id="70d67-237">Özet</span><span class="sxs-lookup"><span data-stu-id="70d67-237">Summary</span></span>

<span data-ttu-id="70d67-238">Bu öğreticide, bu durumda herhangi bir değişikliği uygulamadan önce bir nesnenin iç durumunu denetlemek için model eşleştirmeyi kullanmayı öğrendiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-238">In this tutorial, you learned to use pattern matching to check the internal state of an object before applying any changes to that state.</span></span> <span data-ttu-id="70d67-239">Özelliklerin birleşimlerini denetleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="70d67-239">You can check combinations of properties.</span></span> <span data-ttu-id="70d67-240">Bu geçişlerde herhangi biri için tablolar oluşturduktan sonra kodunuzu test edersiniz ve daha sonra okunabilirlik ve bakım için basitleştik.</span><span class="sxs-lookup"><span data-stu-id="70d67-240">Once you've built tables for any of those transitions, you test your code, then simplify for readability and maintainability.</span></span> <span data-ttu-id="70d67-241">Bu ilk yeniden düzenlemeler, iç durumu doğrulayan veya diğer API değişikliklerini yöneten daha fazla yeniden düzenlemeler önerebilir.</span><span class="sxs-lookup"><span data-stu-id="70d67-241">These initial refactorings may suggest further refactorings that validate internal state or manage other API changes.</span></span> <span data-ttu-id="70d67-242">Bu öğretici, sınıfları ve nesneleri, bu sınıfları uygulamaya yönelik daha fazla veri odaklı, desenli bir yaklaşımla birleştirmelidir.</span><span class="sxs-lookup"><span data-stu-id="70d67-242">This tutorial combined classes and objects with a more data-oriented, pattern-based approach to implement those classes.</span></span>
