---
title: Kaynaklar ve Kod
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
ms.openlocfilehash: 2917c9d15a6195c2d67781d6b2cfb0a5f1c136d3
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187165"
---
# <a name="resources-and-code"></a><span data-ttu-id="f77f9-102">Kaynaklar ve Kod</span><span class="sxs-lookup"><span data-stu-id="f77f9-102">Resources and Code</span></span>
<span data-ttu-id="f77f9-103">Bu genel bakış, [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] kaynakların sözdizimi yerine [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] kod kullanılarak nasıl erişilebildiği veya oluşturulabileceği üzerinde yoğunlaşmışolur.</span><span class="sxs-lookup"><span data-stu-id="f77f9-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="f77f9-104">Sözdizimi açısından genel kaynak kullanımı [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] ve kaynakları hakkında daha fazla bilgi için [Bkz. XAML Kaynakları.](xaml-resources.md)</span><span class="sxs-lookup"><span data-stu-id="f77f9-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](xaml-resources.md).</span></span>  

<a name="accessing"></a>
## <a name="accessing-resources-from-code"></a><span data-ttu-id="f77f9-105">Koddan Kaynaklara Erişim</span><span class="sxs-lookup"><span data-stu-id="f77f9-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="f77f9-106">Kaynaklar tanımlanıyorsa tanımlayan [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] anahtarlar, kaynağı kod olarak talep ederseniz belirli kaynakları almak için de kullanılır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="f77f9-107">Bir kaynağı koddan almanın en basit yolu, uygulamanızdaki çerçeve düzeyindeki nesnelerden ya da <xref:System.Windows.FrameworkElement.FindResource%2A> <xref:System.Windows.FrameworkElement.TryFindResource%2A> yöntemi aramaktır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="f77f9-108">Bu yöntemler arasındaki davranış farkı, istenen anahtar bulunamazsa ne olacağıdır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="f77f9-109"><xref:System.Windows.FrameworkElement.FindResource%2A>bir istisna getirir; <xref:System.Windows.FrameworkElement.TryFindResource%2A> bir özel durum yükseltmez, ancak döndürür. `null`</span><span class="sxs-lookup"><span data-stu-id="f77f9-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="f77f9-110">Her yöntem kaynak anahtarını giriş parametresi olarak alır ve gevşek bir şekilde yazılan nesneyi döndürür.</span><span class="sxs-lookup"><span data-stu-id="f77f9-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="f77f9-111">Genellikle, kaynak anahtarı bir dizedir, ancak zaman zaman nonstring kullanımları vardır; ayrıntılar için [Nesneleri Keys olarak kullanma](#objectaskey) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="f77f9-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="f77f9-112">Genellikle, döndürülen nesneyi kaynağı isterken ayarladığınız özelliğin gerektirdiği türe atarsınız.</span><span class="sxs-lookup"><span data-stu-id="f77f9-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="f77f9-113">Kod kaynağı çözümlemesi için arama mantığı dinamik [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] kaynak başvuru örneğiyle aynıdır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="f77f9-114">Kaynak arama sı çağrı öğesinden başlar, ardından mantıksal ağaçtaki ardışık üst öğeler devam edin.</span><span class="sxs-lookup"><span data-stu-id="f77f9-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="f77f9-115">Arama, gerekirse uygulama kaynaklarına, temalara ve sistem kaynaklarına doğru devam eder.</span><span class="sxs-lookup"><span data-stu-id="f77f9-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="f77f9-116">Kaynak için bir kod isteği, kaynak sözlüklerinden yüklenen [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]kaynak sözlüklerinden sonra yapılmış olabilecek çalışma zamanı değişikliklerini ve ayrıca gerçek zamanlı sistem kaynak değişikliklerini düzgün bir şekilde hesaba katar.</span><span class="sxs-lookup"><span data-stu-id="f77f9-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="f77f9-117">Aşağıda, anahtara göre bir kaynak bulan ve olay işleyicisi olarak uygulanan <xref:System.Windows.Controls.Primitives.ButtonBase.Click> bir özellik ayarlamak için döndürülen değeri kullanan kısa bir kod örneği verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="f77f9-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="f77f9-118">Kaynak başvurusu atamak için alternatif <xref:System.Windows.FrameworkElement.SetResourceReference%2A>bir yöntem.</span><span class="sxs-lookup"><span data-stu-id="f77f9-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="f77f9-119">Bu yöntem iki parametre alır: kaynak anahtarı ve kaynak değerinin atanması gereken öğe örneğinde bulunan belirli bir bağımlılık özelliği için tanımlayıcı.</span><span class="sxs-lookup"><span data-stu-id="f77f9-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="f77f9-120">İşlevsel olarak, bu yöntem aynıdır ve iade değerlerinin herhangi bir döküm gerektirmeyen avantajı vardır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="f77f9-121">Yine de kaynaklara programlı olarak erişmenin <xref:System.Windows.FrameworkElement.Resources%2A> başka bir yolu da, bir sözlük olarak özelliğin içeriğine erişmektir.</span><span class="sxs-lookup"><span data-stu-id="f77f9-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="f77f9-122">Bu özelliğin içerdiği sözlüklere erişmek, varolan koleksiyonlara yeni kaynaklar eklemenin, koleksiyonda belirli bir anahtar adının zaten alınıp alınıp alınıp alınmadığını ve diğer sözlük/toplama işlemlerine nasıl ekleyebileceğinizdir.</span><span class="sxs-lookup"><span data-stu-id="f77f9-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="f77f9-123">Bir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uygulamayı tamamen kodla yazıyorsanız, tüm koleksiyonu kod halinde oluşturabilir, anahtarları atayabilir ve tamamlanmış koleksiyonu <xref:System.Windows.FrameworkElement.Resources%2A> yerleşik bir öğenin özelliğine atayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f77f9-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="f77f9-124">Bu bir sonraki bölümde açıklanacaktır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="f77f9-125">Dizin olarak belirli <xref:System.Windows.FrameworkElement.Resources%2A> bir anahtar kullanarak belirli bir koleksiyon içinde dizin ekleyebilirsiniz, ancak kaynağa bu şekilde erişimin normal çalışma zamanı kaynak çözümleme kurallarına uymadığını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="f77f9-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="f77f9-126">Yalnızca belirli bir koleksiyona erişebiliyorsun.</span><span class="sxs-lookup"><span data-stu-id="f77f9-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="f77f9-127">İstenen anahtarda geçerli bir nesne bulunamazsa, kaynak araması kapsamı köke veya uygulamaya geçmeyecek.</span><span class="sxs-lookup"><span data-stu-id="f77f9-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="f77f9-128">Ancak, anahtar için arama kapsamı daha kısıtlı olduğundan, bu yaklaşım bazı durumlarda tam olarak performans avantajları olabilir.</span><span class="sxs-lookup"><span data-stu-id="f77f9-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="f77f9-129">Kaynak <xref:System.Windows.ResourceDictionary> sözlüğüyle doğrudan nasıl çalışacağınız hakkında daha fazla bilgi için sınıfa bakın.</span><span class="sxs-lookup"><span data-stu-id="f77f9-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>
## <a name="creating-resources-with-code"></a><span data-ttu-id="f77f9-130">Kodla Kaynak Oluşturma</span><span class="sxs-lookup"><span data-stu-id="f77f9-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="f77f9-131">Tüm [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uygulamayı kod halinde oluşturmak istiyorsanız, bu uygulamada kod içinde herhangi bir kaynak da oluşturmak isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f77f9-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="f77f9-132">Bunu başarmak için yeni <xref:System.Windows.ResourceDictionary> bir örnek oluşturun ve ardışık çağrıları kullanarak <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>tüm kaynakları bir biri ardına gelen çağrıları kullanarak sözlükte ekleyin.</span><span class="sxs-lookup"><span data-stu-id="f77f9-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f77f9-133">Daha sonra, <xref:System.Windows.ResourceDictionary> böylece bir <xref:System.Windows.FrameworkElement.Resources%2A> sayfa kapsamında mevcut bir öğe veya . <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="f77f9-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f77f9-134">Ayrıca, bir <xref:System.Windows.ResourceDictionary> öğeye eklemeden bağımsız bir nesne olarak koruyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f77f9-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="f77f9-135">Ancak, bunu yaparsanız, genel bir sözlük gibi, öğe anahtarı ile içindeki kaynaklara erişmelisiniz.</span><span class="sxs-lookup"><span data-stu-id="f77f9-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="f77f9-136">Bir <xref:System.Windows.ResourceDictionary> öğe `Resources` özelliğine bağlı olmayan bir öğe ağacının bir parçası olarak var olmaz ve ve tarafından <xref:System.Windows.FrameworkElement.FindResource%2A> ve ilgili yöntemler tarafından kullanılabilecek bir arama sırasına hiçbir kapsamı vardır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>
## <a name="using-objects-as-keys"></a><span data-ttu-id="f77f9-137">Nesneleri Anahtar Olarak Kullanma</span><span class="sxs-lookup"><span data-stu-id="f77f9-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="f77f9-138">Çoğu kaynak kullanımı, kaynağın anahtarını bir dize olarak ayarlar.</span><span class="sxs-lookup"><span data-stu-id="f77f9-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="f77f9-139">Ancak, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] çeşitli özellikler kasıtlı olarak anahtarları belirtmek için bir dize türü kullanmayın, bunun yerine bu parametre bir nesnedir.</span><span class="sxs-lookup"><span data-stu-id="f77f9-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="f77f9-140">Kaynağın bir nesne tarafından anahtarlanması [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] özelliği stil ve temalı destek tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="f77f9-141">Başka bir şekilde tarz olmayan bir denetim için varsayılan stil haline gelen <xref:System.Type> temalardaki stillerin her biri, başvurmaları gereken denetimin her biri tarafından anahtarlanır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="f77f9-142">Türe göre anahtarlı olmak, her denetim türünün varsayılan örnekleriüzerinde çalışan güvenilir bir arama mekanizması sağlar ve türemiş türde varsayılan bir stil olmasa bile, yansıma tarafından algılanabilir ve türemiş sınıfları şekillendirmek için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="f77f9-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="f77f9-143">[X:Type Markup](../../../desktop-wpf/xaml-services/xtype-markup-extension.md)Extension'ı [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] kullanarak tanımlanan bir kaynak için bir <xref:System.Type> anahtar belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="f77f9-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../../desktop-wpf/xaml-services/xtype-markup-extension.md).</span></span> <span data-ttu-id="f77f9-144">[BileşenKaynak Anahtar Biçimlendirme Uzantısı](componentresourcekey-markup-extension.md)gibi özellikleri [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] destekleyen diğer nonstring anahtar kullanımları için benzer uzantılar vardır.</span><span class="sxs-lookup"><span data-stu-id="f77f9-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f77f9-145">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="f77f9-145">See also</span></span>

- [<span data-ttu-id="f77f9-146">XAML Kaynakları</span><span class="sxs-lookup"><span data-stu-id="f77f9-146">XAML Resources</span></span>](xaml-resources.md)
- [<span data-ttu-id="f77f9-147">Stil ve Şablon Oluşturma</span><span class="sxs-lookup"><span data-stu-id="f77f9-147">Styling and Templating</span></span>](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
