---
description: 'Daha fazla bilgi edinin: bağlam değişimi Protokolü'
title: Bağlam Değişimi Protokolü
ms.date: 03/30/2017
ms.assetid: 3dfd38e0-ae52-491c-94f4-7a862b9843d4
ms.openlocfilehash: c4c81ef28821cd7373d53822728490d50687d5f2
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99780537"
---
# <a name="context-exchange-protocol"></a><span data-ttu-id="2e4c1-103">Bağlam Değişimi Protokolü</span><span class="sxs-lookup"><span data-stu-id="2e4c1-103">Context Exchange Protocol</span></span>

<span data-ttu-id="2e4c1-104">Bu bölümde, sürüm 3,5 ' de Windows Communication Foundation (WCF) sürümü .NET Framework tanıtılan bağlam Değişim Protokolü açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-104">This section describes the context exchange protocol introduced in Windows Communication Foundation (WCF) release .NET Framework version 3.5.</span></span> <span data-ttu-id="2e4c1-105">Bu protokol, istemci kanalının bir hizmet tarafından sağlanan bağlamı kabul etmesine ve bu hizmetin aynı istemci kanalı örneği üzerinden gönderilen sonraki tüm isteklere uygulanmasına olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-105">This protocol allows the client channel to accept a context supplied by a service and apply it to all subsequent requests to that service sent over the same client channel instance.</span></span> <span data-ttu-id="2e4c1-106">Bağlam değişimi Protokolü uygulaması, bağlamı sunucu ile istemci arasında yaymak için aşağıdaki iki mekanizmadan birini kullanabilir: HTTP tanımlama bilgileri veya bir SOAP üstbilgisi.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-106">The implementation of the context exchange protocol can use one of the following two mechanisms to propagate the context between the server and the client: HTTP cookies or a SOAP header.</span></span>  
  
 <span data-ttu-id="2e4c1-107">Bağlam değişimi Protokolü özel bir kanal katmanında uygulanır.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-107">The context exchange protocol is implemented in a custom channel layer.</span></span> <span data-ttu-id="2e4c1-108">Kanal, özelliği kullanarak uygulama katmanından ve öğesinden bağlamı iletişim kurar <xref:System.ServiceModel.Channels.ContextMessageProperty> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-108">The channel communicates the context to and from the application layer using a <xref:System.ServiceModel.Channels.ContextMessageProperty> property.</span></span> <span data-ttu-id="2e4c1-109">Uç noktalar arasındaki iletim için bağlam değeri, kanal katmanında bir SOAP üst bilgisi olarak serileştirilir veya bir HTTP isteğini ve yanıtını temsil eden ileti özelliklerinden veya bu özelliklerden dönüştürülür.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-109">For transmission between endpoints, the value of the context is either serialized as a SOAP header at the channel layer, or converted to or from the message properties that represent a HTTP request and response.</span></span> <span data-ttu-id="2e4c1-110">İkinci durumda, temel alınan kanal katmanlarından birinin HTTP istek ve yanıt iletisi özelliklerini sırasıyla HTTP tanımlama bilgilerine dönüştürdüğü beklenmektedir.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-110">In the latter case, it is expected that one of the underlying channel layers converts the HTTP request and response message properties to and from HTTP cookies, respectively.</span></span> <span data-ttu-id="2e4c1-111">Bağlamını değiştirmek için kullanılan mekanizmanın seçimi <xref:System.ServiceModel.Channels.ContextExchangeMechanism> , üzerindeki özelliği kullanılarak yapılır <xref:System.ServiceModel.Channels.ContextBindingElement> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-111">The choice of the mechanism used to exchange the context is done using the <xref:System.ServiceModel.Channels.ContextExchangeMechanism> property on the <xref:System.ServiceModel.Channels.ContextBindingElement>.</span></span> <span data-ttu-id="2e4c1-112">Geçerli değerler veya ' dir `HttpCookie` `SoapHeader` .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-112">Valid values are `HttpCookie` or `SoapHeader`.</span></span>  
  
 <span data-ttu-id="2e4c1-113">İstemcide, kanalın bir örneği, kanal özelliğindeki ayarlara bağlı olarak iki modda çalışabilir <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-113">On the client, an instance of a channel can operate in two modes based on the settings on the channel property, <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A>.</span></span>  
  
## <a name="mode-1-channel-context-management"></a><span data-ttu-id="2e4c1-114">Mod 1: Kanal bağlam yönetimi</span><span class="sxs-lookup"><span data-stu-id="2e4c1-114">Mode 1: Channel Context Management</span></span>  

 <span data-ttu-id="2e4c1-115">Bu, olarak ayarlandığı varsayılan moddur <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A> `true` .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-115">This is the default mode where <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A> is set to `true`.</span></span> <span data-ttu-id="2e4c1-116">Bu modda bağlam kanalı bağlamı yönetir ve ömrü boyunca bağlamı önbelleğe alır.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-116">In this mode the context channel manages the context and caches the context during its lifetime.</span></span> <span data-ttu-id="2e4c1-117">Bağlam, yöntemi çağırarak kanaldan Kanal özelliği aracılığıyla alınabilir `IContextManager` `GetContext` .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-117">Context can be retrieved from the channel through channel property `IContextManager` by calling the `GetContext` method.</span></span> <span data-ttu-id="2e4c1-118">Kanal, `SetContext` yöntemi Kanal özelliği üzerinde çağırarak açılmadan önce belirli bağlamla önceden başlatılabilir.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-118">The channel can also be pre-initialized with specific context before being opened by calling the `SetContext` method on the channel property.</span></span> <span data-ttu-id="2e4c1-119">Kanal, bağlamı ile başlatıldıktan sonra sıfırlanamaz.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-119">Once the channel is initialized with context it cannot be reset.</span></span>  
  
 <span data-ttu-id="2e4c1-120">Aşağıda, bu moddaki ınvarıant 'ların bir listesi verilmiştir:</span><span class="sxs-lookup"><span data-stu-id="2e4c1-120">The following is a list of invariants in this mode:</span></span>  
  
- <span data-ttu-id="2e4c1-121">Kanal açıldıktan sonra kullanarak bağlamı sıfırlama girişimleri `SetContext` bir oluşturur <xref:System.InvalidOperationException> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-121">Any attempt to reset the context using `SetContext` after the channel has been opened throws an <xref:System.InvalidOperationException>.</span></span>  
  
- <span data-ttu-id="2e4c1-122">Giden bir iletide öğesini kullanarak bağlamı gönderme girişimleri <xref:System.ServiceModel.Channels.ContextMessageProperty> bir oluşturur <xref:System.InvalidOperationException> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-122">Any attempt to send context by using the <xref:System.ServiceModel.Channels.ContextMessageProperty> in an outgoing message throws an <xref:System.InvalidOperationException>.</span></span>  
  
- <span data-ttu-id="2e4c1-123">Belirli bir içeriğe sahip sunucudan bir ileti alındığında, Kanal belirli bir içerikle zaten başlatılmış olduğunda, bu bir ile sonuçlanır <xref:System.ServiceModel.ProtocolException> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-123">If a message is received from server with a specific context, when the channel has already been initialized with a specific context, this results in a <xref:System.ServiceModel.ProtocolException>.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="2e4c1-124">Yalnızca Kanal açıkça herhangi bir bağlam kümesi olmadan açılırsa sunucudan ilk bağlam almak uygun olur.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-124">It is appropriate to receive an initial context from the server only if the channel is opened without any context set explicitly.</span></span>  
  
- <span data-ttu-id="2e4c1-125"><xref:System.ServiceModel.Channels.ContextMessageProperty>Gelen ileti her zaman null olur.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-125">The <xref:System.ServiceModel.Channels.ContextMessageProperty> on incoming message is always null.</span></span>  
  
## <a name="mode-2-application-context-management"></a><span data-ttu-id="2e4c1-126">Mod 2: uygulama bağlamı yönetimi</span><span class="sxs-lookup"><span data-stu-id="2e4c1-126">Mode 2: Application Context Management</span></span>  

 <span data-ttu-id="2e4c1-127">Bu mod <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A> olarak ayarlanır `false` .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-127">This is the mode when <xref:System.ServiceModel.Channels.IContextManager.Enabled%2A> is set to `false`.</span></span> <span data-ttu-id="2e4c1-128">Bu modda bağlam kanalı bağlamı yönetmez.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-128">In this mode the context channel does not manage context.</span></span> <span data-ttu-id="2e4c1-129">Kullanarak bağlamı alma, yönetme ve uygulama sorumluluğu uygulamanın sorumluluğundadır <xref:System.ServiceModel.Channels.ContextMessageProperty> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-129">It is the application's responsibility to retrieve, manage and apply context by using the <xref:System.ServiceModel.Channels.ContextMessageProperty>.</span></span> <span data-ttu-id="2e4c1-130">Herhangi bir çağrı yapmaya `GetContext` veya `SetContext` bir ile sonuçlanır <xref:System.InvalidOperationException> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-130">Any attempt to call `GetContext` or `SetContext` results in an <xref:System.InvalidOperationException>.</span></span>  
  
 <span data-ttu-id="2e4c1-131">Hangi modun seçildiği, istemci kanalı fabrikası, <xref:System.ServiceModel.Channels.IRequestChannel> <xref:System.ServiceModel.Channels.IRequestSessionChannel> ve <xref:System.ServiceModel.Channels.IDuplexSessionChannel> ileti değişimi modellerini destekler.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-131">No matter which mode is chosen the client channel factory supports <xref:System.ServiceModel.Channels.IRequestChannel>, <xref:System.ServiceModel.Channels.IRequestSessionChannel>, and <xref:System.ServiceModel.Channels.IDuplexSessionChannel> message exchange patterns.</span></span>  
  
 <span data-ttu-id="2e4c1-132">Hizmette, gelen iletilerde istemci tarafından sağlanan bağlamın öğesine dönüştürülmesi, kanalın bir örneği sorumludur <xref:System.ServiceModel.Channels.ContextMessageProperty> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-132">On the service, an instance of the channel is responsible for converting the context supplied by the client on incoming messages to the <xref:System.ServiceModel.Channels.ContextMessageProperty>.</span></span> <span data-ttu-id="2e4c1-133">İleti özelliğine daha sonra uygulama katmanı veya diğer kanallar tarafından çağrı yığınında daha fazla erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-133">The message property can then be accessed by the application layer or other channels further up in the call stack.</span></span> <span data-ttu-id="2e4c1-134">Hizmet kanalları aynı zamanda uygulama katmanının yanıt iletisine bir ekleyerek istemciye geri yayılacağı yeni bir içerik değeri belirtmesini de sağlar <xref:System.ServiceModel.Channels.ContextMessageProperty> .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-134">The service channels also allow the application layer to specify a new context value to be propagated back to the client by attaching a <xref:System.ServiceModel.Channels.ContextMessageProperty> to the response message.</span></span> <span data-ttu-id="2e4c1-135">Bu özellik, bağlamanın yapılandırmasına bağlı olarak, bağlamını içeren SOAP üstbilgisine veya HTTP tanımlama bilgisine dönüştürülür.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-135">This property is converted to the SOAP header or HTTP cookie that contains the context, which depends on the configuration of the binding.</span></span> <span data-ttu-id="2e4c1-136">Hizmet kanalı dinleyicisi,, <xref:System.ServiceModel.Channels.IReplyChannel> <xref:System.ServiceModel.Channels.IReplySessionChannel> ve <xref:System.ServiceModel.Channels.IReplySessionChannel> ileti değişimi düzenlerini destekler.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-136">The service channel listener supports <xref:System.ServiceModel.Channels.IReplyChannel>, <xref:System.ServiceModel.Channels.IReplySessionChannel>, and <xref:System.ServiceModel.Channels.IReplySessionChannel> message exchange patterns.</span></span>  
  
 <span data-ttu-id="2e4c1-137">Bağlam değişimi Protokolü, `wsc:Context` http tanımlama bilgileri bağlamı yaymakta olmadığında bağlam bilgilerini temsil eden yeni bir SOAP üst bilgisi tanıtır.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-137">The context exchange protocol introduces a new `wsc:Context` SOAP header to represent the context information when HTTP cookies are not used to propagate the context.</span></span> <span data-ttu-id="2e4c1-138">Bağlam üst bilgisi şeması, her biri dize anahtarı ve dize içeriği olan herhangi bir sayıda alt öğe sağlar.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-138">The context header schema allows for any number of child elements, each with a string key and string content.</span></span> <span data-ttu-id="2e4c1-139">Aşağıda bir bağlam üst bilgisi örneği verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-139">The following is an example of a context header.</span></span>  
  
 `<Context xmlns="http://schemas.microsoft.com/ws/2006/05/context">`  
  
 `<property name="myContext">context-2</property>`  
  
 `</Context>`  
  
 <span data-ttu-id="2e4c1-140">`HttpCookie`Modundayken, tanımlama bilgileri `SetCookie` üst bilgi kullanılarak ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-140">When in `HttpCookie` mode, cookies are set using the `SetCookie` header.</span></span> <span data-ttu-id="2e4c1-141">Tanımlama bilgisi adı `WscContext` .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-141">The cookie name is `WscContext`.</span></span> <span data-ttu-id="2e4c1-142">Tanımlama bilgisinin değeri, üst bilginin Base64 kodlamasıdır `wsc:Context` .</span><span class="sxs-lookup"><span data-stu-id="2e4c1-142">The value of the cookie is the Base64 encoding of the `wsc:Context` header.</span></span> <span data-ttu-id="2e4c1-143">Bu değer tırnak içine alınır.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-143">This value is enclosed in quotes.</span></span>  
  
 <span data-ttu-id="2e4c1-144">Bağlam değeri, aktarım sırasında aynı nedenden dolayı, WS-Addressing üst bilgilerin korunması durumunda değişiklik yapılmasının korunması gerekir. bu üst bilgi, isteğin hizmette nereye dağıtılacağını belirlemekte kullanılır.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-144">The value of the context must be protected from modification while in transit for the same reason WS-Addressing headers are protected – the header is used to determine where to dispatch the request to on the service.</span></span> <span data-ttu-id="2e4c1-145">`wsc:Context`Bu nedenle, bağlama ileti koruma özelliği sunduğunda, üst BILGININ SOAP veya Aktarım düzeyinde dijital olarak imzalanması ya da imzalanması ve şifrelenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-145">The `wsc:Context` header is therefore required to be digitally signed or signed and encrypted at either the SOAP or transport level when the binding offers message protection capability.</span></span> <span data-ttu-id="2e4c1-146">Bağlam yaymakta HTTP tanımlama bilgileri kullanıldığında, bunların aktarım güvenliği kullanılarak korunması gerekir.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-146">When HTTP cookies are used to propagate context, they should be protected using transport security.</span></span>  
  
 <span data-ttu-id="2e4c1-147">Bağlam değişimi Protokolü için destek gerektiren hizmet uç noktaları, yayımlanan ilkede açık hale gelir.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-147">Service endpoints that require support for the context exchange protocol can make it explicit in the published policy.</span></span> <span data-ttu-id="2e4c1-148">İstemcinin SOAP düzeyinde bağlam değişim protokolünü destekleme veya HTTP tanımlama bilgisi desteğini etkinleştirme gereksinimini temsil eden iki yeni ilke onayı eklenmiştir.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-148">Two new policy assertions have been introduced to represent the requirement for the client to support the context exchange protocol at the SOAP level or to enable HTTP cookie support.</span></span> <span data-ttu-id="2e4c1-149">Bu onayların hizmette ilke üzerinde oluşturulması, özelliğin değeri tarafından <xref:System.ServiceModel.Channels.ContextBindingElement.ContextExchangeMechanism%2A> aşağıdaki gibi denetlenir:</span><span class="sxs-lookup"><span data-stu-id="2e4c1-149">Generation of these assertions into the policy on the service is controlled by the value of the <xref:System.ServiceModel.Channels.ContextBindingElement.ContextExchangeMechanism%2A> property as follows:</span></span>  
  
- <span data-ttu-id="2e4c1-150">İçin <xref:System.ServiceModel.Channels.ContextExchangeMechanism.ContextSoapHeader> aşağıdaki onaylama oluşturulmuştur:</span><span class="sxs-lookup"><span data-stu-id="2e4c1-150">For <xref:System.ServiceModel.Channels.ContextExchangeMechanism.ContextSoapHeader>, the following assertion is generated:</span></span>  
  
    ```xml  
    <IncludeContext
    xmlns="http://schemas.microsoft.com/ws/2006/05/context"  
    protectionLevel="Sign" />  
    ```  
  
- <span data-ttu-id="2e4c1-151">İçin <xref:System.ServiceModel.Channels.ContextExchangeMechanism.HttpCookie> aşağıdaki onaylama oluşturulmuştur:</span><span class="sxs-lookup"><span data-stu-id="2e4c1-151">For <xref:System.ServiceModel.Channels.ContextExchangeMechanism.HttpCookie>, the following assertion is generated:</span></span>  
  
    ```xml  
    <HttpUseCookie xmlns="http://schemas.xmlsoap.org/soap/http"/>  
    ```  
  
## <a name="see-also"></a><span data-ttu-id="2e4c1-152">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="2e4c1-152">See also</span></span>

- [<span data-ttu-id="2e4c1-153">Web Hizmetleri Protokolleri Birlikte Çalışabilirlik Kılavuzu</span><span class="sxs-lookup"><span data-stu-id="2e4c1-153">Web Services Protocols Interoperability Guide</span></span>](web-services-protocols-interoperability-guide.md)
