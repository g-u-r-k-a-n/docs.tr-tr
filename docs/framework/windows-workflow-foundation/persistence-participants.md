---
title: Kalıcılık Katılımcıları
ms.date: 03/30/2017
ms.assetid: f84d2d5d-1c1b-4f19-be45-65b552d3e9e3
ms.openlocfilehash: 0bff6cc8fafb1832dc4d0e33b754fe3adb81dcf6
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/26/2020
ms.locfileid: "96246114"
---
# <a name="persistence-participants"></a><span data-ttu-id="d4b49-102">Kalıcılık Katılımcıları</span><span class="sxs-lookup"><span data-stu-id="d4b49-102">Persistence Participants</span></span>

<span data-ttu-id="d4b49-103">Kalıcılık Katılımcısı, bir uygulama ana bilgisayarı tarafından tetiklenen bir kalıcılık işlemine (kaydetme veya yükleme) katılabilir.</span><span class="sxs-lookup"><span data-stu-id="d4b49-103">A persistence participant can participate in a persistence operation (Save or Load) triggered by an application host.</span></span> <span data-ttu-id="d4b49-104">, [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] Bir Kalıcılık Katılımcısı oluşturmak için kullanabileceğiniz iki soyut sınıf ( **persistencekatılımcı** ve **Persistenceıopmakalenıpant**) ile birlikte gelir.</span><span class="sxs-lookup"><span data-stu-id="d4b49-104">The [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] ships with two abstract classes, **PersistenceParticipant** and **PersistenceIOParticipant**, which you can use to create a persistence participant.</span></span> <span data-ttu-id="d4b49-105">Bir Kalıcılık Katılımcısı, bu sınıfların birinden türetilir, ilgilendiğiniz yöntemleri uygular ve sonra bir sınıfının bir örneğini <xref:System.ServiceModel.Activities.WorkflowServiceHost.WorkflowExtensions%2A> koleksiyonuna ekler <xref:System.ServiceModel.Activities.WorkflowServiceHost> .</span><span class="sxs-lookup"><span data-stu-id="d4b49-105">A persistence participant derives from one of these classes, implements the methods of interest, and then adds an instance of the class to the <xref:System.ServiceModel.Activities.WorkflowServiceHost.WorkflowExtensions%2A> collection on the <xref:System.ServiceModel.Activities.WorkflowServiceHost> .</span></span> <span data-ttu-id="d4b49-106">Uygulama Konağı, bir iş akışı örneğini kalıcı hale getiren ve uygun zamanlarda Kalıcılık katılımcıları üzerinde uygun yöntemleri çağırdığınızda bu tür iş akışı uzantılarını arayabilir.</span><span class="sxs-lookup"><span data-stu-id="d4b49-106">The application host may look for such workflow extensions when persisting a workflow instance and invoke appropriate methods on the persistence participants at appropriate times.</span></span>  
  
 <span data-ttu-id="d4b49-107">Aşağıdaki listede, devam eden (Kaydet) işleminin farklı aşamalarda Kalıcılık alt sistemi tarafından gerçekleştirilen görevler açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-107">The following list describes the tasks performed by the persistence subsystem in different stages of the Persist (Save) operation.</span></span> <span data-ttu-id="d4b49-108">Kalıcılık katılımcıları, üçüncü ve dördüncü aşamalarda kullanılır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-108">The persistence participants are used in the third and fourth stages.</span></span> <span data-ttu-id="d4b49-109">Katılımcı bir g/ç katılımcısıdır (g/ç işlemlerine da katılan bir Kalıcılık Katılımcısı), katılımcı de altıncı aşamada kullanılır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-109">If the participant is an I/O participant (a persistence participant that also participates in I/O operations), the participant is also used in the sixth stage.</span></span>  
  
1. <span data-ttu-id="d4b49-110">İş akışı durumu, yer işaretleri, eşlenmiş değişkenler ve zaman damgası dahil yerleşik değerleri toplar.</span><span class="sxs-lookup"><span data-stu-id="d4b49-110">Gathers built-in values, including workflow state, bookmarks, mapped variables, and timestamp.</span></span>  
  
2. <span data-ttu-id="d4b49-111">İş akışı örneğiyle ilişkili uzantı koleksiyonuna eklenen tüm Kalıcılık katılımcılarını toplar.</span><span class="sxs-lookup"><span data-stu-id="d4b49-111">Gathers all persistence participants that were added to the extension collection associated with the workflow instance.</span></span>  
  
3. <span data-ttu-id="d4b49-112"><xref:System.Activities.Persistence.PersistenceParticipant.CollectValues%2A>Tüm Kalıcılık katılımcıları tarafından uygulanan yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-112">Invokes the <xref:System.Activities.Persistence.PersistenceParticipant.CollectValues%2A> method implemented by all persistence participants.</span></span>  
  
4. <span data-ttu-id="d4b49-113"><xref:System.Activities.Persistence.PersistenceParticipant.MapValues%2A>Tüm Kalıcılık katılımcıları tarafından uygulanan yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-113">Invokes the <xref:System.Activities.Persistence.PersistenceParticipant.MapValues%2A> method implemented by all persistence participants.</span></span>  
  
5. <span data-ttu-id="d4b49-114">İş akışını kalıcı hale getirin veya kalıcı depoya kaydedin.</span><span class="sxs-lookup"><span data-stu-id="d4b49-114">Persist or save the workflow into the persistence store.</span></span>  
  
6. <span data-ttu-id="d4b49-115"><xref:System.Activities.Persistence.PersistenceIOParticipant.BeginOnSave%2A>Tüm Kalıcılık g/ç katılımcıları üzerinde yöntemini çağırır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-115">Invokes the <xref:System.Activities.Persistence.PersistenceIOParticipant.BeginOnSave%2A> method on all of the persistence I/O participants.</span></span> <span data-ttu-id="d4b49-116">Katılımcı bir g/ç katılımcısı değilse, bu görev atlanır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-116">If the participant is not an I/O participant, this task is skipped.</span></span> <span data-ttu-id="d4b49-117">Kalıcılık bölümü işlem ise, işlem Transaction. Current özelliğinde sağlanır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-117">If the persistence episode is transactional, the transaction is provided in Transaction.Current property.</span></span>  
  
7. <span data-ttu-id="d4b49-118">Tüm Kalıcılık katılımcılarının tamamlanmasını bekler.</span><span class="sxs-lookup"><span data-stu-id="d4b49-118">Waits for all persistence participants to complete.</span></span> <span data-ttu-id="d4b49-119">Tüm katılımcılar kalıcı örnek verilerinde başarılı olursa, işlemi kaydeder.</span><span class="sxs-lookup"><span data-stu-id="d4b49-119">If all the participants succeed in persisting instance data, commits the transaction.</span></span>  
  
 <span data-ttu-id="d4b49-120">Bir Kalıcılık Katılımcısı, **persistencekatılımcı** sınıfından türetilir ve **CollectValues** ve **MapValues** yöntemlerini uygulayabilir.</span><span class="sxs-lookup"><span data-stu-id="d4b49-120">A persistence participant derives from the **PersistenceParticipant** class and may implement the **CollectValues** and **MapValues** methods.</span></span> <span data-ttu-id="d4b49-121">Kalıcılık g/ç katılımcısı, **Persistenceıopmakalenıpant** sınıfından türetilir ve **CollectValues** ve **MapValues** yöntemlerini uygulamaya ek olarak **BeginOnSave** metodunu uygulayabilir.</span><span class="sxs-lookup"><span data-stu-id="d4b49-121">A persistence I/O participant derives from the **PersistenceIOParticipant** class and may implement the **BeginOnSave** method in addition to implementing the **CollectValues** and **MapValues** methods.</span></span>  
  
 <span data-ttu-id="d4b49-122">Her aşama, sonraki aşama başlamadan önce tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-122">Each stage is completed before the next stage begins.</span></span> <span data-ttu-id="d4b49-123">Örneğin, ilk aşamadaki **Tüm** Kalıcılık katılımcılarının değerleri toplanır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-123">For example, values are collected from **all** persistence participants in the first stage.</span></span> <span data-ttu-id="d4b49-124">Ardından ilk aşamada toplanan tüm değerler, eşleme için ikinci aşamadaki tüm Kalıcılık katılımcılarına sağlanır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-124">Then all the values collected in the first stage are provided to all persistence participants in the second stage for mapping.</span></span> <span data-ttu-id="d4b49-125">Ardından ilk ve ikinci aşamada toplanan ve eşlenen tüm değerler, üçüncü aşamadaki Kalıcılık sağlayıcısına sağlanır ve bu şekilde devam eder.</span><span class="sxs-lookup"><span data-stu-id="d4b49-125">Then all the values collected and mapped in the first and second stages are provided to the persistence provider in the third stage, and so on.</span></span>  
  
 <span data-ttu-id="d4b49-126">Aşağıdaki listede, yük işleminin farklı aşamalarda Kalıcılık alt sistemi tarafından gerçekleştirilen görevler açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-126">The following list describes the tasks performed by the persistence subsystem in different stages of the Load operation.</span></span> <span data-ttu-id="d4b49-127">Kalıcılık katılımcıları dördüncü aşamada kullanılır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-127">The persistence participants are used in the fourth stage.</span></span> <span data-ttu-id="d4b49-128">Kalıcılık g/ç katılımcıları (Ayrıca g/ç işlemlerine katılan Kalıcılık katılımcıları) üçüncü aşamada de kullanılır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-128">The persistence I/O participants (persistence participants that also participate in I/O operations) are also used in the third stage.</span></span>  
  
1. <span data-ttu-id="d4b49-129">İş akışı örneğiyle ilişkili uzantı koleksiyonuna eklenen tüm Kalıcılık katılımcılarını toplar.</span><span class="sxs-lookup"><span data-stu-id="d4b49-129">Gathers all persistence participants that were added to the extension collection associated with the workflow instance.</span></span>  
  
2. <span data-ttu-id="d4b49-130">Kalıcılık deposundan iş akışını yükler.</span><span class="sxs-lookup"><span data-stu-id="d4b49-130">Loads the workflow from the persistence store.</span></span>  
  
3. <span data-ttu-id="d4b49-131"><xref:System.Activities.Persistence.PersistenceIOParticipant.BeginOnLoad%2A>Tüm Kalıcılık g/ç katılımcıları üzerinde öğesini çağırır ve tüm Kalıcılık katılımcılarının tamamlanmasını bekler.</span><span class="sxs-lookup"><span data-stu-id="d4b49-131">Invokes the <xref:System.Activities.Persistence.PersistenceIOParticipant.BeginOnLoad%2A> on all persistence I/O participants and waits for all the persistence participants to complete.</span></span> <span data-ttu-id="d4b49-132">Kalıcılık bölümü işlem halinde ise işlem Transaction. Current ' da sağlanır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-132">If the persistence episode is transactional, the transaction is provided in Transaction.Current.</span></span>  
  
4. <span data-ttu-id="d4b49-133">Kalıcılık deposundan alınan verileri temel alarak, belleğe iş akışı örneğini yükler.</span><span class="sxs-lookup"><span data-stu-id="d4b49-133">Loads the workflow instance in memory based on the data retrieved from the persistence store.</span></span>  
  
5. <span data-ttu-id="d4b49-134"><xref:System.Activities.Persistence.PersistenceParticipant.PublishValues%2A>Her bir Kalıcılık Katılımcısı üzerinde çağırır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-134">Invokes <xref:System.Activities.Persistence.PersistenceParticipant.PublishValues%2A> on each persistence participant.</span></span>  
  
 <span data-ttu-id="d4b49-135">Bir Kalıcılık Katılımcısı, **persistencekatılımcı** sınıfından türetilir ve **PublishValues** metodunu uygulayabilir.</span><span class="sxs-lookup"><span data-stu-id="d4b49-135">A persistence participant derives from the **PersistenceParticipant** class and may implement the **PublishValues** method.</span></span> <span data-ttu-id="d4b49-136">Kalıcılık g/ç katılımcısı, **Persistenceıopmakalenıpant** sınıfından türetilir ve **PublishValues** metodunu uygulamaya ek olarak **BeginOnLoad** metodunu uygulayabilir.</span><span class="sxs-lookup"><span data-stu-id="d4b49-136">A persistence I/O participant derives from the **PersistenceIOParticipant** class and may implement the **BeginOnLoad** method in addition to implementing the **PublishValues** method.</span></span>  
  
 <span data-ttu-id="d4b49-137">Bir iş akışı örneği yüklenirken kalıcılık sağlayıcısı bu örnekte bir kilit oluşturur.</span><span class="sxs-lookup"><span data-stu-id="d4b49-137">When loading a workflow instance the persistence provider creates a lock on that instance.</span></span> <span data-ttu-id="d4b49-138">Bu, örneğin çok düğümlü bir senaryoda birden çok konak tarafından yüklenmesini engeller.</span><span class="sxs-lookup"><span data-stu-id="d4b49-138">This prevents the instance from being loaded by more than one host in a multi-node scenario.</span></span> <span data-ttu-id="d4b49-139">Kilitlenen bir iş akışı örneğini yüklemeye çalışırsanız, şunlar gibi bir özel durum görürsünüz: "System. ServiceModel. kalıcılık. InstanceLockException:" 00000000-0000-0000-0000-000000000000 "örneği için kilit alınamadığından istenen işlem tamamlanamadı.</span><span class="sxs-lookup"><span data-stu-id="d4b49-139">If you attempt to load a workflow instance that has been locked you will see an exception like the following: The exception " System.ServiceModel.Persistence.InstanceLockException: The requested operation could not complete because the lock for instance '00000000-0000-0000-0000-000000000000' could not be acquired".</span></span> <span data-ttu-id="d4b49-140">Aşağıdakilerden biri gerçekleştiğinde bu hata oluşur:</span><span class="sxs-lookup"><span data-stu-id="d4b49-140">This error is caused when one of the following occurs:</span></span>  
  
- <span data-ttu-id="d4b49-141">Çok düğümlü bir senaryoda, örnek başka bir ana bilgisayar tarafından yüklenir.</span><span class="sxs-lookup"><span data-stu-id="d4b49-141">In a multi-node scenario the instance is loaded by another host.</span></span>  <span data-ttu-id="d4b49-142">Bu çakışma türlerini çözmek için birkaç farklı yol vardır: işlemeyi, kilidi olan düğüme iletin ve yeniden deneyin ya da yükü zorlamak için, diğer konağın çalışmalarını kaydedememesine neden olacak.</span><span class="sxs-lookup"><span data-stu-id="d4b49-142">There are a few different ways to resolve these types of conflicts: forward the processing to the node which owns the lock and retry, or force the load which will cause the other host to be unable to save their work.</span></span>  
  
- <span data-ttu-id="d4b49-143">Tek düğümlü bir senaryoda ve ana bilgisayar kilitlendi.</span><span class="sxs-lookup"><span data-stu-id="d4b49-143">In a single-node scenario and the host crashed.</span></span>  <span data-ttu-id="d4b49-144">Konak yeniden başlatıldığında (bir işlem geri dönüşümü veya yeni bir kalıcılık sağlayıcısı fabrikası oluştururken), kilidin henüz geçerliliği tamamlanmadığından, yeni ana bilgisayar eski ana bilgisayar tarafından kilitlenen bir örneği yüklemeye çalışır.</span><span class="sxs-lookup"><span data-stu-id="d4b49-144">When the host starts up again (a process recycle or creating a new persistence provider factory) the new host attempts to load an instance which is still locked by the old host because the lock hasn't expired yet.</span></span>  
  
- <span data-ttu-id="d4b49-145">Tek düğümlü bir senaryoda ve söz konusu örnek bir noktada durduruluyordu ve farklı bir ana bilgisayar KIMLIĞI olan yeni bir kalıcılık sağlayıcısı örneği oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="d4b49-145">In a single-node scenario and the instance in question was aborted at some point and a new persistence provider instance is created which has a different host ID.</span></span>  
  
 <span data-ttu-id="d4b49-146">Kilit zaman aşımı değeri varsayılan 5 dakikalık bir değere sahiptir, çağrılırken farklı bir zaman aşımı değeri belirtebilirsiniz <xref:System.ServiceModel.Persistence.PersistenceProvider.Load%2A> .</span><span class="sxs-lookup"><span data-stu-id="d4b49-146">The lock timeout value has a default value of 5 minutes, you can specify a different timeout value when calling <xref:System.ServiceModel.Persistence.PersistenceProvider.Load%2A>.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="d4b49-147">Bu Bölümde</span><span class="sxs-lookup"><span data-stu-id="d4b49-147">In This Section</span></span>  
  
- [<span data-ttu-id="d4b49-148">Nasıl yapılır: Özel Kalıcılık Katılımcısı Oluşturma</span><span class="sxs-lookup"><span data-stu-id="d4b49-148">How to: Create a Custom Persistence Participant</span></span>](how-to-create-a-custom-persistence-participant.md)  
  
## <a name="see-also"></a><span data-ttu-id="d4b49-149">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="d4b49-149">See also</span></span>

- [<span data-ttu-id="d4b49-150">Depo Genişletilebilirliği</span><span class="sxs-lookup"><span data-stu-id="d4b49-150">Store Extensibility</span></span>](store-extensibility.md)
