---
title: Mikro hizmetler arasında olay tabanlı iletişim uygulama (tümleştirme olayları)
description: Kapsayıcılı .NET uygulamaları için .NET mikro hizmetleri mimarisi | Mikro hizmetler arasında olay tabanlı iletişim uygulamak için tümleştirme olaylarını anlayın.
ms.date: 10/02/2018
ms.openlocfilehash: a355ba9ede4e3390edd858d173dd88548e876202
ms.sourcegitcommit: 5fb5b6520b06d7f5e6131ec2ad854da302a28f2e
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 12/03/2019
ms.locfileid: "74711221"
---
# <a name="implementing-event-based-communication-between-microservices-integration-events"></a><span data-ttu-id="a2dbd-103">Mikro hizmetler arasında olay tabanlı iletişim uygulama (tümleştirme olayları)</span><span class="sxs-lookup"><span data-stu-id="a2dbd-103">Implementing event-based communication between microservices (integration events)</span></span>

<span data-ttu-id="a2dbd-104">Daha önce açıklandığı gibi, olay tabanlı iletişimi kullandığınızda bir mikro hizmet, bir iş varlığını güncelleştirdiğinde olduğu gibi bir şey gerçekleştiğinde bir olay yayınlar.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-104">As described earlier, when you use event-based communication, a microservice publishes an event when something notable happens, such as when it updates a business entity.</span></span> <span data-ttu-id="a2dbd-105">Diğer mikro hizmetler bu olaylara abone olur.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-105">Other microservices subscribe to those events.</span></span> <span data-ttu-id="a2dbd-106">Bir mikro hizmet bir olay aldığında, kendi iş varlıklarını güncelleştirebilir ve bu da daha fazla olay yayımlanmaya neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-106">When a microservice receives an event, it can update its own business entities, which might lead to more events being published.</span></span> <span data-ttu-id="a2dbd-107">Bu, nihai tutarlılık kavramının özünü.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-107">This is the essence of the eventual consistency concept.</span></span> <span data-ttu-id="a2dbd-108">Bu yayımlama/abone olma sistemi genellikle bir olay veri yolunun uygulanması kullanılarak gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-108">This publish/subscribe system is usually performed by using an implementation of an event bus.</span></span> <span data-ttu-id="a2dbd-109">Olay veri yolu, olaylara abone olmak ve olayları kaldırmak ve olayları yayımlamak için gereken API ile bir arabirim olarak tasarlanabilir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-109">The event bus can be designed as an interface with the API needed to subscribe and unsubscribe to events and to publish events.</span></span> <span data-ttu-id="a2dbd-110">Ayrıca, bir mesajlaşma kuyruğu veya zaman uyumsuz iletişimi destekleyen bir hizmet veri yolu veya bir yayımlama/abonelik modeli gibi işlem içi veya mesajlaşma iletişimine dayalı bir veya daha fazla uygulama olabilir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-110">It can also have one or more implementations based on any inter-process or messaging communication, such as a messaging queue or a service bus that supports asynchronous communication and a publish/subscribe model.</span></span>

<span data-ttu-id="a2dbd-111">Olayları, bu hizmetler arasında nihai tutarlılık sağlayan birden çok hizmete yayılan iş işlemlerini uygulamak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-111">You can use events to implement business transactions that span multiple services, which gives you eventual consistency between those services.</span></span> <span data-ttu-id="a2dbd-112">Sonuçta tutarlı bir işlem, bir dizi dağıtılmış eylemden oluşur.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-112">An eventually consistent transaction consists of a series of distributed actions.</span></span> <span data-ttu-id="a2dbd-113">Her eylemde, mikro hizmet bir iş varlığını güncelleştirir ve sonraki eylemi tetikleyen bir olay yayımlar.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-113">At each action, the microservice updates a business entity and publishes an event that triggers the next action.</span></span> <span data-ttu-id="a2dbd-114">Şekil 6-18 aşağıdaki şekilde, ve olay veri yolu aracılığıyla yayınlanan PriceUpdated olayını gösterir, bu nedenle fiyat güncelleştirmesi sepet ve diğer mikro hizmetlere yayılır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-114">Figure 6-18 below, shows a PriceUpdated event published through and event bus, so the price update is propagated to the Basket and other microservices.</span></span>

![Olay veri yolu ile zaman uyumsuz olay odaklı iletişimin diyagramı.](./media/integration-event-based-microservice-communications/event-driven-communication.png)

<span data-ttu-id="a2dbd-116">**Şekil 6-18**.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-116">**Figure 6-18**.</span></span> <span data-ttu-id="a2dbd-117">Olay veri yoluna dayalı olay odaklı iletişim</span><span class="sxs-lookup"><span data-stu-id="a2dbd-117">Event-driven communication based on an event bus</span></span>

<span data-ttu-id="a2dbd-118">Bu bölümde, Şekil 6-18 ' de gösterildiği gibi, .NET ile bu tür iletişimin nasıl uygulanacağı açıklanır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-118">This section describes how you can implement this type of communication with .NET by using a generic event bus interface, as shown in Figure 6-18.</span></span> <span data-ttu-id="a2dbd-119">Her biri, Korbbitmq, Azure Service Bus veya diğer üçüncü taraf açık kaynaklı veya ticari hizmet veri yolu gibi farklı bir teknoloji veya altyapıyı kullanan birden çok olası uygulama vardır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-119">There are multiple potential implementations, each using a different technology or infrastructure such as RabbitMQ, Azure Service Bus, or any other third-party open-source or commercial service bus.</span></span>

## <a name="using-message-brokers-and-services-buses-for-production-systems"></a><span data-ttu-id="a2dbd-120">Üretim sistemleri için ileti aracılarını ve hizmet veri yollarını kullanma</span><span class="sxs-lookup"><span data-stu-id="a2dbd-120">Using message brokers and services buses for production systems</span></span>

<span data-ttu-id="a2dbd-121">Mimari bölümünde belirtildiği gibi, soyut olay veri yolunu uygulamak için birden çok mesajlaşma teknolojisinden seçim yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-121">As noted in the architecture section, you can choose from multiple messaging technologies for implementing your abstract event bus.</span></span> <span data-ttu-id="a2dbd-122">Ancak bu teknolojiler farklı düzeylerde bulunur.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-122">But these technologies are at different levels.</span></span> <span data-ttu-id="a2dbd-123">Örneğin, bir mesajlaşma Aracısı taşıması olan Kbbitmq, Azure Service Bus, NServiceBus, Masstransıya veya daha parlak gibi ticari ürünlerden daha düşük bir düzeyindedir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-123">For instance, RabbitMQ, a messaging broker transport, is at a lower level than commercial products like Azure Service Bus, NServiceBus, MassTransit, or Brighter.</span></span> <span data-ttu-id="a2dbd-124">Bu ürünlerin çoğu, Korbbitmq veya Azure Service Bus üzerinde çalışabilir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-124">Most of these products can work on top of either RabbitMQ or Azure Service Bus.</span></span> <span data-ttu-id="a2dbd-125">Ürün seçiminiz, uygulamanız için ne kadar özellik ve ne kadar hazır ölçeklenebilirlik için ihtiyaç duydığınıza bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-125">Your choice of product depends on how many features and how much out-of-the-box scalability you need for your application.</span></span>

<span data-ttu-id="a2dbd-126">EShopOnContainers örneğinde olduğu gibi, geliştirme ortamınız için yalnızca bir olay veri yolu kavramını uygulamak amacıyla, bir kapsayıcı olarak çalışan Kbbitmq üzerinde basit bir uygulama yeterince olabilir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-126">For implementing just an event bus proof-of-concept for your development environment, as in the eShopOnContainers sample, a simple implementation on top of RabbitMQ running as a container might be enough.</span></span> <span data-ttu-id="a2dbd-127">Ancak, yüksek ölçeklenebilirlik gerektiren görev açısından kritik ve üretim sistemlerinde Azure Service Bus değerlendirmek ve kullanmak isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-127">But for mission-critical and production systems that need high scalability, you might want to evaluate and use Azure Service Bus.</span></span>

<span data-ttu-id="a2dbd-128">Dağıtılmış geliştirmeyi daha kolay hale getirmek için yüksek düzeyde soyut ve çok daha zengin özellikler, örneğin NServiceBus, Masstransıya ve daha [parlak gibi diğer](https://docs.particular.net/nservicebus/sagas/) ticari ve açık kaynaklı hizmet yolları gerekir irsiniz.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-128">If you require high-level abstractions and richer features like [Sagas](https://docs.particular.net/nservicebus/sagas/) for long-running processes that make distributed development easier, other commercial and open-source service buses like NServiceBus, MassTransit, and Brighter are worth evaluating.</span></span> <span data-ttu-id="a2dbd-129">Bu durumda, kullanılacak soyutlamalar ve API genellikle kendi soyutlamaları yerine bu üst düzey hizmet veri yolları tarafından sağlananlar olur ( [eShopOnContainers 'da sunulan basit olay veri yolu soyutlaması](https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/BuildingBlocks/EventBus/EventBus/Abstractions/IEventBus.cs)gibi).</span><span class="sxs-lookup"><span data-stu-id="a2dbd-129">In this case, the abstractions and API to use would usually be directly the ones provided by those high-level service buses instead of your own abstractions (like the [simple event bus abstractions provided at eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/BuildingBlocks/EventBus/EventBus/Abstractions/IEventBus.cs)).</span></span> <span data-ttu-id="a2dbd-130">Bu şekilde, NServiceBus (belirli yazılımlar tarafından uygulanan ek türetilmiş örnek) [kullanarak, forlenmiş eShopOnContainers](https://go.particular.net/eShopOnContainers) 'ı araştırabilirsiniz</span><span class="sxs-lookup"><span data-stu-id="a2dbd-130">For that matter, you can research the [forked eShopOnContainers using NServiceBus](https://go.particular.net/eShopOnContainers) (additional derived sample implemented by Particular Software)</span></span>

<span data-ttu-id="a2dbd-131">Tabii ki, her zaman Pbbitmq ve Docker gibi alt düzey teknolojilerin üzerinde kendi hizmet veri yolu özelliklerini derleyebilir, ancak "tekerleği yeniden bağlamak" için gereken iş, özel bir kurumsal uygulama için çok maliyetli olabilir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-131">Of course, you could always build your own service bus features on top of lower-level technologies like RabbitMQ and Docker, but the work needed to “reinvent the wheel” might be too costly for a custom enterprise application.</span></span>

<span data-ttu-id="a2dbd-132">Yeniden yinelemek için: eShopOnContainers örneğinde gösterilen örnek olay veri yolu soyutlamaları ve uygulama, yalnızca kavram kanıtı olarak kullanılmak üzere tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-132">To reiterate: the sample event bus abstractions and implementation showcased in the eShopOnContainers sample are intended to be used only as a proof of concept.</span></span> <span data-ttu-id="a2dbd-133">Geçerli bölümde açıklandığı gibi zaman uyumsuz ve olay odaklı iletişim sağlamak istediğinize karar verdikten sonra, üretim için gereksinimlerinize en uygun hizmet veri yolu ürününü seçmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-133">Once you have decided that you want to have asynchronous and event-driven communication, as explained in the current section, you should choose the service bus product that best fits your needs for production.</span></span>

## <a name="integration-events"></a><span data-ttu-id="a2dbd-134">Tümleştirme olayları</span><span class="sxs-lookup"><span data-stu-id="a2dbd-134">Integration events</span></span>

<span data-ttu-id="a2dbd-135">Tümleştirme olayları, etki alanı durumunun birden fazla mikro hizmet veya dış sistemler arasında eşitlenmiş şekilde getirilmesi için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-135">Integration events are used for bringing domain state in sync across multiple microservices or external systems.</span></span> <span data-ttu-id="a2dbd-136">Bu, mikro hizmet dışındaki tümleştirme olayları yayınlanarak yapılır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-136">This is done by publishing integration events outside the microservice.</span></span> <span data-ttu-id="a2dbd-137">Bir olay birden çok alıcı mikro hizmetine yayımlandığında (Tümleştirme olayına abone olan çok sayıda mikro hizmet için), her bir alıcı mikro hizmetindeki uygun olay işleyicisi olayı işler.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-137">When an event is published to multiple receiver microservices (to as many microservices as are subscribed to the integration event), the appropriate event handler in each receiver microservice handles the event.</span></span>

<span data-ttu-id="a2dbd-138">Bir tümleştirme olayı, aşağıdaki örnekte olduğu gibi temel olarak veri tutan bir sınıftır:</span><span class="sxs-lookup"><span data-stu-id="a2dbd-138">An integration event is basically a data-holding class, as in the following example:</span></span>

```csharp
public class ProductPriceChangedIntegrationEvent : IntegrationEvent
{
    public int ProductId { get; private set; }
    public decimal NewPrice { get; private set; }
    public decimal OldPrice { get; private set; }

    public ProductPriceChangedIntegrationEvent(int productId, decimal newPrice,
        decimal oldPrice)
    {
        ProductId = productId;
        NewPrice = newPrice;
        OldPrice = oldPrice;
    }
}
```

<span data-ttu-id="a2dbd-139">Tümleştirme olayları, her bir mikro hizmetin uygulama düzeyinde tanımlanabilir, bu nedenle diğer mikro hizmetlerden farklı olarak, görüntü modellerinin sunucu ve istemcide nasıl tanımlandıklarından bağımsız olarak bir şekilde ayrılır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-139">The integration events can be defined at the application level of each microservice, so they are decoupled from other microservices, in a way comparable to how ViewModels are defined in the server and client.</span></span> <span data-ttu-id="a2dbd-140">Çok sayıda mikro hizmette ortak bir tümleştirme olayları kitaplığını paylaşma önerilmez; Bunun yapılması, bu mikro hizmetlerden tek bir olay tanımı veri kitaplığıyla eşlenmelidir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-140">What is not recommended is sharing a common integration events library across multiple microservices; doing that would be coupling those microservices with a single event definition data library.</span></span> <span data-ttu-id="a2dbd-141">Birden çok mikro hizmette ortak bir etki alanı modeli paylaşmak istemediğiniz nedenlerle bunu yapmak istemezsiniz: mikro hizmetler tamamen otonom olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-141">You do not want to do that for the same reasons that you do not want to share a common domain model across multiple microservices: microservices must be completely autonomous.</span></span>

<span data-ttu-id="a2dbd-142">Mikro hizmetler arasında paylaşmanız gereken yalnızca birkaç kitaplık türü vardır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-142">There are only a few kinds of libraries you should share across microservices.</span></span> <span data-ttu-id="a2dbd-143">Bir tane, eShopOnContainers içinde olduğu gibi, [olay veri yolu istemci API 'si](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/BuildingBlocks/EventBus)gibi son uygulama blokları olan kitaplıklardır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-143">One is libraries that are final application blocks, like the [Event Bus client API](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/BuildingBlocks/EventBus), as in eShopOnContainers.</span></span> <span data-ttu-id="a2dbd-144">Diğer bir deyişle, JSON serileştiricileri gibi NuGet bileşenleri olarak da paylaşılabilen araçlar oluşturan kitaplıklarıdır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-144">Another is libraries that constitute tools that could also be shared as NuGet components, like JSON serializers.</span></span>

## <a name="the-event-bus"></a><span data-ttu-id="a2dbd-145">Olay veri yolu</span><span class="sxs-lookup"><span data-stu-id="a2dbd-145">The event bus</span></span>

<span data-ttu-id="a2dbd-146">Bir olay veri yolu, Şekil 6-19 ' de gösterildiği gibi, bileşenlerin birbirleriyle açıkça farkında olması gerekmeden mikro hizmetler arasında yayımlama/abonelik stili iletişim sağlar.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-146">An event bus allows publish/subscribe-style communication between microservices without requiring the components to explicitly be aware of each other, as shown in Figure 6-19.</span></span>

![Temel yayımla/abone ol deseninin gösterildiği diyagram.](./media/integration-event-based-microservice-communications/publish-subscribe-basics.png)

<span data-ttu-id="a2dbd-148">**Şekil 6-19**.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-148">**Figure 6-19**.</span></span> <span data-ttu-id="a2dbd-149">Bir olay veri yolundan temel olarak yayımlama/abone olma</span><span class="sxs-lookup"><span data-stu-id="a2dbd-149">Publish/subscribe basics with an event bus</span></span>

<span data-ttu-id="a2dbd-150">Yukarıdaki diyagramda, mikro hizmet B ve C 'yi abone olarak yayımlayan ve yayımcı tarafından abonelere gerek duymadan bir olay veri yolu yayımlayıcısı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-150">The above diagram shows that microservice A publishes to Event Bus, which distributes to subscribing microservices B and C, without the publisher needing to know the subscribers.</span></span> <span data-ttu-id="a2dbd-151">Olay veri yolu, gözlemci düzeniyle ve Yayımla-abone ol düzeniyle ilgilidir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-151">The event bus is related to the Observer pattern and the publish-subscribe pattern.</span></span>

### <a name="observer-pattern"></a><span data-ttu-id="a2dbd-152">Gözlemci kalıbı</span><span class="sxs-lookup"><span data-stu-id="a2dbd-152">Observer pattern</span></span>

<span data-ttu-id="a2dbd-153">[Gözlemci](https://en.wikipedia.org/wiki/Observer_pattern)düzeninde, birincil nesneniz (observable olarak bilinir) ilgili bilgileri (olay) ile ilgili diğer nesneleri (observers olarak bilinir) bilgilendirir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-153">In the [Observer pattern](https://en.wikipedia.org/wiki/Observer_pattern), your primary object (known as the Observable) notifies other interested objects (known as Observers) with relevant information (events).</span></span>

### <a name="publishsubscribe-pubsub-pattern"></a><span data-ttu-id="a2dbd-154">Yayımla/abone ol (yayımlama/alt) kalıbı</span><span class="sxs-lookup"><span data-stu-id="a2dbd-154">Publish/Subscribe (Pub/Sub) pattern</span></span>

<span data-ttu-id="a2dbd-155">[Yayımla/abone ol deseninin](https://docs.microsoft.com/previous-versions/msp-n-p/ff649664(v=pandp.10)) amacı gözlemci düzeniyle aynıdır: belirli olaylar gerçekleşirken diğer hizmetlere bildirimde bulunmasını istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-155">The purpose of the [Publish/Subscribe pattern](https://docs.microsoft.com/previous-versions/msp-n-p/ff649664(v=pandp.10)) is the same as the Observer pattern: you want to notify other services when certain events take place.</span></span> <span data-ttu-id="a2dbd-156">Ancak gözlemci ve Pub/Sub desenleri arasında önemli bir farklılık vardır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-156">But there is an important difference between the Observer and Pub/Sub patterns.</span></span> <span data-ttu-id="a2dbd-157">Gözlemci modelinde, yayın doğrudan observable 'dan observers 'a yapılır, bu nedenle birbirini "bilir".</span><span class="sxs-lookup"><span data-stu-id="a2dbd-157">In the observer pattern, the broadcast is performed directly from the observable to the observers, so they “know” each other.</span></span> <span data-ttu-id="a2dbd-158">Ancak, bir yayın/alt model kullanılırken, aracı veya ileti Aracısı ya da yayımcı ve abone tarafından bilinen olay veri yolu adlı üçüncü bir bileşen vardır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-158">But when using a Pub/Sub pattern, there is a third component, called broker or message broker or event bus, which is known by both the publisher and subscriber.</span></span> <span data-ttu-id="a2dbd-159">Bu nedenle, yayın/alt model kullanılırken yayımcı ve aboneler, belirtilen olay veri yolu veya ileti aracısına tam olarak bir şekilde ayrılır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-159">Therefore, when using the Pub/Sub pattern the publisher and the subscribers are precisely decoupled thanks to the mentioned event bus or message broker.</span></span>

### <a name="the-middleman-or-event-bus"></a><span data-ttu-id="a2dbd-160">Middleman veya olay veri yolu</span><span class="sxs-lookup"><span data-stu-id="a2dbd-160">The middleman or event bus</span></span>

<span data-ttu-id="a2dbd-161">Yayımcı ve abone arasında nasıl anonimlik elde edersiniz?</span><span class="sxs-lookup"><span data-stu-id="a2dbd-161">How do you achieve anonymity between publisher and subscriber?</span></span> <span data-ttu-id="a2dbd-162">Kolay bir yol, tüm iletişimin Middleman bir ele almasına olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-162">An easy way is let a middleman take care of all the communication.</span></span> <span data-ttu-id="a2dbd-163">Bir olay veri yolu, Middleman.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-163">An event bus is one such middleman.</span></span>

<span data-ttu-id="a2dbd-164">Olay veri yolu genellikle iki bölümden oluşur:</span><span class="sxs-lookup"><span data-stu-id="a2dbd-164">An event bus is typically composed of two parts:</span></span>

- <span data-ttu-id="a2dbd-165">Soyutlama veya arabirim.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-165">The abstraction or interface.</span></span>

- <span data-ttu-id="a2dbd-166">Bir veya daha fazla uygulama.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-166">One or more implementations.</span></span>

<span data-ttu-id="a2dbd-167">Şekil 6-19 ' de, bir uygulama görünümünden, olay veri yolunun bir yayın/alt kanaldan ne kadar fazla şey olduğu hakkında bilgi alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-167">In Figure 6-19 you can see how, from an application point of view, the event bus is nothing more than a Pub/Sub channel.</span></span> <span data-ttu-id="a2dbd-168">Bu zaman uyumsuz iletişimi uygulama yönteminiz farklılık gösterebilir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-168">The way you implement this asynchronous communication can vary.</span></span> <span data-ttu-id="a2dbd-169">Ortam gereksinimlerine (örneğin, üretim ve geliştirme ortamlarına göre) bağlı olarak, aralarında geçiş yapabilmeniz için birden çok uygulama olabilir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-169">It can have multiple implementations so that you can swap between them, depending on the environment requirements (for example, production versus development environments).</span></span>

<span data-ttu-id="a2dbd-170">Şekil 6-20 ' de, kbbitmq, Azure Service Bus veya başka bir olay/ileti Aracısı gibi altyapı mesajlaşma teknolojilerine göre birden çok uygulama içeren bir olay veri yolu soyutlama görebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-170">In Figure 6-20 you can see an abstraction of an event bus with multiple implementations based on infrastructure messaging technologies like RabbitMQ, Azure Service Bus, or another event/message broker.</span></span>

![Bir olay veri yolu soyutlama katmanının eklenmesini gösteren diyagram.](./media/integration-event-based-microservice-communications/multiple-implementations-event-bus.png)

<span data-ttu-id="a2dbd-172">**Şekil 6-20.**</span><span class="sxs-lookup"><span data-stu-id="a2dbd-172">**Figure 6- 20.**</span></span> <span data-ttu-id="a2dbd-173">Bir olay veri yolunun birden çok uygulaması</span><span class="sxs-lookup"><span data-stu-id="a2dbd-173">Multiple implementations of an event bus</span></span>

<span data-ttu-id="a2dbd-174">Veri yolu, bir arabirim aracılığıyla tanımlanabilmesi ve bu sayede, Kbıbitmq Azure Service Bus veya diğerleri gibi çeşitli teknolojilerle uygulanabilmesi yararlı olur.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-174">It's good to have the event bus defined through an interface so it can be implemented with several technologies, like RabbitMQ Azure Service bus or others.</span></span> <span data-ttu-id="a2dbd-175">Ancak, daha önce bahsedildiği gibi, kendi soyutlarınızın (olay veri yolu arabirimi) kullanılması yalnızca, soyutlamalar tarafından desteklenen temel olay veri yolu özelliklerine ihtiyacınız varsa iyidir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-175">However, and as mentioned previously, using your own abstractions (the event bus interface) is good only if you need basic event bus features supported by your abstractions.</span></span> <span data-ttu-id="a2dbd-176">Daha zengin Service Bus özelliklerine ihtiyacınız varsa, büyük olasılıkla kendi soyutlamaları yerine tercih ettiğiniz ticari hizmet veri yolu tarafından sunulan API 'yi ve soyutlamaları kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-176">If you need richer service bus features, you should probably use the API and abstractions provided by your preferred commercial service bus instead of your own abstractions.</span></span>

### <a name="defining-an-event-bus-interface"></a><span data-ttu-id="a2dbd-177">Olay veri yolu arabirimi tanımlama</span><span class="sxs-lookup"><span data-stu-id="a2dbd-177">Defining an event bus interface</span></span>

<span data-ttu-id="a2dbd-178">Olay veri yolu arabirimi ve Araştırma amaçları için olası uygulamalar için bazı uygulama kodları ile başlayalım.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-178">Let’s start with some implementation code for the event bus interface and possible implementations for exploration purposes.</span></span> <span data-ttu-id="a2dbd-179">Arabirim, aşağıdaki arabirimde olduğu gibi genel ve kolay olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-179">The interface should be generic and straightforward, as in the following interface.</span></span>

```csharp
public interface IEventBus
{
    void Publish(IntegrationEvent @event);

    void Subscribe<T, TH>()
        where T : IntegrationEvent
        where TH : IIntegrationEventHandler<T>;

    void SubscribeDynamic<TH>(string eventName)
        where TH : IDynamicIntegrationEventHandler;

    void UnsubscribeDynamic<TH>(string eventName)
        where TH : IDynamicIntegrationEventHandler;

    void Unsubscribe<T, TH>()
        where TH : IIntegrationEventHandler<T>
        where T : IntegrationEvent;
}
```

<span data-ttu-id="a2dbd-180">`Publish` yöntemi basittir.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-180">The `Publish` method is straightforward.</span></span> <span data-ttu-id="a2dbd-181">Olay veri yolu, kendisine geçirilen tümleştirme olayını herhangi bir mikro hizmete veya hatta bu olaya abone olan bir dış uygulamaya yayınlayacak.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-181">The event bus will broadcast the integration event passed to it to any microservice, or even an external application, subscribed to that event.</span></span> <span data-ttu-id="a2dbd-182">Bu yöntem, olayı yayımlayan mikro hizmet tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-182">This method is used by the microservice that is publishing the event.</span></span>

<span data-ttu-id="a2dbd-183">`Subscribe` Yöntemleri (bağımsız değişkenlere bağlı olarak birkaç uygulama olabilir), olayları almak isteyen mikro hizmetler tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-183">The `Subscribe` methods (you can have several implementations depending on the arguments) are used by the microservices that want to receive events.</span></span> <span data-ttu-id="a2dbd-184">Bu yöntemin iki bağımsız değişkeni vardır.</span><span class="sxs-lookup"><span data-stu-id="a2dbd-184">This method has two arguments.</span></span> <span data-ttu-id="a2dbd-185">Birincisi, Abone olunacak tümleştirme olayıdır (`IntegrationEvent`).</span><span class="sxs-lookup"><span data-stu-id="a2dbd-185">The first is the integration event to subscribe to (`IntegrationEvent`).</span></span> <span data-ttu-id="a2dbd-186">İkinci bağımsız değişken, alıcı mikro hizmeti bu tümleştirme olay iletisini aldığında yürütülecek `IIntegrationEventHandler<T>`adlı tümleştirme olay işleyicisidir (veya geri çağırma yöntemidir).</span><span class="sxs-lookup"><span data-stu-id="a2dbd-186">The second argument is the integration event handler (or callback method), named `IIntegrationEventHandler<T>`, to be executed when the receiver microservice gets that integration event message.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="a2dbd-187">Ek kaynaklar</span><span class="sxs-lookup"><span data-stu-id="a2dbd-187">Additional resources</span></span>

<span data-ttu-id="a2dbd-188">Üretime yönelik olarak hazırlanmaya yönelik bazı mesajlaşma çözümleri:</span><span class="sxs-lookup"><span data-stu-id="a2dbd-188">Some production-ready messaging solutions:</span></span>

- <span data-ttu-id="a2dbd-189">**Azure Service Bus** </span><span class="sxs-lookup"><span data-stu-id="a2dbd-189">**Azure Service Bus** </span></span>\
  <https://docs.microsoft.com/azure/service-bus-messaging/>
  
- <span data-ttu-id="a2dbd-190">**Nservicebus** </span><span class="sxs-lookup"><span data-stu-id="a2dbd-190">**NServiceBus** </span></span>\
  <https://particular.net/nservicebus>
  
- <span data-ttu-id="a2dbd-191">**Masstransıt** </span><span class="sxs-lookup"><span data-stu-id="a2dbd-191">**MassTransit** </span></span>\
  <https://masstransit-project.com/>

> [!div class="step-by-step"]
> <span data-ttu-id="a2dbd-192">[Önceki](database-server-container.md)
> [İleri](rabbitmq-event-bus-development-test-environment.md)</span><span class="sxs-lookup"><span data-stu-id="a2dbd-192">[Previous](database-server-container.md)
[Next](rabbitmq-event-bus-development-test-environment.md)</span></span>
