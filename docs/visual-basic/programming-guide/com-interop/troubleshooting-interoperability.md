---
title: Birlikte Çalışabilirlik İle İlgili Sorun Giderme
ms.date: 07/20/2015
helpviewer_keywords:
- interop, deploying assemblies
- assemblies [Visual Basic]
- interop, installing assemblies that share components
- COM objects, troubleshooting
- interop, sharing components
- troubleshooting interoperability [Visual Basic]
- interoperability, troubleshooting
- COM interop [Visual Basic], troubleshooting
- assemblies [Visual Basic], deploying
- troubleshooting Visual Basic, interoperability
- interop assemblies
- interoperability, sharing components
- shared components, using with assemblies
ms.assetid: b324cc1e-b03c-4f39-aea6-6a6d5bfd0e37
ms.openlocfilehash: 344c180cf0b9426898e17b45db768a337fd45beb
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/22/2019
ms.locfileid: "74338681"
---
# <a name="troubleshooting-interoperability-visual-basic"></a><span data-ttu-id="2baf6-102">Birlikte Çalışabilirlik İle İlgili Sorun Giderme (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2baf6-102">Troubleshooting Interoperability (Visual Basic)</span></span>
<span data-ttu-id="2baf6-103">.NET Framework COM ile yönetilen kod arasında birlikte çalışırken, aşağıdaki yaygın sorunlardan biri veya birkaçı olabilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-103">When you interoperate between COM and the managed code of the .NET Framework, you may encounter one or more of the following common issues.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor1"></a><span data-ttu-id="2baf6-104">Birlikte çalışabilirlik sıralaması</span><span class="sxs-lookup"><span data-stu-id="2baf6-104">Interop Marshaling</span></span>  
 <span data-ttu-id="2baf6-105">Her zaman, .NET Framework parçası olmayan veri türlerini kullanmanız gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-105">At times, you may have to use data types that are not part of the .NET Framework.</span></span> <span data-ttu-id="2baf6-106">Birlikte çalışma derlemeleri, COM nesneleri için çalışmanın çoğunu işler, ancak yönetilen nesneler COM 'a sunulduğunda kullanılan veri türlerini kontrol etmeniz gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-106">Interop assemblies handle most of the work for COM objects, but you may have to control the data types that are used when managed objects are exposed to COM.</span></span> <span data-ttu-id="2baf6-107">Örneğin, sınıf kitaplıklarındaki yapılar, Visual Basic 6,0 ve önceki sürümleri tarafından oluşturulan COM nesnelerine gönderilen dizelerde `BStr` yönetilmeyen türü belirtmelidir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-107">For example, structures in class libraries must specify the `BStr` unmanaged type on strings sent to COM objects created by Visual Basic 6.0 and earlier versions.</span></span> <span data-ttu-id="2baf6-108">Bu gibi durumlarda, yönetilen türlerin yönetilmeyen türler olarak gösterilmesini sağlamak için <xref:System.Runtime.InteropServices.MarshalAsAttribute> özniteliğini kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-108">In such cases, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute to cause managed types to be exposed as unmanaged types.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor2"></a><span data-ttu-id="2baf6-109">Sabit uzunluklu dizeleri yönetilmeyen koda verme</span><span class="sxs-lookup"><span data-stu-id="2baf6-109">Exporting Fixed-Length Strings to Unmanaged Code</span></span>  
 <span data-ttu-id="2baf6-110">Visual Basic 6,0 ve önceki sürümlerde dizeler, COM nesnelerine null sonlandırma karakteri olmayan bayt dizileri olarak aktarılmalıdır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-110">In Visual Basic 6.0 and earlier versions, strings are exported to COM objects as sequences of bytes without a null termination character.</span></span> <span data-ttu-id="2baf6-111">Diğer dillerle uyumluluk için, .NET Visual Basic dizeleri dışarı aktarırken sonlandırma karakteri içerir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-111">For compatibility with other languages, Visual Basic .NET includes a termination character when exporting strings.</span></span> <span data-ttu-id="2baf6-112">Bu uyumsuzluğu ele almanın en iyi yolu, sonlandırma karakteri olmayan dizeleri `Byte` veya `Char`dizileri olarak dışarı aktarmanız.</span><span class="sxs-lookup"><span data-stu-id="2baf6-112">The best way to address this incompatibility is to export strings that lack the termination character as arrays of `Byte` or `Char`.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor3"></a><span data-ttu-id="2baf6-113">Devralma hiyerarşileri dışarı aktarılıyor</span><span class="sxs-lookup"><span data-stu-id="2baf6-113">Exporting Inheritance Hierarchies</span></span>  
 <span data-ttu-id="2baf6-114">Yönetilen sınıf hiyerarşileri, COM nesneleri olarak sunulduğunu düzleştirebilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-114">Managed class hierarchies flatten out when exposed as COM objects.</span></span> <span data-ttu-id="2baf6-115">Örneğin, bir üye içeren bir temel sınıf tanımlarsanız ve sonra bir COM nesnesi olarak sunulan türetilmiş bir sınıfta temel sınıfı devraldıysanız, COM nesnesinde türetilmiş sınıfı kullanan istemciler devralınan üyeleri kullanamaz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-115">For example, if you define a base class with a member, and then inherit the base class in a derived class that is exposed as a COM object, clients that use the derived class in the COM object will not be able to use the inherited members.</span></span> <span data-ttu-id="2baf6-116">Temel sınıf üyelerine yalnızca bir temel sınıfın örnekleri olarak COM nesnelerinden erişilebilir ve ardından yalnızca temel sınıf de bir COM nesnesi olarak oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-116">Base class members can be accessed from COM objects only as instances of a base class, and then only if the base class is also created as a COM object.</span></span>  
  
## <a name="overloaded-methods"></a><span data-ttu-id="2baf6-117">Aşırı yüklenmiş yöntemler</span><span class="sxs-lookup"><span data-stu-id="2baf6-117">Overloaded Methods</span></span>  
 <span data-ttu-id="2baf6-118">Visual Basic aşırı yüklenmiş yöntemler oluşturabilseniz de, COM tarafından desteklenmez.</span><span class="sxs-lookup"><span data-stu-id="2baf6-118">Although you can create overloaded methods with Visual Basic, they are not supported by COM.</span></span> <span data-ttu-id="2baf6-119">Aşırı yüklenmiş yöntemler içeren bir sınıf bir COM nesnesi olarak kullanıma sunulduğunda, aşırı yüklenmiş yöntemler için yeni yöntem adları oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-119">When a class that contains overloaded methods is exposed as a COM object, new method names are generated for the overloaded methods.</span></span>  
  
 <span data-ttu-id="2baf6-120">Örneğin, `Synch` yönteminin iki aşırı yüküne sahip bir sınıfı düşünün.</span><span class="sxs-lookup"><span data-stu-id="2baf6-120">For example, consider a class that has two overloads of the `Synch` method.</span></span> <span data-ttu-id="2baf6-121">Sınıf bir COM nesnesi olarak kullanıma sunulduğunda, yeni oluşturulan yöntem adları `Synch` ve `Synch_2`olabilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-121">When the class is exposed as a COM object, the new generated method names could be `Synch` and `Synch_2`.</span></span>  
  
 <span data-ttu-id="2baf6-122">Yeniden adlandırma, COM nesnesinin tüketicileri için iki soruna neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-122">The renaming can cause two problems for consumers of the COM object.</span></span>  
  
1. <span data-ttu-id="2baf6-123">İstemciler oluşturulan yöntem adlarını beklememeyebilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-123">Clients might not expect the generated method names.</span></span>  
  
2. <span data-ttu-id="2baf6-124">Bir COM nesnesi olarak sunulan sınıfta oluşturulan yöntem adları, sınıfa veya temel sınıfına yeni aşırı yüklemeler eklendiğinde değişebilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-124">The generated method names in the class exposed as a COM object can change when new overloads are added to the class or its base class.</span></span> <span data-ttu-id="2baf6-125">Bu, sürüm oluşturma sorunlarına neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-125">This can cause versioning problems.</span></span>  
  
 <span data-ttu-id="2baf6-126">Her iki sorunu da çözümlemek için, COM nesneleri olarak kullanıma sunulacak nesneleri geliştirirken, her yönteme, aşırı yükleme kullanmak yerine benzersiz bir ad verin.</span><span class="sxs-lookup"><span data-stu-id="2baf6-126">To solve both problems, give each method a unique name, instead of using overloading, when you develop objects that will be exposed as COM objects.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor4"></a><span data-ttu-id="2baf6-127">Birlikte çalışma derlemeleri aracılığıyla COM nesnelerinin kullanımı</span><span class="sxs-lookup"><span data-stu-id="2baf6-127">Use of COM Objects Through Interop Assemblies</span></span>  
 <span data-ttu-id="2baf6-128">Birlikte çalışma derlemelerini, temsil ettikleri COM nesneleri için yönetilen kod değiştirmeleri gibi neredeyse kullanırsınız.</span><span class="sxs-lookup"><span data-stu-id="2baf6-128">You use interop assemblies almost as if they are managed code replacements for the COM objects they represent.</span></span> <span data-ttu-id="2baf6-129">Ancak, sarmalayıcılar olduklarından ve gerçek COM nesneleri olmadığından, birlikte çalışma derlemeleri ve standart derlemelerin kullanılması arasında bazı farklılıklar vardır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-129">However, because they are wrappers and not actual COM objects, there are some differences between using interop assemblies and standard assemblies.</span></span> <span data-ttu-id="2baf6-130">Bu fark alanlarında sınıfların pozlaması ve parametreler ve dönüş değerleri için veri türleri yer alır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-130">These areas of difference include the exposure of classes, and data types for parameters and return values.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor5"></a><span data-ttu-id="2baf6-131">Hem arabirimler hem de sınıflar olarak gösterilen sınıflar</span><span class="sxs-lookup"><span data-stu-id="2baf6-131">Classes Exposed as Both Interfaces and Classes</span></span>  
 <span data-ttu-id="2baf6-132">Standart derlemelerdeki sınıfların aksine COM sınıfları, birlikte çalışma derlemelerindeki bir arabirim ve COM sınıfını temsil eden bir sınıf olarak sunulur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-132">Unlike classes in standard assemblies, COM classes are exposed in interop assemblies as both an interface and a class that represents the COM class.</span></span> <span data-ttu-id="2baf6-133">Arabirimin adı, COM sınıfıyla aynıdır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-133">The interface's name is identical to that of the COM class.</span></span> <span data-ttu-id="2baf6-134">Birlikte çalışma sınıfının adı, özgün COM sınıfının, ancak "Class" sözcüğünün eklendiği ile aynıdır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-134">The name of the interop class is the same as that of the original COM class, but with the word "Class" appended.</span></span> <span data-ttu-id="2baf6-135">Örneğin, bir COM nesnesi için birlikte çalışma derlemesine başvuru içeren bir projeniz olduğunu varsayalım.</span><span class="sxs-lookup"><span data-stu-id="2baf6-135">For example, suppose you have a project with a reference to an interop assembly for a COM object.</span></span> <span data-ttu-id="2baf6-136">COM sınıfının adı `MyComClass`, IntelliSense ve Nesne Tarayıcısı `MyComClass` adlı bir arabirimi ve `MyComClassClass`adlı bir sınıfı gösterir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-136">If the COM class is named `MyComClass`, IntelliSense and the Object Browser show an interface named `MyComClass` and a class named `MyComClassClass`.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor6"></a><span data-ttu-id="2baf6-137">.NET Framework sınıfının örneklerini oluşturma</span><span class="sxs-lookup"><span data-stu-id="2baf6-137">Creating Instances of a .NET Framework Class</span></span>  
 <span data-ttu-id="2baf6-138">Genellikle, bir sınıf adı ile `New` ifadesini kullanarak .NET Framework sınıfının bir örneğini oluşturursunuz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-138">Generally, you create an instance of a .NET Framework class using the `New` statement with a class name.</span></span> <span data-ttu-id="2baf6-139">Bir birlikte çalışma derlemesi tarafından temsil edilen COM sınıfının olması, `New` ifadesini bir arabirimle kullanabileceğiniz bir durumdur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-139">Having a COM class represented by an interop assembly is the one case in which you can use the `New` statement with an interface.</span></span> <span data-ttu-id="2baf6-140">COM sınıfını bir `Inherits` ifadesiyle kullanmadığınız sürece, arabirimi tıpkı bir sınıf gibi kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-140">Unless you are using the COM class with an `Inherits` statement, you can use the interface just as you would a class.</span></span> <span data-ttu-id="2baf6-141">Aşağıdaki kod, Microsoft ActiveX Data Objects 2,8 kitaplığı COM nesnesine bir başvuru içeren bir projede `Command` nesnesinin nasıl oluşturulduğunu gösterir:</span><span class="sxs-lookup"><span data-stu-id="2baf6-141">The following code demonstrates how to create a `Command` object in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object:</span></span>  
  
 [!code-vb[VbVbalrInterop#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#20)]  
  
 <span data-ttu-id="2baf6-142">Ancak, bir türetilmiş sınıf için temel olarak COM sınıfını kullanıyorsanız, aşağıdaki kodda olduğu gibi COM sınıfını temsil eden birlikte çalışma sınıfını kullanmanız gerekir:</span><span class="sxs-lookup"><span data-stu-id="2baf6-142">However, if you are using the COM class as the base for a derived class, you must use the interop class that represents the COM class, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrInterop#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#21)]  
  
> [!NOTE]
> <span data-ttu-id="2baf6-143">Birlikte çalışma derlemeleri, COM sınıflarını temsil eden arabirimleri örtülü olarak uygular.</span><span class="sxs-lookup"><span data-stu-id="2baf6-143">Interop assemblies implicitly implement interfaces that represent COM classes.</span></span> <span data-ttu-id="2baf6-144">Bu arabirimleri uygulamak için `Implements` ifadesini kullanmayı denememelisiniz ya da bir hata sonuç verecek.</span><span class="sxs-lookup"><span data-stu-id="2baf6-144">You should not try to use the `Implements` statement to implement these interfaces or an error will result.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor7"></a><span data-ttu-id="2baf6-145">Parametreler ve dönüş değerleri için veri türleri</span><span class="sxs-lookup"><span data-stu-id="2baf6-145">Data Types for Parameters and Return Values</span></span>  
 <span data-ttu-id="2baf6-146">Standart derlemelerin üyelerinin aksine, birlikte çalışma derleme üyeleri özgün nesne bildiriminde kullanılanlardan farklı veri türlerine sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-146">Unlike members of standard assemblies, interop assembly members may have data types that differ from those used in the  original object declaration.</span></span> <span data-ttu-id="2baf6-147">Birlikte çalışma derlemeleri dolaylı olarak COM türlerini uyumlu ortak dil çalışma zamanı türlerine dönüştürse de, çalışma zamanı hatalarını engellemek için her iki taraf tarafından kullanılan veri türlerine dikkat etmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-147">Although interop assemblies implicitly convert COM types to compatible common language runtime types, you should pay attention to the data types that are used by both sides to prevent runtime errors.</span></span> <span data-ttu-id="2baf6-148">Örneğin, Visual Basic 6,0 ve önceki sürümlerde oluşturulan COM nesnelerinde, `Integer` türündeki değerler .NET Framework eşdeğer türü `Short`varsayar.</span><span class="sxs-lookup"><span data-stu-id="2baf6-148">For example, in COM objects created in Visual Basic 6.0 and earlier versions, values of type `Integer` assume the .NET Framework equivalent type, `Short`.</span></span> <span data-ttu-id="2baf6-149">İçeri aktarılan üyelerin özelliklerini kullanmadan önce incelemek için Nesne Tarayıcısı kullanmanız önerilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-149">It is recommended that you use the Object Browser to examine the characteristics of imported members before you use them.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor8"></a><span data-ttu-id="2baf6-150">Modül düzeyi COM yöntemleri</span><span class="sxs-lookup"><span data-stu-id="2baf6-150">Module level COM methods</span></span>  
 <span data-ttu-id="2baf6-151">Çoğu COM nesnesi, `New` anahtar sözcüğünü kullanarak COM sınıfının bir örneğini oluşturarak ve sonra nesnenin yöntemlerini çağırarak kullanılır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-151">Most COM objects are used by creating an instance of a COM class using the `New` keyword and then calling methods of the object.</span></span> <span data-ttu-id="2baf6-152">Bu kural için bir özel durum, `AppObj` veya `GlobalMultiUse` COM sınıfları içeren COM nesnelerini içerir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-152">One exception to this rule involves COM objects that contain `AppObj` or `GlobalMultiUse` COM classes.</span></span> <span data-ttu-id="2baf6-153">Bu sınıflar, Visual Basic .NET sınıflarında modül düzeyi yöntemlere benzer.</span><span class="sxs-lookup"><span data-stu-id="2baf6-153">Such classes resemble module level methods in Visual Basic .NET classes.</span></span> <span data-ttu-id="2baf6-154">Visual Basic 6,0 ve önceki sürümler, yöntemlerinden birini ilk kez çağırdığınızda bu nesnelerin örneklerini örtülü olarak oluşturur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-154">Visual Basic 6.0 and earlier versions implicitly create instances of such objects for you the first time that you call one of their methods.</span></span> <span data-ttu-id="2baf6-155">Örneğin, Visual Basic 6,0 ' de, Microsoft DAO 3,6 nesne kitaplığına bir başvuru ekleyebilir ve öncelikle bir örnek oluşturmadan `DBEngine` metodunu çağırabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="2baf6-155">For example, in Visual Basic 6.0 you can add a reference to the Microsoft DAO 3.6 Object Library and call the `DBEngine` method without first creating an instance:</span></span>  
  
```vb  
Dim db As DAO.Database  
' Open the database.  
Set db = DBEngine.OpenDatabase("C:\nwind.mdb")  
' Use the database object.  
```  
  
 <span data-ttu-id="2baf6-156">Visual Basic .NET, yöntemlerini kullanabilmeniz için her zaman COM nesneleri örnekleri oluşturmanızı gerektirir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-156">Visual Basic .NET requires that you always create instances of COM objects before you can use their methods.</span></span> <span data-ttu-id="2baf6-157">Bu yöntemleri Visual Basic ' de kullanmak için, istenen sınıfın bir değişkenini bildirin ve yeni anahtar sözcüğünü kullanarak nesneyi nesne değişkenine atayın.</span><span class="sxs-lookup"><span data-stu-id="2baf6-157">To use these methods in Visual Basic, declare a variable of the desired class and use the new keyword to assign the object to the object variable.</span></span> <span data-ttu-id="2baf6-158">`Shared` anahtar sözcüğü, sınıfın yalnızca bir örneğinin oluşturulduğundan emin olmak istediğinizde kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-158">The `Shared` keyword can be used when you want to make sure that only one instance of the class is created.</span></span>  
  
 [!code-vb[VbVbalrInterop#23](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#23)]  
  
## <a name="vbconinteroperabilitymarshalinganchor9"></a><span data-ttu-id="2baf6-159">Olay Işleyicilerde işlenmeyen hatalar</span><span class="sxs-lookup"><span data-stu-id="2baf6-159">Unhandled Errors in Event Handlers</span></span>  
 <span data-ttu-id="2baf6-160">Ortak bir birlikte çalışma sorunu, COM nesneleri tarafından oluşturulan olayları işleyen olay işleyicilerindeki hataları içerir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-160">One common interop problem involves errors in event handlers that handle events raised by COM objects.</span></span> <span data-ttu-id="2baf6-161">Bu tür hatalar, özellikle `On Error` veya `Try...Catch...Finally` deyimlerini kullanarak hata denetimi yapmadığınız takdirde yok sayılır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-161">Such errors are ignored unless you specifically check for errors using `On Error` or `Try...Catch...Finally` statements.</span></span> <span data-ttu-id="2baf6-162">Örneğin, aşağıdaki örnek, Microsoft ActiveX Data Objects 2,8 Library COM nesnesine yönelik bir başvuruya sahip Visual Basic bir .NET projesinden verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-162">For example, the following example is from a Visual Basic .NET project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object.</span></span>  
  
 [!code-vb[VbVbalrInterop#24](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#24)]  
  
 <span data-ttu-id="2baf6-163">Bu örnek, beklenen şekilde bir hata oluşturur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-163">This example raises an error as expected.</span></span> <span data-ttu-id="2baf6-164">Ancak, `Try...Catch...Finally` bloğu olmadan aynı örneği denerseniz, hata, `OnError Resume Next` ifadesini kullanmış gibi yok sayılır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-164">However, if you try the same example without the `Try...Catch...Finally` block, the error is ignored as if you used the `OnError Resume Next` statement.</span></span> <span data-ttu-id="2baf6-165">Hata işleme olmadan, sıfıra kadar bölme sessizce başarısız olur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-165">Without error handling, the division by zero silently fails.</span></span> <span data-ttu-id="2baf6-166">Bu tür hatalar hiçbir şekilde işlenmemiş özel durum hatalarını yükseltmediği için, COM nesnelerinden olayları işleyen olay işleyicilerinde özel durum işlemenin bir biçimini kullanmanız önemlidir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-166">Because such errors never raise unhandled exception errors, it is important that you use some form of exception handling in event handlers that handle events from COM objects.</span></span>  
  
### <a name="understanding-com-interop-errors"></a><span data-ttu-id="2baf6-167">COM birlikte çalışma hatalarını anlama</span><span class="sxs-lookup"><span data-stu-id="2baf6-167">Understanding COM interop errors</span></span>  
 <span data-ttu-id="2baf6-168">Hata işleme olmadan, birlikte çalışma çağrıları genellikle az bilgi sağlayan hatalar oluşturur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-168">Without error handling, interop calls often generate errors that provide little information.</span></span> <span data-ttu-id="2baf6-169">Mümkün olduğunda, oluşma sorunları hakkında daha fazla bilgi sağlamak için yapılandırılmış hata işlemeyi kullanın.</span><span class="sxs-lookup"><span data-stu-id="2baf6-169">Whenever possible, use structured error handling to provide more information about problems when they occur.</span></span> <span data-ttu-id="2baf6-170">Bu, özellikle uygulamalarda hata ayıklarken yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-170">This can be especially helpful when you debug applications.</span></span> <span data-ttu-id="2baf6-171">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="2baf6-171">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#25](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#25)]  
  
 <span data-ttu-id="2baf6-172">Özel durum nesnesinin içeriğini inceleyerek hata açıklaması, HRESULT ve COM hatalarının kaynağı gibi bilgileri bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-172">You can find information such as the error description, HRESULT, and the source of COM errors by examining the contents of the exception object.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor10"></a><span data-ttu-id="2baf6-173">ActiveX denetim sorunları</span><span class="sxs-lookup"><span data-stu-id="2baf6-173">ActiveX Control Issues</span></span>  
 <span data-ttu-id="2baf6-174">Visual Basic 6,0 ile çalışan çoğu ActiveX denetimleri, sorun olmaksızın Visual Basic .NET ile çalışır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-174">Most ActiveX controls that work with Visual Basic 6.0 work with Visual Basic .NET without trouble.</span></span> <span data-ttu-id="2baf6-175">Ana özel durumlar, kapsayıcı denetimleridir veya görsel olarak diğer denetimleri içeren denetimlerdir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-175">The main exceptions are container controls, or controls that visually contain other controls.</span></span> <span data-ttu-id="2baf6-176">Visual Studio ile düzgün çalışmayan eski denetimlerin bazı örnekleri şunlardır:</span><span class="sxs-lookup"><span data-stu-id="2baf6-176">Some examples of older controls that do not work correctly with Visual Studio are as follows:</span></span>  
  
- <span data-ttu-id="2baf6-177">Microsoft Forms 2,0 çerçeve denetimi</span><span class="sxs-lookup"><span data-stu-id="2baf6-177">Microsoft Forms 2.0 Frame control</span></span>  
  
- <span data-ttu-id="2baf6-178">Aşağı açılan denetim, döndürme denetimi olarak da bilinir</span><span class="sxs-lookup"><span data-stu-id="2baf6-178">Up-Down control, also known as the spin control</span></span>  
  
- <span data-ttu-id="2baf6-179">Sheridan Tab denetimi</span><span class="sxs-lookup"><span data-stu-id="2baf6-179">Sheridan Tab Control</span></span>  
  
 <span data-ttu-id="2baf6-180">Desteklenmeyen ActiveX denetim sorunları için yalnızca birkaç geçici çözüm vardır.</span><span class="sxs-lookup"><span data-stu-id="2baf6-180">There are only a few workarounds for unsupported ActiveX control problems.</span></span> <span data-ttu-id="2baf6-181">Özgün kaynak koda sahipseniz, varolan denetimleri Visual Studio 'ya geçirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-181">You can migrate existing controls to Visual Studio if you own the original source code.</span></span> <span data-ttu-id="2baf6-182">Aksi takdirde, yazılım satıcılarıyla güncelleştirilmiş olup olmadığını kontrol edebilirsiniz. Desteklenmeyen ActiveX denetimlerinin yerini alacak denetimlerin NET uyumlu sürümleri.</span><span class="sxs-lookup"><span data-stu-id="2baf6-182">Otherwise, you can check with software vendors for updated .NET-compatible versions of controls to replace unsupported ActiveX controls.</span></span>  
  
## <a name="vbconinteroperabilitymarshalinganchor11"></a><span data-ttu-id="2baf6-183">Denetimlerin ReadOnly özelliklerinin geçirilmesi ByRef</span><span class="sxs-lookup"><span data-stu-id="2baf6-183">Passing ReadOnly Properties of Controls ByRef</span></span>  
 <span data-ttu-id="2baf6-184">Visual Basic .NET, bazı eski ActiveX denetimlerinin `ReadOnly` özelliklerini diğer yordamlara `ByRef` parametre olarak geçirdiğinizde, bazen "hata 0x800A017F CTL_E_SETNOTSUPPORTED" gibi COM hataları oluşturur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-184">Visual Basic .NET sometimes raises COM errors such as, "Error 0x800A017F CTL_E_SETNOTSUPPORTED", when you pass `ReadOnly` properties of some older ActiveX controls as `ByRef` parameters to other procedures.</span></span> <span data-ttu-id="2baf6-185">Visual Basic 6,0 ' den benzer yordam çağrıları bir hata oluşturmaz ve parametreleri değere göre geçirmiş gibi kabul edilir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-185">Similar procedure calls from Visual Basic 6.0 do not raise an error, and the parameters are treated as if you passed them by value.</span></span> <span data-ttu-id="2baf6-186">Visual Basic .NET hata iletisi, özellik `Set` yordamı olmayan bir özelliği değiştirmeye çalıştığınız anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-186">The Visual Basic .NET error message indicates that you are trying to change a property that does not have a property `Set` procedure.</span></span>  
  
 <span data-ttu-id="2baf6-187">Çağrılan yordama erişiminiz varsa, `ReadOnly` özelliklerini kabul eden parametreleri bildirmek için `ByVal` anahtar sözcüğünü kullanarak bu hatayı önleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-187">If you have access to the procedure being called, you can prevent this error by using the `ByVal` keyword to declare parameters that accept `ReadOnly` properties.</span></span> <span data-ttu-id="2baf6-188">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="2baf6-188">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#26](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#26)]  
  
 <span data-ttu-id="2baf6-189">Çağrılmakta olan yordamın kaynak koduna erişiminiz yoksa, çağıran yordamın çevresine fazladan bir parantez kümesi ekleyerek özelliği değere göre geçirilecek şekilde zorlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-189">If you do not have access to the source code for the procedure being called, you can force the property to be passed by value by adding an extra set of brackets around the calling procedure.</span></span> <span data-ttu-id="2baf6-190">Örneğin, Microsoft ActiveX Data Objects 2,8 Library COM nesnesine bir başvuru içeren bir projede şunları kullanabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="2baf6-190">For example, in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object, you can use:</span></span>  
  
 [!code-vb[VbVbalrInterop#27](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#27)]  
  
## <a name="vbconinteroperabilitymarshalinganchor12"></a><span data-ttu-id="2baf6-191">Birlikte çalışabilirliği sunan derlemeleri dağıtma</span><span class="sxs-lookup"><span data-stu-id="2baf6-191">Deploying Assemblies That Expose Interop</span></span>  
 <span data-ttu-id="2baf6-192">COM arabirimlerini sunan derlemelerin dağıtımı bazı benzersiz güçlükler sunar.</span><span class="sxs-lookup"><span data-stu-id="2baf6-192">Deploying assemblies that expose COM interfaces presents some unique challenges.</span></span> <span data-ttu-id="2baf6-193">Örneğin, ayrı uygulamalar aynı COM derlemesine başvuru yaparken olası bir sorun oluşur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-193">For example, a potential problem occurs when separate applications reference the same COM assembly.</span></span> <span data-ttu-id="2baf6-194">Bu durum, bir derlemenin yeni bir sürümü yüklendiğinde ve başka bir uygulamanın derlemenin eski sürümünü kullanmaya devam ediyorsa yaygın bir durumdur.</span><span class="sxs-lookup"><span data-stu-id="2baf6-194">This situation is common when a new version of an assembly is installed and another application is still using the old version of the assembly.</span></span> <span data-ttu-id="2baf6-195">DLL 'yi paylaşan bir derlemeyi kaldırırsanız, yanlışlıkla diğer derlemeler için kullanılamaz hale getirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-195">If you uninstall an assembly that shares a DLL, you can unintentionally make it unavailable to the other assemblies.</span></span>  
  
 <span data-ttu-id="2baf6-196">Bu sorundan kaçınmak için, paylaşılan derlemeleri genel derleme önbelleği 'ne (GAC) yüklemeli ve bileşen için bir MergeModule kullanmalısınız.</span><span class="sxs-lookup"><span data-stu-id="2baf6-196">To avoid this problem, you should install shared assemblies to the Global Assembly Cache (GAC) and use a MergeModule for the component.</span></span> <span data-ttu-id="2baf6-197">Uygulamayı GAC 'ye yükleyemezseniz, sürüme özgü bir alt dizinde Commonfilesklasörüne yüklenmelidir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-197">If you cannot install the application in the GAC, it should be installed to CommonFilesFolder in a version-specific subdirectory.</span></span>  
  
 <span data-ttu-id="2baf6-198">Paylaşılmayan derlemeler, çağıran uygulamayla birlikte dizinde yan yana yerleştirilmelidir.</span><span class="sxs-lookup"><span data-stu-id="2baf6-198">Assemblies that are not shared should be located side by side in the directory with the calling application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2baf6-199">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="2baf6-199">See also</span></span>

- <xref:System.Runtime.InteropServices.MarshalAsAttribute>
- [<span data-ttu-id="2baf6-200">COM Birlikte Çalışma</span><span class="sxs-lookup"><span data-stu-id="2baf6-200">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="2baf6-201">Tlbimp.exe (Tür Kitaplığı İçeri Aktarıcı)</span><span class="sxs-lookup"><span data-stu-id="2baf6-201">Tlbimp.exe (Type Library Importer)</span></span>](../../../framework/tools/tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="2baf6-202">Tlbexp.exe (Tür Kitaplığı Dışarı Aktarıcı)</span><span class="sxs-lookup"><span data-stu-id="2baf6-202">Tlbexp.exe (Type Library Exporter)</span></span>](../../../framework/tools/tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="2baf6-203">İzlenecek yol: COM Nesnelerinde Kalıtım Uygulama</span><span class="sxs-lookup"><span data-stu-id="2baf6-203">Walkthrough: Implementing Inheritance with COM Objects</span></span>](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)
- [<span data-ttu-id="2baf6-204">Inherits Deyimi</span><span class="sxs-lookup"><span data-stu-id="2baf6-204">Inherits Statement</span></span>](../../../visual-basic/language-reference/statements/inherits-statement.md)
- [<span data-ttu-id="2baf6-205">Genel Derleme Önbelleği</span><span class="sxs-lookup"><span data-stu-id="2baf6-205">Global Assembly Cache</span></span>](../../../framework/app-domains/gac.md)
