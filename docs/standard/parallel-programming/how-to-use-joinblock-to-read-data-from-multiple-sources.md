---
title: "Nasıl yapılır: Birden Fazla Kaynaktan Okumak için JoinBlock'u Kullanma"
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Task Parallel Library, dataflows
- TPL dataflow library, joining blocks in
- dataflow blocks, joining in TPL
ms.assetid: e9c1ada4-ac57-4704-87cb-2f5117f8151d
ms.openlocfilehash: 66fd7ed7a98b8be8f88f65ecb52710a1e40af778
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/30/2019
ms.locfileid: "73139743"
---
# <a name="how-to-use-joinblock-to-read-data-from-multiple-sources"></a><span data-ttu-id="3f6a4-102">Nasıl yapılır: Birden Fazla Kaynaktan Okumak için JoinBlock'u Kullanma</span><span class="sxs-lookup"><span data-stu-id="3f6a4-102">How to: Use JoinBlock to Read Data From Multiple Sources</span></span>
<span data-ttu-id="3f6a4-103">Bu belgede, verileri birden çok kaynaktan kullanılabilir olduğunda bir işlemi gerçekleştirmek için <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> sınıfının nasıl kullanılacağı açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-103">This document explains how to use the <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> class to perform an operation when data is available from multiple sources.</span></span> <span data-ttu-id="3f6a4-104">Ayrıca, birden çok JOIN bloklarının bir veri kaynağını daha verimli bir şekilde paylaşmasını sağlamak için doyumsuz olmayan modu nasıl kullanacağınızı gösterir.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-104">It also demonstrates how to use non-greedy mode to enable multiple join blocks to share a data source more efficiently.</span></span>

[!INCLUDE [tpl-install-instructions](../../../includes/tpl-install-instructions.md)]

## <a name="example"></a><span data-ttu-id="3f6a4-105">Örnek</span><span class="sxs-lookup"><span data-stu-id="3f6a4-105">Example</span></span>  
 <span data-ttu-id="3f6a4-106">Aşağıdaki örnek üç kaynak türünü tanımlar, `NetworkResource`, `FileResource`ve `MemoryResource`ve kaynakları kullanılabilir hale geldiğinde işlemleri gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-106">The following example defines three resource types, `NetworkResource`, `FileResource`, and `MemoryResource`, and performs operations when resources become available.</span></span> <span data-ttu-id="3f6a4-107">Bu örnekte, ikinci işlemi gerçekleştirmek için ilk işlemi ve bir `FileResource` ve `MemoryResource` çiftini gerçekleştirmek üzere bir `NetworkResource` ve `MemoryResource` çifti gerekir.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-107">This example requires a `NetworkResource` and `MemoryResource` pair in order to perform the first operation and a `FileResource` and `MemoryResource` pair in order to perform the second operation.</span></span> <span data-ttu-id="3f6a4-108">Tüm gerekli kaynaklar kullanılabilir olduğunda bu işlemlerin gerçekleşmesini sağlamak için, bu örnek <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> sınıfını kullanır.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-108">To enable these operations to occur when all required resources are available, this example uses the <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> class.</span></span> <span data-ttu-id="3f6a4-109">Bir <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> nesnesi tüm kaynaklardaki verileri aldığında, bu verileri hedefine yayar, bu örnekte bir <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> nesnesidir.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-109">When a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> object receives data from all sources, it propagates that data to its target, which in this example is an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object.</span></span> <span data-ttu-id="3f6a4-110">Her iki <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> nesnesi de `MemoryResource` nesnelerden oluşan paylaşılan havuzdan okundu.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-110">Both <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects read from a shared pool of `MemoryResource` objects.</span></span>  
  
 [!code-csharp[TPLDataflow_NonGreedyJoin#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_nongreedyjoin/cs/nongreedyjoin.cs#1)]
 [!code-vb[TPLDataflow_NonGreedyJoin#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_nongreedyjoin/vb/nongreedyjoin.vb#1)]  
  
 <span data-ttu-id="3f6a4-111">`MemoryResource` nesnelerinin paylaşılan havuzunun verimli kullanımını sağlamak için bu örnek, <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> özelliği, doyumsuz olmayan modda davranan <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> nesneleri oluşturmak için `False` olarak ayarlanmış bir <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions> nesnesini belirtir.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-111">To enable efficient use of the shared pool of `MemoryResource` objects, this example specifies a <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions> object that has the <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> property set to `False` to create <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects that act in non-greedy mode.</span></span> <span data-ttu-id="3f6a4-112">Doyumsuz olmayan bir JOIN bloğu, her kaynaktan bir tane kullanılabilir olana kadar gelen tüm iletileri erteler.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-112">A non-greedy join block postpones all incoming messages until one is available from each source.</span></span> <span data-ttu-id="3f6a4-113">Ertelenen iletilerden herhangi biri başka bir blok tarafından kabul edildiyse, JOIN bloğu işlemi yeniden başlatır.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-113">If any of the postponed messages were accepted by another block, the join block restarts the process.</span></span> <span data-ttu-id="3f6a4-114">Doyumsuz olmayan mod, diğer blokların veri beklemesi durumunda ileri ilerleme durumuna getirmek için bir veya daha fazla kaynak bloğunu paylaşan JOIN blokları sağlar.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-114">Non-greedy mode enables join blocks that share one or more source blocks to make forward progress as the other blocks wait for data.</span></span> <span data-ttu-id="3f6a4-115">Bu örnekte, `memoryResources` havuzuna bir `MemoryResource` nesnesi eklenirse, ikinci veri kaynağını almak için ilk JOIN bloğu ilerlemeye devam edebilir.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-115">In this example, if a `MemoryResource` object is added to the `memoryResources` pool, the first join block to receive its second data source can make forward progress.</span></span> <span data-ttu-id="3f6a4-116">Bu örnek, varsayılan olan doyumsuz modunu kullanıyorsa, tek bir JOIN bloğu `MemoryResource` nesnesini alabilir ve ikinci kaynağın kullanılabilir hale gelmesini bekleyebilir.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-116">If this example were to use greedy mode, which is the default, one join block might take the `MemoryResource` object and wait for the second resource to become available.</span></span> <span data-ttu-id="3f6a4-117">Ancak, diğer bir JOIN bloğunun ikinci veri kaynağı varsa, `MemoryResource` nesnesi diğer bir JOIN bloğu tarafından alındığından ileri ilerleme yapamaz.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-117">However, if the other join block has its second data source available, it cannot make forward progress because the `MemoryResource` object has been taken by the other join block.</span></span>  
  
## <a name="robust-programming"></a><span data-ttu-id="3f6a4-118">Güçlü Programlama</span><span class="sxs-lookup"><span data-stu-id="3f6a4-118">Robust Programming</span></span>  
 <span data-ttu-id="3f6a4-119">Doyumsuz olmayan birleşimlerin kullanımı uygulamanızda kilitlenmeyi önlemenize de yardımcı olabilir.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-119">The use of non-greedy joins can also help you prevent deadlock in your application.</span></span> <span data-ttu-id="3f6a4-120">Bir yazılım uygulamasında, iki veya daha fazla işlem bir kaynağı her tutar ve başka bir işlemin başka bir kaynağı serbest bırakma işlemini karşılıklı olarak beklemek durumunda *kilitlenme* oluşur.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-120">In a software application, *deadlock* occurs when two or more processes each hold a resource and mutually wait for another process to release some other resource.</span></span> <span data-ttu-id="3f6a4-121">İki <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> nesnesini tanımlayan bir uygulama düşünün.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-121">Consider an application that defines two <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects.</span></span> <span data-ttu-id="3f6a4-122">Her iki nesnenin her ikisi de iki paylaşılan kaynak blobundan okur.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-122">Both objects each read data from two shared source blocks.</span></span> <span data-ttu-id="3f6a4-123">Doyumsuz modunda, bir JOIN bloğunun ilk kaynaktan okuduğu ve ikinci kaynaktan ikinci bir JOIN bloğunun okuduğu, uygulama kilitlenmeye neden olabileceğinden, her iki JOIN bloğu, kaynağını serbest bırakmalarını karşılıklı olarak bekler.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-123">In greedy mode, if one join block reads from the first source and the second join block reads from the second source, the application might deadlock because both join blocks mutually wait for the other to release its resource.</span></span> <span data-ttu-id="3f6a4-124">Doyumsuz olmayan modda, her bir JOIN bloğu kaynaklarından yalnızca tüm veriler kullanılabilir olduğunda okur ve bu nedenle, kilitlenme riski ortadan kalkar.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-124">In non-greedy mode, each join block reads from its sources only when all data is available, and therefore, the risk of deadlock is eliminated.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3f6a4-125">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="3f6a4-125">See also</span></span>

- [<span data-ttu-id="3f6a4-126">Veri akışı</span><span class="sxs-lookup"><span data-stu-id="3f6a4-126">Dataflow</span></span>](../../../docs/standard/parallel-programming/dataflow-task-parallel-library.md)
