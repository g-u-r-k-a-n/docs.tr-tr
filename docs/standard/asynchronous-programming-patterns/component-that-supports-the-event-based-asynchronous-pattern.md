---
description: 'Hakkında daha fazla bilgi edinin: nasıl yapılır: olay tabanlı zaman uyumsuz stili destekleyen bir bileşeni uygulama'
title: 'Nasıl yapılır: Olay Tabanlı Zaman Uyumsuz Deseni Destekleyen Bir Bileşeni Uygulama'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Event-based Asynchronous Pattern
- ProgressChangedEventArgs class
- BackgroundWorker component
- events [.NET], asynchronous
- Asynchronous Pattern
- AsyncOperationManager class
- threading [.NET], asynchronous features
- components [.NET], asynchronous
- AsyncOperation class
- threading [Windows Forms], asynchronous features
- AsyncCompletedEventArgs class
ms.assetid: 61f676b5-936f-40f6-83ce-f22805ec9c2f
ms.openlocfilehash: ca25370bda7a1dd451ff9333fee546d4106914c0
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99714124"
---
# <a name="how-to-implement-a-component-that-supports-the-event-based-asynchronous-pattern"></a><span data-ttu-id="1cef6-103">Nasıl yapılır: Olay Tabanlı Zaman Uyumsuz Deseni Destekleyen Bir Bileşeni Uygulama</span><span class="sxs-lookup"><span data-stu-id="1cef6-103">How to: Implement a Component That Supports the Event-based Asynchronous Pattern</span></span>

<span data-ttu-id="1cef6-104">Fark edilebilir gecikme olabilecek bazı işlemlerle bir sınıf yazıyorsanız, [olay tabanlı zaman uyumsuz düzene genel bakış](event-based-asynchronous-pattern-overview.md)' ı uygulayarak zaman uyumsuz işlevsellik vermeyi düşünün.</span><span class="sxs-lookup"><span data-stu-id="1cef6-104">If you are writing a class with some operations that may incur noticeable delays, consider giving it asynchronous functionality by implementing the [Event-based Asynchronous Pattern Overview](event-based-asynchronous-pattern-overview.md).</span></span>  
  
 <span data-ttu-id="1cef6-105">Bu izlenecek yol, olay tabanlı zaman uyumsuz model uygulayan bir bileşenin nasıl oluşturulacağını göstermektedir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-105">This walkthrough illustrates how to create a component that implements the Event-based Asynchronous Pattern.</span></span> <span data-ttu-id="1cef6-106">Bu, <xref:System.ComponentModel?displayProperty=nameWithType> bileşenin ASP.net, konsol uygulamaları ve Windows Forms uygulamaları dahil olmak üzere herhangi bir uygulama modelinde doğru şekilde çalıştığından emin olmak üzere ad alanından yardımcı sınıflar kullanılarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-106">It is implemented using helper classes from the <xref:System.ComponentModel?displayProperty=nameWithType> namespace, which ensures that the component works correctly under any application model, including ASP.NET, Console applications and Windows Forms applications.</span></span> <span data-ttu-id="1cef6-107">Bu bileşen ayrıca bir <xref:System.Windows.Forms.PropertyGrid> denetimle ve kendi özel tasarımcılarına göre de genişletilebilir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-107">This component is also designable with a <xref:System.Windows.Forms.PropertyGrid> control and your own custom designers.</span></span>  
  
 <span data-ttu-id="1cef6-108">İşlem sırasında, ana sayıları zaman uyumsuz olarak hesaplayan bir uygulamaya sahip olursunuz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-108">When you are through, you will have an application that computes prime numbers asynchronously.</span></span> <span data-ttu-id="1cef6-109">Uygulamanız ana kullanıcı arabirimi (UI) iş parçacığına ve her asal sayı hesaplaması için bir iş parçacığına sahip olacaktır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-109">Your application will have a main user interface (UI) thread and a thread for each prime number calculation.</span></span> <span data-ttu-id="1cef6-110">Büyük bir sayının asal olup olmadığını test etmek, fark edilebilir bir süre alabilir, ancak ana kullanıcı arabirimi iş parçacığı bu gecikmeyle kesintiye uğramaz ve hesaplamalar sırasında form yanıt verir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-110">Although testing whether a large number is prime can take a noticeable amount of time, the main UI thread will not be interrupted by this delay, and the form will be responsive during the calculations.</span></span> <span data-ttu-id="1cef6-111">Aynı anda istediğiniz sayıda hesaplama çalıştırabilir ve bekleyen hesaplamaları seçmeli olarak iptal edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-111">You will be able to run as many calculations as you like concurrently and selectively cancel pending calculations.</span></span>  
  
 <span data-ttu-id="1cef6-112">Bu izlenecek yolda gösterilen görevler şunlardır:</span><span class="sxs-lookup"><span data-stu-id="1cef6-112">Tasks illustrated in this walkthrough include:</span></span>  
  
- <span data-ttu-id="1cef6-113">Bileşeni oluşturma</span><span class="sxs-lookup"><span data-stu-id="1cef6-113">Creating the Component</span></span>  
  
- <span data-ttu-id="1cef6-114">Ortak zaman uyumsuz olayları ve temsilcileri tanımlama</span><span class="sxs-lookup"><span data-stu-id="1cef6-114">Defining Public Asynchronous Events and Delegates</span></span>  
  
- <span data-ttu-id="1cef6-115">Özel temsilciler tanımlama</span><span class="sxs-lookup"><span data-stu-id="1cef6-115">Defining Private Delegates</span></span>  
  
- <span data-ttu-id="1cef6-116">Ortak olayları uygulama</span><span class="sxs-lookup"><span data-stu-id="1cef6-116">Implementing Public Events</span></span>  
  
- <span data-ttu-id="1cef6-117">Tamamlama yöntemini uygulama</span><span class="sxs-lookup"><span data-stu-id="1cef6-117">Implementing the Completion Method</span></span>  
  
- <span data-ttu-id="1cef6-118">Çalışan yöntemlerini uygulama</span><span class="sxs-lookup"><span data-stu-id="1cef6-118">Implementing the Worker Methods</span></span>  
  
- <span data-ttu-id="1cef6-119">Start ve Cancel yöntemlerini uygulama</span><span class="sxs-lookup"><span data-stu-id="1cef6-119">Implementing Start and Cancel Methods</span></span>  
  
 <span data-ttu-id="1cef6-120">Bu konudaki kodu tek bir liste olarak kopyalamak için bkz. [nasıl yapılır: olay tabanlı zaman uyumsuz düzendeki bir Istemciyi uygulama](how-to-implement-a-client-of-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="1cef6-120">To copy the code in this topic as a single listing, see [How to: Implement a Client of the Event-based Asynchronous Pattern](how-to-implement-a-client-of-the-event-based-asynchronous-pattern.md).</span></span>  
  
## <a name="creating-the-component"></a><span data-ttu-id="1cef6-121">Bileşeni oluşturma</span><span class="sxs-lookup"><span data-stu-id="1cef6-121">Creating the Component</span></span>  

 <span data-ttu-id="1cef6-122">İlk adım, olay tabanlı zaman uyumsuz düzene uygulanacak bileşeni oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-122">The first step is to create the component that will implement the Event-based Asynchronous Pattern.</span></span>  
  
### <a name="to-create-the-component"></a><span data-ttu-id="1cef6-123">Bileşeni oluşturmak için</span><span class="sxs-lookup"><span data-stu-id="1cef6-123">To create the component</span></span>  
  
- <span data-ttu-id="1cef6-124">Öğesinden devralan adlı bir sınıf oluşturun `PrimeNumberCalculator` <xref:System.ComponentModel.Component> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-124">Create a class called `PrimeNumberCalculator` that inherits from <xref:System.ComponentModel.Component>.</span></span>  
  
## <a name="defining-public-asynchronous-events-and-delegates"></a><span data-ttu-id="1cef6-125">Ortak zaman uyumsuz olayları ve temsilcileri tanımlama</span><span class="sxs-lookup"><span data-stu-id="1cef6-125">Defining Public Asynchronous Events and Delegates</span></span>  

 <span data-ttu-id="1cef6-126">Bileşeniniz, olayları kullanarak istemcilerle iletişim kurar.</span><span class="sxs-lookup"><span data-stu-id="1cef6-126">Your component communicates to clients using events.</span></span> <span data-ttu-id="1cef6-127">_MethodName_**olay uyarıları** istemcileri, zaman uyumsuz bir görevin tamamlanmasını sağlar ve _MethodName_**ProgressChanged & lt** olayı, zaman uyumsuz bir görevin ilerleme durumunu istemcilere bildirir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-127">The _MethodName_**Completed** event alerts clients to the completion of an asynchronous task, and the _MethodName_**ProgressChanged** event informs clients of the progress of an asynchronous task.</span></span>  
  
### <a name="to-define-asynchronous-events-for-clients-of-your-component"></a><span data-ttu-id="1cef6-128">Bileşeninizin istemcilerine yönelik zaman uyumsuz olayları tanımlamak için:</span><span class="sxs-lookup"><span data-stu-id="1cef6-128">To define asynchronous events for clients of your component:</span></span>  
  
1. <span data-ttu-id="1cef6-129"><xref:System.Threading?displayProperty=nameWithType>Ve <xref:System.Collections.Specialized?displayProperty=nameWithType> ad alanlarını dosyanızın en üstüne aktarın.</span><span class="sxs-lookup"><span data-stu-id="1cef6-129">Import the <xref:System.Threading?displayProperty=nameWithType> and <xref:System.Collections.Specialized?displayProperty=nameWithType> namespaces at the top of your file.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#11](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#11)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#11](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#11)]  
  
2. <span data-ttu-id="1cef6-130">`PrimeNumberCalculator`Sınıf tanımından önce, ilerleme ve tamamlanma olayları için temsilciler bildirin.</span><span class="sxs-lookup"><span data-stu-id="1cef6-130">Before the `PrimeNumberCalculator` class definition, declare delegates for progress and completion events.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#7](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#7)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#7](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#7)]  
  
3. <span data-ttu-id="1cef6-131">`PrimeNumberCalculator`Sınıf tanımında, ilerlemeyi raporlamaya ve istemcilere tamamlamaya yönelik olayları bildirin.</span><span class="sxs-lookup"><span data-stu-id="1cef6-131">In the `PrimeNumberCalculator` class definition, declare events for reporting progress and completion to clients.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#8](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#8)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#8](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#8)]  
  
4. <span data-ttu-id="1cef6-132">`PrimeNumberCalculator`Sınıf tanımından sonra, `CalculatePrimeCompletedEventArgs` her hesaplamanın sonucunu,. Event için istemcinin olay işleyicisine bildirmek üzere sınıfını türetebilirsiniz `CalculatePrimeCompleted` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-132">After the `PrimeNumberCalculator` class definition, derive the `CalculatePrimeCompletedEventArgs` class for reporting the outcome of each calculation to the client's event handler for the `CalculatePrimeCompleted`.event.</span></span> <span data-ttu-id="1cef6-133">`AsyncCompletedEventArgs`Bu sınıf, özelliklere ek olarak, istemcinin hangi sayının test edildiğini, asal olup olmadığını ve ilk bölen ana değilse ne olduğunu belirlemesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="1cef6-133">In addition to the `AsyncCompletedEventArgs` properties, this class enables the client to determine what number was tested, whether it is prime, and what the first divisor is if it is not prime.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#6](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#6)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#6](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#6)]  
  
## <a name="checkpoint"></a><span data-ttu-id="1cef6-134">Checkpoint</span><span class="sxs-lookup"><span data-stu-id="1cef6-134">Checkpoint</span></span>  

 <span data-ttu-id="1cef6-135">Bu noktada, bileşeni oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-135">At this point, you can build the component.</span></span>  
  
### <a name="to-test-your-component"></a><span data-ttu-id="1cef6-136">Bileşeninizi test etmek için</span><span class="sxs-lookup"><span data-stu-id="1cef6-136">To test your component</span></span>  
  
- <span data-ttu-id="1cef6-137">Bileşeni derleyin.</span><span class="sxs-lookup"><span data-stu-id="1cef6-137">Compile the component.</span></span>  
  
     <span data-ttu-id="1cef6-138">İki derleyici uyarısı alacaksınız:</span><span class="sxs-lookup"><span data-stu-id="1cef6-138">You will receive two compiler warnings:</span></span>  
  
    ```console  
    warning CS0067: The event 'AsynchronousPatternExample.PrimeNumberCalculator.ProgressChanged' is never used  
    warning CS0067: The event 'AsynchronousPatternExample.PrimeNumberCalculator.CalculatePrimeCompleted' is never used  
    ```  
  
     <span data-ttu-id="1cef6-139">Bu uyarılar sonraki bölümde temizlenir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-139">These warnings will be cleared in the next section.</span></span>  
  
## <a name="defining-private-delegates"></a><span data-ttu-id="1cef6-140">Özel temsilciler tanımlama</span><span class="sxs-lookup"><span data-stu-id="1cef6-140">Defining Private Delegates</span></span>  

 <span data-ttu-id="1cef6-141">Bileşenin zaman uyumsuz yönleri, `PrimeNumberCalculator` olarak bilinen özel bir temsilci ile dahili olarak uygulanır <xref:System.Threading.SendOrPostCallback> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-141">The asynchronous aspects of the `PrimeNumberCalculator` component are implemented internally with a special delegate known as a <xref:System.Threading.SendOrPostCallback>.</span></span> <span data-ttu-id="1cef6-142">Bir <xref:System.Threading.SendOrPostCallback> iş parçacığında yürütülen bir geri çağırma yöntemini temsil eder <xref:System.Threading.ThreadPool> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-142">A <xref:System.Threading.SendOrPostCallback> represents a callback method that executes on a <xref:System.Threading.ThreadPool> thread.</span></span> <span data-ttu-id="1cef6-143">Geri çağırma yöntemi türünde tek bir parametre alan bir imzaya sahip olmalıdır <xref:System.Object> , bu, bir sarmalayıcı sınıfında temsilciler arasında durum geçirmeniz gereken anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-143">The callback method must have a signature that takes a single parameter of type <xref:System.Object>, which means you will need to pass state among delegates in a wrapper class.</span></span> <span data-ttu-id="1cef6-144">Daha fazla bilgi için bkz. <xref:System.Threading.SendOrPostCallback>.</span><span class="sxs-lookup"><span data-stu-id="1cef6-144">For more information, see <xref:System.Threading.SendOrPostCallback>.</span></span>  
  
### <a name="to-implement-your-components-internal-asynchronous-behavior"></a><span data-ttu-id="1cef6-145">Bileşeninizin iç zaman uyumsuz davranışını uygulamak için:</span><span class="sxs-lookup"><span data-stu-id="1cef6-145">To implement your component's internal asynchronous behavior:</span></span>  
  
1. <span data-ttu-id="1cef6-146">Sınıfında temsilciler bildirin ve oluşturun <xref:System.Threading.SendOrPostCallback> `PrimeNumberCalculator` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-146">Declare and create the <xref:System.Threading.SendOrPostCallback> delegates in the `PrimeNumberCalculator` class.</span></span> <span data-ttu-id="1cef6-147"><xref:System.Threading.SendOrPostCallback>Adlı bir yardımcı program yönteminde nesneleri oluşturun `InitializeDelegates` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-147">Create the <xref:System.Threading.SendOrPostCallback> objects in a utility method called `InitializeDelegates`.</span></span>  
  
     <span data-ttu-id="1cef6-148">İki temsilcinin olması gerekir: biri istemciye ilerleme durumunu raporlamak için bir diğeri ise istemciye tamamlanmayı rapor eder.</span><span class="sxs-lookup"><span data-stu-id="1cef6-148">You will need two delegates: one for reporting progress to the client, and one for reporting completion to the client.</span></span>  

     [!code-csharp[System.ComponentModel.AsyncOperationManager#9](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#9)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#9](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#9)]  
    [!code-csharp[System.ComponentModel.AsyncOperationManager#20](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#20)]
    [!code-vb[System.ComponentModel.AsyncOperationManager#20](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#20)]  
  
2. <span data-ttu-id="1cef6-149">`InitializeDelegates`Bileşenin oluşturucusunda yöntemini çağırın.</span><span class="sxs-lookup"><span data-stu-id="1cef6-149">Call the `InitializeDelegates` method in your component's constructor.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#21](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#21)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#21](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#21)]  
  
3. <span data-ttu-id="1cef6-150">`PrimeNumberCalculator`Zaman uyumsuz olarak yapılacak gerçek işleri işleyen sınıfta bir temsilci bildirin.</span><span class="sxs-lookup"><span data-stu-id="1cef6-150">Declare a delegate in the `PrimeNumberCalculator` class that handles the actual work to be done asynchronously.</span></span> <span data-ttu-id="1cef6-151">Bu temsilci, bir sayının asal olup olmadığını test eden çalışan yöntemini sarmalanmış.</span><span class="sxs-lookup"><span data-stu-id="1cef6-151">This delegate wraps the worker method that tests whether a number is prime.</span></span> <span data-ttu-id="1cef6-152">Temsilci, <xref:System.ComponentModel.AsyncOperation> zaman uyumsuz işlemin ömrünü izlemek için kullanılacak bir parametre alır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-152">The delegate takes an <xref:System.ComponentModel.AsyncOperation> parameter, which will be used to track the lifetime of the asynchronous operation.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#22](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#22)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#22](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#22)]  
  
4. <span data-ttu-id="1cef6-153">Bekleyen zaman uyumsuz işlemlerin yaşam sürelerini yönetmek için bir koleksiyon oluşturun.</span><span class="sxs-lookup"><span data-stu-id="1cef6-153">Create a collection for managing lifetimes of pending asynchronous operations.</span></span> <span data-ttu-id="1cef6-154">İstemci, yürütüldüğü ve tamamlandıkları sırada işlemleri izlemek için bir yönteme ihtiyaç duyuyor ve bu izleme, istemci zaman uyumsuz metoda çağrı yaptığında, istemcinin benzersiz bir belirteç veya görev KIMLIĞI geçmesini gerektirerek yapılır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-154">The client needs a way to track operations as they are executed and completed, and this tracking is done by requiring the client to pass a unique token, or task ID, when the client makes the call to the asynchronous method.</span></span> <span data-ttu-id="1cef6-155">`PrimeNumberCalculator`Bileşen, görev kimliğini karşılık gelen çağrıdan ilişkilendirerek her bir çağrıyı takip etmelidir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-155">The `PrimeNumberCalculator` component must keep track of each call by associating the task ID with its corresponding invocation.</span></span> <span data-ttu-id="1cef6-156">İstemci benzersiz olmayan bir görev KIMLIĞI geçirirse, `PrimeNumberCalculator` bileşen bir özel durum yükseltmelidir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-156">If the client passes a task ID that is not unique, the `PrimeNumberCalculator` component must raise an exception.</span></span>  
  
     <span data-ttu-id="1cef6-157">`PrimeNumberCalculator`Bileşen, adlı özel bir koleksiyon sınıfını kullanarak görev kimliğini izler <xref:System.Collections.Specialized.HybridDictionary> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-157">The `PrimeNumberCalculator` component keeps track of task ID by using a special collection class called a <xref:System.Collections.Specialized.HybridDictionary>.</span></span> <span data-ttu-id="1cef6-158">Sınıf tanımında, adlı bir adı oluşturun <xref:System.Collections.Specialized.HybridDictionary> `userTokenToLifetime` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-158">In the class definition, create a <xref:System.Collections.Specialized.HybridDictionary> called `userTokenToLifetime`.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#23](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#23)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#23](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#23)]  
  
## <a name="implementing-public-events"></a><span data-ttu-id="1cef6-159">Ortak olayları uygulama</span><span class="sxs-lookup"><span data-stu-id="1cef6-159">Implementing Public Events</span></span>  

 <span data-ttu-id="1cef6-160">Olay tabanlı zaman uyumsuz model uygulayan bileşenler olayları kullanarak istemcilerle iletişim kurar.</span><span class="sxs-lookup"><span data-stu-id="1cef6-160">Components that implement the Event-based Asynchronous Pattern communicate to clients using events.</span></span> <span data-ttu-id="1cef6-161">Bu olaylar, sınıfının yardımıyla uygun iş parçacığında çağrılır <xref:System.ComponentModel.AsyncOperation> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-161">These events are invoked on the proper thread with the help of the <xref:System.ComponentModel.AsyncOperation> class.</span></span>  
  
### <a name="to-raise-events-to-your-components-clients"></a><span data-ttu-id="1cef6-162">Bileşenin istemcilerine olay yükseltmek için:</span><span class="sxs-lookup"><span data-stu-id="1cef6-162">To raise events to your component's clients:</span></span>  
  
1. <span data-ttu-id="1cef6-163">İstemcilere raporlama için ortak olayları uygulayın.</span><span class="sxs-lookup"><span data-stu-id="1cef6-163">Implement public events for reporting to clients.</span></span> <span data-ttu-id="1cef6-164">İlerlemeyi raporlamak için bir olaya ve bir etkinliğin tamamlanmasını raporlamaya ihtiyacınız olacak.</span><span class="sxs-lookup"><span data-stu-id="1cef6-164">You will need an event for reporting progress and one for reporting completion.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#24](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#24)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#24](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#24)]  
  
## <a name="implementing-the-completion-method"></a><span data-ttu-id="1cef6-165">Tamamlama yöntemini uygulama</span><span class="sxs-lookup"><span data-stu-id="1cef6-165">Implementing the Completion Method</span></span>  

 <span data-ttu-id="1cef6-166">Tamamlanma temsilcisi, zaman uyumsuz işlem başarılı tamamlama, hata veya iptal ile sona erdiğinde, temel alınan, serbest iş parçacıklı zaman uyumsuz davranışın çağıracağı yöntemdir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-166">The completion delegate is the method that the underlying, free-threaded asynchronous behavior will invoke when the asynchronous operation ends by successful completion, error, or cancellation.</span></span> <span data-ttu-id="1cef6-167">Bu çağrı, rastgele bir iş parçacığında gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-167">This invocation happens on an arbitrary thread.</span></span>  
  
 <span data-ttu-id="1cef6-168">Bu yöntem, istemcinin görev KIMLIĞININ, benzersiz istemci belirteçleri iç koleksiyonundan kaldırıldığı yerdir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-168">This method is where the client's task ID is removed from the internal collection of unique client tokens.</span></span> <span data-ttu-id="1cef6-169">Bu yöntem, karşılık gelen yöntemini çağırarak belirli bir zaman uyumsuz işlemin ömrünü de sonlandırır <xref:System.ComponentModel.AsyncOperation.PostOperationCompleted%2A> <xref:System.ComponentModel.AsyncOperation> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-169">This method also ends the lifetime of a particular asynchronous operation by calling the <xref:System.ComponentModel.AsyncOperation.PostOperationCompleted%2A> method on the corresponding <xref:System.ComponentModel.AsyncOperation>.</span></span> <span data-ttu-id="1cef6-170">Bu çağrı, uygulama modeli için uygun olan iş parçacığında tamamlanma olayını başlatır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-170">This call raises the completion event on the thread that is appropriate for the application model.</span></span> <span data-ttu-id="1cef6-171"><xref:System.ComponentModel.AsyncOperation.PostOperationCompleted%2A>Yöntemi çağrıldıktan sonra, bu örneği <xref:System.ComponentModel.AsyncOperation> artık kullanılamaz ve bunu kullanmaya yönelik sonraki girişimler bir özel durum oluşturur.</span><span class="sxs-lookup"><span data-stu-id="1cef6-171">After the <xref:System.ComponentModel.AsyncOperation.PostOperationCompleted%2A> method is called, this instance of <xref:System.ComponentModel.AsyncOperation> can no longer be used, and any subsequent attempts to use it will throw an exception.</span></span>  
  
 <span data-ttu-id="1cef6-172">`CompletionMethod`İmza, zaman uyumsuz işlemin sonucunu anlatmak için gereken tüm durumu tutmalıdır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-172">The `CompletionMethod` signature must hold all state necessary to describe the outcome of the asynchronous operation.</span></span> <span data-ttu-id="1cef6-173">Bu, belirli zaman uyumsuz işlem tarafından test edilen numaranın, sayının asal olup olmadığı ve asal sayı değilse ilk bölenin değerinin durumunu barındırır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-173">It holds state for the number that was tested by this particular asynchronous operation, whether the number is prime, and the value of its first divisor if it is not a prime number.</span></span> <span data-ttu-id="1cef6-174">Ayrıca, oluşan tüm özel durumları ve <xref:System.ComponentModel.AsyncOperation> Bu göreve karşılık gelen durumu açıklayan durumu da barındırır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-174">It also holds state describing any exception that occurred, and the <xref:System.ComponentModel.AsyncOperation> corresponding to this particular task.</span></span>  
  
### <a name="to-complete-an-asynchronous-operation"></a><span data-ttu-id="1cef6-175">Zaman uyumsuz bir işlemi gerçekleştirmek için:</span><span class="sxs-lookup"><span data-stu-id="1cef6-175">To complete an asynchronous operation:</span></span>  
  
- <span data-ttu-id="1cef6-176">Tamamlama yöntemini uygulayın.</span><span class="sxs-lookup"><span data-stu-id="1cef6-176">Implement the completion method.</span></span> <span data-ttu-id="1cef6-177">İstemciye, istemci tarafından döndürülen bir istemciyi doldurmak için kullandığı altı parametre alır `CalculatePrimeCompletedEventArgs` `CalculatePrimeCompletedEventHandler` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-177">It takes six parameters, which it uses to populate a `CalculatePrimeCompletedEventArgs` that is returned to the client through the client's `CalculatePrimeCompletedEventHandler`.</span></span> <span data-ttu-id="1cef6-178">İstemci görev KIMLIĞI belirtecini iç koleksiyondan kaldırır ve çağrısı ile zaman uyumsuz işlemin ömrünü sonlandırır <xref:System.ComponentModel.AsyncOperation.PostOperationCompleted%2A> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-178">It removes the client's task ID token from the internal collection, and it ends the asynchronous operation's lifetime with a call to <xref:System.ComponentModel.AsyncOperation.PostOperationCompleted%2A>.</span></span> <span data-ttu-id="1cef6-179">, <xref:System.ComponentModel.AsyncOperation> Uygulama modeli için uygun olan iş parçacığına veya içeriğe yapılan çağrıyı sıralar.</span><span class="sxs-lookup"><span data-stu-id="1cef6-179">The <xref:System.ComponentModel.AsyncOperation> marshals the call to the thread or context that is appropriate for the application model.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#26](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#26)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#26](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#26)]  
  
## <a name="checkpoint"></a><span data-ttu-id="1cef6-180">Checkpoint</span><span class="sxs-lookup"><span data-stu-id="1cef6-180">Checkpoint</span></span>  

 <span data-ttu-id="1cef6-181">Bu noktada, bileşeni oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-181">At this point, you can build the component.</span></span>  
  
### <a name="to-test-your-component"></a><span data-ttu-id="1cef6-182">Bileşeninizi test etmek için</span><span class="sxs-lookup"><span data-stu-id="1cef6-182">To test your component</span></span>  
  
- <span data-ttu-id="1cef6-183">Bileşeni derleyin.</span><span class="sxs-lookup"><span data-stu-id="1cef6-183">Compile the component.</span></span>  
  
     <span data-ttu-id="1cef6-184">Bir derleyici uyarısı alacaksınız:</span><span class="sxs-lookup"><span data-stu-id="1cef6-184">You will receive one compiler warning:</span></span>  
  
    ```console  
    warning CS0169: The private field 'AsynchronousPatternExample.PrimeNumberCalculator.workerDelegate' is never used  
    ```  
  
     <span data-ttu-id="1cef6-185">Bu uyarı sonraki bölümde çözümlenir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-185">This warning will be resolved in the next section.</span></span>  
  
## <a name="implementing-the-worker-methods"></a><span data-ttu-id="1cef6-186">Çalışan yöntemlerini uygulama</span><span class="sxs-lookup"><span data-stu-id="1cef6-186">Implementing the Worker Methods</span></span>  

 <span data-ttu-id="1cef6-187">Şimdiye kadar, bileşen için zaman uyumsuz kod destekleme kodu uyguladık `PrimeNumberCalculator` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-187">So far, you have implemented the supporting asynchronous code for the `PrimeNumberCalculator` component.</span></span> <span data-ttu-id="1cef6-188">Artık gerçek işi yapan kodu uygulayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-188">Now you can implement the code that does the actual work.</span></span> <span data-ttu-id="1cef6-189">Üç yöntem uygulayacaksınız: `CalculateWorker` , `BuildPrimeNumberList` , ve `IsPrime` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-189">You will implement three methods: `CalculateWorker`, `BuildPrimeNumberList`, and `IsPrime`.</span></span> <span data-ttu-id="1cef6-190">Birlikte, `BuildPrimeNumberList` `IsPrime` bir sayının, test numarasının kare köküne kadar tüm asal sayıları bularak bir sayının asal olup olmadığını belirleyen, en iyi bilinen bir algoritma oluşturur.</span><span class="sxs-lookup"><span data-stu-id="1cef6-190">Together, `BuildPrimeNumberList` and `IsPrime` comprise a well-known algorithm called the Sieve of Eratosthenes, which determines if a number is prime by finding all the prime numbers up to the square root of the test number.</span></span> <span data-ttu-id="1cef6-191">Bu nokta tarafından hiçbir izleme bulunmazsa, test numarası asal olur.</span><span class="sxs-lookup"><span data-stu-id="1cef6-191">If no divisors are found by that point, the test number is prime.</span></span>  
  
 <span data-ttu-id="1cef6-192">Bu bileşen en yüksek verimlilik için yazılmışsa, farklı test numaraları için çeşitli etkinleştirmeleri tarafından bulunan tüm asal sayıları hatırlayacaktı.</span><span class="sxs-lookup"><span data-stu-id="1cef6-192">If this component were written for maximum efficiency, it would remember all the prime numbers discovered by various invocations for different test numbers.</span></span> <span data-ttu-id="1cef6-193">Ayrıca, 2, 3 ve 5 gibi önemsiz bir göz atın.</span><span class="sxs-lookup"><span data-stu-id="1cef6-193">It would also check for trivial divisors like 2, 3, and 5.</span></span> <span data-ttu-id="1cef6-194">Bu örneğin amacı, zaman alan işlemlerin zaman uyumsuz olarak nasıl yürütülebileceğini göstermek, ancak bu iyileştirmelerin sizin için bir alıştırma olarak ayrılmamaktır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-194">The intent of this example is to demonstrate how time-consuming operations can be executed asynchronously, however, so these optimizations are left as an exercise for you.</span></span>  
  
 <span data-ttu-id="1cef6-195">`CalculateWorker`Yöntemi bir temsilciye sarmalanmış ve çağrısı ile zaman uyumsuz olarak çağırılır `BeginInvoke` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-195">The `CalculateWorker` method is wrapped in a delegate and is invoked asynchronously with a call to `BeginInvoke`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1cef6-196">İlerleme raporlaması `BuildPrimeNumberList` yönteminde uygulanır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-196">Progress reporting is implemented in the `BuildPrimeNumberList` method.</span></span> <span data-ttu-id="1cef6-197">Hızlı bilgisayarlarda, `ProgressChanged` Olaylar hızlı bir şekilde birbirini izleyen bir şekilde oluşturulabilir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-197">On fast computers, `ProgressChanged` events can be raised in rapid succession.</span></span> <span data-ttu-id="1cef6-198">Bu olayların oluşturulduğu istemci iş parçacığı, bu durumu işleyebilmelidir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-198">The client thread, on which these events are raised, must be able to handle this situation.</span></span> <span data-ttu-id="1cef6-199">Kullanıcı arabirimi kodu iletilerle taştı ve devam edemiyor olabilir ve yanıt vermeyebilir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-199">User interface code may be flooded with messages and unable to keep up, resulting in unresponsiveness.</span></span> <span data-ttu-id="1cef6-200">Bu durumu işleyen örnek bir kullanıcı arabirimi için bkz. [nasıl yapılır: olay tabanlı zaman uyumsuz düzendeki bir Istemciyi uygulama](how-to-implement-a-client-of-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="1cef6-200">For an example user interface that handles this situation, see [How to: Implement a Client of the Event-based Asynchronous Pattern](how-to-implement-a-client-of-the-event-based-asynchronous-pattern.md).</span></span>  
  
### <a name="to-execute-the-prime-number-calculation-asynchronously"></a><span data-ttu-id="1cef6-201">Ana sayı hesaplamasını zaman uyumsuz olarak yürütmek için:</span><span class="sxs-lookup"><span data-stu-id="1cef6-201">To execute the prime number calculation asynchronously:</span></span>  
  
1. <span data-ttu-id="1cef6-202">`TaskCanceled`Yardımcı program yöntemini uygulayın.</span><span class="sxs-lookup"><span data-stu-id="1cef6-202">Implement the `TaskCanceled` utility method.</span></span> <span data-ttu-id="1cef6-203">Bu, verilen görev KIMLIĞI için görev ömrü toplamayı denetler ve `true` görev kimliği bulunmazsa döndürür.</span><span class="sxs-lookup"><span data-stu-id="1cef6-203">This checks the task lifetime collection for the given task ID, and returns `true` if the task ID is not found.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#32](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#32)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#32](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#32)]  
  
2. <span data-ttu-id="1cef6-204">Yöntemini uygulayın `CalculateWorker` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-204">Implement the `CalculateWorker` method.</span></span> <span data-ttu-id="1cef6-205">İki parametre alır: sınanacak sayı ve bir <xref:System.ComponentModel.AsyncOperation> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-205">It takes two parameters: a number to test, and an <xref:System.ComponentModel.AsyncOperation>.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#27](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#27)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#27](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#27)]  
  
3. <span data-ttu-id="1cef6-206">Uygulayın `BuildPrimeNumberList` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-206">Implement `BuildPrimeNumberList`.</span></span> <span data-ttu-id="1cef6-207">İki parametre alır: sınanacak sayı ve bir <xref:System.ComponentModel.AsyncOperation> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-207">It takes two parameters: the number to test, and an <xref:System.ComponentModel.AsyncOperation>.</span></span> <span data-ttu-id="1cef6-208"><xref:System.ComponentModel.AsyncOperation>İlerleme durumunu ve artımlı sonuçları raporlamak için öğesini kullanır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-208">It uses the <xref:System.ComponentModel.AsyncOperation> to report progress and incremental results.</span></span> <span data-ttu-id="1cef6-209">Bu, istemcinin olay işleyicilerinin uygulama modeli için uygun iş parçacığında veya içerikte çağrılması sağlar.</span><span class="sxs-lookup"><span data-stu-id="1cef6-209">This assures that the client's event handlers are called on the proper thread or context for the application model.</span></span> <span data-ttu-id="1cef6-210">`BuildPrimeNumberList`Bir asal sayı bulduğunda, bu, olayı için istemcinin olay işleyicisine artımlı bir sonuç olarak bildirir `ProgressChanged` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-210">When `BuildPrimeNumberList` finds a prime number, it reports this as an incremental result to the client's event handler for the `ProgressChanged` event.</span></span> <span data-ttu-id="1cef6-211">Bu, <xref:System.ComponentModel.ProgressChangedEventArgs> `CalculatePrimeProgressChangedEventArgs` eklenen bir özelliği olan adlı öğesinden türetilmiş bir sınıf gerektirir `LatestPrimeNumber` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-211">This requires a class derived from <xref:System.ComponentModel.ProgressChangedEventArgs>, called `CalculatePrimeProgressChangedEventArgs`, which has one added property called `LatestPrimeNumber`.</span></span>  
  
     <span data-ttu-id="1cef6-212">Yöntemi `BuildPrimeNumberList` Ayrıca yöntemi düzenli olarak çağırır `TaskCanceled` ve Yöntem döndürüyorsa çıkar `true` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-212">The `BuildPrimeNumberList` method also periodically calls the `TaskCanceled` method and exits if the method returns `true`.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#5](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#5)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#5](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#5)]  
  
4. <span data-ttu-id="1cef6-213">Uygulayın `IsPrime` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-213">Implement `IsPrime`.</span></span> <span data-ttu-id="1cef6-214">Üç parametre vardır: bilinen asal sayıların listesi, sınanacak sayı ve bulunan ilk bölen için bir çıktı parametresi.</span><span class="sxs-lookup"><span data-stu-id="1cef6-214">It takes three parameters: a list of known prime numbers, the number to test, and an output parameter for the first divisor found.</span></span> <span data-ttu-id="1cef6-215">Asal sayıların listesi verildiğinde, test numarasının asal olup olmadığını belirler.</span><span class="sxs-lookup"><span data-stu-id="1cef6-215">Given the list of prime numbers, it determines if the test number is prime.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#28](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#28)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#28](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#28)]  
  
5. <span data-ttu-id="1cef6-216">Türet `CalculatePrimeProgressChangedEventArgs` <xref:System.ComponentModel.ProgressChangedEventArgs> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-216">Derive `CalculatePrimeProgressChangedEventArgs` from <xref:System.ComponentModel.ProgressChangedEventArgs>.</span></span> <span data-ttu-id="1cef6-217">Bu sınıf, olay için istemcinin olay işleyicisine artımlı sonuçlar bildirmek için gereklidir `ProgressChanged` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-217">This class is necessary for reporting incremental results to the client's event handler for the `ProgressChanged` event.</span></span> <span data-ttu-id="1cef6-218">Adında eklenen bir özelliğe sahiptir `LatestPrimeNumber` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-218">It has one added property called `LatestPrimeNumber`.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#29](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#29)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#29](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#29)]  
  
## <a name="checkpoint"></a><span data-ttu-id="1cef6-219">Checkpoint</span><span class="sxs-lookup"><span data-stu-id="1cef6-219">Checkpoint</span></span>  

 <span data-ttu-id="1cef6-220">Bu noktada, bileşeni oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-220">At this point, you can build the component.</span></span>  
  
### <a name="to-test-your-component"></a><span data-ttu-id="1cef6-221">Bileşeninizi test etmek için</span><span class="sxs-lookup"><span data-stu-id="1cef6-221">To test your component</span></span>  
  
- <span data-ttu-id="1cef6-222">Bileşeni derleyin.</span><span class="sxs-lookup"><span data-stu-id="1cef6-222">Compile the component.</span></span>  
  
     <span data-ttu-id="1cef6-223">Yazılması gereken işlemler, zaman uyumsuz işlemleri başlatma ve iptal etme yöntemleridir `CalculatePrimeAsync` `CancelAsync` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-223">All that remains to be written are the methods to start and cancel asynchronous operations, `CalculatePrimeAsync` and `CancelAsync`.</span></span>  
  
## <a name="implementing-the-start-and-cancel-methods"></a><span data-ttu-id="1cef6-224">Start ve Cancel yöntemlerini uygulama</span><span class="sxs-lookup"><span data-stu-id="1cef6-224">Implementing the Start and Cancel Methods</span></span>  

 <span data-ttu-id="1cef6-225">Çalışan metodunu, sarmalayan temsilciyi çağırarak kendi iş parçacığında başlatabilirsiniz `BeginInvoke` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-225">You start the worker method on its own thread by calling `BeginInvoke` on the delegate that wraps it.</span></span> <span data-ttu-id="1cef6-226">Belirli bir zaman uyumsuz işlemin ömrünü yönetmek için <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A> <xref:System.ComponentModel.AsyncOperationManager> yardımcı sınıfında yöntemi çağırın.</span><span class="sxs-lookup"><span data-stu-id="1cef6-226">To manage the lifetime of a particular asynchronous operation, you call the <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A> method on the <xref:System.ComponentModel.AsyncOperationManager> helper class.</span></span> <span data-ttu-id="1cef6-227">Bu <xref:System.ComponentModel.AsyncOperation> , istemci olay işleyicilerinde doğru iş parçacığına veya içeriğe çağrı getiren bir döndürür.</span><span class="sxs-lookup"><span data-stu-id="1cef6-227">This returns an <xref:System.ComponentModel.AsyncOperation>, which marshals calls on the client's event handlers to the proper thread or context.</span></span>  
  
 <span data-ttu-id="1cef6-228">Kendisine karşılık gelen bir bekleyen işlemi çağırarak iptal edersiniz <xref:System.ComponentModel.AsyncOperation.PostOperationCompleted%2A> <xref:System.ComponentModel.AsyncOperation> .</span><span class="sxs-lookup"><span data-stu-id="1cef6-228">You cancel a particular pending operation by calling <xref:System.ComponentModel.AsyncOperation.PostOperationCompleted%2A> on its corresponding <xref:System.ComponentModel.AsyncOperation>.</span></span> <span data-ttu-id="1cef6-229">Bu işlem sonlanır ve bundan sonraki çağrılar <xref:System.ComponentModel.AsyncOperation> bir özel durum oluşturur.</span><span class="sxs-lookup"><span data-stu-id="1cef6-229">This ends that operation, and any subsequent calls to its <xref:System.ComponentModel.AsyncOperation> will throw an exception.</span></span>  
  
### <a name="to-implement-start-and-cancel-functionality"></a><span data-ttu-id="1cef6-230">Start ve Cancel işlevlerini uygulamak için:</span><span class="sxs-lookup"><span data-stu-id="1cef6-230">To implement Start and Cancel functionality:</span></span>  
  
1. <span data-ttu-id="1cef6-231">Yöntemini uygulayın `CalculatePrimeAsync` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-231">Implement the `CalculatePrimeAsync` method.</span></span> <span data-ttu-id="1cef6-232">İstemci tarafından sağlanan belirtecin (görev KIMLIĞI), şu anda bekleyen görevleri temsil eden tüm belirteçlere göre benzersiz olduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="1cef6-232">Make sure the client-supplied token (task ID) is unique with respect to all the tokens representing currently pending tasks.</span></span> <span data-ttu-id="1cef6-233">İstemci benzersiz olmayan bir belirteçte geçerse `CalculatePrimeAsync` bir özel durum oluşturur.</span><span class="sxs-lookup"><span data-stu-id="1cef6-233">If the client passes in a non-unique token, `CalculatePrimeAsync` raises an exception.</span></span> <span data-ttu-id="1cef6-234">Aksi takdirde, belirteç görev KIMLIĞI koleksiyonuna eklenir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-234">Otherwise, the token is added to the task ID collection.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#3](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#3)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#3](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#3)]  
  
2. <span data-ttu-id="1cef6-235">Yöntemini uygulayın `CancelAsync` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-235">Implement the `CancelAsync` method.</span></span> <span data-ttu-id="1cef6-236">`taskId`Parametre belirteç koleksiyonunda varsa, kaldırılır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-236">If the `taskId` parameter exists in the token collection, it is removed.</span></span> <span data-ttu-id="1cef6-237">Bu, çalışmayı başlatmayan iptal edilen görevleri engeller.</span><span class="sxs-lookup"><span data-stu-id="1cef6-237">This prevents canceled tasks that have not started from running.</span></span> <span data-ttu-id="1cef6-238">Görev çalışıyorsa `BuildPrimeNumberList` yöntemi, görev kimliğinin ömür koleksiyonundan kaldırıldığını algıladığında çıkar.</span><span class="sxs-lookup"><span data-stu-id="1cef6-238">If the task is running, the `BuildPrimeNumberList` method exits when it detects that the task ID has been removed from the lifetime collection.</span></span>  
  
     [!code-csharp[System.ComponentModel.AsyncOperationManager#4](snippets/component-that-supports-the-event-based-asynchronous-pattern/csharp/primenumbercalculatormain.cs#4)]
     [!code-vb[System.ComponentModel.AsyncOperationManager#4](snippets/component-that-supports-the-event-based-asynchronous-pattern/vb/primenumbercalculatormain.vb#4)]  
  
## <a name="checkpoint"></a><span data-ttu-id="1cef6-239">Checkpoint</span><span class="sxs-lookup"><span data-stu-id="1cef6-239">Checkpoint</span></span>  

 <span data-ttu-id="1cef6-240">Bu noktada, bileşeni oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-240">At this point, you can build the component.</span></span>  
  
### <a name="to-test-your-component"></a><span data-ttu-id="1cef6-241">Bileşeninizi test etmek için</span><span class="sxs-lookup"><span data-stu-id="1cef6-241">To test your component</span></span>  
  
- <span data-ttu-id="1cef6-242">Bileşeni derleyin.</span><span class="sxs-lookup"><span data-stu-id="1cef6-242">Compile the component.</span></span>  
  
 <span data-ttu-id="1cef6-243">`PrimeNumberCalculator`Bileşen artık tamamlanmıştır ve kullanıma hazırdır.</span><span class="sxs-lookup"><span data-stu-id="1cef6-243">The `PrimeNumberCalculator` component is now complete and ready to use.</span></span>  
  
 <span data-ttu-id="1cef6-244">Bileşenini kullanan örnek bir istemci için `PrimeNumberCalculator` bkz. [nasıl yapılır: olay tabanlı zaman uyumsuz düzende istemci uygulama](how-to-implement-a-client-of-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="1cef6-244">For an example client that uses the `PrimeNumberCalculator` component, see [How to: Implement a Client of the Event-based Asynchronous Pattern](how-to-implement-a-client-of-the-event-based-asynchronous-pattern.md).</span></span>  
  
## <a name="next-steps"></a><span data-ttu-id="1cef6-245">Sonraki Adımlar</span><span class="sxs-lookup"><span data-stu-id="1cef6-245">Next Steps</span></span>  

 <span data-ttu-id="1cef6-246">`CalculatePrime`Yöntemin zaman uyumlu eşdeğerini yazarak bu örneği doldurabilirsiniz `CalculatePrimeAsync` .</span><span class="sxs-lookup"><span data-stu-id="1cef6-246">You can fill out this example by writing `CalculatePrime`, the synchronous equivalent of `CalculatePrimeAsync` method.</span></span> <span data-ttu-id="1cef6-247">Bu, `PrimeNumberCalculator` bileşeni olay tabanlı zaman uyumsuz düzeniyle tamamen uyumlu hale getirir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-247">This will make the `PrimeNumberCalculator` component fully compliant with the Event-based Asynchronous Pattern.</span></span>  
  
 <span data-ttu-id="1cef6-248">Farklı test numaraları için çeşitli etkinleştirmeleri tarafından bulunan tüm asal sayıların listesini koruyarak bu örneği geliştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-248">You can improve this example by retaining the list of all the prime numbers discovered by various invocations for different test numbers.</span></span> <span data-ttu-id="1cef6-249">Bu yaklaşımı kullanarak, her görev önceki görevler tarafından gerçekleştirilen işin avantajına sahip olur.</span><span class="sxs-lookup"><span data-stu-id="1cef6-249">Using this approach, each task will benefit from the work done by previous tasks.</span></span> <span data-ttu-id="1cef6-250">Bu listeyi bölgelerle korumamaya dikkat `lock` edin, bu nedenle listeye farklı iş parçacıkları tarafından erişim serileştirilir.</span><span class="sxs-lookup"><span data-stu-id="1cef6-250">Be careful to protect this list with `lock` regions, so access to the list by different threads is serialized.</span></span>  
  
 <span data-ttu-id="1cef6-251">Bu örneği Ayrıca, 2, 3 ve 5 gibi önemsiz ve daha fazla bilgi için test ederek geliştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-251">You can also improve this example by testing for trivial divisors, like 2, 3, and 5.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1cef6-252">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="1cef6-252">See also</span></span>

- [<span data-ttu-id="1cef6-253">Nasıl yapılır: Arka Planda İşlem Çalıştırma</span><span class="sxs-lookup"><span data-stu-id="1cef6-253">How to: Run an Operation in the Background</span></span>](/dotnet/desktop/winforms/controls/how-to-run-an-operation-in-the-background)
- [<span data-ttu-id="1cef6-254">Olay Tabanlı Zaman Uyumsuz Desene Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="1cef6-254">Event-based Asynchronous Pattern Overview</span></span>](event-based-asynchronous-pattern-overview.md)
- [<span data-ttu-id="1cef6-255">Olay Tabanlı Zaman Uyumsuz Desen (EAP)</span><span class="sxs-lookup"><span data-stu-id="1cef6-255">Event-based Asynchronous Pattern (EAP)</span></span>](event-based-asynchronous-pattern-eap.md)
