---
title: İşlem Kapsamı Kullanarak Örtük İşlem Uygulama
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 49d1706a-1e0c-4c85-9704-75c908372eb9
ms.openlocfilehash: 33b51cf26a35bbdda70582d86db6ac39c22597da
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79174400"
---
# <a name="implementing-an-implicit-transaction-using-transaction-scope"></a><span data-ttu-id="35a65-102">İşlem Kapsamı Kullanarak Örtük İşlem Uygulama</span><span class="sxs-lookup"><span data-stu-id="35a65-102">Implementing an Implicit Transaction using Transaction Scope</span></span>
<span data-ttu-id="35a65-103">Sınıf, <xref:System.Transactions.TransactionScope> hareketin kendisiyle etkileşimkurmanızı gerektirmeden, bir kod bloğunu bir hareketle ilgili olarak işaretlemenin basit bir yolunu sağlar.</span><span class="sxs-lookup"><span data-stu-id="35a65-103">The <xref:System.Transactions.TransactionScope> class provides a simple way to mark a block of code as participating in a transaction, without requiring you to interact with the transaction itself.</span></span> <span data-ttu-id="35a65-104">Hareket kapsamı ortam işlemini otomatik olarak seçebilir ve yönetebilir.</span><span class="sxs-lookup"><span data-stu-id="35a65-104">A transaction scope can select and manage the ambient transaction automatically.</span></span> <span data-ttu-id="35a65-105">Kullanım kolaylığı ve verimliliği nedeniyle, bir işlem uygulaması <xref:System.Transactions.TransactionScope> geliştirirken sınıfı kullanmanız önerilir.</span><span class="sxs-lookup"><span data-stu-id="35a65-105">Due to its ease of use and efficiency, it is recommended that you use the <xref:System.Transactions.TransactionScope> class when developing a transaction application.</span></span>  
  
 <span data-ttu-id="35a65-106">Ayrıca, kaynakları açıkça hareketle kaydolmanız gerekmez.</span><span class="sxs-lookup"><span data-stu-id="35a65-106">In addition, you do not need to enlist resources explicitly with the transaction.</span></span> <span data-ttu-id="35a65-107">Herhangi <xref:System.Transactions> bir kaynak yöneticisi (SQL Server 2005 gibi) kapsam tarafından oluşturulan bir ortam hareketinin varlığını algılayabilir ve otomatik olarak kaydolabilir.</span><span class="sxs-lookup"><span data-stu-id="35a65-107">Any <xref:System.Transactions> resource manager (such as SQL Server 2005) can detect the existence of an ambient transaction created by the scope and automatically enlist.</span></span>  
  
## <a name="creating-a-transaction-scope"></a><span data-ttu-id="35a65-108">Hareket kapsamı oluşturma</span><span class="sxs-lookup"><span data-stu-id="35a65-108">Creating a transaction scope</span></span>  
 <span data-ttu-id="35a65-109">Aşağıdaki örnek, bir basit kullanımını gösterir <xref:System.Transactions.TransactionScope> sınıfı.</span><span class="sxs-lookup"><span data-stu-id="35a65-109">The following sample shows a simple usage of the <xref:System.Transactions.TransactionScope> class.</span></span>  
  
 [!code-csharp[TransactionScope#1](../../../../samples/snippets/csharp/VS_Snippets_Remoting/TransactionScope/cs/ScopeWithSQL.cs#1)]
 [!code-vb[TransactionScope#1](../../../../samples/snippets/visualbasic/VS_Snippets_Remoting/TransactionScope/vb/ScopeWithSQL.vb#1)]  
  
 <span data-ttu-id="35a65-110">Yeni <xref:System.Transactions.TransactionScope> bir nesne oluşturduğunuzda hareket kapsamı başlatılır.</span><span class="sxs-lookup"><span data-stu-id="35a65-110">The transaction scope is started once you create a new <xref:System.Transactions.TransactionScope> object.</span></span>  <span data-ttu-id="35a65-111">Kod örneğinde gösterildiği gibi, bir `using` deyimle kapsam oluşturmanız önerilir.</span><span class="sxs-lookup"><span data-stu-id="35a65-111">As illustrated in the code sample, it is recommended that you create scopes with a `using` statement.</span></span> <span data-ttu-id="35a65-112">`using` İfade c# ve Visual Basic hem de mevcuttur `try`ve bir gibi çalışır ... `finally` kapsamın düzgün bir şekilde atıldığından emin olmak için blok.</span><span class="sxs-lookup"><span data-stu-id="35a65-112">The `using` statement is available both in C# and in Visual Basic, and works like a `try`...`finally` block to ensure that the scope is disposed of properly.</span></span>  
  
 <span data-ttu-id="35a65-113"><xref:System.Transactions.TransactionScope>Anında işlem yöneticisi hangi işlemin katılacağını belirler.</span><span class="sxs-lookup"><span data-stu-id="35a65-113">When you instantiate <xref:System.Transactions.TransactionScope>, the transaction manager determines which transaction to participate in.</span></span> <span data-ttu-id="35a65-114">Belirlendikten sonra, kapsam her zaman bu işlemde katılır.</span><span class="sxs-lookup"><span data-stu-id="35a65-114">Once determined, the scope always participates in that transaction.</span></span> <span data-ttu-id="35a65-115">Karar iki faktöre dayanır: ortam işleminin mevcut olup olmadığı `TransactionScopeOption` ve oluşturucudaki parametrenin değeri.</span><span class="sxs-lookup"><span data-stu-id="35a65-115">The decision is based on two factors: whether an ambient transaction is present and the value of the `TransactionScopeOption` parameter in the constructor.</span></span> <span data-ttu-id="35a65-116">Ortam hareketi, kodunuzun yürütüldettiği harekettir.</span><span class="sxs-lookup"><span data-stu-id="35a65-116">The ambient transaction is the transaction within which your code executes.</span></span> <span data-ttu-id="35a65-117"><xref:System.Transactions.Transaction> Sınıfın statik <xref:System.Transactions.Transaction.Current%2A?displayProperty=nameWithType> özelliğini arayarak ortam hareketine başvuru alabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35a65-117">You can obtain a reference to the ambient transaction by calling the static <xref:System.Transactions.Transaction.Current%2A?displayProperty=nameWithType> property of the <xref:System.Transactions.Transaction> class.</span></span> <span data-ttu-id="35a65-118">Bu parametrenin nasıl kullanıldığı hakkında daha fazla bilgi için, bu konunun [TransactionScopeOption](#ManageTxFlow) bölümünü kullanarak Yönetim hareket akışına bakın.</span><span class="sxs-lookup"><span data-stu-id="35a65-118">For more information on how this parameter is used, see the [Managing transaction flow using TransactionScopeOption](#ManageTxFlow) section of this topic.</span></span>  
  
## <a name="completing-a-transaction-scope"></a><span data-ttu-id="35a65-119">Hareket kapsamını tamamlama</span><span class="sxs-lookup"><span data-stu-id="35a65-119">Completing a transaction scope</span></span>  
 <span data-ttu-id="35a65-120">Uygulamanız bir işlemde gerçekleştirmek istediği tüm işi tamamladığında, <xref:System.Transactions.TransactionScope.Complete%2A?displayProperty=nameWIthType> işlem yöneticisine hareketi gerçekleştirmenin kabul edilebilir olduğunu bildirmek için yöntemi yalnızca bir kez aramalısınız.</span><span class="sxs-lookup"><span data-stu-id="35a65-120">When your application completes all the work it wants to perform in a transaction, you should call the <xref:System.Transactions.TransactionScope.Complete%2A?displayProperty=nameWIthType> method only once to inform the transaction manager that it is acceptable to commit the transaction.</span></span> <span data-ttu-id="35a65-121">Bu <xref:System.Transactions.TransactionScope.Complete%2A> `using` blokta son ifade olarak arama koymak için çok iyi bir uygulamadır.</span><span class="sxs-lookup"><span data-stu-id="35a65-121">It is very good practice to put the call to <xref:System.Transactions.TransactionScope.Complete%2A> as the last statement in the `using` block.</span></span>  
  
 <span data-ttu-id="35a65-122">İşlem yöneticisi bunu bir sistem hatası veya işlem kapsamında atılan bir özel durum olarak yorumladığı için, bu yöntemin çağrılmaması hareketi iptal eder.</span><span class="sxs-lookup"><span data-stu-id="35a65-122">Failing to call this method aborts the transaction, because the transaction manager interprets this as a system failure, or equivalent to an exception thrown within the scope of the transaction.</span></span> <span data-ttu-id="35a65-123">Ancak, bu yöntemi çağırmak, işlemin solunan bir söz olduğunu garanti etmez.</span><span class="sxs-lookup"><span data-stu-id="35a65-123">However, calling this method does not guarantee that the transaction wil be committed.</span></span> <span data-ttu-id="35a65-124">Bu yalnızca işlem yöneticisine durumunuzu bildirmenin bir yoludur.</span><span class="sxs-lookup"><span data-stu-id="35a65-124">It is merely a way of informing the transaction manager of your status.</span></span> <span data-ttu-id="35a65-125"><xref:System.Transactions.TransactionScope.Complete%2A> Yöntemi aradıktan sonra, <xref:System.Transactions.Transaction.Current%2A> özelliği kullanarak ortam hareketine artık erişemezsiniz ve bunu yapmaya çalışmak bir özel durum atılmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="35a65-125">After calling the <xref:System.Transactions.TransactionScope.Complete%2A> method, you can no longer access the ambient transaction by using the <xref:System.Transactions.Transaction.Current%2A> property, and attempting to do so will result in an exception being thrown.</span></span>  
  
 <span data-ttu-id="35a65-126"><xref:System.Transactions.TransactionScope> Nesne hareketi başlangıçta oluşturduysa, hareket yöneticisi tarafından hareketi gerçekleştirmenin gerçek işi `using` bloktaki son kod satırından sonra gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="35a65-126">If the <xref:System.Transactions.TransactionScope> object created the transaction initially, the actual work of committing the transaction by the transaction manager occurs after the last line of code in the `using` block.</span></span> <span data-ttu-id="35a65-127">İşlemi oluşturmadıysa, <xref:System.Transactions.CommittableTransaction.Commit%2A> <xref:System.Transactions.CommittableTransaction> nesnenin sahibi tarafından çağrıldığında commit oluşur.</span><span class="sxs-lookup"><span data-stu-id="35a65-127">If it did not create the transaction, the commit occurs whenever <xref:System.Transactions.CommittableTransaction.Commit%2A> is called by the owner of the <xref:System.Transactions.CommittableTransaction> object.</span></span> <span data-ttu-id="35a65-128">Bu noktada işlem yöneticisi kaynak yöneticilerini çağırır ve yöntemin <xref:System.Transactions.TransactionScope.Complete%2A> <xref:System.Transactions.TransactionScope> nesneye çağrılıp çağrılmadığına bağlı olarak kaynak yöneticilerini çağırır ve onları işleme veya geri alma konusunda bilgilendirir.</span><span class="sxs-lookup"><span data-stu-id="35a65-128">At that point the transaction manager calls the resource managers and informs them to either commit or rollback, based on whether the <xref:System.Transactions.TransactionScope.Complete%2A> method was called on the <xref:System.Transactions.TransactionScope> object.</span></span>  
  
 <span data-ttu-id="35a65-129">Deyim, `using` bir özel <xref:System.Transactions.TransactionScope.Dispose%2A> durum <xref:System.Transactions.TransactionScope> oluşsa bile nesnenin yönteminin çağrılmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="35a65-129">The `using` statement ensures that the <xref:System.Transactions.TransactionScope.Dispose%2A> method of the <xref:System.Transactions.TransactionScope> object is called even if an exception occurs.</span></span> <span data-ttu-id="35a65-130">Yöntem, <xref:System.Transactions.TransactionScope.Dispose%2A> hareket kapsamının sonunu işaretler.</span><span class="sxs-lookup"><span data-stu-id="35a65-130">The <xref:System.Transactions.TransactionScope.Dispose%2A> method marks the end of the transaction scope.</span></span> <span data-ttu-id="35a65-131">Bu yöntemi aradıktan sonra oluşan özel durumlar hareketi etkilemeyebilir.</span><span class="sxs-lookup"><span data-stu-id="35a65-131">Exceptions that occur after calling this method may not affect the transaction.</span></span> <span data-ttu-id="35a65-132">Bu yöntem, ortam işlemini önceki durumuna da geri yükler.</span><span class="sxs-lookup"><span data-stu-id="35a65-132">This method also restores the ambient transaction to it previous state.</span></span>  
  
 <span data-ttu-id="35a65-133">Kapsam <xref:System.Transactions.TransactionAbortedException> hareketi oluşturursa ve hareket iptal edilirse a atılır.</span><span class="sxs-lookup"><span data-stu-id="35a65-133">A <xref:System.Transactions.TransactionAbortedException> is thrown if the scope creates the transaction, and the transaction is aborted.</span></span> <span data-ttu-id="35a65-134">Hareket <xref:System.Transactions.TransactionInDoubtException> yöneticisi Commit kararına ulaşamıyorsa a atılır.</span><span class="sxs-lookup"><span data-stu-id="35a65-134">A <xref:System.Transactions.TransactionInDoubtException> is thrown if the transaction manager cannot reach a Commit decision.</span></span> <span data-ttu-id="35a65-135">Hareket işlenirse özel durum atılmaz.</span><span class="sxs-lookup"><span data-stu-id="35a65-135">No exception is thrown if the transaction is committed.</span></span>  
  
## <a name="rolling-back-a-transaction"></a><span data-ttu-id="35a65-136">Bir hareketi geri alma</span><span class="sxs-lookup"><span data-stu-id="35a65-136">Rolling back a transaction</span></span>  
 <span data-ttu-id="35a65-137">Bir hareketi geri almak istiyorsanız, <xref:System.Transactions.TransactionScope.Complete%2A> yöntemin işlem kapsamı içinde çağrılmaması gerekir.</span><span class="sxs-lookup"><span data-stu-id="35a65-137">If you want to rollback a transaction, you should not call the <xref:System.Transactions.TransactionScope.Complete%2A> method within the transaction scope.</span></span> <span data-ttu-id="35a65-138">Örneğin, kapsam içinde bir özel durum.</span><span class="sxs-lookup"><span data-stu-id="35a65-138">For example, you can throw an exception within the scope.</span></span> <span data-ttu-id="35a65-139">Katıldığı işlem geri alınır.</span><span class="sxs-lookup"><span data-stu-id="35a65-139">The transaction in which it participates in will be rolled back.</span></span>  
  
## <a name="managing-transaction-flow-using-transactionscopeoption"></a><a name="ManageTxFlow"></a><span data-ttu-id="35a65-140">TransactionScopeOption kullanarak işlem akışını yönetme</span><span class="sxs-lookup"><span data-stu-id="35a65-140">Managing transaction flow using TransactionScopeOption</span></span>  
 <span data-ttu-id="35a65-141">İşlem kapsamı, aşağıdaki örnekte olduğu gibi, <xref:System.Transactions.TransactionScope> `RootMethod` kendi kapsamını kullanan bir yöntem içinden a kullanan bir yöntem çağırarak iç içe olabilir,</span><span class="sxs-lookup"><span data-stu-id="35a65-141">Transaction scope can be nested by calling a method that uses a <xref:System.Transactions.TransactionScope> from within a method that uses its own scope, as is the case with the `RootMethod` method in the following example,</span></span>  
  
```csharp  
void RootMethod()
{
    using(TransactionScope scope = new TransactionScope())
    {
        /* Perform transactional work here */
        SomeMethod();
        scope.Complete();
    }
}

void SomeMethod()
{
    using(TransactionScope scope = new TransactionScope())
    {
        /* Perform transactional work here */
        scope.Complete();
    }
}
```  
  
 <span data-ttu-id="35a65-142">En çok işlem kapsamı kök kapsamı olarak adlandırılır.</span><span class="sxs-lookup"><span data-stu-id="35a65-142">The top-most transaction scope is referred to as the root scope.</span></span>  
  
 <span data-ttu-id="35a65-143">Sınıf, <xref:System.Transactions.TransactionScope> kapsamın işlem davranışını tanımlayan türün <xref:System.Transactions.TransactionScopeOption>numaralandırmasını kabul eden birkaç aşırı yüklü oluşturucu sağlar.</span><span class="sxs-lookup"><span data-stu-id="35a65-143">The <xref:System.Transactions.TransactionScope> class provides several overloaded constructors that accept an enumeration of the type <xref:System.Transactions.TransactionScopeOption>, which defines the transactional behavior of the scope.</span></span>  
  
 <span data-ttu-id="35a65-144">Bir <xref:System.Transactions.TransactionScope> nesnenin üç seçenek vardır:</span><span class="sxs-lookup"><span data-stu-id="35a65-144">A <xref:System.Transactions.TransactionScope> object has three options:</span></span>  
  
- <span data-ttu-id="35a65-145">Ortam işlemine katılın veya yoksa yeni bir işlem oluşturun.</span><span class="sxs-lookup"><span data-stu-id="35a65-145">Join the ambient transaction, or create a new one if one does not exist.</span></span>  
  
- <span data-ttu-id="35a65-146">Yeni bir kök kapsam, yani, yeni bir işlem başlatmak ve bu işlem kendi kapsamı içinde yeni ortam hareketi olmak olun.</span><span class="sxs-lookup"><span data-stu-id="35a65-146">Be a new root scope, that is, start a new transaction and have that transaction be the new ambient transaction inside its own scope.</span></span>  
  
- <span data-ttu-id="35a65-147">Bir işlemde yer almamak.</span><span class="sxs-lookup"><span data-stu-id="35a65-147">Not take part in a transaction at all.</span></span> <span data-ttu-id="35a65-148">Sonuç olarak ortam hareketi yoktur.</span><span class="sxs-lookup"><span data-stu-id="35a65-148">There is no ambient transaction as a result.</span></span>  
  
 <span data-ttu-id="35a65-149">Kapsam <xref:System.Transactions.TransactionScopeOption.Required>ile anında ve ortam hareketi varsa, kapsam bu hareketi birleştirir.</span><span class="sxs-lookup"><span data-stu-id="35a65-149">If the scope is instantiated with <xref:System.Transactions.TransactionScopeOption.Required>, and an ambient transaction is present, the scope joins that transaction.</span></span> <span data-ttu-id="35a65-150">Diğer taraftan, ortam hareketi yoksa, kapsam yeni bir işlem oluşturur ve kök kapsam haline gelir.</span><span class="sxs-lookup"><span data-stu-id="35a65-150">If, on the other hand, there is no ambient transaction, then the scope creates a new transaction, and become the root scope.</span></span> <span data-ttu-id="35a65-151">Varsayılan değer budur.</span><span class="sxs-lookup"><span data-stu-id="35a65-151">This is the default value.</span></span> <span data-ttu-id="35a65-152">Kullanıldığında, <xref:System.Transactions.TransactionScopeOption.Required> kapsam içindeki kodun kök olsun veya sadece ortam işlemine katılarak farklı davranması gerekmez.</span><span class="sxs-lookup"><span data-stu-id="35a65-152">When <xref:System.Transactions.TransactionScopeOption.Required> is used, the code inside the scope does not need to behave differently whether it is the root or just joining the ambient transaction.</span></span> <span data-ttu-id="35a65-153">Her iki durumda da aynı şekilde çalışması.</span><span class="sxs-lookup"><span data-stu-id="35a65-153">It should operate identically in both cases.</span></span>  
  
 <span data-ttu-id="35a65-154">Kapsamı ile örneği varsa <xref:System.Transactions.TransactionScopeOption.RequiresNew>, her zaman bir kök kapsam olur.</span><span class="sxs-lookup"><span data-stu-id="35a65-154">If the scope is instantiated with <xref:System.Transactions.TransactionScopeOption.RequiresNew>, it is always the root scope.</span></span> <span data-ttu-id="35a65-155">Yeni bir işlem başlatır ve hareketi kapsam içindeki yeni ortam hareketi olur.</span><span class="sxs-lookup"><span data-stu-id="35a65-155">It starts a new transaction, and its transaction becomes the new ambient transaction inside the scope.</span></span>  
  
 <span data-ttu-id="35a65-156">Kapsam, <xref:System.Transactions.TransactionScopeOption.Suppress>ortam hareketinin mevcut olup olmadığına bakılmaksızın hiçbir zaman bir işlemde yer almaz.</span><span class="sxs-lookup"><span data-stu-id="35a65-156">If the scope is instantiated with <xref:System.Transactions.TransactionScopeOption.Suppress>, it never takes part in a transaction, regardless of whether an ambient transaction is present.</span></span> <span data-ttu-id="35a65-157">Bu değerle anında birleştirilmiş bir `null` kapsam, ortam hareketi olarak her zaman vardır.</span><span class="sxs-lookup"><span data-stu-id="35a65-157">A scope instantiated with this value always have `null` as its ambient transaction.</span></span>  
  
 <span data-ttu-id="35a65-158">Yukarıdaki seçenekleri aşağıdaki tabloda özetlenmiştir.</span><span class="sxs-lookup"><span data-stu-id="35a65-158">The above options are summarized in the following table.</span></span>  
  
|<span data-ttu-id="35a65-159">TransactionScopeOption</span><span class="sxs-lookup"><span data-stu-id="35a65-159">TransactionScopeOption</span></span>|<span data-ttu-id="35a65-160">Ortam İşlemi</span><span class="sxs-lookup"><span data-stu-id="35a65-160">Ambient Transaction</span></span>|<span data-ttu-id="35a65-161">Kapsam bölümü alır</span><span class="sxs-lookup"><span data-stu-id="35a65-161">The scope takes part in</span></span>|  
|----------------------------|-------------------------|-----------------------------|  
|<span data-ttu-id="35a65-162">Gerekli</span><span class="sxs-lookup"><span data-stu-id="35a65-162">Required</span></span>|<span data-ttu-id="35a65-163">Hayır</span><span class="sxs-lookup"><span data-stu-id="35a65-163">No</span></span>|<span data-ttu-id="35a65-164">Yeni İşlem (kök olacak)</span><span class="sxs-lookup"><span data-stu-id="35a65-164">New Transaction (will be the root)</span></span>|  
|<span data-ttu-id="35a65-165">Yeni gerektirir</span><span class="sxs-lookup"><span data-stu-id="35a65-165">Requires New</span></span>|<span data-ttu-id="35a65-166">Hayır</span><span class="sxs-lookup"><span data-stu-id="35a65-166">No</span></span>|<span data-ttu-id="35a65-167">Yeni İşlem (kök olacak)</span><span class="sxs-lookup"><span data-stu-id="35a65-167">New Transaction (will be the root)</span></span>|  
|<span data-ttu-id="35a65-168">Önle</span><span class="sxs-lookup"><span data-stu-id="35a65-168">Suppress</span></span>|<span data-ttu-id="35a65-169">Hayır</span><span class="sxs-lookup"><span data-stu-id="35a65-169">No</span></span>|<span data-ttu-id="35a65-170">İşlem Yok</span><span class="sxs-lookup"><span data-stu-id="35a65-170">No Transaction</span></span>|  
|<span data-ttu-id="35a65-171">Gerekli</span><span class="sxs-lookup"><span data-stu-id="35a65-171">Required</span></span>|<span data-ttu-id="35a65-172">Evet</span><span class="sxs-lookup"><span data-stu-id="35a65-172">Yes</span></span>|<span data-ttu-id="35a65-173">Ortam İşlemi</span><span class="sxs-lookup"><span data-stu-id="35a65-173">Ambient  Transaction</span></span>|  
|<span data-ttu-id="35a65-174">Yeni gerektirir</span><span class="sxs-lookup"><span data-stu-id="35a65-174">Requires New</span></span>|<span data-ttu-id="35a65-175">Evet</span><span class="sxs-lookup"><span data-stu-id="35a65-175">Yes</span></span>|<span data-ttu-id="35a65-176">Yeni İşlem (kök olacak)</span><span class="sxs-lookup"><span data-stu-id="35a65-176">New Transaction (will be the root)</span></span>|  
|<span data-ttu-id="35a65-177">Önle</span><span class="sxs-lookup"><span data-stu-id="35a65-177">Suppress</span></span>|<span data-ttu-id="35a65-178">Evet</span><span class="sxs-lookup"><span data-stu-id="35a65-178">Yes</span></span>|<span data-ttu-id="35a65-179">İşlem Yok</span><span class="sxs-lookup"><span data-stu-id="35a65-179">No Transaction</span></span>|  
  
 <span data-ttu-id="35a65-180">Bir <xref:System.Transactions.TransactionScope> nesne varolan bir ortam hareketine katıldığında, kapsam nesnesinin atılması, kapsam hareketi iptal etmediği sürece hareketi sonlandıramaz.</span><span class="sxs-lookup"><span data-stu-id="35a65-180">When a <xref:System.Transactions.TransactionScope> object joins an existing ambient transaction, disposing of the scope object may not end the transaction, unless the scope aborts the transaction.</span></span> <span data-ttu-id="35a65-181">Ortam hareketi bir kök kapsamı tarafından oluşturulduysa, yalnızca kök kapsamı atıldığında, hareket <xref:System.Transactions.CommittableTransaction.Commit%2A> çağrıldı.</span><span class="sxs-lookup"><span data-stu-id="35a65-181">If the ambient transaction was created by a root scope, only when the root scope is disposed of, does <xref:System.Transactions.CommittableTransaction.Commit%2A> get called on the transaction.</span></span> <span data-ttu-id="35a65-182">Hareket el ile oluşturulduysa, hareket iptal edildiğinde veya oluşturucusu tarafından işlendiğinde sona erer.</span><span class="sxs-lookup"><span data-stu-id="35a65-182">If the transaction was created manually, the transaction ends when it is either aborted, or committed by its creator.</span></span>  
  
 <span data-ttu-id="35a65-183">Aşağıdaki örnekte gösterildiği bir <xref:System.Transactions.TransactionScope> üç iç içe kapsamlı nesneler, farklı bir her örneklenen oluşturan nesne <xref:System.Transactions.TransactionScopeOption> değeri.</span><span class="sxs-lookup"><span data-stu-id="35a65-183">The following example shows a <xref:System.Transactions.TransactionScope> object that creates three nested scope objects, each instantiated with a different <xref:System.Transactions.TransactionScopeOption> value.</span></span>  
  
```csharp  
using(TransactionScope scope1 = new TransactionScope())
//Default is Required
{
    using(TransactionScope scope2 = new TransactionScope(TransactionScopeOption.Required))
    {
        //...
    }

    using(TransactionScope scope3 = new TransactionScope(TransactionScopeOption.RequiresNew))
    {
        //...  
    }
  
    using(TransactionScope scope4 = new TransactionScope(TransactionScopeOption.Suppress))
    {
        //...  
    }
}
```  
  
 <span data-ttu-id="35a65-184">Örnek, herhangi bir ortam hareketi oluşturmadan bir kod`scope1`bloğu <xref:System.Transactions.TransactionScopeOption.Required>gösterir ( ) ile .</span><span class="sxs-lookup"><span data-stu-id="35a65-184">The example shows a code block without any ambient transaction creating a new scope (`scope1`) with <xref:System.Transactions.TransactionScopeOption.Required>.</span></span> <span data-ttu-id="35a65-185">`scope1` Kapsam, yeni bir hareket (Hareket A) oluşturur ve Hareket A'yı ortam hareketi yapar gibi bir kök kapsamdır.</span><span class="sxs-lookup"><span data-stu-id="35a65-185">The scope `scope1` is a root scope as it creates a new transaction (Transaction A) and makes Transaction A the ambient transaction.</span></span> <span data-ttu-id="35a65-186">`Scope1`Daha sonra her farklı bir ile üç daha fazla nesne oluşturur <xref:System.Transactions.TransactionScopeOption> değeri.</span><span class="sxs-lookup"><span data-stu-id="35a65-186">`Scope1` then creates three more objects, each with a different <xref:System.Transactions.TransactionScopeOption> value.</span></span> <span data-ttu-id="35a65-187">Örneğin, `scope2` 'ile <xref:System.Transactions.TransactionScopeOption.Required>oluşturulur ve bir ortam hareketi olduğundan, '' tarafından `scope1`oluşturulan ilk işlem birleştirir.</span><span class="sxs-lookup"><span data-stu-id="35a65-187">For example, `scope2` is created with <xref:System.Transactions.TransactionScopeOption.Required>, and since there is an ambient transaction, it joins the first transaction created by `scope1`.</span></span> <span data-ttu-id="35a65-188">Yeni `scope3` bir işlemin kök kapsamı olduğunu ve `scope4` ortam hareketi olmadığını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="35a65-188">Note that `scope3` is the root scope of a new transaction, and that `scope4` has no ambient transaction.</span></span>  
  
 <span data-ttu-id="35a65-189">Değerini varsayılan ve en sık kullanılan olsa da <xref:System.Transactions.TransactionScopeOption> olan <xref:System.Transactions.TransactionScopeOption.Required>, her diğer değerlerinin benzersiz amacı vardır.</span><span class="sxs-lookup"><span data-stu-id="35a65-189">Although the default and most commonly used value of <xref:System.Transactions.TransactionScopeOption> is <xref:System.Transactions.TransactionScopeOption.Required>, each of the other values has its unique purpose.</span></span>  

### <a name="non-transactional-code-inside-a-transaction-scope"></a><span data-ttu-id="35a65-190">Hareket kapsamı içinde işlem kodu olmayan</span><span class="sxs-lookup"><span data-stu-id="35a65-190">Non-transactional code inside a transaction scope</span></span>

 <span data-ttu-id="35a65-191"><xref:System.Transactions.TransactionScopeOption.Suppress>kod bölümü tarafından gerçekleştirilen işlemleri korumak istediğinizde ve işlemler başarısız olursa ortam işlemini iptal etmek istemediğiniz zaman yararlıdır.</span><span class="sxs-lookup"><span data-stu-id="35a65-191"><xref:System.Transactions.TransactionScopeOption.Suppress> is useful when you want to preserve the operations performed by the code section, and do not want to abort the ambient transaction if the operations fail.</span></span> <span data-ttu-id="35a65-192">Örneğin, günlüğe kaydetme veya denetleme işlemleri gerçekleştirmek istediğinizde veya ortam işleminizin taahhüt edilip edilmediğine veya iptal edilmediğine bakılmaksızın olayları abonelere yayınlamak istediğinizde.</span><span class="sxs-lookup"><span data-stu-id="35a65-192">For example, when you want to perform logging or audit operations, or when you want to publish events to subscribers regardless of whether your ambient transaction commits or aborts.</span></span> <span data-ttu-id="35a65-193">Bu değer, aşağıdaki örnekte gösterildiği gibi, bir işlem kapsamı içinde işlem dışı bir kod bölümüne sahip olmak sağlar.</span><span class="sxs-lookup"><span data-stu-id="35a65-193">This value allows you to have a non-transactional code section inside a transaction scope, as shown in the following example.</span></span>  
  
```csharp  
using(TransactionScope scope1 = new TransactionScope())
{
    try
    {
        //Start of non-transactional section
        using(TransactionScope scope2 = new
            TransactionScope(TransactionScopeOption.Suppress))  
        {  
            //Do non-transactional work here  
        }  
        //Restores ambient transaction here
   }
   catch {}  
   //Rest of scope1
}
```  
  
### <a name="voting-inside-a-nested-scope"></a><span data-ttu-id="35a65-194">İç içe bir kapsam içinde oylama</span><span class="sxs-lookup"><span data-stu-id="35a65-194">Voting inside a nested scope</span></span>  
 <span data-ttu-id="35a65-195">İç içe bir kapsam kök kapsamının ortam hareketine <xref:System.Transactions.TransactionScope.Complete%2A> katılabilse de, iç içe olan kapsamdaki aramanın kök kapsamı üzerinde hiçbir etkisi yoktur.</span><span class="sxs-lookup"><span data-stu-id="35a65-195">Although a nested scope can join the ambient transaction of the root scope, calling <xref:System.Transactions.TransactionScope.Complete%2A> in the nested scope has no affect on the root scope.</span></span> <span data-ttu-id="35a65-196">Yalnızca, kök kapsamdan işlem için son iç içe geçen kapsama kadar tüm kapsamlar oylanırsa, işlem işlenir.</span><span class="sxs-lookup"><span data-stu-id="35a65-196">Only if all the scopes from the root scope down to the last nested scope vote to commit the transaction, will the transaction be committed.</span></span> <span data-ttu-id="35a65-197">Ortam <xref:System.Transactions.TransactionScope.Complete%2A> hareketi hemen iptal edilince, iç içe bir kapsamda aramamak kök kapsamı etkileyecektir.</span><span class="sxs-lookup"><span data-stu-id="35a65-197">Not calling <xref:System.Transactions.TransactionScope.Complete%2A> in a nested scope will affect the root scope as the ambient transaction will immediately be aborted.</span></span>  
  
## <a name="setting-the-transactionscope-timeout"></a><span data-ttu-id="35a65-198">TransactionScope zaman ayarı</span><span class="sxs-lookup"><span data-stu-id="35a65-198">Setting the TransactionScope timeout</span></span>  
 <span data-ttu-id="35a65-199">Aşırı yüklü yapıcıların bazıları, <xref:System.Transactions.TransactionScope> hareketin zaman <xref:System.TimeSpan>aşımını denetlemek için kullanılan bir tür değerini kabul eder.</span><span class="sxs-lookup"><span data-stu-id="35a65-199">Some of the overloaded constructors of <xref:System.Transactions.TransactionScope> accept a value of type <xref:System.TimeSpan>, which is used to control the timeout of the transaction.</span></span> <span data-ttu-id="35a65-200">Sıfır olarak ayarlanmış bir zaman aşımı sonsuz bir zaman aşımı anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="35a65-200">A timeout set to zero means an infinite timeout.</span></span> <span data-ttu-id="35a65-201">Sonsuz zaman aşımı, kodunuzda adım atarak iş mantığınızdaki bir sorunu yalıtmak istediğinizde ve hatayı ayıklama işleminin sorunu bulmaya çalışırken zaman dışarı etmesini istemiyorsanız, hata ayıklama için çoğunlukla hata ayıklama için yararlıdır.</span><span class="sxs-lookup"><span data-stu-id="35a65-201">Infinite timeout is useful mostly for debugging, when you want to isolate a problem in your business logic by stepping through your code, and you do not want the transaction you debug to time out while you attempt to locate the problem.</span></span> <span data-ttu-id="35a65-202">İşlem kilitlenmelerine karşı korumaları geçersiz kıldığı için, diğer tüm durumlarda sonsuz zaman kaybı değerini kullanırken son derece dikkatli olun.</span><span class="sxs-lookup"><span data-stu-id="35a65-202">Be extremely careful using the infinite timeout value in all other cases, because it overrides the safeguards against transaction deadlocks.</span></span>  
  
 <span data-ttu-id="35a65-203">Genellikle ayarlanabilir <xref:System.Transactions.TransactionScope> zaman aşımına uğramak üzere iki durumda da varsayılan dışındaki değerler.</span><span class="sxs-lookup"><span data-stu-id="35a65-203">You typically set the <xref:System.Transactions.TransactionScope> timeout to values other than default in two cases.</span></span> <span data-ttu-id="35a65-204">İlki, uygulamanızın iptal edilen hareketleri işleme şeklini test etmek istediğiniz geliştirme sırasındadır.</span><span class="sxs-lookup"><span data-stu-id="35a65-204">The first is during development, when you want to test the way your application handles aborted transactions.</span></span> <span data-ttu-id="35a65-205">Zaman aşışını küçük bir değere (bir milisaniye gibi) ayarlayarak, işleminizin başarısız olması için sorun alabilirsiniz ve böylece hata işleme kodunuzu gözlemleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35a65-205">By setting the timeout to a small value (such as one millisecond), you cause your transaction to fail and can thus observe your error handling code.</span></span> <span data-ttu-id="35a65-206">Kapsam içinde kaynak talebi, söz konusu kilitlenmeleri kaynaklanan düşünüyorsanız, varsayılan zaman aşımı değerinden bir değere ayarlamanız ikinci durumdur.</span><span class="sxs-lookup"><span data-stu-id="35a65-206">The second case in which you set the value to be less than the default timeout is when you believe that the scope is involved in resource contention, resulting in deadlocks.</span></span> <span data-ttu-id="35a65-207">Bu durumda, hareketi mümkün olan en kısa sürede iptal etmek ve varsayılan zaman aşımısüresinin dolmasını beklememek istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="35a65-207">In that case, you want to abort the transaction as soon as possible and not wait for the default timeout to expire.</span></span>  
  
 <span data-ttu-id="35a65-208">Bir kapsam ortam hareketine katıldığında ancak ortam hareketinin ayarlandığından daha küçük bir zaman aşımı belirttiğinde, <xref:System.Transactions.TransactionScope> nesne üzerinde yeni, daha kısa zaman aşımı zorlanır ve kapsam belirtilen iç içe geçen süre içinde sona ermeli veya işlem otomatik olarak iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="35a65-208">When a scope joins an ambient transaction but specifies a smaller timeout than the one the ambient transaction is set to, the new, shorter timeout is enforced on the <xref:System.Transactions.TransactionScope> object, and the scope must end within the nested time specified, or the transaction is automatically aborted.</span></span> <span data-ttu-id="35a65-209">İç içe geçme süresi ortam hareketinden daha fazlaysa, hiçbir etkisi yoktur.</span><span class="sxs-lookup"><span data-stu-id="35a65-209">If the nested scope's timeout is more than that of the ambient transaction, it has no effect.</span></span>  
  
## <a name="setting-the-transactionscope-isolation-level"></a><span data-ttu-id="35a65-210">TransactionScope yalıtım düzeyini ayarlama</span><span class="sxs-lookup"><span data-stu-id="35a65-210">Setting the TransactionScope isolation level</span></span>  
 <span data-ttu-id="35a65-211">Zaman aşma değerine ek <xref:System.Transactions.TransactionScope> olarak yalıtım düzeyi <xref:System.Transactions.TransactionOptions> belirtmek için aşırı yüklü yapıyı kabul eden aşırı yüklü yapıcılardan bazıları.</span><span class="sxs-lookup"><span data-stu-id="35a65-211">Some of the overloaded constructors of <xref:System.Transactions.TransactionScope> accept a structure of type <xref:System.Transactions.TransactionOptions> to specify an isolation level, in addition to a timeout value.</span></span> <span data-ttu-id="35a65-212">Varsayılan olarak, hareket yalıtım düzeyi <xref:System.Transactions.IsolationLevel.Serializable>olarak ayarlanmış yürütülür.</span><span class="sxs-lookup"><span data-stu-id="35a65-212">By default, the transaction executes with isolation level set to <xref:System.Transactions.IsolationLevel.Serializable>.</span></span> <span data-ttu-id="35a65-213">Başka bir yalıtım düzeyi seçme <xref:System.Transactions.IsolationLevel.Serializable> yaygın olarak okuma yoğun sistemleri için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="35a65-213">Selecting an isolation level other than <xref:System.Transactions.IsolationLevel.Serializable> is commonly used for read-intensive systems.</span></span> <span data-ttu-id="35a65-214">Bu, işlem işleme teorisive işlemin kendisinin anlambiliminin, eşzamanlılık sorunlarının ve sistem tutarlılığının sonuçlarının sağlam bir şekilde anlaşılmasını gerektirir.</span><span class="sxs-lookup"><span data-stu-id="35a65-214">This requires a solid understanding of transaction processing theory and the semantics of the transaction itself, the concurrency issues involved, and the consequences for system consistency.</span></span>  
  
 <span data-ttu-id="35a65-215">Buna ek olarak, tüm kaynak yöneticileri tüm yalıtım düzeylerini desteklemez ve yapılandırılandan daha yüksek bir düzeyde işlemde yer almayı seçebilirler.</span><span class="sxs-lookup"><span data-stu-id="35a65-215">In addition, not all resource managers support all levels of isolation, and they may elect to take part in the transaction at a higher level than the one configured.</span></span>  
  
 <span data-ttu-id="35a65-216">Aynı bilgilere <xref:System.Transactions.IsolationLevel.Serializable> erişen diğer işlemlerden kaynaklanan tutarsızlığa karşı her yalıtım düzeyi de açıktır.</span><span class="sxs-lookup"><span data-stu-id="35a65-216">Every isolation level besides <xref:System.Transactions.IsolationLevel.Serializable> is susceptible to inconsistency resulting from other transactions accessing the same information.</span></span> <span data-ttu-id="35a65-217">Farklı yalıtım düzeyleri arasındaki farkı biçiminde okunur ve yazma kilitler kullanılır.</span><span class="sxs-lookup"><span data-stu-id="35a65-217">The difference between the different isolation levels is in the way read and write locks are used.</span></span> <span data-ttu-id="35a65-218">Kilit yalnızca işlem kaynak yöneticisindeki verilere eriştığında veya hareket işlenene veya iptal edilene kadar tutulabilir.</span><span class="sxs-lookup"><span data-stu-id="35a65-218">A lock can be held only when the transaction accesses the data in the resource manager, or it can be held until the transaction is committed or aborted.</span></span> <span data-ttu-id="35a65-219">Eski verimlilik, tutarlılık ikincisi için iyidir.</span><span class="sxs-lookup"><span data-stu-id="35a65-219">The former is better for throughput, the latter for consistency.</span></span> <span data-ttu-id="35a65-220">Kilit iki tür ve işlemleri (okuma/yazma) iki tür dört temel yalıtım düzeyi verin.</span><span class="sxs-lookup"><span data-stu-id="35a65-220">The two kinds of locks and the two kinds of operations (read/write) give four basic isolation levels.</span></span> <span data-ttu-id="35a65-221">Daha fazla bilgi edinmek için bkz. <xref:System.Transactions.IsolationLevel>.</span><span class="sxs-lookup"><span data-stu-id="35a65-221">See <xref:System.Transactions.IsolationLevel> for more information.</span></span>  
  
 <span data-ttu-id="35a65-222">İç içe <xref:System.Transactions.TransactionScope> geçen nesneler kullanılırken, ortam hareketine katılmak istiyorlarsa, iç içe geçen tüm kapsamların tam olarak aynı yalıtım düzeyini kullanacak şekilde yapılandırılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="35a65-222">When using nested <xref:System.Transactions.TransactionScope> objects, all nested scopes must be configured to use exactly the same isolation level if they want to join the ambient transaction.</span></span> <span data-ttu-id="35a65-223">İç içe <xref:System.Transactions.TransactionScope> bir nesne ortam işlemine katılmaya çalışırsa, ancak farklı bir <xref:System.ArgumentException> yalıtım düzeyi belirtirse, bir atılır.</span><span class="sxs-lookup"><span data-stu-id="35a65-223">If a nested <xref:System.Transactions.TransactionScope> object tries to join the ambient transaction yet it specifies a different isolation level, an <xref:System.ArgumentException> is thrown.</span></span>  
  
## <a name="interop-with-com"></a><span data-ttu-id="35a65-224">COM + ile birlikte çalışma</span><span class="sxs-lookup"><span data-stu-id="35a65-224">Interop with COM+</span></span>  
 <span data-ttu-id="35a65-225">Yeni <xref:System.Transactions.TransactionScope> bir örnek oluşturduğunuzda, <xref:System.Transactions.EnterpriseServicesInteropOption> com+ ile nasıl etkileşimde kullanılacağını belirtmek için yapı oluşturuculardan birinde numaralandırmayı kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="35a65-225">When you create a new <xref:System.Transactions.TransactionScope> instance, you can use the <xref:System.Transactions.EnterpriseServicesInteropOption> enumeration in one of the constructors to specify how to interact with COM+.</span></span> <span data-ttu-id="35a65-226">Bu konuda daha fazla bilgi için, [Kurumsal Hizmetler ve COM+ İşlemleriyle Birlikte Çalışabilirlik'e](interoperability-with-enterprise-services-and-com-transactions.md)bakın.</span><span class="sxs-lookup"><span data-stu-id="35a65-226">For more information on this, see [Interoperability with Enterprise Services and COM+ Transactions](interoperability-with-enterprise-services-and-com-transactions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="35a65-227">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="35a65-227">See also</span></span>

- <xref:System.Transactions.Transaction.Clone%2A>
- <xref:System.Transactions.TransactionScope>
