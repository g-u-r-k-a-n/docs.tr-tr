---
title: "C'de asynchronous programlama #"
description: Async, await, Task ve Task kullanarak eşzamanlı programlama için C# dil desteğine genel bakış<T>
ms.date: 03/18/2019
ms.openlocfilehash: 4cbbff0f2c48f0ec2f8befa234ea5023465a1c5d
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/15/2020
ms.locfileid: "79169915"
---
# <a name="asynchronous-programming-with-async-and-await"></a><span data-ttu-id="e5b86-103">Async ve await ile asenkron programlama</span><span class="sxs-lookup"><span data-stu-id="e5b86-103">Asynchronous programming with async and await</span></span>

<span data-ttu-id="e5b86-104">Görev asynchronous programlama modeli (TAP) asynchronous kodu üzerinde bir soyutlama sağlar.</span><span class="sxs-lookup"><span data-stu-id="e5b86-104">The Task asynchronous programming model (TAP) provides an abstraction over asynchronous code.</span></span> <span data-ttu-id="e5b86-105">Her zamanki gibi kod dizilimi olarak yazarsın.</span><span class="sxs-lookup"><span data-stu-id="e5b86-105">You write code as a sequence of statements, just like always.</span></span> <span data-ttu-id="e5b86-106">Bu kodu, her deyim bir sonraki başlamadan önce tamamlanmış gibi okuyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-106">You can read that code as though each statement completes before the next begins.</span></span> <span data-ttu-id="e5b86-107">Derleyici, bu ifadelerden bazıları çalışmaya başlayıp devam eden <xref:System.Threading.Tasks.Task> çalışmayı temsil eden bir dönüşüm döndürebileceğinden bir dizi dönüşüm gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-107">The compiler performs a number of transformations because some of those statements may start work and return a <xref:System.Threading.Tasks.Task> that represents the ongoing work.</span></span>

<span data-ttu-id="e5b86-108">Bu sözdiziminin amacı budur: bir dizi deyim gibi okuyan, ancak dış kaynak tahsisine ve görevler tamamlandığında çok daha karmaşık bir sırada yürüten kodu etkinleştirin.</span><span class="sxs-lookup"><span data-stu-id="e5b86-108">That's the goal of this syntax: enable code that reads like a sequence of statements, but executes in a much more complicated order based on external resource allocation and when tasks complete.</span></span> <span data-ttu-id="e5b86-109">İnsanların eşzamanlı görevleri içeren işlemler için nasıl talimat verdiğine benzer.</span><span class="sxs-lookup"><span data-stu-id="e5b86-109">It's analogous to how people give instructions for processes that include asynchronous tasks.</span></span> <span data-ttu-id="e5b86-110">Bu makale boyunca, bir dizi eşzamanlı yönerge içeren kod hakkında `async` `await` neden oluşturmayı nasıl kolaylaştırdığını görmek için kahvaltı yapmak için bir talimat örneği kullanırsınız.</span><span class="sxs-lookup"><span data-stu-id="e5b86-110">Throughout this article, you'll use an example of instructions for making a breakfast to see how the `async` and `await` keywords make it easier to reason about code that includes a series of asynchronous instructions.</span></span> <span data-ttu-id="e5b86-111">Nasıl bir kahvaltı yapmak açıklamak için aşağıdaki liste gibi talimatlar bir şey yazmak istiyorum:</span><span class="sxs-lookup"><span data-stu-id="e5b86-111">You'd write the instructions something like the following list to explain how to make a breakfast:</span></span>

1. <span data-ttu-id="e5b86-112">Bir fincan kahve dök.</span><span class="sxs-lookup"><span data-stu-id="e5b86-112">Pour a cup of coffee.</span></span>
1. <span data-ttu-id="e5b86-113">Bir tavayı ısıtın, sonra iki yumurta kızartın.</span><span class="sxs-lookup"><span data-stu-id="e5b86-113">Heat up a pan, then fry two eggs.</span></span>
1. <span data-ttu-id="e5b86-114">Üç dilim pastırma kızartın.</span><span class="sxs-lookup"><span data-stu-id="e5b86-114">Fry three slices of bacon.</span></span>
1. <span data-ttu-id="e5b86-115">İki parça ekmeği kızartın.</span><span class="sxs-lookup"><span data-stu-id="e5b86-115">Toast two pieces of bread.</span></span>
1. <span data-ttu-id="e5b86-116">Tost tereyağı ve reçel ekleyin.</span><span class="sxs-lookup"><span data-stu-id="e5b86-116">Add butter and jam to the toast.</span></span>
1. <span data-ttu-id="e5b86-117">Bir bardak portakal suyu dökün.</span><span class="sxs-lookup"><span data-stu-id="e5b86-117">Pour a glass of orange juice.</span></span>

<span data-ttu-id="e5b86-118">Eğer pişirme konusunda deneyime sahipseniz, bu talimatları **eşzamanlı olarak**uygularsınız.</span><span class="sxs-lookup"><span data-stu-id="e5b86-118">If you have experience with cooking, you'd execute those instructions **asynchronously**.</span></span> <span data-ttu-id="e5b86-119">Yumurta için tavayı ısıtmaya başlarsın, sonra da pastırma başlardın.</span><span class="sxs-lookup"><span data-stu-id="e5b86-119">You'd start warming the pan for eggs, then start the bacon.</span></span> <span data-ttu-id="e5b86-120">Ekmeği tost makinesine koyup yumurtaya başla.</span><span class="sxs-lookup"><span data-stu-id="e5b86-120">You'd put the bread in the toaster, then start the eggs.</span></span> <span data-ttu-id="e5b86-121">İşlemin her adımında, bir göreve başlar, sonra dikkatinizi çekmek için hazır olan görevlere dikkatinizi çekersiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-121">At each step of the process, you'd start a task, then turn your attention to tasks that are ready for your attention.</span></span>

<span data-ttu-id="e5b86-122">Yemek kahvaltı paralel olmayan asynchronous iş iyi bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-122">Cooking breakfast is a good example of asynchronous work that isn't parallel.</span></span> <span data-ttu-id="e5b86-123">Bir kişi (veya iş parçacığı) tüm bu görevleri işleyebilir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-123">One person (or thread) can handle all these tasks.</span></span> <span data-ttu-id="e5b86-124">Kahvaltı benzetmesini sürdüren bir kişi, ilk tamamlanmadan bir sonraki göreve başlayarak kahvaltıyı eş senkronize bir şekilde yapabilir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-124">Continuing the breakfast analogy, one person can make breakfast asynchronously by starting the next task before the first completes.</span></span> <span data-ttu-id="e5b86-125">Yemek pişirme, birinin izlemesine bakılmaksızın ilerler.</span><span class="sxs-lookup"><span data-stu-id="e5b86-125">The cooking progresses whether or not someone is watching it.</span></span> <span data-ttu-id="e5b86-126">En kısa sürede yumurta için tava ısınma ya başlar, pastırma kızartma başlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-126">As soon as you start warming the pan for the eggs, you can begin frying the bacon.</span></span> <span data-ttu-id="e5b86-127">Pastırma başladıktan sonra ekmeği tost makinesine koyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-127">Once the bacon starts, you can put the bread into the toaster.</span></span>

<span data-ttu-id="e5b86-128">Paralel bir algoritma için birden çok aşçıya (veya iş parçacığına) ihtiyacınız vardır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-128">For a parallel algorithm, you'd need multiple cooks (or threads).</span></span> <span data-ttu-id="e5b86-129">Biri yumurta, diğeri pastırma, vesaire.</span><span class="sxs-lookup"><span data-stu-id="e5b86-129">One would make the eggs, one the bacon, and so on.</span></span> <span data-ttu-id="e5b86-130">Her biri sadece bir göreve odaklanacak.</span><span class="sxs-lookup"><span data-stu-id="e5b86-130">Each one would be focused on just that one task.</span></span> <span data-ttu-id="e5b86-131">Her aşçı (veya iplik) senkronize pastırma çevirmek için hazır olması için bekleyen bloke olurdu, ya da pop tost.</span><span class="sxs-lookup"><span data-stu-id="e5b86-131">Each cook (or thread) would be blocked synchronously waiting for bacon to be ready to flip, or the toast to pop.</span></span>

<span data-ttu-id="e5b86-132">Şimdi, C# ifadeleri olarak yazılmış aynı talimatları düşünün:</span><span class="sxs-lookup"><span data-stu-id="e5b86-132">Now, consider those same instructions written as C# statements:</span></span>

[!code-csharp[SynchronousBreakfast](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-starter/Program.cs#Main)]

<span data-ttu-id="e5b86-133">Bilgisayarlar bu talimatları insanlar gibi yorumlamaz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-133">Computers don't interpret those instructions the same way people do.</span></span> <span data-ttu-id="e5b86-134">Bilgisayar, bir sonraki deyime geçmeden önce çalışma tamamlanana kadar her ifadeyi engeller.</span><span class="sxs-lookup"><span data-stu-id="e5b86-134">The computer will block on each statement until the work is complete before moving on to the next statement.</span></span> <span data-ttu-id="e5b86-135">Bu tatmin edici olmayan bir kahvaltı yaratır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-135">That creates an unsatisfying breakfast.</span></span> <span data-ttu-id="e5b86-136">Önceki görevler tamamlanana kadar sonraki görevler başlatılmazdı.</span><span class="sxs-lookup"><span data-stu-id="e5b86-136">The later tasks wouldn't be started until the earlier tasks had completed.</span></span> <span data-ttu-id="e5b86-137">Kahvaltıyı hazırlamak çok daha uzun sürerve bazı eşyalar servis edilmeden önce soğurdu.</span><span class="sxs-lookup"><span data-stu-id="e5b86-137">It would take much longer to create the breakfast, and some items would have gotten cold before being served.</span></span>

<span data-ttu-id="e5b86-138">Bilgisayarın yukarıdaki yönergeleri eşit olarak yürütmesini istiyorsanız, eşzamanlı kod yazmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-138">If you want the computer to execute the above instructions asynchronously, you must write asynchronous code.</span></span>

<span data-ttu-id="e5b86-139">Bu endişeler bugün yazdığınız programlar için önemlidir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-139">These concerns are important for the programs you write today.</span></span> <span data-ttu-id="e5b86-140">İstemci programları yazarken, Kullanıcı Arabirimi'nin kullanıcı girişine yanıt vermesini istersiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-140">When you write client programs, you want the UI to be responsive to user input.</span></span> <span data-ttu-id="e5b86-141">Uygulamanız, web'den veri indirirken bir telefonun dondurulmuş görünmesini sağlamalıdır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-141">Your application shouldn't make a phone appear frozen while it's downloading data from the web.</span></span> <span data-ttu-id="e5b86-142">Sunucu programları yazarken, iş parçacıklarının engellenmesini istemezsin.</span><span class="sxs-lookup"><span data-stu-id="e5b86-142">When you write server programs, you don't want threads blocked.</span></span> <span data-ttu-id="e5b86-143">Bu iş parçacıkları diğer isteklere hizmet ediyor olabilir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-143">Those threads could be serving other requests.</span></span> <span data-ttu-id="e5b86-144">Eşzamanlı alternatifler mevcutolduğunda senkron kodu kullanmak, daha az pahalı ölçeklendirme yeteneğinizi zedeler.</span><span class="sxs-lookup"><span data-stu-id="e5b86-144">Using synchronous code when asynchronous alternatives exist hurts your ability to scale out less expensively.</span></span> <span data-ttu-id="e5b86-145">Bu engellenen konuları için ödeme.</span><span class="sxs-lookup"><span data-stu-id="e5b86-145">You pay for those blocked threads.</span></span>

<span data-ttu-id="e5b86-146">Başarılı modern uygulamalar asynchronous kodu gerektirir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-146">Successful modern applications require asynchronous code.</span></span> <span data-ttu-id="e5b86-147">Dil desteği olmadan, eşkron kod yazmak, kodun özgün amacını gizleyen geri aramalar, tamamlama olayları veya başka yollarla gereklidir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-147">Without language support, writing asynchronous code required callbacks, completion events, or other means that obscured the original intent of the code.</span></span> <span data-ttu-id="e5b86-148">Senkron kodun avantajı, kolay anlaşılır olmasıdır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-148">The advantage of the synchronous code is that it's easy to understand.</span></span> <span data-ttu-id="e5b86-149">Adım adım eylemler, tarayıp anlamayı kolaylaştırır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-149">The step-by-step actions make it easy to scan and understand.</span></span> <span data-ttu-id="e5b86-150">Geleneksel eşenkron modeller sizi kodun temel eylemlerine değil, kodun eşzamanlı doğasına odaklanmaya zorlar.</span><span class="sxs-lookup"><span data-stu-id="e5b86-150">Traditional asynchronous models forced you to focus on the asynchronous nature of the code, not on the fundamental actions of the code.</span></span>

## <a name="dont-block-await-instead"></a><span data-ttu-id="e5b86-151">Engellemeyin, onun yerine bekleyin</span><span class="sxs-lookup"><span data-stu-id="e5b86-151">Don't block, await instead</span></span>

<span data-ttu-id="e5b86-152">Önceki kod kötü bir uygulama gösterir: eşzamanlı işlemleri gerçekleştirmek için senkron kod oluşturma.</span><span class="sxs-lookup"><span data-stu-id="e5b86-152">The preceding code demonstrates a bad practice: constructing synchronous code to perform asynchronous operations.</span></span> <span data-ttu-id="e5b86-153">Yazıldığı gibi, bu kod iş parçacığının başka bir iş yapmasını engeller.</span><span class="sxs-lookup"><span data-stu-id="e5b86-153">As written, this code blocks the thread executing it from doing any other work.</span></span> <span data-ttu-id="e5b86-154">Görevlerin hiçbiri devam ederken kesintiye uğramaz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-154">It won't be interrupted while any of the tasks are in progress.</span></span> <span data-ttu-id="e5b86-155">Ekmeği koyduktan sonra tost makinesine bakmış gibi olursun.</span><span class="sxs-lookup"><span data-stu-id="e5b86-155">It would be as though you stared at the toaster after putting the bread in.</span></span> <span data-ttu-id="e5b86-156">Tost patlayana kadar seninle konuşan ları görmezden gelirdin.</span><span class="sxs-lookup"><span data-stu-id="e5b86-156">You'd ignore anyone talking to you until the toast popped.</span></span>

<span data-ttu-id="e5b86-157">İş parçacığının görevler çalışırken engellememesi için bu kodu güncelleyerek başlayalım.</span><span class="sxs-lookup"><span data-stu-id="e5b86-157">Let's start by updating this code so that the thread doesn't block while tasks are running.</span></span> <span data-ttu-id="e5b86-158">Anahtar `await` kelime, bir görevi başlatmak için engellenmeyen bir yol sağlar ve bu görev tamamlandığında yürütmeye devam eder.</span><span class="sxs-lookup"><span data-stu-id="e5b86-158">The `await` keyword provides a non-blocking way to start a task, then continue execution when that task completes.</span></span> <span data-ttu-id="e5b86-159">Bir kahvaltı kodu yapmak basit bir asynchronous sürümü aşağıdaki snippet gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="e5b86-159">A simple asynchronous version of the make a breakfast code would look like the following snippet:</span></span>

[!code-csharp[SimpleAsyncBreakfast](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-V2/Program.cs#Main)]

<span data-ttu-id="e5b86-160">Yumurta lar veya domuz pastırması pişerken bu kod engellenmez.</span><span class="sxs-lookup"><span data-stu-id="e5b86-160">This code doesn't block while the eggs or the bacon are cooking.</span></span> <span data-ttu-id="e5b86-161">Bu kod başka görevleri başlatmaz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-161">This code won't start any other tasks though.</span></span> <span data-ttu-id="e5b86-162">Yine de tost makinesine tost koyar ve patlayana kadar ona bakardın.</span><span class="sxs-lookup"><span data-stu-id="e5b86-162">You'd still put the toast in the toaster and stare at it until it pops.</span></span> <span data-ttu-id="e5b86-163">Ama en azından dikkatini çekmek isteyen herkese cevap verirsin.</span><span class="sxs-lookup"><span data-stu-id="e5b86-163">But at least, you'd respond to anyone that wanted your attention.</span></span> <span data-ttu-id="e5b86-164">Birden fazla sipariş verilen bir restoranda, aşçı ilk yemek yaparken başka bir kahvaltı başlayabilir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-164">In a restaurant where multiple orders are placed, the cook could start another breakfast while the first is cooking.</span></span>

<span data-ttu-id="e5b86-165">Şimdi, henüz bitmemiş herhangi bir başlangıç görevi beklerken kahvaltı üzerinde çalışan konu engellenmez.</span><span class="sxs-lookup"><span data-stu-id="e5b86-165">Now, the thread working on the breakfast isn't blocked while awaiting any started task that hasn't yet finished.</span></span> <span data-ttu-id="e5b86-166">Bazı uygulamalar için bu değişiklik gereken tek şeydir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-166">For some applications, this change is all that's needed.</span></span> <span data-ttu-id="e5b86-167">Bir GUI uygulaması yine de kullanıcıya yalnızca bu değişiklikle yanıt verir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-167">A GUI application still responds to the user with just this change.</span></span> <span data-ttu-id="e5b86-168">Ancak, bu senaryo için daha fazlasını istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-168">However, for this scenario, you want more.</span></span> <span data-ttu-id="e5b86-169">Bileşen görevlerinin her birinin sırayla yürütülmesini istemezsin.</span><span class="sxs-lookup"><span data-stu-id="e5b86-169">You don't want each of the component tasks to be executed sequentially.</span></span> <span data-ttu-id="e5b86-170">Önceki görevin tamamlanmasını beklemeden önce bileşen görevlerinin her birini başlatmak daha iyidir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-170">It's better to start each of the component tasks before awaiting the previous task's completion.</span></span>

## <a name="start-tasks-concurrently"></a><span data-ttu-id="e5b86-171">Görevleri aynı anda başlatma</span><span class="sxs-lookup"><span data-stu-id="e5b86-171">Start tasks concurrently</span></span>

<span data-ttu-id="e5b86-172">Birçok senaryoda, hemen birkaç bağımsız görevi başlatmak istiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-172">In many scenarios, you want to start several independent tasks immediately.</span></span> <span data-ttu-id="e5b86-173">Daha sonra, her görev sona ererken, hazır olan diğer işlere devam edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-173">Then, as each task finishes, you can continue other work that's ready.</span></span> <span data-ttu-id="e5b86-174">Kahvaltı benzetmesinde, kahvaltıyı bu şekilde daha hızlı halledebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-174">In the breakfast analogy, that's how you get breakfast done more quickly.</span></span> <span data-ttu-id="e5b86-175">Ayrıca her şeyi aynı anda yakın yapılır olsun.</span><span class="sxs-lookup"><span data-stu-id="e5b86-175">You also get everything done close to the same time.</span></span> <span data-ttu-id="e5b86-176">Sıcak bir kahvaltı alacaksın.</span><span class="sxs-lookup"><span data-stu-id="e5b86-176">You'll get a hot breakfast.</span></span>

<span data-ttu-id="e5b86-177">Ve <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> ilgili türler, devam etmekte olan görevler hakkında neden olmak için kullanabileceğiniz sınıflardır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-177">The <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> and related types are classes you can use to reason about tasks that are in progress.</span></span> <span data-ttu-id="e5b86-178">Bu, aslında kahvaltı oluşturmak istiyorum şekilde daha yakından benzer kod yazmak için olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="e5b86-178">That enables you to write code that more closely resembles the way you'd actually create breakfast.</span></span> <span data-ttu-id="e5b86-179">Aynı anda yumurta, pastırma ve tost pişirmeye başlardın.</span><span class="sxs-lookup"><span data-stu-id="e5b86-179">You'd start cooking the eggs, bacon, and toast at the same time.</span></span> <span data-ttu-id="e5b86-180">Her biri eylem gerektirdiğinden, dikkatinizi bu göreve yöneltirsiniz, bir sonraki eylemle ilgilenir, sonra da dikkatinizi gerektiren başka bir şeyi beklersiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-180">As each requires action, you'd turn your attention to that task, take care of the next action, then await for something else that requires your attention.</span></span>

<span data-ttu-id="e5b86-181">Bir görevi başlatın ve <xref:System.Threading.Tasks.Task> çalışmayı temsil eden nesneye tutunun.</span><span class="sxs-lookup"><span data-stu-id="e5b86-181">You start a task and hold on to the <xref:System.Threading.Tasks.Task> object that represents the work.</span></span> <span data-ttu-id="e5b86-182">Sonucuyla `await` çalışmadan önce her görev iniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-182">You'll `await` each task before working with its result.</span></span>

<span data-ttu-id="e5b86-183">Kahvaltı kanununda şu değişiklikleri yapalım.</span><span class="sxs-lookup"><span data-stu-id="e5b86-183">Let's make these changes to the breakfast code.</span></span> <span data-ttu-id="e5b86-184">İlk adım, görevleri beklemek yerine, başladıklarında işlemler için depolamaktır:</span><span class="sxs-lookup"><span data-stu-id="e5b86-184">The first step is to store the tasks for operations when they start, rather than awaiting them:</span></span>

```csharp
Coffee cup = PourCoffee();
Console.WriteLine("coffee is ready");
Task<Egg> eggsTask = FryEggs(2);
Egg eggs = await eggsTask;
Console.WriteLine("eggs are ready");
Task<Bacon> baconTask = FryBacon(3);
Bacon bacon = await baconTask;
Console.WriteLine("bacon is ready");
Task<Toast> toastTask = ToastBread(2);
Toast toast = await toastTask;
ApplyButter(toast);
ApplyJam(toast);
Console.WriteLine("toast is ready");
Juice oj = PourOJ();
Console.WriteLine("oj is ready");

Console.WriteLine("Breakfast is ready!");
```

<span data-ttu-id="e5b86-185">Daha sonra, kahvaltı `await` sunmadan önce, yöntemin sonuna pastırma ve yumurta için ifadeler taşıyabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="e5b86-185">Next, you can move the `await` statements for the bacon and eggs to the end of the method, before serving breakfast:</span></span>

```csharp
Coffee cup = PourCoffee();
Console.WriteLine("coffee is ready");
Task<Egg> eggsTask = FryEggs(2);
Task<Bacon> baconTask = FryBacon(3);
Task<Toast> toastTask = ToastBread(2);
Toast toast = await toastTask;
ApplyButter(toast);
ApplyJam(toast);
Console.WriteLine("toast is ready");
Juice oj = PourOJ();
Console.WriteLine("oj is ready");

Egg eggs = await eggsTask;
Console.WriteLine("eggs are ready");
Bacon bacon = await baconTask;
Console.WriteLine("bacon is ready");

Console.WriteLine("Breakfast is ready!");
```

<span data-ttu-id="e5b86-186">Önceki kod daha iyi çalışır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-186">The preceding code works better.</span></span> <span data-ttu-id="e5b86-187">Tüm eşzamanlı görevleri aynı anda başla.</span><span class="sxs-lookup"><span data-stu-id="e5b86-187">You start all the asynchronous tasks at once.</span></span> <span data-ttu-id="e5b86-188">Her görevi yalnızca sonuçlara ihtiyacınız olduğunda beklersiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-188">You await each task only when you need the results.</span></span> <span data-ttu-id="e5b86-189">Önceki kod, farklı mikro hizmetlerden istekte bulunan, ardından sonuçları tek bir sayfada birleştiren bir web uygulamasındaki koda benzer olabilir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-189">The preceding code may be similar to code in a web application that makes requests of different microservices, then combines the results into a single page.</span></span> <span data-ttu-id="e5b86-190">Tüm istekleri hemen yapacaksınız, `await` ardından tüm bu görevler ve web sayfası oluşturacaksınız.</span><span class="sxs-lookup"><span data-stu-id="e5b86-190">You'll make all the requests immediately, then `await` all those tasks and compose the web page.</span></span>

## <a name="composition-with-tasks"></a><span data-ttu-id="e5b86-191">Görevlerle kompozisyon</span><span class="sxs-lookup"><span data-stu-id="e5b86-191">Composition with tasks</span></span>

 <span data-ttu-id="e5b86-192">Tost hariç her şeyi aynı anda kahvaltı için hazır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-192">You have everything ready for breakfast at the same time except the toast.</span></span> <span data-ttu-id="e5b86-193">Tost yapmak bir asynchronous operasyon (ekmek kızartma) ve senkron işlemleri (tereyağı ve reçel ekleyerek) bileşimidir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-193">Making the toast is the composition of an asynchronous operation (toasting the bread), and synchronous operations (adding the butter and the jam).</span></span> <span data-ttu-id="e5b86-194">Bu kodun güncelleştirilmesi önemli bir kavramı göstermektedir:</span><span class="sxs-lookup"><span data-stu-id="e5b86-194">Updating this code illustrates an important concept:</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e5b86-195">Senkron çalışmanın ardından bir eşzamanlı işlemin bileşimi asynchronous işlemidir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-195">The composition of an asynchronous operation followed by synchronous work is an asynchronous operation.</span></span> <span data-ttu-id="e5b86-196">Başka bir şekilde belirtildiği gibi, bir işlemin herhangi bir bölümü asynchronous ise, tüm işlem asynchronous olduğunu.</span><span class="sxs-lookup"><span data-stu-id="e5b86-196">Stated another way, if any portion of an operation is asynchronous, the entire operation is asynchronous.</span></span>

<span data-ttu-id="e5b86-197">Önceki kod, çalışan görevleri tutmak <xref:System.Threading.Tasks.Task> <xref:System.Threading.Tasks.Task%601> için kullanabileceğinizi veya nesneleri gösterebileceğinizi gösterdi.</span><span class="sxs-lookup"><span data-stu-id="e5b86-197">The preceding code showed you that you can use <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> objects to hold running tasks.</span></span> <span data-ttu-id="e5b86-198">`await` Sonucunu kullanmadan önce her görev.</span><span class="sxs-lookup"><span data-stu-id="e5b86-198">You `await` each task before using its result.</span></span> <span data-ttu-id="e5b86-199">Bir sonraki adım, diğer çalışmaların birleşimini temsil eden yöntemler oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-199">The next step is to create methods that represent the combination of other work.</span></span> <span data-ttu-id="e5b86-200">Kahvaltı servis etmeden önce, tereyağı ve reçel eklemeden önce ekmek kızartma temsil eden görevi beklemek istiyorum.</span><span class="sxs-lookup"><span data-stu-id="e5b86-200">Before serving breakfast, you want to await the task that represents toasting the bread before adding butter and jam.</span></span> <span data-ttu-id="e5b86-201">Bu çalışmayı aşağıdaki kodla temsil edebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="e5b86-201">You can represent that work with the following code:</span></span>

[!code-csharp[ComposeToastTask](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-V3/Program.cs#ComposeToastTask)]

<span data-ttu-id="e5b86-202">Önceki yöntemin imzasında `async` değiştirici vardır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-202">The preceding method has the `async` modifier in its signature.</span></span> <span data-ttu-id="e5b86-203">Derleyiciye bu yöntemin bir `await` deyim içerdiğini bildirir; eşzamanlı işlemler içerir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-203">That signals to the compiler that this method contains an `await` statement; it contains asynchronous operations.</span></span> <span data-ttu-id="e5b86-204">Bu yöntem, ekmek tost görevi temsil eder, sonra tereyağı ve reçel ekler.</span><span class="sxs-lookup"><span data-stu-id="e5b86-204">This method represents the task that toasts the bread, then adds butter and jam.</span></span> <span data-ttu-id="e5b86-205">Bu yöntem, <xref:System.Threading.Tasks.Task%601> bu üç işlemin bileşimini temsil eden bir döndürür.</span><span class="sxs-lookup"><span data-stu-id="e5b86-205">This method returns a <xref:System.Threading.Tasks.Task%601> that represents the composition of those three operations.</span></span> <span data-ttu-id="e5b86-206">Ana kod bloğu şimdi olur:</span><span class="sxs-lookup"><span data-stu-id="e5b86-206">The main block of code now becomes:</span></span>

[!code-csharp[StartConcurrentTasks](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-V3/Program.cs#Main)]

<span data-ttu-id="e5b86-207">Önceki değişiklik asynchronous kodu ile çalışmak için önemli bir teknik gösterdi.</span><span class="sxs-lookup"><span data-stu-id="e5b86-207">The previous change illustrated an important technique for working with asynchronous code.</span></span> <span data-ttu-id="e5b86-208">İşlemleri bir görevi döndüren yeni bir yönteme ayırarak görevleri oluşturursunuz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-208">You compose tasks by separating the operations into a new method that returns a task.</span></span> <span data-ttu-id="e5b86-209">Bu görevi ne zaman bekleyeceğinizi seçebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-209">You can choose when to await that task.</span></span> <span data-ttu-id="e5b86-210">Diğer görevleri aynı anda başlatabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-210">You can start other tasks concurrently.</span></span>

## <a name="await-tasks-efficiently"></a><span data-ttu-id="e5b86-211">Görevleri verimli bir şekilde bekleyin</span><span class="sxs-lookup"><span data-stu-id="e5b86-211">Await tasks efficiently</span></span>

<span data-ttu-id="e5b86-212">Önceki kodun sonundaki `await` ifadeler dizisi `Task` sınıfın yöntemleri kullanılarak geliştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-212">The series of `await` statements at the end of the preceding code can be improved by using methods of the `Task` class.</span></span> <span data-ttu-id="e5b86-213">Aşağıdaki kodda gösterildiği <xref:System.Threading.Tasks.Task.WhenAll%2A>gibi, <xref:System.Threading.Tasks.Task> bağımsız değişken listesindeki tüm görevler tamamlandığında tamamlayan apilerden biri olan API'ler:</span><span class="sxs-lookup"><span data-stu-id="e5b86-213">One of those APIs is <xref:System.Threading.Tasks.Task.WhenAll%2A>, which returns a <xref:System.Threading.Tasks.Task> that completes when all the tasks in its argument list have completed, as shown in the following code:</span></span>

```csharp
await Task.WhenAll(eggsTask, baconTask, toastTask);
Console.WriteLine("eggs are ready");
Console.WriteLine("bacon is ready");
Console.WriteLine("toast is ready");
Console.WriteLine("Breakfast is ready!");
```

<span data-ttu-id="e5b86-214">Başka bir seçenek <xref:System.Threading.Tasks.Task.WhenAny%2A>kullanmaktır `Task<Task>` , hangi bir döner bir tamamlar herhangi bir bağımsız değişkenleri tamamlar.</span><span class="sxs-lookup"><span data-stu-id="e5b86-214">Another option is to use <xref:System.Threading.Tasks.Task.WhenAny%2A>, which returns a `Task<Task>` that completes when any of its arguments completes.</span></span> <span data-ttu-id="e5b86-215">İade edilen görevi, zaten tamamlandığını bilerek bekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-215">You can await the returned task, knowing that it has already finished.</span></span> <span data-ttu-id="e5b86-216">Aşağıdaki kod, bitirmek ve <xref:System.Threading.Tasks.Task.WhenAny%2A> sonra sonucunu işlemek için ilk görevi beklemek için nasıl kullanabileceğinizi gösterir.</span><span class="sxs-lookup"><span data-stu-id="e5b86-216">The following code shows how you could use <xref:System.Threading.Tasks.Task.WhenAny%2A> to await the first task to finish and then process its result.</span></span> <span data-ttu-id="e5b86-217">Tamamlanan görevden sonucu işledikten sonra, tamamlanan görevi ' ye `WhenAny`geçirilen görevler listesinden kaldırırsınız.</span><span class="sxs-lookup"><span data-stu-id="e5b86-217">After processing the result from the completed task, you remove that completed task from the list of tasks passed to `WhenAny`.</span></span>

[!code-csharp[AwaitAnyTask](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-final/Program.cs#AwaitAnyTask)]

<span data-ttu-id="e5b86-218">Tüm bu değişikliklerden `Main` sonra, son sürümü aşağıdaki kod gibi görünür:</span><span class="sxs-lookup"><span data-stu-id="e5b86-218">After all those changes, the final version of `Main` looks like the following code:</span></span>

[!code-csharp[Final](~/samples/snippets/csharp/tour-of-async/AsyncBreakfast-final/Program.cs#Main)]

<span data-ttu-id="e5b86-219">Bu son kod asynchronous olduğunu.</span><span class="sxs-lookup"><span data-stu-id="e5b86-219">This final code is asynchronous.</span></span> <span data-ttu-id="e5b86-220">Daha doğru bir kişinin bir kahvaltı pişirmek nasıl yansıtır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-220">It more accurately reflects how a person would cook a breakfast.</span></span> <span data-ttu-id="e5b86-221">Önceki kodu bu makaledeki ilk kod örneğiyle karşılaştırın.</span><span class="sxs-lookup"><span data-stu-id="e5b86-221">Compare the preceding code with the first code sample in this article.</span></span> <span data-ttu-id="e5b86-222">Temel eylemler hala kodu okuma açıktır.</span><span class="sxs-lookup"><span data-stu-id="e5b86-222">The core actions are still clear from reading the code.</span></span> <span data-ttu-id="e5b86-223">Bu kodu, bu makalenin başında kahvaltı yapmak için bu talimatları okuduğunuz gibi okuyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="e5b86-223">You can read this code the same way you'd read those instructions for making a breakfast at the beginning of this article.</span></span> <span data-ttu-id="e5b86-224">Dil özellikleri `async` için `await` her kişi bu yazılı yönergeleri takip etmek için yapar çeviri sağlar: mümkün olduğunca görevleri başlatmak ve görevleri tamamlamak için bekleyen engellemeyin.</span><span class="sxs-lookup"><span data-stu-id="e5b86-224">The language features for `async` and `await` provide the translation every person makes to follow those written instructions: start tasks as you can and don't block waiting for tasks to complete.</span></span>
