---
title: "C 'de zaman uyumsuz programlama #"
description: Async, await, Task ve Task kullanılarak zaman uyumsuz programlama için C# dil desteğine genel bakış<T>
ms.date: 06/04/2020
ms.openlocfilehash: 853019c39880b1f4ef6536aed5841ecab53d7304
ms.sourcegitcommit: b1f4756120deaecb8b554477bb040620f69a4209
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 09/03/2020
ms.locfileid: "89414987"
---
# <a name="asynchronous-programming-with-async-and-await"></a><span data-ttu-id="3a855-103">Async ve await ile asenkron programlama</span><span class="sxs-lookup"><span data-stu-id="3a855-103">Asynchronous programming with async and await</span></span>

<span data-ttu-id="3a855-104">[Görev zaman uyumsuz programlama modeli (TAP)](task-asynchronous-programming-model.md) , zaman uyumsuz kod üzerinde bir soyutlama sağlar.</span><span class="sxs-lookup"><span data-stu-id="3a855-104">The [Task asynchronous programming model (TAP)](task-asynchronous-programming-model.md) provides an abstraction over asynchronous code.</span></span> <span data-ttu-id="3a855-105">Her zaman olduğu gibi, kodu deyimler dizisi olarak yazarsınız.</span><span class="sxs-lookup"><span data-stu-id="3a855-105">You write code as a sequence of statements, just like always.</span></span> <span data-ttu-id="3a855-106">Bu kodu, bir sonraki başlamadan önce her bir deyimin tamamlansa da okuyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-106">You can read that code as though each statement completes before the next begins.</span></span> <span data-ttu-id="3a855-107">Derleyici bir dizi dönüştürme gerçekleştirir, çünkü bu deyimlerden bazıları işe başlayabilir ve <xref:System.Threading.Tasks.Task> devam eden çalışmayı temsil eden bir döndürür.</span><span class="sxs-lookup"><span data-stu-id="3a855-107">The compiler performs a number of transformations because some of those statements may start work and return a <xref:System.Threading.Tasks.Task> that represents the ongoing work.</span></span>

<span data-ttu-id="3a855-108">Bu sözdiziminin amacı: bir deyim dizisi gibi okuyan kodu etkinleştirin, ancak dış kaynak ayırmaya ve görevler tamamlandığında çok daha karmaşık bir sırayla yürütülür.</span><span class="sxs-lookup"><span data-stu-id="3a855-108">That's the goal of this syntax: enable code that reads like a sequence of statements, but executes in a much more complicated order based on external resource allocation and when tasks complete.</span></span> <span data-ttu-id="3a855-109">Kullanıcıların zaman uyumsuz görevler içeren işlemlere yönelik yönergeler verme yöntemi benzerdir.</span><span class="sxs-lookup"><span data-stu-id="3a855-109">It's analogous to how people give instructions for processes that include asynchronous tasks.</span></span> <span data-ttu-id="3a855-110">Bu makalede, `async` ve `await` anahtar kelimelerin, bir dizi zaman uyumsuz yönergeler içeren kod hakkında neden daha kolay olduğunu görmek için bir yönergeler örneği kullanacaksınız.</span><span class="sxs-lookup"><span data-stu-id="3a855-110">Throughout this article, you'll use an example of instructions for making a breakfast to see how the `async` and `await` keywords make it easier to reason about code, that includes a series of asynchronous instructions.</span></span> <span data-ttu-id="3a855-111">Daha hızlı nasıl yapılacağını açıklamak için aşağıdaki listeye benzer yönergeler yazın:</span><span class="sxs-lookup"><span data-stu-id="3a855-111">You'd write the instructions something like the following list to explain how to make a breakfast:</span></span>

1. <span data-ttu-id="3a855-112">Kahve kupa dök.</span><span class="sxs-lookup"><span data-stu-id="3a855-112">Pour a cup of coffee.</span></span>
1. <span data-ttu-id="3a855-113">Bir Pan, sonra da iki Yumura kadar bir kaydır.</span><span class="sxs-lookup"><span data-stu-id="3a855-113">Heat up a pan, then fry two eggs.</span></span>
1. <span data-ttu-id="3a855-114">Bacon üç dilimi.</span><span class="sxs-lookup"><span data-stu-id="3a855-114">Fry three slices of bacon.</span></span>
1. <span data-ttu-id="3a855-115">İki adet içerik.</span><span class="sxs-lookup"><span data-stu-id="3a855-115">Toast two pieces of bread.</span></span>
1. <span data-ttu-id="3a855-116">Bildirim 'e alın ve sıkıştı ekleyin.</span><span class="sxs-lookup"><span data-stu-id="3a855-116">Add butter and jam to the toast.</span></span>
1. <span data-ttu-id="3a855-117">Turuncu bir büyütece bir cam dök.</span><span class="sxs-lookup"><span data-stu-id="3a855-117">Pour a glass of orange juice.</span></span>

<span data-ttu-id="3a855-118">Pişirme deneyiminiz varsa, bu yönergeleri **zaman uyumsuz**olarak yürütebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-118">If you have experience with cooking, you'd execute those instructions **asynchronously**.</span></span> <span data-ttu-id="3a855-119">Yumurlar için kaydırmayı ısıncak ve sonra Bacon 'u başlatacak.</span><span class="sxs-lookup"><span data-stu-id="3a855-119">You'd start warming the pan for eggs, then start the bacon.</span></span> <span data-ttu-id="3a855-120">Ekseyi Toaster ' a yerleştirip yumurtalar ' ı başlatın.</span><span class="sxs-lookup"><span data-stu-id="3a855-120">You'd put the bread in the toaster, then start the eggs.</span></span> <span data-ttu-id="3a855-121">İşlemin her adımında bir görev başlatır, sonra ilgilenmeniz için uygun olan görevlere dikkat etmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="3a855-121">At each step of the process, you'd start a task, then turn your attention to tasks that are ready for your attention.</span></span>

<span data-ttu-id="3a855-122">Pişirme kahileri, paralel olmayan bir zaman uyumsuz çalışmaya yönelik iyi bir örnektir.</span><span class="sxs-lookup"><span data-stu-id="3a855-122">Cooking breakfast is a good example of asynchronous work that isn't parallel.</span></span> <span data-ttu-id="3a855-123">Bir kişi (veya iş parçacığı), tüm bu görevleri işleyebilir.</span><span class="sxs-lookup"><span data-stu-id="3a855-123">One person (or thread) can handle all these tasks.</span></span> <span data-ttu-id="3a855-124">Breakfast benzerleme vurguladı devam ederken bir kişi, ilk tamamlanmadan önce sonraki görevi başlatarak zaman uyumsuz olarak zaman uyumsuz hale getirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-124">Continuing the breakfast analogy, one person can make breakfast asynchronously by starting the next task before the first completes.</span></span> <span data-ttu-id="3a855-125">Pişirme işlemi, birisinin onu izliyor olup olmadığı konusunda ilerler.</span><span class="sxs-lookup"><span data-stu-id="3a855-125">The cooking progresses whether or not someone is watching it.</span></span> <span data-ttu-id="3a855-126">Yumurlar için kaydırma işlemini başlattığınızda, Bacon kızartma başlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-126">As soon as you start warming the pan for the eggs, you can begin frying the bacon.</span></span> <span data-ttu-id="3a855-127">Bacon başladıktan sonra, ekseyi Toaster 'a yerleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-127">Once the bacon starts, you can put the bread into the toaster.</span></span>

<span data-ttu-id="3a855-128">Paralel bir algoritma için birden çok ortak iş (veya iş parçacığı) gerekir.</span><span class="sxs-lookup"><span data-stu-id="3a855-128">For a parallel algorithm, you'd need multiple cooks (or threads).</span></span> <span data-ttu-id="3a855-129">Bunlardan biri, bir, Bacon, vb. olur.</span><span class="sxs-lookup"><span data-stu-id="3a855-129">One would make the eggs, one the bacon, and so on.</span></span> <span data-ttu-id="3a855-130">Her biri yalnızca bir göreve odaklanılmıştır.</span><span class="sxs-lookup"><span data-stu-id="3a855-130">Each one would be focused on just that one task.</span></span> <span data-ttu-id="3a855-131">Her bir Cook (veya iş parçacığı), Bacon 'un çevrilmeye hazırlanması veya bildirim açılanması için zaman uyumlu olarak engelleniyor.</span><span class="sxs-lookup"><span data-stu-id="3a855-131">Each cook (or thread) would be blocked synchronously waiting for bacon to be ready to flip, or the toast to pop.</span></span>

<span data-ttu-id="3a855-132">Şimdi C# deyimleri olarak yazılmış yönergeleri göz önünde bulundurun:</span><span class="sxs-lookup"><span data-stu-id="3a855-132">Now, consider those same instructions written as C# statements:</span></span>

:::code language="csharp" source="snippets/index/AsyncBreakfast-starter/Program.cs" highlight="8-27":::

:::image type="content" source="media/synchronous-breakfast.png" alt-text="zaman uyumlu Breakfast":::

<span data-ttu-id="3a855-134">Zaman uyumlu olarak hazırlanan kahhızlı, toplam her bir görevin toplamı olduğundan, yaklaşık olarak 30 dakika sürer.</span><span class="sxs-lookup"><span data-stu-id="3a855-134">The synchronously prepared breakfast, took roughly 30 minutes because the total is the sum of each individual task.</span></span>

> [!NOTE]
> <span data-ttu-id="3a855-135">`Coffee`,, `Egg` , `Bacon` `Toast` Ve `Juice` sınıfları boş.</span><span class="sxs-lookup"><span data-stu-id="3a855-135">The `Coffee`, `Egg`, `Bacon`, `Toast`, and `Juice` classes are empty.</span></span> <span data-ttu-id="3a855-136">Bunlar yalnızca tanıtım amaçlı sınıflardır, hiçbir özellik içermez ve başka bir amaç sunabilir.</span><span class="sxs-lookup"><span data-stu-id="3a855-136">They are simply marker classes for the purpose of demonstration, contain no properties, and serve no other purpose.</span></span>

<span data-ttu-id="3a855-137">Bilgisayarlar bu yönergeleri insanlar ile aynı şekilde yorumlamaz.</span><span class="sxs-lookup"><span data-stu-id="3a855-137">Computers don't interpret those instructions the same way people do.</span></span> <span data-ttu-id="3a855-138">Bir sonraki ifadeye geçmeden önce, bilgisayar her bir bildirimde, iş tamamlanana kadar engeller.</span><span class="sxs-lookup"><span data-stu-id="3a855-138">The computer will block on each statement until the work is complete before moving on to the next statement.</span></span> <span data-ttu-id="3a855-139">Bu, karşılanunan bir Breakfast oluşturur.</span><span class="sxs-lookup"><span data-stu-id="3a855-139">That creates an unsatisfying breakfast.</span></span> <span data-ttu-id="3a855-140">Daha sonraki görevler, önceki görevler tamamlanana kadar başlatılamaz.</span><span class="sxs-lookup"><span data-stu-id="3a855-140">The later tasks wouldn't be started until the earlier tasks had completed.</span></span> <span data-ttu-id="3a855-141">Daha uzun sürer ve bazı öğeler sunulmadan önce soğuk hale gelir.</span><span class="sxs-lookup"><span data-stu-id="3a855-141">It would take much longer to create the breakfast, and some items would have gotten cold before being served.</span></span>

<span data-ttu-id="3a855-142">Bilgisayarın yukarıdaki yönergeleri zaman uyumsuz olarak yürütmesini istiyorsanız, zaman uyumsuz kod yazmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="3a855-142">If you want the computer to execute the above instructions asynchronously, you must write asynchronous code.</span></span>

<span data-ttu-id="3a855-143">Bu sorunlar, bugün yazdığınız programlar için önemlidir.</span><span class="sxs-lookup"><span data-stu-id="3a855-143">These concerns are important for the programs you write today.</span></span> <span data-ttu-id="3a855-144">İstemci programları yazdığınızda, kullanıcı ARABIRIMININ Kullanıcı girişine yanıt vermesini istersiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-144">When you write client programs, you want the UI to be responsive to user input.</span></span> <span data-ttu-id="3a855-145">Uygulamanız, Web 'den veri indirirken bir telefonu dondurulmuş hale döndürmemelidir.</span><span class="sxs-lookup"><span data-stu-id="3a855-145">Your application shouldn't make a phone appear frozen while it's downloading data from the web.</span></span> <span data-ttu-id="3a855-146">Sunucu programları yazdığınızda, iş parçacıklarının engellenmesini istemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-146">When you write server programs, you don't want threads blocked.</span></span> <span data-ttu-id="3a855-147">Bu iş parçacıkları diğer isteklere hizmet verebilir.</span><span class="sxs-lookup"><span data-stu-id="3a855-147">Those threads could be serving other requests.</span></span> <span data-ttu-id="3a855-148">Zaman uyumsuz alternatifler mevcut olduğunda zaman uyumlu kod kullanarak daha ucuz bir şekilde ölçeklendirme imkanına sahip olabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-148">Using synchronous code when asynchronous alternatives exist hurts your ability to scale out less expensively.</span></span> <span data-ttu-id="3a855-149">Engellenen bu iş parçacıkları için ödeme yaparsınız.</span><span class="sxs-lookup"><span data-stu-id="3a855-149">You pay for those blocked threads.</span></span>

<span data-ttu-id="3a855-150">Başarılı modern uygulamalar zaman uyumsuz kod gerektirir.</span><span class="sxs-lookup"><span data-stu-id="3a855-150">Successful modern applications require asynchronous code.</span></span> <span data-ttu-id="3a855-151">Dil desteği olmadan, zaman uyumsuz kod gerekli geri çağırmaları, tamamlanma olaylarını veya başka bir deyişle, kodun orijinal hedefini görünmez hale gelir.</span><span class="sxs-lookup"><span data-stu-id="3a855-151">Without language support, writing asynchronous code required callbacks, completion events, or other means that obscured the original intent of the code.</span></span> <span data-ttu-id="3a855-152">Zaman uyumlu kodun avantajı, bu işlemin adım adım işlemler tarafından taranması ve anlaşılması kolay hale gelir.</span><span class="sxs-lookup"><span data-stu-id="3a855-152">The advantage of the synchronous code is that it's step-by-step actions make it easy to scan and understand.</span></span> <span data-ttu-id="3a855-153">Geleneksel zaman uyumsuz modeller kodun temel eylemlerine değil, kodun zaman uyumsuz yapısına odaklanmaya zorlanır.</span><span class="sxs-lookup"><span data-stu-id="3a855-153">Traditional asynchronous models forced you to focus on the asynchronous nature of the code, not on the fundamental actions of the code.</span></span>

## <a name="dont-block-await-instead"></a><span data-ttu-id="3a855-154">Engelleme, yerine await</span><span class="sxs-lookup"><span data-stu-id="3a855-154">Don't block, await instead</span></span>

<span data-ttu-id="3a855-155">Yukarıdaki kodda kötü bir uygulama gösterilmektedir: zaman uyumsuz işlemleri gerçekleştirmek için zaman uyumlu kod oluşturma.</span><span class="sxs-lookup"><span data-stu-id="3a855-155">The preceding code demonstrates a bad practice: constructing synchronous code to perform asynchronous operations.</span></span> <span data-ttu-id="3a855-156">Yazıldığı gibi, bu kod başka herhangi bir işi yapmadan yürüten iş parçacığını engeller.</span><span class="sxs-lookup"><span data-stu-id="3a855-156">As written, this code blocks the thread executing it from doing any other work.</span></span> <span data-ttu-id="3a855-157">Görevlerden herhangi biri devam ederken bu işlem kesintiye uğramaz.</span><span class="sxs-lookup"><span data-stu-id="3a855-157">It won't be interrupted while any of the tasks are in progress.</span></span> <span data-ttu-id="3a855-158">Bu, ' ın içine yerleştirdikten sonra Toaster ' ta başmış gibi olacaktır.</span><span class="sxs-lookup"><span data-stu-id="3a855-158">It would be as though you stared at the toaster after putting the bread in.</span></span> <span data-ttu-id="3a855-159">Bildirim alınana kadar sizi konuşuyor olan herkesi yoksayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-159">You'd ignore anyone talking to you until the toast popped.</span></span>

<span data-ttu-id="3a855-160">İş parçacığı, görevler çalışırken engellenmemesi için bu kodu güncelleyerek başlayalım.</span><span class="sxs-lookup"><span data-stu-id="3a855-160">Let's start by updating this code so that the thread doesn't block while tasks are running.</span></span> <span data-ttu-id="3a855-161">`await`Anahtar sözcüğü, bir görevi başlatmak için engellenmeyen bir yöntem sağlar ve ardından bu görev tamamlandığında yürütmeye devam eder.</span><span class="sxs-lookup"><span data-stu-id="3a855-161">The `await` keyword provides a non-blocking way to start a task, then continue execution when that task completes.</span></span> <span data-ttu-id="3a855-162">Bir Breakfast kodu oluştur 'un basit bir zaman uyumsuz sürümü aşağıdaki kod parçacığına benzer:</span><span class="sxs-lookup"><span data-stu-id="3a855-162">A simple asynchronous version of the make a breakfast code would look like the following snippet:</span></span>

:::code language="csharp" source="snippets/index/AsyncBreakfast-V2/Program.cs" id="SnippetMain":::

> [!IMPORTANT]
> <span data-ttu-id="3a855-163">Geçen toplam süre kabaca ilk senkronizasyon sürümü ile aynıdır.</span><span class="sxs-lookup"><span data-stu-id="3a855-163">The total elapsed time is roughly the same as the initial synchonous version.</span></span> <span data-ttu-id="3a855-164">Kod, zaman uyumsuz programlama için bazı temel özelliklerden yararlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="3a855-164">The code has yet to take advantage of some of the key features of asynchronous programming.</span></span>

> [!TIP]
> <span data-ttu-id="3a855-165">, Ve ' nin tüm ve sırasıyla,, ve ' ın bir bütün olarak, ve ' ı `FryEggsAsync` `FryBaconAsync` `ToastBreadAsync` döndürecek şekilde güncelleştirilmiştir `Task<Egg>` `Task<Bacon>` `Task<Toast>` .</span><span class="sxs-lookup"><span data-stu-id="3a855-165">The method bodies of the `FryEggsAsync`, `FryBaconAsync`, and `ToastBreadAsync` have all been updated to return `Task<Egg>`, `Task<Bacon>`, and `Task<Toast>` respectively.</span></span> <span data-ttu-id="3a855-166">Yöntemler özgün sürümlerinden "Async" sonekini içerecek şekilde yeniden adlandırılır.</span><span class="sxs-lookup"><span data-stu-id="3a855-166">The methods are renamed from their original version to include the "Async" suffix.</span></span> <span data-ttu-id="3a855-167">Uygulamaları, bu makalenin ilerleyen bölümlerinde [son sürümün](#final-version) bir parçası olarak gösterilir.</span><span class="sxs-lookup"><span data-stu-id="3a855-167">Their implementations are shown as part of the [final version](#final-version) later in this article.</span></span>

<span data-ttu-id="3a855-168">Bu kod, yumurtalar veya Bacon pişirirken engellenmez.</span><span class="sxs-lookup"><span data-stu-id="3a855-168">This code doesn't block while the eggs or the bacon are cooking.</span></span> <span data-ttu-id="3a855-169">Bu kod, diğer görevleri de başlatmayacaktır.</span><span class="sxs-lookup"><span data-stu-id="3a855-169">This code won't start any other tasks though.</span></span> <span data-ttu-id="3a855-170">Yine de bildirim, siz de bir araya gelene kadar Toaster 'a yerleştirirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-170">You'd still put the toast in the toaster and stare at it until it pops.</span></span> <span data-ttu-id="3a855-171">Ancak en azından, ilgilenmeniz istenen herkese yanıt verirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-171">But at least, you'd respond to anyone that wanted your attention.</span></span> <span data-ttu-id="3a855-172">Birden çok siparişin yerleştirildiği bir restoran içinde, ilk pişirme sırasında Cook bir daha hızlı başlatılabilir.</span><span class="sxs-lookup"><span data-stu-id="3a855-172">In a restaurant where multiple orders are placed, the cook could start another breakfast while the first is cooking.</span></span>

<span data-ttu-id="3a855-173">Şimdi, henüz bitmemiş olan herhangi bir başlatılan görevi beklerken, Kahvalı üzerinde çalışan iş parçacığı engellenmiyor.</span><span class="sxs-lookup"><span data-stu-id="3a855-173">Now, the thread working on the breakfast isn't blocked while awaiting any started task that hasn't yet finished.</span></span> <span data-ttu-id="3a855-174">Bazı uygulamalarda, bu değişiklik gereklidir.</span><span class="sxs-lookup"><span data-stu-id="3a855-174">For some applications, this change is all that's needed.</span></span> <span data-ttu-id="3a855-175">Yalnızca bu değişikliğe sahip bir GUI uygulaması kullanıcıya yanıt veriyor.</span><span class="sxs-lookup"><span data-stu-id="3a855-175">A GUI application still responds to the user with just this change.</span></span> <span data-ttu-id="3a855-176">Ancak, bu senaryo için daha fazla bilgi istersiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-176">However, for this scenario, you want more.</span></span> <span data-ttu-id="3a855-177">Her bileşen görevinin her ardışık olarak yürütülmesini istemezsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-177">You don't want each of the component tasks to be executed sequentially.</span></span> <span data-ttu-id="3a855-178">Önceki görevin tamamlanmasını beklerken önce her bir bileşen görevinin başlatılması daha iyidir.</span><span class="sxs-lookup"><span data-stu-id="3a855-178">It's better to start each of the component tasks before awaiting the previous task's completion.</span></span>

## <a name="start-tasks-concurrently"></a><span data-ttu-id="3a855-179">Görevleri eşzamanlı olarak Başlat</span><span class="sxs-lookup"><span data-stu-id="3a855-179">Start tasks concurrently</span></span>

<span data-ttu-id="3a855-180">Birçok senaryoda, birkaç bağımsız görevi hemen başlatmak istersiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-180">In many scenarios, you want to start several independent tasks immediately.</span></span> <span data-ttu-id="3a855-181">Ardından, her bir görev tamamlandığında, daha önce hazırlanmaya devam edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-181">Then, as each task finishes, you can continue other work that's ready.</span></span> <span data-ttu-id="3a855-182">Kahhızlı benzerleme vurguladı, daha hızlı bir şekilde daha hızlı bir şekilde daha hızlı bir şekilde yapılır.</span><span class="sxs-lookup"><span data-stu-id="3a855-182">In the breakfast analogy, that's how you get breakfast done more quickly.</span></span> <span data-ttu-id="3a855-183">Her şeyin aynı anda kapatılmasını de sağlar.</span><span class="sxs-lookup"><span data-stu-id="3a855-183">You also get everything done close to the same time.</span></span> <span data-ttu-id="3a855-184">Sık erişimli bir kahvaltı alacaksınız.</span><span class="sxs-lookup"><span data-stu-id="3a855-184">You'll get a hot breakfast.</span></span>

<span data-ttu-id="3a855-185"><xref:System.Threading.Tasks.Task?displayProperty=nameWithType>Ve ilgili türler, sürmekte olan görevlerle ilgili nedenlerle kullanabileceğiniz sınıflardır.</span><span class="sxs-lookup"><span data-stu-id="3a855-185">The <xref:System.Threading.Tasks.Task?displayProperty=nameWithType> and related types are classes you can use to reason about tasks that are in progress.</span></span> <span data-ttu-id="3a855-186">Bu sayede, aslında daha iyi bir şekilde daha çok benzeyen bir kod yazmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="3a855-186">That enables you to write code that more closely resembles the way you'd actually create breakfast.</span></span> <span data-ttu-id="3a855-187">Eggs, Bacon ve bildirim ' ı aynı anda aşalım.</span><span class="sxs-lookup"><span data-stu-id="3a855-187">You'd start cooking the eggs, bacon, and toast at the same time.</span></span> <span data-ttu-id="3a855-188">Her biri bir eylem gerektirdiğinden, bu göreve dikkat etmeniz, sonraki eylemi ele almanız ve daha sonra ilgilenmeniz gereken başka bir şey için await ' ı kapatmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="3a855-188">As each requires action, you'd turn your attention to that task, take care of the next action, then await for something else that requires your attention.</span></span>

<span data-ttu-id="3a855-189">Bir görevi başlatır ve <xref:System.Threading.Tasks.Task> işi temsil eden nesneyi basılı tutabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-189">You start a task and hold on to the <xref:System.Threading.Tasks.Task> object that represents the work.</span></span> <span data-ttu-id="3a855-190">`await`Sonucuyla çalışmadan önce her görevi gerçekleştirirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-190">You'll `await` each task before working with its result.</span></span>

<span data-ttu-id="3a855-191">Bu değişiklikleri Breakfast kodunda yapalim.</span><span class="sxs-lookup"><span data-stu-id="3a855-191">Let's make these changes to the breakfast code.</span></span> <span data-ttu-id="3a855-192">İlk adım, işlemler için görevleri her zaman beklerken depolamak yerine depolarlar:</span><span class="sxs-lookup"><span data-stu-id="3a855-192">The first step is to store the tasks for operations when they start, rather than awaiting them:</span></span>

```csharp
Coffee cup = PourCoffee();
Console.WriteLine("coffee is ready");

Task<Egg> eggsTask = FryEggsAsync(2);
Egg eggs = await eggsTask;
Console.WriteLine("eggs are ready");

Task<Bacon> baconTask = FryBaconAsync(3);
Bacon bacon = await baconTask;
Console.WriteLine("bacon is ready");

Task<Toast> toastTask = ToastBreadAsync(2);
Toast toast = await toastTask;
ApplyButter(toast);
ApplyJam(toast);
Console.WriteLine("toast is ready");

Juice oj = PourOJ();
Console.WriteLine("oj is ready");
Console.WriteLine("Breakfast is ready!");
```

<span data-ttu-id="3a855-193">Daha sonra, bir sonraki `await` ve yumurg deyimlerini, Breakfast sunmadan önce yönteminin sonuna taşıyabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="3a855-193">Next, you can move the `await` statements for the bacon and eggs to the end of the method, before serving breakfast:</span></span>

```csharp
Coffee cup = PourCoffee();
Console.WriteLine("coffee is ready");

Task<Egg> eggsTask = FryEggsAsync(2);
Task<Bacon> baconTask = FryBaconAsync(3);
Task<Toast> toastTask = ToastBreadAsync(2);

Toast toast = await toastTask;
ApplyButter(toast);
ApplyJam(toast);
Console.WriteLine("toast is ready");
Juice oj = PourOJ();
Console.WriteLine("oj is ready");

Egg eggs = await eggsTask;
Console.WriteLine("eggs are ready");
Bacon bacon = await baconTask;
Console.WriteLine("bacon is ready");

Console.WriteLine("Breakfast is ready!");
```

:::image type="content" source="media/asynchronous-breakfast.png" alt-text="zaman uyumsuz Breakfast":::

<span data-ttu-id="3a855-195">Zaman uyumsuz hazırlanmış Breakfast yaklaşık 20 dakika sürdü, bunun nedeni bazı görevlerin eşzamanlı olarak çalıştırılabilmesidir.</span><span class="sxs-lookup"><span data-stu-id="3a855-195">The asynchronously prepared breakfast took roughly 20 minutes, this is because some tasks were able to run concurrently.</span></span>

<span data-ttu-id="3a855-196">Yukarıdaki kod daha iyi çalışmaktadır.</span><span class="sxs-lookup"><span data-stu-id="3a855-196">The preceding code works better.</span></span> <span data-ttu-id="3a855-197">Tüm zaman uyumsuz görevleri aynı anda başlatabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-197">You start all the asynchronous tasks at once.</span></span> <span data-ttu-id="3a855-198">Her bir görevi yalnızca sonuçlara ihtiyacınız olduğunda bekleolursunuz.</span><span class="sxs-lookup"><span data-stu-id="3a855-198">You await each task only when you need the results.</span></span> <span data-ttu-id="3a855-199">Yukarıdaki kod, farklı mikro hizmetlere istek yapan bir Web uygulamasındaki koda benzer ve sonuçları tek bir sayfada birleştirir.</span><span class="sxs-lookup"><span data-stu-id="3a855-199">The preceding code may be similar to code in a web application that makes requests of different microservices, then combines the results into a single page.</span></span> <span data-ttu-id="3a855-200">Tüm istekleri hemen, ardından `await` Tüm bu görevleri ve Web sayfasını oluşturduğunuz şekilde yaparsınız.</span><span class="sxs-lookup"><span data-stu-id="3a855-200">You'll make all the requests immediately, then `await` all those tasks and compose the web page.</span></span>

## <a name="composition-with-tasks"></a><span data-ttu-id="3a855-201">Görevlerle oluşturma</span><span class="sxs-lookup"><span data-stu-id="3a855-201">Composition with tasks</span></span>

 <span data-ttu-id="3a855-202">Bildirim hariç her şeyi aynı anda kah, daha hızlı bir şekilde hazırlayın.</span><span class="sxs-lookup"><span data-stu-id="3a855-202">You have everything ready for breakfast at the same time except the toast.</span></span> <span data-ttu-id="3a855-203">Bildirim, zaman uyumsuz bir işlemin (Ekleyici) ve zaman uyumlu işlemlerin (alın ve sıkışan) bir bileşim haline getirilmesi.</span><span class="sxs-lookup"><span data-stu-id="3a855-203">Making the toast is the composition of an asynchronous operation (toasting the bread), and synchronous operations (adding the butter and the jam).</span></span> <span data-ttu-id="3a855-204">Bu kodun güncelleştirilmesi önemli bir kavramı gösterir:</span><span class="sxs-lookup"><span data-stu-id="3a855-204">Updating this code illustrates an important concept:</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3a855-205">Zaman uyumsuz bir işlemin ardından zaman uyumlu iş tarafından oluşturulması zaman uyumsuz bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="3a855-205">The composition of an asynchronous operation followed by synchronous work is an asynchronous operation.</span></span> <span data-ttu-id="3a855-206">Başka bir şekilde ifade edilen bir işlemin herhangi bir bölümü zaman uyumsuz ise, tüm işlem zaman uyumsuzdur.</span><span class="sxs-lookup"><span data-stu-id="3a855-206">Stated another way, if any portion of an operation is asynchronous, the entire operation is asynchronous.</span></span>

<span data-ttu-id="3a855-207">Yukarıdaki kod, <xref:System.Threading.Tasks.Task> <xref:System.Threading.Tasks.Task%601> çalışan görevleri tutmak için veya nesneleri kullanacağınızı gösterdi.</span><span class="sxs-lookup"><span data-stu-id="3a855-207">The preceding code showed you that you can use <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> objects to hold running tasks.</span></span> <span data-ttu-id="3a855-208">`await`Sonucunu kullanmadan önce her görevi gerçekleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-208">You `await` each task before using its result.</span></span> <span data-ttu-id="3a855-209">Sonraki adım, diğer çalışmanın birleşimini temsil eden yöntemler oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="3a855-209">The next step is to create methods that represent the combination of other work.</span></span> <span data-ttu-id="3a855-210">Kahvileri sunmadan önce, Butter ve sıkışmadan önce Ekleyici 'yi temsil eden görevi beklemek istersiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-210">Before serving breakfast, you want to await the task that represents toasting the bread before adding butter and jam.</span></span> <span data-ttu-id="3a855-211">Bu işi aşağıdaki kodla temsil edebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="3a855-211">You can represent that work with the following code:</span></span>

:::code language="csharp" source="snippets/index/AsyncBreakfast-V3/Program.cs" id="SnippetComposeToastTask":::

<span data-ttu-id="3a855-212">Önceki Yöntem `async` imzasında değiştiriciye sahiptir.</span><span class="sxs-lookup"><span data-stu-id="3a855-212">The preceding method has the `async` modifier in its signature.</span></span> <span data-ttu-id="3a855-213">Bu yöntemin bir ifade içerdiğini derleyiciye bildirir `await` ; zaman uyumsuz işlemler içerir.</span><span class="sxs-lookup"><span data-stu-id="3a855-213">That signals to the compiler that this method contains an `await` statement; it contains asynchronous operations.</span></span> <span data-ttu-id="3a855-214">Bu yöntem, Ekleyici ve sıkışıklığı ekleyen görevi temsil eder.</span><span class="sxs-lookup"><span data-stu-id="3a855-214">This method represents the task that toasts the bread, then adds butter and jam.</span></span> <span data-ttu-id="3a855-215">Bu yöntem, bu <xref:System.Threading.Tasks.Task%601> üç işlemin oluşumunu temsil eden bir döndürür.</span><span class="sxs-lookup"><span data-stu-id="3a855-215">This method returns a <xref:System.Threading.Tasks.Task%601> that represents the composition of those three operations.</span></span> <span data-ttu-id="3a855-216">Kodun ana bloğu şu şekilde olur:</span><span class="sxs-lookup"><span data-stu-id="3a855-216">The main block of code now becomes:</span></span>

:::code language="csharp" source="snippets/index/AsyncBreakfast-V3/Program.cs" id="SnippetMain":::

<span data-ttu-id="3a855-217">Önceki değişiklik, zaman uyumsuz kod ile çalışmak için önemli bir teknik gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="3a855-217">The previous change illustrated an important technique for working with asynchronous code.</span></span> <span data-ttu-id="3a855-218">İşlemleri bir görevi döndüren yeni bir yönteme ayırarak görevleri oluşturursunuz.</span><span class="sxs-lookup"><span data-stu-id="3a855-218">You compose tasks by separating the operations into a new method that returns a task.</span></span> <span data-ttu-id="3a855-219">Bu görevin ne zaman bekleme seçeneğini belirleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-219">You can choose when to await that task.</span></span> <span data-ttu-id="3a855-220">Diğer görevleri eşzamanlı olarak başlatabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-220">You can start other tasks concurrently.</span></span>

## <a name="await-tasks-efficiently"></a><span data-ttu-id="3a855-221">Görevleri verimli olarak await</span><span class="sxs-lookup"><span data-stu-id="3a855-221">Await tasks efficiently</span></span>

<span data-ttu-id="3a855-222">`await`Önceki kodun sonundaki deyim dizileri, sınıfının yöntemleri kullanılarak artırılabilir `Task` .</span><span class="sxs-lookup"><span data-stu-id="3a855-222">The series of `await` statements at the end of the preceding code can be improved by using methods of the `Task` class.</span></span> <span data-ttu-id="3a855-223">Bu API 'lerden biri, <xref:System.Threading.Tasks.Task.WhenAll%2A> <xref:System.Threading.Tasks.Task> aşağıdaki kodda gösterildiği gibi, bağımsız değişken listesindeki tüm görevler tamamlandığında tamamlanan bir döndürür.</span><span class="sxs-lookup"><span data-stu-id="3a855-223">One of those APIs is <xref:System.Threading.Tasks.Task.WhenAll%2A>, which returns a <xref:System.Threading.Tasks.Task> that completes when all the tasks in its argument list have completed, as shown in the following code:</span></span>

```csharp
await Task.WhenAll(eggsTask, baconTask, toastTask);
Console.WriteLine("eggs are ready");
Console.WriteLine("bacon is ready");
Console.WriteLine("toast is ready");
Console.WriteLine("Breakfast is ready!");
```

<span data-ttu-id="3a855-224">Diğer bir seçenek de <xref:System.Threading.Tasks.Task.WhenAny%2A> , `Task<Task>` bağımsız değişkenlerinden herhangi biri tamamlandığında tamamlanan bir döndürür.</span><span class="sxs-lookup"><span data-stu-id="3a855-224">Another option is to use <xref:System.Threading.Tasks.Task.WhenAny%2A>, which returns a `Task<Task>` that completes when any of its arguments completes.</span></span> <span data-ttu-id="3a855-225">Döndürülen görevi, zaten bitdiğinin farkında olacak şekilde beklede olursunuz.</span><span class="sxs-lookup"><span data-stu-id="3a855-225">You can await the returned task, knowing that it has already finished.</span></span> <span data-ttu-id="3a855-226">Aşağıdaki kod, <xref:System.Threading.Tasks.Task.WhenAny%2A> ilk görevin bitmesini beklemek için nasıl kullanabileceğinizi gösterir ve sonra sonucunu işleyebilir.</span><span class="sxs-lookup"><span data-stu-id="3a855-226">The following code shows how you could use <xref:System.Threading.Tasks.Task.WhenAny%2A> to await the first task to finish and then process its result.</span></span> <span data-ttu-id="3a855-227">Tamamlanan görevden elde edilen sonucu işledikten sonra, bu tamamlanmış görevi öğesine geçirilen görev listesinden kaldırırsınız `WhenAny` .</span><span class="sxs-lookup"><span data-stu-id="3a855-227">After processing the result from the completed task, you remove that completed task from the list of tasks passed to `WhenAny`.</span></span>

```csharp
var breakfastTasks = new List<Task> { eggsTask, baconTask, toastTask };
while (breakfastTasks.Count > 0)
{
    Task finishedTask = await Task.WhenAny(breakfastTasks);
    if (finishedTask == eggsTask)
    {
        Console.WriteLine("eggs are ready");
    }
    else if (finishedTask == baconTask)
    {
        Console.WriteLine("bacon is ready");
    }
    else if (finishedTask == toastTask)
    {
        Console.WriteLine("toast is ready");
    }
    breakfastTasks.Remove(finishedTask);
}
```

<span data-ttu-id="3a855-228">Tüm bu değişiklikler yapıldıktan sonra, kodun son sürümü şöyle görünür: <a id="final-version"></a></span><span class="sxs-lookup"><span data-stu-id="3a855-228">After all those changes, the final version of the code looks like this: <a id="final-version"></a></span></span>
:::code language="csharp" source="snippets/index/AsyncBreakfast-final/Program.cs" highlight="9-40":::

:::image type="content" source="media/whenany-async-breakfast.png" alt-text="herhangi bir zaman uyumsuz Breakfast":::

<span data-ttu-id="3a855-230">Zaman uyumsuz hazırlanmış Breakfast 'in son sürümü yaklaşık 15 dakika sürdü, bunun nedeni bazı görevlerin eşzamanlı olarak çalıştırılabilmesi ve kodun aynı anda birden çok görevi izleyebilmesi ve yalnızca gerektiğinde işlem yapması olabilir.</span><span class="sxs-lookup"><span data-stu-id="3a855-230">The final version of the asynchronously prepared breakfast took roughly 15 minutes, this is because some tasks were able to run concurrently, and the code was able to monitor multiple tasks at once and only take action when it was needed.</span></span>

<span data-ttu-id="3a855-231">Bu son kod zaman uyumsuzdur.</span><span class="sxs-lookup"><span data-stu-id="3a855-231">This final code is asynchronous.</span></span> <span data-ttu-id="3a855-232">Bu, bir kişinin ne kadar hızlı bir şekilde bir kahtacağını daha doğru yansıtır.</span><span class="sxs-lookup"><span data-stu-id="3a855-232">It more accurately reflects how a person would cook a breakfast.</span></span> <span data-ttu-id="3a855-233">Yukarıdaki kodu, bu makaledeki ilk kod örneğiyle karşılaştırın.</span><span class="sxs-lookup"><span data-stu-id="3a855-233">Compare the preceding code with the first code sample in this article.</span></span> <span data-ttu-id="3a855-234">Temel eylemler, kodu okumayı hala temizler.</span><span class="sxs-lookup"><span data-stu-id="3a855-234">The core actions are still clear from reading the code.</span></span> <span data-ttu-id="3a855-235">Bu kodu, bu makalenin başlangıcında bir daha hızlı hale getirmek için bu talimatları okuduğunuzdan aynı şekilde okuyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="3a855-235">You can read this code the same way you'd read those instructions for making a breakfast at the beginning of this article.</span></span> <span data-ttu-id="3a855-236">İçin dil özellikleri `async` ve `await` çeviri, her birinin bu yazılı yönergeleri izlemesini sağlar: Başlangıç görevleri, yaptığınız gibi başlatın ve görevlerin tamamlanmasını beklemeyi engellemez.</span><span class="sxs-lookup"><span data-stu-id="3a855-236">The language features for `async` and `await` provide the translation every person makes to follow those written instructions: start tasks as you can and don't block waiting for tasks to complete.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3a855-237">Sonraki adımlar</span><span class="sxs-lookup"><span data-stu-id="3a855-237">Next steps</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="3a855-238">Görev zaman uyumsuz programlama modeli hakkında bilgi edinin</span><span class="sxs-lookup"><span data-stu-id="3a855-238">Learn about the task asynchronous programming model</span></span>](task-asynchronous-programming-model.md)
