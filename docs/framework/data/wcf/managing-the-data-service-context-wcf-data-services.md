---
title: Veri hizmeti bağlamını yönetme (WCF Veri Hizmetleri)
ms.date: 03/30/2017
ms.assetid: 15b19d09-7de7-4638-9556-6ef396cc45ec
ms.openlocfilehash: e67f7280bc85c7577f960707659890f59470e535
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 09/24/2020
ms.locfileid: "91194303"
---
# <a name="managing-the-data-service-context-wcf-data-services"></a>Veri hizmeti bağlamını yönetme (WCF Veri Hizmetleri)

<xref:System.Data.Services.Client.DataServiceContext>Sınıfı, belirtilen bir veri hizmetine göre desteklenen işlemleri kapsüller. OData Hizmetleri durum bilgisiz olmasına karşın bağlam değildir. Bu nedenle, <xref:System.Data.Services.Client.DataServiceContext> değişiklik yönetimi gibi özellikleri desteklemek için veri hizmeti ile etkileşimler arasında istemcideki durumu korumak için sınıfını kullanabilirsiniz. Bu sınıf Ayrıca kimlikleri yönetir ve değişiklikleri izler.  
  
## <a name="merge-options-and-identity-resolution"></a>Birleştirme seçenekleri ve kimlik çözümlemesi  

 Bir <xref:System.Data.Services.Client.DataServiceQuery%601> yürütüldüğünde, yanıt akışındaki varlıklar nesnelere uygulanır. Daha fazla bilgi için bkz. [nesne materialization](object-materialization-wcf-data-services.md). Yanıt iletisindeki girdilerin nesnelere nasıl gerçekleştirildiği, kimlik çözümlemesine göre yapılır ve sorgu yürütüldüğü birleştirme seçeneğine bağlıdır. Tek bir kapsamda birden çok sorgu veya yük isteği yürütüldüğünde <xref:System.Data.Services.Client.DataServiceContext> , WCF veri Hizmetleri istemci yalnızca belirli bir anahtar değeri olan bir nesnenin tek bir örneğini izler. Kimlik çözümlemesi yapmak için kullanılan bu anahtar, benzersiz olarak bir varlığı tanımlar.  
  
 Varsayılan olarak, istemci, yanıt akışındaki bir girişi yalnızca tarafından izlenmekte olan varlıklar için bir nesneye çıkarır <xref:System.Data.Services.Client.DataServiceContext> . Bu, önbellekte bulunan nesnelerdeki değişikliklerin üzerine yazılmayacağı anlamına gelir. Bu davranış <xref:System.Data.Services.Client.MergeOption> sorgular ve yükleme işlemleri için bir değer belirtilerek denetlenir. Bu seçenek <xref:System.Data.Services.Client.DataServiceContext.MergeOption%2A> , üzerinde özelliği ayarlanarak belirtilir <xref:System.Data.Services.Client.DataServiceContext> . Varsayılan birleştirme seçeneği değeri <xref:System.Data.Services.Client.MergeOption.AppendOnly> . Bu, yalnızca izlenmekte olmayan varlıklar için nesneleri çıkarır, bu da mevcut nesnelerin üzerine yazılmayacağı anlamına gelir. İstemci üzerindeki nesnelerdeki değişikliklerin, veri hizmetindeki güncelleştirmeler tarafından üzerine yazılmasını önlemenin bir başka yolu da belirtmektir <xref:System.Data.Services.Client.MergeOption.PreserveChanges> . Belirttiğinizde <xref:System.Data.Services.Client.MergeOption.OverwriteChanges> , istemci üzerindeki nesne değerleri, bu nesnelerde değişiklik yapılmış olsa bile yanıt akışındaki girişlerden en son değerlerle değiştirilir. <xref:System.Data.Services.Client.MergeOption.NoTracking>Birleştirme seçeneği kullanıldığında, <xref:System.Data.Services.Client.DataServiceContext> istemci nesnelerinde yapılan değişiklikleri veri hizmetine gönderemez. Bu seçenekle, değişikliklerin her zaman veri hizmetindeki değerlerle üzerine yazılır.  
  
## <a name="managing-concurrency"></a>Eşzamanlılığı Yönetme  

 OData, veri hizmetinin güncelleştirme çakışmalarını algılamasını sağlayan iyimser eşzamanlılığı destekler. Veri hizmeti sağlayıcısı, veri hizmetinin bir eşzamanlılık belirteci kullanarak varlıklara yapılan değişiklikleri denetlemesi için bu şekilde yapılandırılabilir. Bu belirteç, bir kaynağın değişip değişmediğini anlamak üzere veri hizmeti tarafından doğrulanan bir varlık türünün bir veya daha fazla özelliğini içerir. Veri hizmetine gönderilen isteklerin eTag üstbilgisine dahil edilen eşzamanlılık belirteçleri, WCF Veri Hizmetleri istemcisi tarafından sizin için yönetilir. Daha fazla bilgi için bkz. [veri hizmetini güncelleştirme](updating-the-data-service-wcf-data-services.md).  
  
 ,,, <xref:System.Data.Services.Client.DataServiceContext> Veya kullanılarak el ile bildirilen nesnelerde yapılan değişiklikleri izler <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> <xref:System.Data.Services.Client.DataServiceCollection%601> . <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>Yöntemi çağrıldığında, istemci değişiklikleri veri hizmetine geri gönderir. <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> istemcideki veri değişiklikleri veri hizmetindeki değişikliklerle çakışıyorsa başarısız olabilir. Bu gerçekleştiğinde, güncelleştirme verilerini almak için varlık kaynağını yeniden sorgumalısınız. Veri hizmetindeki değişikliklerin üzerine yazmak için, birleştirme seçeneğini kullanarak sorguyu yürütün <xref:System.Data.Services.Client.MergeOption.PreserveChanges> . <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>Yeniden çağırdığınızda, istemci üzerinde korunan değişiklikler, veri hizmetindeki kaynakta daha fazla değişiklik yapılmadığından, veri hizmetine kalıcı hale getirilir.  
  
## <a name="saving-changes"></a>Değişiklikler kaydediliyor  

 Değişiklikler örnekte izlenir, <xref:System.Data.Services.Client.DataServiceContext> ancak anında sunucuya gönderilmez. Belirtilen bir etkinlik için gerekli değişikliklerle işiniz bittiğinde, <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> tüm değişiklikleri veri hizmetine göndermek için çağırın. <xref:System.Data.Services.Client.DataServiceResponse>İşlem tamamlandıktan sonra bir nesne döndürülür <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> . <xref:System.Data.Services.Client.DataServiceResponse>Nesnesi, <xref:System.Data.Services.Client.OperationResponse> <xref:System.Data.Services.Client.EntityDescriptor> <xref:System.Data.Services.Client.LinkDescriptor> kalıcı veya denenen değişiklikleri temsil eden bir dizi veya örnek içeren bir nesne dizisi içerir. Veri hizmetinde bir varlık oluşturulduğunda veya değiştirildiğinde, <xref:System.Data.Services.Client.EntityDescriptor> önceki örnekteki oluşturulan değer gibi sunucu tarafından oluşturulan özellik değerleri de dahil olmak üzere, güncelleştirilmiş varlığa yönelik bir başvuru içerir `ProductID` . İstemci kitaplığı, .NET Framework nesnesini bu yeni değerlere sahip olacak şekilde otomatik olarak güncelleştirir.  
  
 Başarılı ekleme ve güncelleştirme işlemleri için, <xref:System.Data.Services.Client.EntityDescriptor> işlemle ilişkili veya nesnesinin State özelliği <xref:System.Data.Services.Client.LinkDescriptor> olarak ayarlanır <xref:System.Data.Services.Client.EntityStates.Unchanged> ve yeni değerler kullanılarak birleştirilir <xref:System.Data.Services.Client.MergeOption.OverwriteChanges> . Veri hizmetinde bir INSERT, Update veya delete işlemi başarısız olduğunda, varlık durumu çağrıldıktan önceki gibi kalır <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> ve <xref:System.Data.Services.Client.OperationResponse.Error%2A> öğesinin özelliği, <xref:System.Data.Services.Client.OperationResponse> <xref:System.Data.Services.Client.DataServiceRequestException> hata hakkında bilgi içeren bir öğesine ayarlanır. Daha fazla bilgi için bkz. [veri hizmetini güncelleştirme](updating-the-data-service-wcf-data-services.md).  
  
### <a name="setting-the-http-method-for-updates"></a>Güncelleştirmeler için HTTP yöntemini ayarlama  

 Varsayılan olarak, .NET Framework istemci kitaplığı, güncelleştirmeleri varolan varlıklara BIRLEŞTIRME istekleri olarak gönderir. BIRLEŞTIRME isteği varlığın seçili özelliklerini güncelleştirir; ancak istemci her zaman BIRLEŞTIRME isteğindeki tüm özellikleri, hatta değişmemiş özellikleri içerir. OData protokolü Ayrıca, varlıkları güncelleştirmek için PUT istekleri göndermeyi destekler. Bir PUT isteğinde, mevcut bir varlık temelde, istemcinin özellik değerleriyle birlikte varlığın yeni bir örneğiyle değiştirilmiştir. PUT isteklerini kullanmak için, <xref:System.Data.Services.Client.SaveChangesOptions.ReplaceOnUpdate> <xref:System.Data.Services.Client.SaveChangesOptions> çağrılırken Numaralandırmadaki bayrağı ayarlayın <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> .  
  
> [!NOTE]
> Bir PUT isteği, istemci varlığın tüm özellikleri hakkında bilgi sahibi olmadığında BIRLEŞTIRME isteğinden farklı davranabilecektir. Bu durum, bir varlık türünü istemcideki yeni bir türe yansıtılabilen ortaya çıkabilir. Ayrıca hizmet veri modelindeki varlığa yeni özellikler eklendiğinde ve <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> üzerindeki özelliği <xref:System.Data.Services.Client.DataServiceContext> `true` Bu tür istemci eşleme hatalarını yoksayacak şekilde ayarlandığında da gerçekleşebilir. Bu durumlarda, bir PUT isteği, istemci için bilinmeyen tüm özellikleri varsayılan değerlerine sıfırlayacaktır.  
  
### <a name="post-tunneling"></a>Tünel SONRASı  

 Varsayılan olarak, istemci kitaplığı POST, GET, PUT/MERGE/PATCH ve DELETE için karşılık gelen HTTP yöntemlerini kullanarak bir OData hizmetine oluşturma, okuma, güncelleştirme ve silme istekleri gönderir. Bu, temsili durum aktarımının (REST) temel ilkelerini barındırır. Ancak, her Web sunucusu uygulamasında HTTP yöntemlerinin tam kümesini desteklememektedir. Bazı durumlarda, desteklenen yöntemler yalnızca GET ve POST ile sınırlandırılmış olabilir. Bu, bir güvenlik duvarı gibi bir aracı belirli yöntemlerle istekleri engellediğinde meydana gelebilir. GET ve POST yöntemleri en sık desteklendiğinden, OData bir POST isteği kullanarak desteklenmeyen HTTP yöntemlerini yürütmek için bir yol önerir. *Yöntem tünel oluşturma* veya *gönderi tüneli*olarak bilinen bu, istemcinin özel üstbilgide BELIRTILEN gerçek yöntemle bir post isteği göndermesini sağlar `X-HTTP-Method` . İstekler için GÖNDERI tünelini etkinleştirmek üzere <xref:System.Data.Services.Client.DataServiceContext.UsePostTunneling%2A> <xref:System.Data.Services.Client.DataServiceContext> örnekteki özelliğini olarak ayarlayın `true` .  
  
## <a name="see-also"></a>Ayrıca bkz.

- [WCF Veri Hizmetleri İstemci Kitaplığı](wcf-data-services-client-library.md)
- [Veri Hizmetini Güncelleştirme](updating-the-data-service-wcf-data-services.md)
- [Zaman Uyumsuz İşlemler](asynchronous-operations-wcf-data-services.md)
- [Toplu İşlemler](batching-operations-wcf-data-services.md)
