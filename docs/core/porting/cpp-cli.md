---
title: C++/CLı projelerini .NET Core 'a geçirme
description: C++/CLı projelerini .NET Core 'a taşıma hakkında bilgi edinin.
author: mjrousos
ms.date: 01/10/2020
ms.openlocfilehash: 1194e1ce03e5b86052d7e2584aa5c15acd01874b
ms.sourcegitcommit: c7f0beaa2bd66ebca86362ca17d673f7e8256ca6
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/23/2021
ms.locfileid: "104873698"
---
# <a name="how-to-port-a-ccli-project-to-net-core"></a><span data-ttu-id="8ba1d-103">C++/CLı projesinde .NET Core 'a bağlantı noktası oluşturma</span><span class="sxs-lookup"><span data-stu-id="8ba1d-103">How to port a C++/CLI project to .NET Core</span></span>

<span data-ttu-id="8ba1d-104">.NET Core 3,1 ve Visual Studio 2019 sürüm 16,4 ile başlayarak, [C++/CLI projeleri](/cpp/dotnet/dotnet-programming-with-cpp-cli-visual-cpp) .NET Core 'u hedefleyebilir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-104">Beginning with .NET Core 3.1 and Visual Studio 2019 version 16.4, [C++/CLI projects](/cpp/dotnet/dotnet-programming-with-cpp-cli-visual-cpp) can target .NET Core.</span></span> <span data-ttu-id="8ba1d-105">Bu destek, Windows masaüstü uygulamalarının C++/CLı birlikte çalışma katmanları ile .NET Core 'a bağlantı noktası kullanmasını mümkün kılar.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-105">This support makes it possible to port Windows desktop applications with C++/CLI interop layers to .NET Core.</span></span> <span data-ttu-id="8ba1d-106">Bu makalede, C++/CLı projelerinin .NET Framework 'dan .NET Core 3,1 ' e nasıl bağlantı kurulacağı açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-106">This article describes how to port C++/CLI projects from .NET Framework to .NET Core 3.1.</span></span>

## <a name="ccli-net-core-limitations"></a><span data-ttu-id="8ba1d-107">C++/CLı .NET Core sınırlamaları</span><span class="sxs-lookup"><span data-stu-id="8ba1d-107">C++/CLI .NET Core limitations</span></span>

<span data-ttu-id="8ba1d-108">C++/CLı projelerinin diğer dillere kıyasla .NET Core 'a taşıma açısından bazı önemli sınırlamalar vardır:</span><span class="sxs-lookup"><span data-stu-id="8ba1d-108">There are some important limitations to porting C++/CLI projects to .NET Core compared to other languages:</span></span>

* <span data-ttu-id="8ba1d-109">.NET Core için C++/CLı desteği yalnızca Windows içindir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-109">C++/CLI support for .NET Core is Windows only.</span></span>
* <span data-ttu-id="8ba1d-110">C++/CLı projeleri yalnızca .NET Core (veya .NET Framework) .NET Standard hedeflemiyor.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-110">C++/CLI projects can't target .NET Standard, only .NET Core (or .NET Framework).</span></span>
* <span data-ttu-id="8ba1d-111">C++/CLı projeleri, yeni SDK stili proje dosyası biçimini desteklemez.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-111">C++/CLI projects don't support the new SDK-style project file format.</span></span> <span data-ttu-id="8ba1d-112">Bunun yerine, .NET Core hedeflenirken bile, C++/CLı projeleri mevcut vcxproj dosya biçimini kullanır.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-112">Instead, even when targeting .NET Core, C++/CLI projects use the existing vcxproj file format.</span></span>
* <span data-ttu-id="8ba1d-113">C++/CLı projeleri çoklu .NET platformlarını çoklu hedefleyebilir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-113">C++/CLI projects can't multitarget multiple .NET platforms.</span></span> <span data-ttu-id="8ba1d-114">Hem .NET Framework hem de .NET Core için bir C++/CLı projesi oluşturmanız gerekiyorsa ayrı proje dosyaları kullanın.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-114">If you need to build a C++/CLI project for both .NET Framework and .NET Core, use separate project files.</span></span>
* <span data-ttu-id="8ba1d-115">.NET Core `-clr:pure` `-clr:safe` , yalnızca yeni `-clr:netcore` seçeneği (.NET Framework için eşdeğer) desteklemez veya derlemesini desteklemez `-clr` .</span><span class="sxs-lookup"><span data-stu-id="8ba1d-115">.NET Core doesn't support `-clr:pure` or `-clr:safe` compilation, only the new `-clr:netcore` option (which is equivalent to `-clr` for .NET Framework).</span></span>

## <a name="port-a-ccli-project"></a><span data-ttu-id="8ba1d-116">Bir C++/CLı projesi bağlantı noktası</span><span class="sxs-lookup"><span data-stu-id="8ba1d-116">Port a C++/CLI project</span></span>

<span data-ttu-id="8ba1d-117">C++/CLı projesinde .NET Core 'a bağlantı kurmak için, vcxproj dosyasında aşağıdaki değişiklikleri yapın.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-117">To port a C++/CLI project to .NET Core, make the following changes to the vcxproj file.</span></span> <span data-ttu-id="8ba1d-118">C++/CLı projeleri SDK stili proje dosyalarını kullanmadığından, bu geçiş adımları diğer proje türleri için gereken adımlardan farklıdır.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-118">These migration steps differ from the steps needed for other project types because C++/CLI projects don't use SDK-style project files.</span></span>

1. <span data-ttu-id="8ba1d-119">`<CLRSupport>true</CLRSupport>`Özellikleri ile değiştirin `<CLRSupport>NetCore</CLRSupport>` .</span><span class="sxs-lookup"><span data-stu-id="8ba1d-119">Replace `<CLRSupport>true</CLRSupport>` properties with `<CLRSupport>NetCore</CLRSupport>`.</span></span> <span data-ttu-id="8ba1d-120">Bu özellik genellikle yapılandırmaya özgü özellik gruplarında olduğundan, bunu birden çok yerde değiştirmeniz gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-120">This property is often in configuration-specific property groups, so you may need to replace it in multiple places.</span></span>
2. <span data-ttu-id="8ba1d-121">`<TargetFrameworkVersion>`Özellikleri ile değiştirin `<TargetFramework>netcoreapp3.1</TargetFramework>` .</span><span class="sxs-lookup"><span data-stu-id="8ba1d-121">Replace `<TargetFrameworkVersion>` properties with `<TargetFramework>netcoreapp3.1</TargetFramework>`.</span></span>
3. <span data-ttu-id="8ba1d-122">.NET Framework başvurularını kaldırın (gibi `<Reference Include="System" />` ).</span><span class="sxs-lookup"><span data-stu-id="8ba1d-122">Remove any .NET Framework references (like `<Reference Include="System" />`).</span></span> <span data-ttu-id="8ba1d-123">.NET Core SDK derlemeler kullanılırken otomatik olarak başvurulur `<CLRSupport>NetCore</CLRSupport>` .</span><span class="sxs-lookup"><span data-stu-id="8ba1d-123">.NET Core SDK assemblies are automatically referenced when using `<CLRSupport>NetCore</CLRSupport>`.</span></span>
4. <span data-ttu-id="8ba1d-124">.NET Core 'da kullanılamayan API 'Leri kaldırmak için, cpp dosyalarındaki API kullanımını güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-124">Update API usage in cpp files, as necessary, to remove APIs unavailable to .NET Core.</span></span> <span data-ttu-id="8ba1d-125">C++/CLı projeleri oldukça hafif birlikte çalışma katmanları olarak eğiltiğinden, genellikle pek çok değişiklik yapılması gerekmez.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-125">Because C++/CLI projects tend to be fairly thin interop layers, there are often not many changes needed.</span></span> <span data-ttu-id="8ba1d-126">[.Net taşınabilirlik Çözümleyicisi](../../standard/analyzers/portability-analyzer.md) , C++/CLI ikili dosyaları tarafından yalnızca yönetilen ikililer gibi kullanılan desteklenmeyen .NET API 'lerini belirlemek için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-126">The [.NET Portability Analyzer](../../standard/analyzers/portability-analyzer.md) can be used to identify unsupported .NET APIs used by C++/CLI binaries just as with purely managed binaries.</span></span> <span data-ttu-id="8ba1d-127">.NET Core API 'lerle çalışmak üzere kod taşınabilirliği ve güncelleştirme projelerinin belirlenmesi için yönergeler, [kitaplık taşıma kılavuzunda](./libraries.md#determine-portability)bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-127">Guidelines for determining code portability and updating projects to work with .NET Core APIs are available in the [library porting guidance](./libraries.md#determine-portability).</span></span>

### <a name="wpf-and-windows-forms-usage"></a><span data-ttu-id="8ba1d-128">WPF ve Windows Forms kullanımı</span><span class="sxs-lookup"><span data-stu-id="8ba1d-128">WPF and Windows Forms usage</span></span>

<span data-ttu-id="8ba1d-129">.NET Core C++/CLı projeleri, Windows Forms ve WPF API 'Lerini kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-129">.NET Core C++/CLI projects can use Windows Forms and WPF APIs.</span></span> <span data-ttu-id="8ba1d-130">Bu Windows Masaüstü API 'Lerini kullanmak için UI kitaplıklarına açık çerçeve başvuruları eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-130">To use these Windows desktop APIs, you need to add explicit framework references to the UI libraries.</span></span> <span data-ttu-id="8ba1d-131">Windows Masaüstü API 'Leri kullanan SDK stili projeler, SDK kullanarak gerekli Framework kitaplıklarına otomatik olarak başvurur `Microsoft.NET.Sdk.WindowsDesktop` .</span><span class="sxs-lookup"><span data-stu-id="8ba1d-131">SDK-style projects that use Windows desktop APIs reference the necessary framework libraries automatically by using the `Microsoft.NET.Sdk.WindowsDesktop` SDK.</span></span> <span data-ttu-id="8ba1d-132">C++/CLı projeleri SDK stili proje biçimini kullanmadığından, .NET Core 'u hedeflerken açık çerçeve başvuruları eklemesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-132">Because C++/CLI projects don't use the SDK-style project format, they need to add explicit framework references when targeting .NET Core.</span></span>

<span data-ttu-id="8ba1d-133">Windows Forms API 'Lerini kullanmak için, bu başvuruyu vcxproj dosyasına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="8ba1d-133">To use Windows Forms APIs, add this reference to the vcxproj file:</span></span>

```xml
<!-- Reference all of Windows Forms -->
<FrameworkReference Include="Microsoft.WindowsDesktop.App.WindowsForms" />
```

<span data-ttu-id="8ba1d-134">WPF API 'Lerini kullanmak için, bu başvuruyu vcxproj dosyasına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="8ba1d-134">To use WPF APIs, add this reference to the vcxproj file:</span></span>

```xml
<!-- Reference all of WPF -->
<FrameworkReference Include="Microsoft.WindowsDesktop.App.WPF" />
```

<span data-ttu-id="8ba1d-135">Hem Windows Forms hem de WPF API 'Lerini kullanmak için, bu başvuruyu vcxproj dosyasına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="8ba1d-135">To use both Windows Forms and WPF APIs, add this reference to the vcxproj file:</span></span>

```xml
<!-- Reference the entirety of the Windows desktop framework:
     Windows Forms, WPF, and the types that provide integration between them -->
<FrameworkReference Include="Microsoft.WindowsDesktop.App" />
```

<span data-ttu-id="8ba1d-136">Şu anda, Visual Studio 'nun başvuru Yöneticisi 'ni kullanarak bu başvuruları eklemek mümkün değildir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-136">Currently, it's not possible to add these references using Visual Studio's reference manager.</span></span> <span data-ttu-id="8ba1d-137">Bunun yerine, proje dosyasını el ile güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-137">Instead, update the project file manually.</span></span> <span data-ttu-id="8ba1d-138">Bu güncelleştirme, projeyi kaldırarak ve ardından proje dosyasını düzenleyerek Visual Studio 'da yapılabilir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-138">This update can be done in Visual Studio by unloading the project and then editing the project file.</span></span> <span data-ttu-id="8ba1d-139">VS Code gibi başka bir düzenleyiciyi de kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-139">You can also use another editor like VS Code.</span></span>

## <a name="build-without-msbuild"></a><span data-ttu-id="8ba1d-140">MSBuild olmadan derleme</span><span class="sxs-lookup"><span data-stu-id="8ba1d-140">Build without MSBuild</span></span>

<span data-ttu-id="8ba1d-141">MSBuild kullanmadan C++/CLı projelerini derlemek de mümkündür.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-141">It's also possible to build C++/CLI projects without using MSBuild.</span></span> <span data-ttu-id="8ba1d-142">Doğrudan *cl.exe* ve *link.exe* ile .NET Core için bir C++/CLI projesi oluşturmak için bu adımları izleyin:</span><span class="sxs-lookup"><span data-stu-id="8ba1d-142">Follow these steps to build a C++/CLI project for .NET Core directly with *cl.exe* and *link.exe*:</span></span>

1. <span data-ttu-id="8ba1d-143">Derlerken `-clr:netcore` *cl.exe* geçirin.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-143">When compiling, pass `-clr:netcore` to *cl.exe*.</span></span>
2. <span data-ttu-id="8ba1d-144">Gerekli .NET Core başvuru Derlemeleriyle başvur.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-144">Reference necessary .NET Core reference assemblies.</span></span>
3. <span data-ttu-id="8ba1d-145">Bağlama sırasında, .NET Core uygulama ana bilgisayar dizinini `LibPath` ( *ijwhost. lib* 'nin bulunabilmesi için) olarak sağlayın.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-145">When linking, provide the .NET Core app host directory as a `LibPath` (so that *ijwhost.lib* can be found).</span></span>
4. <span data-ttu-id="8ba1d-146">*ijwhost.dll* (.NET Core uygulama ana bilgisayar dizininden) projenin çıkış dizinine kopyalayın.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-146">Copy *ijwhost.dll* (from the .NET Core app host directory) to the project's output directory.</span></span>
5. <span data-ttu-id="8ba1d-147">Yönetilen kodu çalıştıracak uygulamanın ilk bileşeni için dosya [runtimeconfig.js](https://github.com/dotnet/sdk/blob/main/documentation/specs/runtime-configuration-file.md) bulunduğundan emin olun.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-147">Make sure a [runtimeconfig.json](https://github.com/dotnet/sdk/blob/main/documentation/specs/runtime-configuration-file.md) file exists for the first component of the application that will run managed code.</span></span> <span data-ttu-id="8ba1d-148">Uygulamanın yönetilen bir giriş noktası varsa, bir `runtime.config` dosya otomatik olarak oluşturulup kopyalanacaktır.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-148">If the application has a managed entry point, a `runtime.config` file will be created and copied automatically.</span></span> <span data-ttu-id="8ba1d-149">Uygulamanın yerel bir giriş noktası varsa, `runtimeconfig.json` .NET Core çalışma zamanını kullanmak için Ilk C++/CLI kitaplığı için bir dosya oluşturmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-149">If the application has a native entry point, though, you need to create a `runtimeconfig.json` file for the first C++/CLI library to use the .NET Core runtime.</span></span>

## <a name="known-issues"></a><span data-ttu-id="8ba1d-150">Bilinen sorunlar</span><span class="sxs-lookup"><span data-stu-id="8ba1d-150">Known issues</span></span>

<span data-ttu-id="8ba1d-151">.NET Core ' u hedefleyen C++/CLı projeleriyle çalışırken göz atmak için birkaç bilinen sorun vardır.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-151">There are a couple known issues to look out for when working with C++/CLI projects targeting .NET Core.</span></span>

* <span data-ttu-id="8ba1d-152">.NET Core C++/CLı projelerinde bir WPF çerçeve başvurusu Şu anda sembolleri içeri aktaramayacağından ilgili bazı ekstra uyarılara neden oluyor.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-152">A WPF framework reference in .NET Core C++/CLI projects currently causes some extraneous warnings about being unable to import symbols.</span></span> <span data-ttu-id="8ba1d-153">Bu uyarılar güvenle yoksayılabilir ve kısa bir süre önce düzeltilmelidir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-153">These warnings can be safely ignored and should be fixed soon.</span></span>
* <span data-ttu-id="8ba1d-154">Uygulamanın yerel bir giriş noktası varsa, önce yönetilen kodu yürüten C++/CLı kitaplığı, dosyasında bir [runtimeconfig.js](https://github.com/dotnet/sdk/blob/main/documentation/specs/runtime-configuration-file.md) gerekir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-154">If the application has a native entry point, the C++/CLI library that first executes managed code needs a [runtimeconfig.json](https://github.com/dotnet/sdk/blob/main/documentation/specs/runtime-configuration-file.md) file.</span></span> <span data-ttu-id="8ba1d-155">Bu yapılandırma dosyası, .NET Core çalışma zamanı başladığında kullanılır.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-155">This config file is used when the .NET Core runtime starts.</span></span> <span data-ttu-id="8ba1d-156">C++/CLı projeleri `runtimeconfig.json` henüz derleme zamanında otomatik olarak dosya oluşturmaz, bu nedenle dosya el ile oluşturulmalıdır.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-156">C++/CLI projects don't create `runtimeconfig.json` files automatically at build time yet, so the file must be generated manually.</span></span> <span data-ttu-id="8ba1d-157">Bir C++/CLı kitaplığı yönetilen bir giriş noktasından çağrılırsa, C++/CLı kitaplığı bir dosyaya gerek kalmaz `runtimeconfig.json` (giriş noktası derlemesi, çalışma zamanı başlatılırken kullanılan bir tane ile aynı olduğundan).</span><span class="sxs-lookup"><span data-stu-id="8ba1d-157">If a C++/CLI library is called from a managed entry point, then the C++/CLI library doesn't need a `runtimeconfig.json` file (since the entry point assembly will have one that is used when starting the runtime).</span></span> <span data-ttu-id="8ba1d-158">Basit bir örnek `runtimeconfig.json` dosya aşağıda gösterilmiştir.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-158">A simple sample `runtimeconfig.json` file is shown below.</span></span> <span data-ttu-id="8ba1d-159">Daha fazla bilgi için [GitHub 'daki spec](https://github.com/dotnet/sdk/blob/main/documentation/specs/runtime-configuration-file.md)'e bakın.</span><span class="sxs-lookup"><span data-stu-id="8ba1d-159">For more information, see the [spec on GitHub](https://github.com/dotnet/sdk/blob/main/documentation/specs/runtime-configuration-file.md).</span></span>

    ```json
    {
          "runtimeOptions": {
             "tfm": "netcoreapp3.1",
             "framework": {
                "name": "Microsoft.NETCore.App",
                "version": "3.1.0"
             }
          }
    }
    ```
