---
title: Derlenmiş Sorgular (LINQ to Entities)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 8025ba1d-29c7-4407-841b-d5a3bed40b7a
ms.openlocfilehash: d4101eae755ac698d4cef5b2e1334d01e02c3e35
ms.sourcegitcommit: 957c49696eaf048c284ef8f9f8ffeb562357ad95
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/07/2020
ms.locfileid: "82895416"
---
# <a name="compiled-queries--linq-to-entities"></a><span data-ttu-id="d98c4-102">Derlenmiş Sorgular (LINQ to Entities)</span><span class="sxs-lookup"><span data-stu-id="d98c4-102">Compiled Queries  (LINQ to Entities)</span></span>
<span data-ttu-id="d98c4-103">Entity Framework birden çok kez yapısal olarak benzer sorgular yürüten bir uygulamanız varsa, sorguyu bir kez derleyerek ve farklı parametrelerle birkaç kez yürüterek performansı sıklıkla artırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d98c4-103">When you have an application that executes structurally similar queries many times in the Entity Framework, you can frequently increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="d98c4-104">Örneğin, bir uygulama belirli bir şehirdeki tüm müşterileri almak zorunda kalabilir. Şehir, çalışma zamanında Kullanıcı tarafından bir formda belirtilir.</span><span class="sxs-lookup"><span data-stu-id="d98c4-104">For example, an application might have to retrieve all the customers in a particular city; the city is specified at runtime by the user in a form.</span></span> <span data-ttu-id="d98c4-105">LINQ to Entities, bu amaçla derlenen sorguların kullanılmasını destekler.</span><span class="sxs-lookup"><span data-stu-id="d98c4-105">LINQ to Entities supports using compiled queries for this purpose.</span></span>  
  
 <span data-ttu-id="d98c4-106">.NET Framework 4,5 ' den başlayarak LINQ sorguları otomatik olarak önbelleğe alınır.</span><span class="sxs-lookup"><span data-stu-id="d98c4-106">Starting with the .NET Framework 4.5, LINQ queries are cached automatically.</span></span> <span data-ttu-id="d98c4-107">Ancak, daha sonra yürütmelerin ve derlenmiş sorguların bu maliyeti azaltmak için derlenen LINQ sorgularını kullanmaya devam edebilirsiniz. bu da, otomatik olarak önbelleğe alınan LINQ sorgularından daha verimli olabilir.</span><span class="sxs-lookup"><span data-stu-id="d98c4-107">However, you can still use compiled LINQ queries to reduce this cost in later executions and compiled queries can be more efficient than LINQ queries that are automatically cached.</span></span> <span data-ttu-id="d98c4-108">Bu işleci, `Enumerable.Contains` bellek içi koleksiyonlara uygulayan LINQ to Entities sorgularının otomatik olarak önbelleğe alınmadığını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="d98c4-108">Note that LINQ to Entities queries that apply the `Enumerable.Contains` operator to in-memory collections are not automatically cached.</span></span> <span data-ttu-id="d98c4-109">Ayrıca, derlenen LINQ sorgularında bellek içi koleksiyonlara parametreleştirmeye izin verilmez.</span><span class="sxs-lookup"><span data-stu-id="d98c4-109">Also parameterizing in-memory collections in compiled LINQ queries is not allowed.</span></span>  
  
 <span data-ttu-id="d98c4-110">Sınıfı <xref:System.Data.Objects.CompiledQuery> , yeniden kullanım için sorguları derleme ve önbelleğe alma sağlar.</span><span class="sxs-lookup"><span data-stu-id="d98c4-110">The <xref:System.Data.Objects.CompiledQuery> class provides compilation and caching of queries for reuse.</span></span> <span data-ttu-id="d98c4-111">Kavramsal olarak, bu sınıf birkaç <xref:System.Data.Objects.CompiledQuery>aşırı `Compile` yükleme içeren bir yöntemi içerir.</span><span class="sxs-lookup"><span data-stu-id="d98c4-111">Conceptually, this class contains a <xref:System.Data.Objects.CompiledQuery>'s `Compile` method with several overloads.</span></span> <span data-ttu-id="d98c4-112">Derlenen sorguyu `Compile` temsil etmek üzere yeni bir temsilci oluşturmak için yöntemini çağırın.</span><span class="sxs-lookup"><span data-stu-id="d98c4-112">Call the `Compile` method to create a new delegate to represent the compiled query.</span></span> <span data-ttu-id="d98c4-113">Ve parametre değerleriyle birlikte sunulan `Compile` Yöntemler, bazı sonuçlar üreten bir temsilci döndürür (örneğin, bir <xref:System.Linq.IQueryable%601> örnek). <xref:System.Data.Objects.ObjectContext></span><span class="sxs-lookup"><span data-stu-id="d98c4-113">The `Compile` methods, provided with a <xref:System.Data.Objects.ObjectContext> and parameter values, return a delegate that produces some result (such as an <xref:System.Linq.IQueryable%601> instance).</span></span> <span data-ttu-id="d98c4-114">Sorgu yalnızca ilk yürütme sırasında bir kez derlenir.</span><span class="sxs-lookup"><span data-stu-id="d98c4-114">The query compiles once during only the first execution.</span></span> <span data-ttu-id="d98c4-115">Derleme sırasında sorgu için ayarlanan birleştirme seçenekleri daha sonra değiştirilemez.</span><span class="sxs-lookup"><span data-stu-id="d98c4-115">The merge options set for the query at the time of the compilation cannot be changed later.</span></span> <span data-ttu-id="d98c4-116">Sorgu derlendikten sonra yalnızca temel tür parametreleri sağlayabilirsiniz ancak oluşturulan SQL 'yi değiştirecek sorgunun parçalarını değiştiremezsiniz.</span><span class="sxs-lookup"><span data-stu-id="d98c4-116">Once the query is compiled you can only supply parameters of primitive type but you cannot replace parts of the query that would change the generated SQL.</span></span> <span data-ttu-id="d98c4-117">Daha fazla bilgi için bkz. [EF birleştirme seçenekleri ve derlenmiş sorgular](https://docs.microsoft.com/archive/blogs/dsimmons/ef-merge-options-and-compiled-queries).</span><span class="sxs-lookup"><span data-stu-id="d98c4-117">For more information, see [EF Merge Options and Compiled Queries](https://docs.microsoft.com/archive/blogs/dsimmons/ef-merge-options-and-compiled-queries).</span></span>
  
 <span data-ttu-id="d98c4-118">Yöntemi derleyen LINQ to Entities sorgu ifadesi <xref:System.Data.Objects.CompiledQuery>, genel `Func` temsilcilerden biri (gibi) ile temsil edilir <xref:System.Func%605> `Compile`</span><span class="sxs-lookup"><span data-stu-id="d98c4-118">The LINQ to Entities query expression that the <xref:System.Data.Objects.CompiledQuery>'s `Compile` method compiles is represented by one of the generic `Func` delegates, such as <xref:System.Func%605>.</span></span> <span data-ttu-id="d98c4-119">En çok, sorgu ifadesi bir `ObjectContext` parametreyi, dönüş parametresini ve 16 sorgu parametresini kapsülleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d98c4-119">At most, the query expression can encapsulate an `ObjectContext` parameter, a return parameter, and 16 query parameters.</span></span> <span data-ttu-id="d98c4-120">16 ' dan fazla sorgu parametresi gerekliyse, özellikleri sorgu parametrelerini temsil eden bir yapı oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d98c4-120">If more than 16 query parameters are required, you can create a structure whose properties represent query parameters.</span></span> <span data-ttu-id="d98c4-121">Daha sonra özellikleri ayarladıktan sonra sorgu ifadesindeki yapıda özellikleri kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d98c4-121">You can then use the properties on the structure in the query expression after you set the properties.</span></span>  
  
## <a name="example-1"></a><span data-ttu-id="d98c4-122">Örnek 1</span><span class="sxs-lookup"><span data-stu-id="d98c4-122">Example 1</span></span>  
 <span data-ttu-id="d98c4-123">Aşağıdaki örnek, bir <xref:System.Decimal> giriş parametresi kabul eden bir sorgu çağırır ve sonra, ödenecek toplam değer $200,00 ' den büyük veya buna eşit olan bir sipariş dizisi döndürür:</span><span class="sxs-lookup"><span data-stu-id="d98c4-123">The following example compiles and then invokes a query that accepts a <xref:System.Decimal> input parameter and returns a sequence of orders where the total due is greater than or equal to $200.00:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CompiledQuery2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#compiledquery2)]
 [!code-vb[DP L2E Conceptual Examples#CompiledQuery2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#compiledquery2)]  
  
## <a name="example-2"></a><span data-ttu-id="d98c4-124">Örnek 2</span><span class="sxs-lookup"><span data-stu-id="d98c4-124">Example 2</span></span>  
 <span data-ttu-id="d98c4-125">Aşağıdaki örnek, bir <xref:System.Data.Objects.ObjectQuery%601> örnek döndüren bir sorgu derler ve çağırır:</span><span class="sxs-lookup"><span data-stu-id="d98c4-125">The following example compiles and then invokes a query that returns an <xref:System.Data.Objects.ObjectQuery%601> instance:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CompiledQuery1_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#compiledquery1_mq)]
 [!code-vb[DP L2E Conceptual Examples#CompiledQuery1_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#compiledquery1_mq)]  
  
## <a name="example-3"></a><span data-ttu-id="d98c4-126">Örnek 3</span><span class="sxs-lookup"><span data-stu-id="d98c4-126">Example 3</span></span>  
 <span data-ttu-id="d98c4-127">Aşağıdaki örnek, ürün listesi fiyatlarının ortalamasını bir <xref:System.Decimal> değer olarak döndüren bir sorguyu derler ve çağırır:</span><span class="sxs-lookup"><span data-stu-id="d98c4-127">The following example compiles and then invokes a query that returns the average of the product list prices as a <xref:System.Decimal> value:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CompiledQuery3_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#compiledquery3_mq)]
 [!code-vb[DP L2E Conceptual Examples#CompiledQuery3_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#compiledquery3_mq)]  
  
## <a name="example-4"></a><span data-ttu-id="d98c4-128">Örnek 4</span><span class="sxs-lookup"><span data-stu-id="d98c4-128">Example 4</span></span>  
 <span data-ttu-id="d98c4-129">Aşağıdaki örnek, bir <xref:System.String> giriş parametresi kabul eden bir sorguyu derler ve sonra bir e-posta adresinin `Contact` belirtilen dizeyle başladığı bir sorgu çağırır:</span><span class="sxs-lookup"><span data-stu-id="d98c4-129">The following example compiles and then invokes a query that accepts a <xref:System.String> input parameter and then returns a `Contact` whose email address starts with the specified string:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CompiledQuery4_MQ](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#compiledquery4_mq)]
 [!code-vb[DP L2E Conceptual Examples#CompiledQuery4_MQ](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#compiledquery4_mq)]  
  
## <a name="example-5"></a><span data-ttu-id="d98c4-130">Örnek 5</span><span class="sxs-lookup"><span data-stu-id="d98c4-130">Example 5</span></span>  
 <span data-ttu-id="d98c4-131">Aşağıdaki örnek, parametreleri kabul <xref:System.DateTime> eden ve <xref:System.Decimal> giriş yapan bir sorgu çağırır ve sonra sipariş tarihinin 8 Mart 2003 ' den daha geç olduğu ve süresi $300,00 ' den küçük olan bir sıra dizisi döndürüyor:</span><span class="sxs-lookup"><span data-stu-id="d98c4-131">The following example compiles and then invokes a query that accepts <xref:System.DateTime> and <xref:System.Decimal> input parameters and returns a sequence of orders where the order date is later than March 8, 2003, and the total due is less than $300.00:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CompiledQuery5](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#compiledquery5)]
 [!code-vb[DP L2E Conceptual Examples#CompiledQuery5](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#compiledquery5)]  
  
## <a name="example-6"></a><span data-ttu-id="d98c4-132">Örnek 6</span><span class="sxs-lookup"><span data-stu-id="d98c4-132">Example 6</span></span>  
 <span data-ttu-id="d98c4-133">Aşağıdaki örnek, bir <xref:System.DateTime> giriş parametresi kabul eden bir sorgu çağırır ve sonra sipariş tarihinin 8 Mart 2004 ' den sonraki bir sıra sırasını döndürür.</span><span class="sxs-lookup"><span data-stu-id="d98c4-133">The following example compiles and then invokes a query that accepts a <xref:System.DateTime> input parameter and returns a sequence of orders where the order date is later than March 8, 2004.</span></span> <span data-ttu-id="d98c4-134">Bu sorgu, düzen bilgilerini anonim türlerin bir dizisi olarak döndürür.</span><span class="sxs-lookup"><span data-stu-id="d98c4-134">This query returns the order information as a sequence of anonymous types.</span></span> <span data-ttu-id="d98c4-135">Anonim türler derleyici tarafından algılanır, bu nedenle <xref:System.Data.Objects.CompiledQuery>kendi `Compile` yönteminde tür parametreleri belirtemezsiniz ve tür sorgunun kendisinde tanımlanmış.</span><span class="sxs-lookup"><span data-stu-id="d98c4-135">Anonymous types are inferred by the compiler, so you cannot specify type parameters in the <xref:System.Data.Objects.CompiledQuery>'s `Compile` method and the type is defined in the query itself.</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CompiledQuery6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#compiledquery6)]
 [!code-vb[DP L2E Conceptual Examples#CompiledQuery6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#compiledquery6)]  
  
## <a name="example-7"></a><span data-ttu-id="d98c4-136">Örnek 7</span><span class="sxs-lookup"><span data-stu-id="d98c4-136">Example 7</span></span>  
 <span data-ttu-id="d98c4-137">Aşağıdaki örnek, Kullanıcı tanımlı bir yapı giriş parametresini kabul eden ve bir dizi siparişi döndüren bir sorguyu derler ve çağırır.</span><span class="sxs-lookup"><span data-stu-id="d98c4-137">The following example compiles and then invokes a query that accepts a user-defined structure input parameter and returns a sequence of orders.</span></span> <span data-ttu-id="d98c4-138">Yapı başlangıç tarihi, bitiş tarihi ve toplam son sorgu parametresini tanımlar ve sorgu, $700,00 Mart 3 ve 8 Mart 2003 tarihleri arasında, ' den büyük bir süre ile gönderilen siparişleri döndürür.</span><span class="sxs-lookup"><span data-stu-id="d98c4-138">The structure defines start date, end date, and total due query parameters, and the query returns orders shipped between March 3 and March 8, 2003 with a total due greater than $700.00.</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CompiledQuery7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#compiledquery7)]
 [!code-vb[DP L2E Conceptual Examples#CompiledQuery7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#compiledquery7)]  
  
 <span data-ttu-id="d98c4-139">Sorgu parametrelerini tanımlayan yapı:</span><span class="sxs-lookup"><span data-stu-id="d98c4-139">The structure that defines the query parameters:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#MyParamsStruct](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#myparamsstruct)]
 [!code-vb[DP L2E Conceptual Examples#MyParamsStruct](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#myparamsstruct)]  
  
## <a name="see-also"></a><span data-ttu-id="d98c4-140">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="d98c4-140">See also</span></span>

- [<span data-ttu-id="d98c4-141">ADO.NET Entity Framework</span><span class="sxs-lookup"><span data-stu-id="d98c4-141">ADO.NET Entity Framework</span></span>](../index.md)
- [<span data-ttu-id="d98c4-142">LINQ - Varlıklar</span><span class="sxs-lookup"><span data-stu-id="d98c4-142">LINQ to Entities</span></span>](linq-to-entities.md)
- [<span data-ttu-id="d98c4-143">EF birleştirme seçenekleri ve derlenmiş sorgular</span><span class="sxs-lookup"><span data-stu-id="d98c4-143">EF Merge Options and Compiled Queries</span></span>](https://docs.microsoft.com/archive/blogs/dsimmons/ef-merge-options-and-compiled-queries)
