---
title: 'CA2007: bir görevi doğrudan bekleme (kod analizi)'
description: 'Kod Analizi kuralı CA2007 hakkında bilgi edinin: bir görevi doğrudan bekleme'
ms.date: 03/08/2019
ms.topic: reference
f1_keywords:
- CA2007
- DoNotDirectlyAwaitATaskAnalyzer
helpviewer_keywords:
- CA2007
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
ms.openlocfilehash: 9a1e21c75a24357744046ccbf8215fd5364ebfc2
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/30/2021
ms.locfileid: "99754777"
---
# <a name="ca2007-do-not-directly-await-a-task"></a><span data-ttu-id="6110f-103">CA2007: Doğrudan bir Görevi beklemeyin</span><span class="sxs-lookup"><span data-stu-id="6110f-103">CA2007: Do not directly await a Task</span></span>

| | <span data-ttu-id="6110f-104">Değer</span><span class="sxs-lookup"><span data-stu-id="6110f-104">Value</span></span> |
|-|-|
| <span data-ttu-id="6110f-105">**Kural Kimliği**</span><span class="sxs-lookup"><span data-stu-id="6110f-105">**Rule ID**</span></span> |<span data-ttu-id="6110f-106">CA2007</span><span class="sxs-lookup"><span data-stu-id="6110f-106">CA2007</span></span>|
| <span data-ttu-id="6110f-107">**Kategori**</span><span class="sxs-lookup"><span data-stu-id="6110f-107">**Category**</span></span> |[<span data-ttu-id="6110f-108">Güvenilirlik</span><span class="sxs-lookup"><span data-stu-id="6110f-108">Reliability</span></span>](reliability-warnings.md)|
| <span data-ttu-id="6110f-109">**Düzeltilme veya kırılmamış**</span><span class="sxs-lookup"><span data-stu-id="6110f-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="6110f-110">Kırılmamış</span><span class="sxs-lookup"><span data-stu-id="6110f-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="6110f-111">Nedeni</span><span class="sxs-lookup"><span data-stu-id="6110f-111">Cause</span></span>

<span data-ttu-id="6110f-112">Zaman uyumsuz bir [](../../../csharp/language-reference/operators/await.md) yöntem doğrudan bekler <xref:System.Threading.Tasks.Task> .</span><span class="sxs-lookup"><span data-stu-id="6110f-112">An asynchronous method [awaits](../../../csharp/language-reference/operators/await.md) a <xref:System.Threading.Tasks.Task> directly.</span></span>

## <a name="rule-description"></a><span data-ttu-id="6110f-113">Kural açıklaması</span><span class="sxs-lookup"><span data-stu-id="6110f-113">Rule description</span></span>

<span data-ttu-id="6110f-114">Zaman uyumsuz bir yöntem <xref:System.Threading.Tasks.Task> doğrudan bekler, zaman uyumsuz bağlam temelinde, devamlılık genellikle görevi oluşturan aynı iş parçacığında oluşur.</span><span class="sxs-lookup"><span data-stu-id="6110f-114">When an asynchronous method awaits a <xref:System.Threading.Tasks.Task> directly, continuation usually occurs in the same thread that created the task, depending on the async context.</span></span> <span data-ttu-id="6110f-115">Bu davranış, performans açısından maliyetli olabilir ve Kullanıcı arabirimi iş parçacığında kilitlenmeye neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="6110f-115">This behavior can be costly in terms of performance and can result in a deadlock on the UI thread.</span></span> <span data-ttu-id="6110f-116"><xref:System.Threading.Tasks.Task.ConfigureAwait(System.Boolean)?displayProperty=nameWithType>Devamlılığını sağlamak için çağırmayı düşünün.</span><span class="sxs-lookup"><span data-stu-id="6110f-116">Consider calling <xref:System.Threading.Tasks.Task.ConfigureAwait(System.Boolean)?displayProperty=nameWithType> to signal your intention for continuation.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="6110f-117">İhlalleri çözme</span><span class="sxs-lookup"><span data-stu-id="6110f-117">How to fix violations</span></span>

<span data-ttu-id="6110f-118">İhlalleri onarmak için, <xref:System.Threading.Tasks.Task.ConfigureAwait%2A> bekletildi üzerinde çağrı yapın <xref:System.Threading.Tasks.Task> .</span><span class="sxs-lookup"><span data-stu-id="6110f-118">To fix violations, call <xref:System.Threading.Tasks.Task.ConfigureAwait%2A> on the awaited <xref:System.Threading.Tasks.Task>.</span></span> <span data-ttu-id="6110f-119">`true`Parametresi için veya ' i geçirebilirsiniz `false` `continueOnCapturedContext` .</span><span class="sxs-lookup"><span data-stu-id="6110f-119">You can pass either `true` or `false` for the `continueOnCapturedContext` parameter.</span></span>

- <span data-ttu-id="6110f-120">`ConfigureAwait(true)`Görevde çağırmak, açıkça çağrılmayan aynı davranışa sahiptir <xref:System.Threading.Tasks.Task.ConfigureAwait%2A> .</span><span class="sxs-lookup"><span data-stu-id="6110f-120">Calling `ConfigureAwait(true)` on the task has the same behavior as not explicitly calling <xref:System.Threading.Tasks.Task.ConfigureAwait%2A>.</span></span> <span data-ttu-id="6110f-121">Bu yöntemi açık bir şekilde çağırarak, okuyucuların özgün eşitleme bağlamında devamlılığını bilerek gerçekleştirmek istediğinizi öğrenmiş olursunuz.</span><span class="sxs-lookup"><span data-stu-id="6110f-121">By explicitly calling this method, you're letting readers know you intentionally want to perform the continuation on the original synchronization context.</span></span>

- <span data-ttu-id="6110f-122">`ConfigureAwait(false)`İş parçacığı havuzunda devamlılıkları zamanlamak için görevde çağrı yapın, böylece kullanıcı arabirimi iş parçacığında kilitlenmelerden kaçının.</span><span class="sxs-lookup"><span data-stu-id="6110f-122">Call `ConfigureAwait(false)` on the task to schedule continuations to the thread pool, thereby avoiding a deadlock on the UI thread.</span></span> <span data-ttu-id="6110f-123">Geçirme `false` , uygulamayla bağımsız kitaplıklar için iyi bir seçenektir.</span><span class="sxs-lookup"><span data-stu-id="6110f-123">Passing `false` is a good option for app-independent libraries.</span></span>

## <a name="example"></a><span data-ttu-id="6110f-124">Örnek</span><span class="sxs-lookup"><span data-stu-id="6110f-124">Example</span></span>

<span data-ttu-id="6110f-125">Aşağıdaki kod parçacığı uyarı oluşturur:</span><span class="sxs-lookup"><span data-stu-id="6110f-125">The following code snippet generates the warning:</span></span>

```csharp
public async Task Execute()
{
    Task task = null;
    await task;
}
```

<span data-ttu-id="6110f-126">İhlalin giderilmesi için, beklenen <xref:System.Threading.Tasks.Task.ConfigureAwait%2A> <xref:System.Threading.Tasks.Task> :</span><span class="sxs-lookup"><span data-stu-id="6110f-126">To fix the violation, call <xref:System.Threading.Tasks.Task.ConfigureAwait%2A> on the awaited <xref:System.Threading.Tasks.Task>:</span></span>

```csharp
public async Task Execute()
{
    Task task = null;
    await task.ConfigureAwait(false);
}
```

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="6110f-127">Uyarıların ne zaman bastırılamıyor</span><span class="sxs-lookup"><span data-stu-id="6110f-127">When to suppress warnings</span></span>

<span data-ttu-id="6110f-128">Bu uyarı, kodun rastgele ortamlarda yürütülebileceği ve kodun ortam hakkında varsayımları olmaması ya da yöntemin çağırıcısı tarafından nasıl çağrıllabileceği ya da beklenmemesi gerektiği kitaplıklara yöneliktir.</span><span class="sxs-lookup"><span data-stu-id="6110f-128">This warning is intended for libraries, where the code may be executed in arbitrary environments and where code shouldn't make assumptions about the environment or how the caller of the method may be invoking or waiting on it.</span></span> <span data-ttu-id="6110f-129">Genellikle, uyarı kodu yerine uygulama kodunu temsil eden projeler için uyarıyı tamamen bastırmak için uygundur; Aslında, bu çözümleyici 'yi uygulama kodunda (örneğin, bir WinForms veya WPF projesindeki düğme tıklama olayı işleyicileri) çalıştırmak, yanlış eylemlere neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="6110f-129">It is generally appropriate to suppress the warning entirely for projects that represent application code rather than library code; in fact, running this analyzer on application code (for example, button click event handlers in a WinForms or WPF project) is likely to lead to the wrong actions being taken.</span></span>

<span data-ttu-id="6110f-130">Devamlılığın orijinal içeriğe geri zamanlanması veya böyle bir bağlamın yerinde olmaması durumunda bu uyarıyı gizleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="6110f-130">You can suppress this warning in any situation where either the continuation should be scheduled back to the original context or where there is no such context in place.</span></span> <span data-ttu-id="6110f-131">Örneğin, bir düğmeye bir bir WinForms veya WPF uygulamasında kod yazarken, genel olarak bir await 'den devamlılık Kullanıcı arabirimi iş parçacığında çalışmalıdır ve bu nedenle devamlılığını kaynak bağlamına geri doğru zamanlamaya yönelik varsayılan davranış tercih edilir.</span><span class="sxs-lookup"><span data-stu-id="6110f-131">For example, when writing code in a button click event handler in a WinForms or WPF application, in general the continuation from an await should run on the UI thread, and thus the default behavior of scheduling the continuation back to the originating context is desirable.</span></span> <span data-ttu-id="6110f-132">Başka bir örnek olarak, bir ASP.NET Core uygulamasına kod yazarken, varsayılan olarak <xref:System.Threading.SynchronizationContext> <xref:System.Threading.Tasks.TaskScheduler> herhangi bir davranışı hiçbir şekilde değiştirmediği için, veya, bir, değildir `ConfigureAwait` .</span><span class="sxs-lookup"><span data-stu-id="6110f-132">As another example, when writing code in an ASP.NET Core application, by default there is no <xref:System.Threading.SynchronizationContext> or <xref:System.Threading.Tasks.TaskScheduler>, for which reason a `ConfigureAwait` wouldn't actually change any behavior.</span></span>

[!INCLUDE [suppress-warning](../../../../includes/code-analysis/suppress-warning.md)]

## <a name="configure-code-to-analyze"></a><span data-ttu-id="6110f-133">Analiz etmek için kodu Yapılandır</span><span class="sxs-lookup"><span data-stu-id="6110f-133">Configure code to analyze</span></span>

<span data-ttu-id="6110f-134">Kod tabanınızın hangi bölümlerinin bu kuralı çalıştıracağınızı yapılandırmak için aşağıdaki seçenekleri kullanın.</span><span class="sxs-lookup"><span data-stu-id="6110f-134">Use the following options to configure which parts of your codebase to run this rule on.</span></span>

- [<span data-ttu-id="6110f-135">Async void yöntemlerini hariç tut</span><span class="sxs-lookup"><span data-stu-id="6110f-135">Exclude async void methods</span></span>](#exclude-async-void-methods)
- [<span data-ttu-id="6110f-136">Çıkış türü</span><span class="sxs-lookup"><span data-stu-id="6110f-136">Output kind</span></span>](#output-kind)

<span data-ttu-id="6110f-137">Bu seçeneklerin tümünü yalnızca bu kural için, tüm kurallar için veya bu kategorideki tüm kurallar ([güvenilirlik](reliability-warnings.md)) için yapılandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="6110f-137">You can configure all of these options for just this rule, for all rules, or for all rules in this category ([Reliability](reliability-warnings.md)).</span></span> <span data-ttu-id="6110f-138">Daha fazla bilgi için bkz. [kod kalitesi kural yapılandırma seçenekleri](../code-quality-rule-options.md).</span><span class="sxs-lookup"><span data-stu-id="6110f-138">For more information, see [Code quality rule configuration options](../code-quality-rule-options.md).</span></span>

### <a name="exclude-async-void-methods"></a><span data-ttu-id="6110f-139">Async void yöntemlerini hariç tut</span><span class="sxs-lookup"><span data-stu-id="6110f-139">Exclude async void methods</span></span>

<span data-ttu-id="6110f-140">Bu kuraldan bir değer döndürmeyen zaman uyumsuz yöntemleri dışlamak isteyip istemediğiniz yapılandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="6110f-140">You can configure whether you want to exclude asynchronous methods that don't return a value from this rule.</span></span> <span data-ttu-id="6110f-141">Bu tür yöntemleri dışlamak için, aşağıdaki anahtar-değer çiftini projenizdeki bir *. editorconfig* dosyasına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="6110f-141">To exclude these kinds of methods, add the following key-value pair to an *.editorconfig* file in your project:</span></span>

```ini
# Package version 2.9.0 and later
dotnet_code_quality.CA2007.exclude_async_void_methods = true

# Package version 2.6.3 and earlier
dotnet_code_quality.CA2007.skip_async_void_methods = true
```

### <a name="output-kind"></a><span data-ttu-id="6110f-142">Çıkış türü</span><span class="sxs-lookup"><span data-stu-id="6110f-142">Output kind</span></span>

<span data-ttu-id="6110f-143">Ayrıca, bu kuralın hangi çıkış derleme türlerini uygulanacağını de yapılandırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="6110f-143">You can also configure which output assembly kinds to apply this rule to.</span></span> <span data-ttu-id="6110f-144">Örneğin, bu kuralı yalnızca bir konsol uygulaması veya dinamik olarak bağlı bir kitaplık (yani, bir UI uygulaması değil) üreten koda uygulamak için, aşağıdaki anahtar-değer çiftini projenizdeki bir *. editorconfig* dosyasına ekleyin:</span><span class="sxs-lookup"><span data-stu-id="6110f-144">For example, to only apply this rule to code that produces a console application or a dynamically linked library (that is, not a UI app), add the following key-value pair to an *.editorconfig* file in your project:</span></span>

```ini
dotnet_code_quality.CA2007.output_kind = ConsoleApplication, DynamicallyLinkedLibrary
```

## <a name="see-also"></a><span data-ttu-id="6110f-145">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="6110f-145">See also</span></span>

- [<span data-ttu-id="6110f-146">ConfigureAwait SSS</span><span class="sxs-lookup"><span data-stu-id="6110f-146">ConfigureAwait FAQ</span></span>](https://devblogs.microsoft.com/dotnet/configureawait-faq/)
- [<span data-ttu-id="6110f-147">ConfigureAwait (false) ile bir görevi beklemem gerekir mi?</span><span class="sxs-lookup"><span data-stu-id="6110f-147">Should I await a task with ConfigureAwait(false)?</span></span>](https://github.com/Microsoft/vs-threading/blob/master/doc/cookbook_vs.md#should-i-await-a-task-with-configureawaitfalse)
- [<span data-ttu-id="6110f-148">CA2008: TaskScheduler geçirmeden görev oluşturmayın</span><span class="sxs-lookup"><span data-stu-id="6110f-148">CA2008: Do not create tasks without passing a TaskScheduler</span></span>](ca2008.md)
- [<span data-ttu-id="6110f-149">Güvenilirlik kuralları</span><span class="sxs-lookup"><span data-stu-id="6110f-149">Reliability rules</span></span>](reliability-warnings.md)
