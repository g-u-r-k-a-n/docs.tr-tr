---
title: 'İş Parçacığında Yerel Depolama: İş Parçacığı Göreli Statik Alanları ve Veri Yuvaları'
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- threading [.NET], local storage
- threading [.NET], thread-relative static fields
- local thread storage
- TLS
ms.assetid: c633a4dc-a790-4ed1-96b5-f72bd968b284
ms.openlocfilehash: f80cc09d87116d3daff8047c1d1398c5e6104178
ms.sourcegitcommit: 7588b1f16b7608bc6833c05f91ae670c22ef56f8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/02/2020
ms.locfileid: "93188165"
---
# <a name="thread-local-storage-thread-relative-static-fields-and-data-slots"></a><span data-ttu-id="dc2cc-102">İş Parçacığında Yerel Depolama: İş Parçacığı Göreli Statik Alanları ve Veri Yuvaları</span><span class="sxs-lookup"><span data-stu-id="dc2cc-102">Thread Local Storage: Thread-Relative Static Fields and Data Slots</span></span>

<span data-ttu-id="dc2cc-103">İş parçacığı ve uygulama etki alanına özgü verileri depolamak için yönetilen iş parçacığı yerel depolaması (TLS) kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-103">You can use managed thread local storage (TLS) to store data that's unique to a thread and application domain.</span></span> <span data-ttu-id="dc2cc-104">.NET yönetilen TLS kullanmak için iki yol sunar: iş parçacığı göreli statik alanları ve veri yuvaları.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-104">.NET provides two ways to use managed TLS: thread-relative static fields and data slots.</span></span>  
  
- <span data-ttu-id="dc2cc-105">Derleme zamanında tam ihtiyaçlarınızı önleyebiliyorsanız, iş parçacığı göreli statik alanları (Visual Basic iş parçacığı göreli `Shared` alanları) kullanın.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-105">Use thread-relative static fields (thread-relative `Shared` fields in Visual Basic) if you can anticipate your exact needs at compile time.</span></span> <span data-ttu-id="dc2cc-106">İş parçacığı göreli statik alanları en iyi performansı sağlar.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-106">Thread-relative static fields provide the best performance.</span></span> <span data-ttu-id="dc2cc-107">Ayrıca, derleme zamanı tür denetimi 'nin avantajlarını da sunar.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-107">They also give you the benefits of compile-time type checking.</span></span>  
  
- <span data-ttu-id="dc2cc-108">Gerçek gereksinimleriniz yalnızca çalışma zamanında keşfedildiğinde veri yuvalarını kullanın.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-108">Use data slots when your actual requirements might be discovered only at run time.</span></span> <span data-ttu-id="dc2cc-109">Veri yuvaları, iş parçacığı göreli statik alanlarından daha yavaş ve daha fazla kullanım açısından daha yavaştır ve veriler tür olarak depolanır, bu <xref:System.Object> nedenle kullanmadan önce doğru türe atamalısınız.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-109">Data slots are slower and more awkward to use than thread-relative static fields, and data is stored as type <xref:System.Object>, so you must cast it to the correct type before you use it.</span></span>  
  
 <span data-ttu-id="dc2cc-110">Yönetilmeyen C++ ' da, `TlsAlloc` yuvaları dinamik olarak ayırmak ve `__declspec(thread)` bir değişkenin iş parçacığı göreli depolamada ayrılması gerektiğini bildirmek için kullanırsınız.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-110">In unmanaged C++, you use `TlsAlloc` to allocate slots dynamically and `__declspec(thread)` to declare that a variable should be allocated in thread-relative storage.</span></span> <span data-ttu-id="dc2cc-111">İş parçacığı göreli statik alanları ve veri yuvaları, bu davranışın yönetilen sürümünü sağlar.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-111">Thread-relative static fields and data slots provide the managed version of this behavior.</span></span>  
  
<span data-ttu-id="dc2cc-112"><xref:System.Threading.ThreadLocal%601?displayProperty=nameWithType>Nesne ilk tüketilmişse, geç başlatılan iş parçacığı yerel nesneleri oluşturmak için sınıfını kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-112">You can use the <xref:System.Threading.ThreadLocal%601?displayProperty=nameWithType> class to create thread-local objects that are initialized lazily when the object is first consumed.</span></span> <span data-ttu-id="dc2cc-113">Daha fazla bilgi için bkz. [yavaş başlatma](../../framework/performance/lazy-initialization.md).</span><span class="sxs-lookup"><span data-stu-id="dc2cc-113">For more information, see [Lazy Initialization](../../framework/performance/lazy-initialization.md).</span></span>  
  
## <a name="uniqueness-of-data-in-managed-tls"></a><span data-ttu-id="dc2cc-114">Yönetilen TLS 'deki verilerin benzersizliği</span><span class="sxs-lookup"><span data-stu-id="dc2cc-114">Uniqueness of Data in Managed TLS</span></span>  
 <span data-ttu-id="dc2cc-115">İş parçacığı göreli statik alanları veya veri yuvaları kullanmanıza bakılmaksızın, yönetilen TLS 'deki veriler, iş parçacığı ve uygulama etki alanı birleşimine özgüdür.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-115">Whether you use thread-relative static fields or data slots, data in managed TLS is unique to the combination of thread and application domain.</span></span>  
  
- <span data-ttu-id="dc2cc-116">Bir uygulama etki alanı içinde, her iki iş parçacığı aynı alanı veya yuvayı kullandıklarında bile, bir iş parçacığı başka bir iş parçacığından verileri değiştiremez.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-116">Within an application domain, one thread cannot modify data from another thread, even when both threads use the same field or slot.</span></span>  
  
- <span data-ttu-id="dc2cc-117">Bir iş parçacığı birden çok uygulama etki alanından aynı alana veya yuvaya eriştiğinde, her uygulama etki alanında ayrı bir değer tutulur.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-117">When a thread accesses the same field or slot from multiple application domains, a separate value is maintained in each application domain.</span></span>  
  
 <span data-ttu-id="dc2cc-118">Örneğin, bir iş parçacığı iş parçacığı göreli statik alanının değerini ayarlarsa, başka bir uygulama etki alanı girer ve sonra alanın değerini alıyorsa ikinci uygulama etki alanında alınan değer ilk uygulama etki alanındaki değerden farklıdır.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-118">For example, if a thread sets the value of a thread-relative static field, enters another application domain, and then retrieves the value of the field, the value retrieved in the second application domain differs from the value in the first application domain.</span></span> <span data-ttu-id="dc2cc-119">İkinci uygulama etki alanındaki alan için yeni bir değer ayarlandığında, ilk uygulama etki alanındaki alanın değeri etkilenmez.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-119">Setting a new value for the field in the second application domain does not affect the field's value in the first application domain.</span></span>  
  
 <span data-ttu-id="dc2cc-120">Benzer şekilde, bir iş parçacığı iki farklı uygulama etki alanında aynı adlandırılmış veri yuvasını aldığında, ilk uygulama etki alanındaki veriler ikinci uygulama etki alanındaki verilerden bağımsız kalır.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-120">Similarly, when a thread gets the same named data slot in two different application domains, the data in the first application domain remains independent of the data in the second application domain.</span></span>  
  
## <a name="thread-relative-static-fields"></a><span data-ttu-id="dc2cc-121">Thread-Relative statik alanlar</span><span class="sxs-lookup"><span data-stu-id="dc2cc-121">Thread-Relative Static Fields</span></span>  
 <span data-ttu-id="dc2cc-122">Bir veri parçasının her zaman bir iş parçacığı ve uygulama-etki alanı birleşimine benzersiz olduğunu biliyorsanız, <xref:System.ThreadStaticAttribute> özniteliğini statik alana uygulayın.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-122">If you know that a piece of data is always unique to a thread and application-domain combination, apply the <xref:System.ThreadStaticAttribute> attribute to the static field.</span></span> <span data-ttu-id="dc2cc-123">Diğer herhangi bir statik alanı kullandığınız için alanı kullanın.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-123">Use the field as you would use any other static field.</span></span> <span data-ttu-id="dc2cc-124">Alanındaki veriler, onu kullanan her iş parçacığı için benzersizdir.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-124">The data in the field is unique to each thread that uses it.</span></span>  
  
 <span data-ttu-id="dc2cc-125">İş parçacığı göreli statik alanları, veri yuvalardan daha iyi performans sağlar ve derleme zamanı tür denetimi avantajına sahiptir.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-125">Thread-relative static fields provide better performance than data slots and have the benefit of compile-time type checking.</span></span>  
  
 <span data-ttu-id="dc2cc-126">Tüm sınıf Oluşturucu kodunun alana erişen ilk bağlamdaki ilk iş parçacığında çalışacağını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-126">Be aware that any class constructor code will run on the first thread in the first context that accesses the field.</span></span> <span data-ttu-id="dc2cc-127">Aynı uygulama etki alanındaki diğer tüm iş parçacıklarında veya bağlamlarda, alanlar `null` `Nothing` başvuru türlerseler (Visual Basic olarak) veya değer türlerseler varsayılan değerleriyle başlatılır.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-127">In all other threads or contexts in the same application domain, the fields will be initialized to `null` (`Nothing` in Visual Basic) if they are reference types, or to their default values if they are value types.</span></span> <span data-ttu-id="dc2cc-128">Bu nedenle, iş parçacığı göreli statik alanlarını başlatmak için sınıf oluşturucularına güvenmemelisiniz.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-128">Therefore, you should not rely on class constructors to initialize thread-relative static fields.</span></span> <span data-ttu-id="dc2cc-129">Bunun yerine, iş parçacığı göreli statik alanları başlatmaktan kaçının ve bunların `null` ( `Nothing` ) ya da varsayılan değerlerine başlatıldığını varsayın.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-129">Instead, avoid initializing thread-relative static fields and assume that they are initialized to `null` (`Nothing`) or to their default values.</span></span>  
  
## <a name="data-slots"></a><span data-ttu-id="dc2cc-130">Veri yuvaları</span><span class="sxs-lookup"><span data-stu-id="dc2cc-130">Data Slots</span></span>  

<span data-ttu-id="dc2cc-131">.NET, iş parçacığı ve uygulama etki alanı birleşimine özgü dinamik veri yuvaları sağlar.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-131">.NET provides dynamic data slots that are unique to a combination of thread and application domain.</span></span> <span data-ttu-id="dc2cc-132">İki tür veri yuvası vardır: adlandırılmış yuvalar ve adlandırılmamış yuvalar.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-132">There are two types of data slots: named slots and unnamed slots.</span></span> <span data-ttu-id="dc2cc-133">Her ikisi de yapı kullanılarak uygulanır <xref:System.LocalDataStoreSlot> .</span><span class="sxs-lookup"><span data-stu-id="dc2cc-133">Both are implemented by using the <xref:System.LocalDataStoreSlot> structure.</span></span>  
  
- <span data-ttu-id="dc2cc-134">Adlandırılmış bir veri yuvası oluşturmak için <xref:System.Threading.Thread.AllocateNamedDataSlot%2A?displayProperty=nameWithType> veya <xref:System.Threading.Thread.GetNamedDataSlot%2A?displayProperty=nameWithType> yöntemini kullanın.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-134">To create a named data slot, use the <xref:System.Threading.Thread.AllocateNamedDataSlot%2A?displayProperty=nameWithType> or <xref:System.Threading.Thread.GetNamedDataSlot%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="dc2cc-135">Var olan bir adlandırılmış yuvaya başvuru almak için, adını <xref:System.Threading.Thread.GetNamedDataSlot%2A> yöntemine geçirin.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-135">To get a reference to an existing named slot, pass its name to the <xref:System.Threading.Thread.GetNamedDataSlot%2A> method.</span></span>  
  
- <span data-ttu-id="dc2cc-136">Adlandırılmamış bir veri yuvası oluşturmak için <xref:System.Threading.Thread.AllocateDataSlot%2A?displayProperty=nameWithType> yöntemini kullanın.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-136">To create an unnamed data slot, use the <xref:System.Threading.Thread.AllocateDataSlot%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="dc2cc-137">Hem adlandırılmış hem de adlandırılmamış yuvalarda, <xref:System.Threading.Thread.SetData%2A?displayProperty=nameWithType> <xref:System.Threading.Thread.GetData%2A?displayProperty=nameWithType> yuvadaki bilgileri ayarlamak ve almak için ve yöntemlerini kullanın.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-137">For both named and unnamed slots, use the <xref:System.Threading.Thread.SetData%2A?displayProperty=nameWithType> and <xref:System.Threading.Thread.GetData%2A?displayProperty=nameWithType> methods to set and retrieve the information in the slot.</span></span> <span data-ttu-id="dc2cc-138">Bunlar, şu anda yürütülmekte olan iş parçacığı için verileri her zaman işleyen statik yöntemlerdir.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-138">These are static methods that always act on the data for the thread that is currently executing them.</span></span>  
  
 <span data-ttu-id="dc2cc-139">Adlandırılmış yuvalar kullanışlı olabilir, çünkü <xref:System.Threading.Thread.GetNamedDataSlot%2A> Adsız bir yuvaya bir başvuru tutmak yerine, adını yöntemine geçirerek bu yuvayı elde edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-139">Named slots can be convenient, because you can retrieve the slot when you need it by passing its name to the <xref:System.Threading.Thread.GetNamedDataSlot%2A> method, instead of maintaining a reference to an unnamed slot.</span></span> <span data-ttu-id="dc2cc-140">Ancak, başka bir bileşen iş parçacığı göreli depolaması için aynı adı kullanıyorsa ve bir iş parçacığı hem bileşeninizden hem de diğer bileşenden kod çalıştırırsa, iki bileşen birbirlerinin verilerinin bozulmasına neden olabilirler.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-140">However, if another component uses the same name for its thread-relative storage and a thread executes code from both your component and the other component, the two components might corrupt each other's data.</span></span> <span data-ttu-id="dc2cc-141">(Bu senaryo her iki bileşenin aynı uygulama etki alanında çalıştığını ve aynı verilerin paylaşılması için tasarlanmadığı varsayılır.)</span><span class="sxs-lookup"><span data-stu-id="dc2cc-141">(This scenario assumes that both components are running in the same application domain, and that they are not designed to share the same data.)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dc2cc-142">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="dc2cc-142">See also</span></span>

- <xref:System.ContextStaticAttribute>
- <xref:System.Threading.Thread.GetNamedDataSlot%2A?displayProperty=nameWithType>
- <xref:System.ThreadStaticAttribute>
- <xref:System.Runtime.Remoting.Messaging.CallContext>
- [<span data-ttu-id="dc2cc-143">İş Parçacığı Oluşturma</span><span class="sxs-lookup"><span data-stu-id="dc2cc-143">Threading</span></span>](index.md)
