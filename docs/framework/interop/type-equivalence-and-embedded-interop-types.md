---
title: Tür eşdeğerliği ve katıştırılmış birlikte çalışma türleri
description: Yönetilen bir derleme ve bu derlemeye gömülü COM türleri arasında .NET türleri ve üyeleri arasında tür eşdeğerliği anlayın. .NET 4 ve üzeri için.
ms.date: 03/30/2017
helpviewer_keywords:
- type equivalence
- embedded interop types
- primary interop assemblies,not necessary in CLR version 4
- NoPIA
ms.assetid: 78892eba-2a58-4165-b4b1-0250ee2f41dc
ms.openlocfilehash: 2d572133c42f01af7d50f6f771588f5173853f9a
ms.sourcegitcommit: 97ce5363efa88179dd76e09de0103a500ca9b659
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/13/2020
ms.locfileid: "86282014"
---
# <a name="type-equivalence-and-embedded-interop-types"></a><span data-ttu-id="ace3e-104">Tür eşdeğerliği ve katıştırılmış birlikte çalışma türleri</span><span class="sxs-lookup"><span data-stu-id="ace3e-104">Type equivalence and embedded interop types</span></span>

<span data-ttu-id="ace3e-105">.NET Framework 4 ' ten başlayarak, ortak dil çalışma zamanı, yönetilen derlemelerin, birlikte çalışabilirlik derlemelerinden COM türleri için tür bilgilerini almasını gerektirmek yerine, COM türleri için tür bilgilerini doğrudan yönetilen derlemelere katıştırmayı destekler.</span><span class="sxs-lookup"><span data-stu-id="ace3e-105">Beginning with the .NET Framework 4, the common language runtime supports embedding type information for COM types directly into managed assemblies, instead of requiring the managed assemblies to obtain type information for COM types from interop assemblies.</span></span> <span data-ttu-id="ace3e-106">Gömülü tür bilgileri yalnızca yönetilen bir derleme tarafından gerçekten kullanılan türleri ve üyeleri içerdiğinden, iki yönetilen derleme aynı COM türünde çok farklı görünümlere sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="ace3e-106">Because the embedded type information includes only the types and members that are actually used by a managed assembly, two managed assemblies might have very different views of the same COM type.</span></span> <span data-ttu-id="ace3e-107">Her yönetilen derlemenin, <xref:System.Type> com türünün görünümünü temsil eden farklı bir nesnesi vardır.</span><span class="sxs-lookup"><span data-stu-id="ace3e-107">Each managed assembly has a different <xref:System.Type> object to represent its view of the COM type.</span></span> <span data-ttu-id="ace3e-108">Ortak dil çalışma zamanı, arabirimler, yapılar, numaralandırmalar ve temsilciler için bu farklı görünümler arasında tür eşdeğerliği destekler.</span><span class="sxs-lookup"><span data-stu-id="ace3e-108">The common language runtime supports type equivalence between these different views for interfaces, structures, enumerations, and delegates.</span></span>

<span data-ttu-id="ace3e-109">Tür eşdeğerliği, yönetilen bir derlemeden diğerine geçirilen bir COM nesnesinin, alıcı derlemede uygun yönetilen türe yayınlanmasını anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="ace3e-109">Type equivalence means that a COM object that is passed from one managed assembly to another can be cast to the appropriate managed type in the receiving assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="ace3e-110">Tür denklik ve katıştırılmış birlikte çalışma türleri, uygulamalarla birlikte çalışma derlemeleri dağıtmak gerekli olmadığı için COM bileşenlerini kullanan uygulamaların ve eklentilerin dağıtımını basitleştirir.</span><span class="sxs-lookup"><span data-stu-id="ace3e-110">Type equivalence and embedded interop types simplify the deployment of applications and add-ins that use COM components, because it is not necessary to deploy interop assemblies with the applications.</span></span> <span data-ttu-id="ace3e-111">Paylaşılan COM bileşenlerinden oluşan geliştiricilerin, bileşenlerinin önceki .NET Framework sürümleri tarafından kullanılmasını istiyorsanız birincil birlikte çalışma derlemeleri (PIA 'lar) oluşturması gerekir.</span><span class="sxs-lookup"><span data-stu-id="ace3e-111">Developers of shared COM components still have to create primary interop assemblies (PIAs) if they want their components to be used by earlier versions of the .NET Framework.</span></span>

## <a name="type-equivalence"></a><span data-ttu-id="ace3e-112">Tür denklik</span><span class="sxs-lookup"><span data-stu-id="ace3e-112">Type equivalence</span></span>

 <span data-ttu-id="ace3e-113">Arabirimler, yapılar, numaralandırmalar ve temsilciler için COM türlerinin denklik 'i desteklenir.</span><span class="sxs-lookup"><span data-stu-id="ace3e-113">Equivalence of COM types is supported for interfaces, structures, enumerations, and delegates.</span></span> <span data-ttu-id="ace3e-114">Aşağıdaki koşulların tümü doğruysa COM türleri eşdeğer olarak niteler:</span><span class="sxs-lookup"><span data-stu-id="ace3e-114">COM types qualify as equivalent if all of the following are true:</span></span>

- <span data-ttu-id="ace3e-115">Türler hem arabirimlerdir, hem de her iki yapı veya her ikisi de temsilcisdir.</span><span class="sxs-lookup"><span data-stu-id="ace3e-115">The types are both interfaces, or both structures, or both enumerations, or both delegates.</span></span>

- <span data-ttu-id="ace3e-116">Türler, sonraki bölümde açıklandığı gibi aynı kimliğe sahiptir.</span><span class="sxs-lookup"><span data-stu-id="ace3e-116">The types have the same identity, as described in the next section.</span></span>

- <span data-ttu-id="ace3e-117">Her iki tür de, tür denklik [IÇIN com türlerini işaretleme](#marking-com-types-for-type-equivalence) bölümünde açıklandığı gibi tür denklik için uygundur.</span><span class="sxs-lookup"><span data-stu-id="ace3e-117">Both types are eligible for type equivalence, as described in the [Marking COM types for type equivalence](#marking-com-types-for-type-equivalence) section.</span></span>

### <a name="type-identity"></a><span data-ttu-id="ace3e-118">Tür kimliği</span><span class="sxs-lookup"><span data-stu-id="ace3e-118">Type identity</span></span>

<span data-ttu-id="ace3e-119">İki tür, kapsamları ve kimlikleri eşleşiyorsa aynı kimliğe sahip olacak şekilde belirlenir, diğer bir deyişle, her birinin <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> özniteliği varsa ve iki özniteliğin eşleşen <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> ve <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> özellikleri vardır.</span><span class="sxs-lookup"><span data-stu-id="ace3e-119">Two types are determined to have the same identity when their scopes and identities match, in other words, if they each have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, and the two attributes have matching <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> and <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> properties.</span></span> <span data-ttu-id="ace3e-120">İçin karşılaştırma <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> büyük/küçük harfe duyarlıdır.</span><span class="sxs-lookup"><span data-stu-id="ace3e-120">The comparison for <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> is case-insensitive.</span></span>

<span data-ttu-id="ace3e-121">Bir türün <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> özniteliği yoksa veya <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> kapsam ve tanımlayıcı belirtmeyen bir özniteliği varsa, tür şu şekilde denklik için de kabul edilebilir:</span><span class="sxs-lookup"><span data-stu-id="ace3e-121">If a type does not have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, or if it has a <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute that does not specify scope and identifier, the type can still be considered for equivalence as follows:</span></span>

- <span data-ttu-id="ace3e-122">Arabirimler için, özelliği yerine öğesinin değeri <xref:System.Runtime.InteropServices.GuidAttribute> kullanılır <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> ve özelliği <xref:System.Type.FullName%2A?displayProperty=nameWithType> (diğer bir deyişle, ad alanı dahil olmak üzere tür adı), özelliği yerine kullanılır <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="ace3e-122">For interfaces, the value of the <xref:System.Runtime.InteropServices.GuidAttribute> is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property (that is, the type name, including the namespace) is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="ace3e-123">Yapılar, numaralandırmalar ve temsilciler için, <xref:System.Runtime.InteropServices.GuidAttribute> kapsayan derlemenin özelliği yerine kullanılır ve özelliği özelliği <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> <xref:System.Type.FullName%2A?displayProperty=nameWithType> yerine kullanılır <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> .</span><span class="sxs-lookup"><span data-stu-id="ace3e-123">For structures, enumerations, and delegates, the <xref:System.Runtime.InteropServices.GuidAttribute> of the containing assembly is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> property.</span></span>

### <a name="marking-com-types-for-type-equivalence"></a><span data-ttu-id="ace3e-124">Tür denklik için COM türleri işaretleniyor</span><span class="sxs-lookup"><span data-stu-id="ace3e-124">Marking COM types for type equivalence</span></span>

 <span data-ttu-id="ace3e-125">Tür denklik için uygun bir türü iki şekilde işaretleyebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="ace3e-125">You can mark a type as eligible for type equivalence in two ways:</span></span>

- <span data-ttu-id="ace3e-126"><xref:System.Runtime.InteropServices.TypeIdentifierAttribute>Özniteliği türüne uygulayın.</span><span class="sxs-lookup"><span data-stu-id="ace3e-126">Apply the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute to the type.</span></span>

- <span data-ttu-id="ace3e-127">Türü bir COM içeri aktarma türü yapın.</span><span class="sxs-lookup"><span data-stu-id="ace3e-127">Make the type a COM import type.</span></span> <span data-ttu-id="ace3e-128">Bir arabirim, özniteliği varsa COM içeri aktarma türüdür <xref:System.Runtime.InteropServices.ComImportAttribute> .</span><span class="sxs-lookup"><span data-stu-id="ace3e-128">An interface is a COM import type if it has the <xref:System.Runtime.InteropServices.ComImportAttribute> attribute.</span></span> <span data-ttu-id="ace3e-129">Arabirim, yapı, numaralandırma veya temsilci, tanımlanan derlemenin özniteliği varsa COM içeri aktarma türüdür <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> .</span><span class="sxs-lookup"><span data-stu-id="ace3e-129">An interface, structure, enumeration, or delegate is a COM import type if the assembly in which it is defined has the <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> attribute.</span></span>

## <a name="see-also"></a><span data-ttu-id="ace3e-130">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="ace3e-130">See also</span></span>

- <xref:System.Type.IsEquivalentTo%2A>
- <span data-ttu-id="ace3e-131">[Yönetilen kodda COM türlerini kullanma](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="ace3e-131">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="ace3e-132">Tür Kitaplığını Derleme Olarak İçeri Aktarma</span><span class="sxs-lookup"><span data-stu-id="ace3e-132">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)
