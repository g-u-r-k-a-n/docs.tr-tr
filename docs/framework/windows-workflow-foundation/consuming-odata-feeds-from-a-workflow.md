---
title: İş akışından OData akışlarını kullanma-WF
ms.date: 03/30/2017
ms.assetid: 1b26617c-53e9-476a-81af-675c36d95919
ms.openlocfilehash: ceac2c2d07351fcb79e2345068f07fa22f356411
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/24/2020
ms.locfileid: "76743785"
---
# <a name="consuming-odata-feeds-from-a-workflow"></a><span data-ttu-id="b54f9-102">Bir iş akışından OData akışlarını kullanma</span><span class="sxs-lookup"><span data-stu-id="b54f9-102">Consuming OData feeds from a workflow</span></span>

<span data-ttu-id="b54f9-103">WCF Veri Hizmetleri, temsili durum aktarımı (REST) semantiğini kullanarak Web veya intranet üzerinden veri sunmak ve kullanmak için açık veri Protokolü 'Nü (OData) kullanan hizmetler oluşturmanızı sağlayan bir .NET Framework bileşenidir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-103">WCF Data Services is a component of the .NET Framework that enables you to create services that use the Open Data Protocol (OData) to expose and consume data over the Web or intranet by using the semantics of representational state transfer (REST).</span></span> <span data-ttu-id="b54f9-104">OData, verileri URI 'Ler tarafından adreslenebilir kaynaklar olarak kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-104">OData exposes data as resources that are addressable by URIs.</span></span> <span data-ttu-id="b54f9-105">Bir HTTP isteği gönderebileceği ve bir veri hizmetinin döndürdüğü OData akışını işlebiliyorsanız, herhangi bir uygulama OData tabanlı bir veri hizmetiyle etkileşim kurabilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-105">Any application can interact with an OData-based data service if it can send an HTTP request and process the OData feed that a data service returns.</span></span> <span data-ttu-id="b54f9-106">Ayrıca WCF Veri Hizmetleri, .NET Framework uygulamalardan OData akışlarını kullanırken daha zengin bir programlama deneyimi sağlayan istemci kitaplıklarını içerir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-106">In addition, WCF Data Services includes client libraries that provide a richer programming experience when you consume OData feeds from .NET Framework applications.</span></span> <span data-ttu-id="b54f9-107">Bu konu, istemci kitaplıklarını kullanmadan ve ile bir iş akışında OData akışını kullanmaya genel bir bakış sağlar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-107">This topic provides an overview of consuming an OData feed in a workflow with and without using the client libraries.</span></span>

## <a name="using-the-sample-northwind-odata-service"></a><span data-ttu-id="b54f9-108">Örnek Northwind OData hizmetini kullanma</span><span class="sxs-lookup"><span data-stu-id="b54f9-108">Using the sample Northwind OData service</span></span>

<span data-ttu-id="b54f9-109">Bu konudaki örneklerde <https://services.odata.org/Northwind/Northwind.svc/>konumunda bulunan örnek Northwind veri hizmeti kullanılmaktadır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-109">The examples in this topic use the sample Northwind data service located at <https://services.odata.org/Northwind/Northwind.svc/>.</span></span> <span data-ttu-id="b54f9-110">Bu hizmet [OData SDK 'sının](https://www.odata.org/ecosystem/#sdk) bir parçası olarak sağlanır ve örnek Northwind veritabanına salt okuma erişimi sağlar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-110">This service is provided as part of the [OData SDK](https://www.odata.org/ecosystem/#sdk) and provides read-only access to the sample Northwind database.</span></span> <span data-ttu-id="b54f9-111">Yazma erişimi isteniyorsa veya yerel bir WCF veri hizmeti isteniyorsa, Northwind veritabanına erişim sağlayan yerel bir OData hizmeti oluşturmak için [WCF veri hizmetleri hızlı başlangıç](../data/wcf/quickstart-wcf-data-services.md) adımlarını izleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="b54f9-111">If write access is desired, or if a local WCF Data Service is desired, you can follow the steps of the [WCF Data Services Quickstart](../data/wcf/quickstart-wcf-data-services.md) to create a local OData service that provides access to the Northwind database.</span></span> <span data-ttu-id="b54f9-112">Hızlı başlangıcı izlerseniz, bu konudaki örnek kodda belirtilen bir yerel URI 'yi yerine koyun.</span><span class="sxs-lookup"><span data-stu-id="b54f9-112">If you follow the quickstart, substitute the local URI for the one provided in the example code in this topic.</span></span>

## <a name="consuming-an-odata-feed-using-the-client-libraries"></a><span data-ttu-id="b54f9-113">İstemci kitaplıklarını kullanarak OData akışını kullanma</span><span class="sxs-lookup"><span data-stu-id="b54f9-113">Consuming an OData feed using the client libraries</span></span>

<span data-ttu-id="b54f9-114">WCF Veri Hizmetleri, .NET Framework ve istemci uygulamalarından bir OData akışını daha kolay bir şekilde kullanmanıza olanak tanıyan istemci kitaplıklarını içerir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-114">WCF Data Services includes client libraries that enable you to more easily consume an OData feed from .NET Framework and client applications.</span></span> <span data-ttu-id="b54f9-115">Bu kitaplıklar HTTP iletileri göndermeyi ve almayı basitleştirir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-115">These libraries simplify sending and receiving HTTP messages.</span></span> <span data-ttu-id="b54f9-116">Ayrıca, ileti yükünü varlık verilerini temsil eden CLR nesnelerine çevirirler.</span><span class="sxs-lookup"><span data-stu-id="b54f9-116">They also translate the message payload into CLR objects that represent entity data.</span></span> <span data-ttu-id="b54f9-117">İstemci kitaplıkları, <xref:System.Data.Services.Client.DataServiceContext> ve <xref:System.Data.Services.Client.DataServiceQuery%601>iki çekirdek sınıfı özelliğidir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-117">The client libraries feature the two core classes <xref:System.Data.Services.Client.DataServiceContext> and <xref:System.Data.Services.Client.DataServiceQuery%601>.</span></span> <span data-ttu-id="b54f9-118">Bu sınıflar bir veri hizmetini sorgulamanızı ve ardından döndürülen varlık verileriyle CLR nesneleri olarak çalışmanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-118">These classes enable you to query a data service and then work with the returned entity data as CLR objects.</span></span> <span data-ttu-id="b54f9-119">Bu bölümde, istemci kitaplıklarını kullanan etkinlikleri oluşturmaya yönelik iki yaklaşım ele alınmaktadır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-119">This section covers two approaches to creating activities that use the client libraries.</span></span>

### <a name="adding-a-service-reference-to-the-wcf-data-service"></a><span data-ttu-id="b54f9-120">WCF veri hizmetine hizmet başvurusu ekleme</span><span class="sxs-lookup"><span data-stu-id="b54f9-120">Adding a service reference to the WCF Data service</span></span>

<span data-ttu-id="b54f9-121">Northwind istemci kitaplıklarını oluşturmak için, Northwind OData hizmetine bir başvuru eklemek üzere Visual Studio 2012 ' deki **hizmet başvurusu Ekle** iletişim kutusunu kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="b54f9-121">To generate the Northwind client libraries, you can use the **Add Service Reference** dialog box in Visual Studio 2012 to add a reference to the Northwind OData service.</span></span>

![Hizmet Başvurusu Ekle iletişim kutusunu gösteren ekran görüntüsü.](./media/consuming-odata-feeds-from-a-workflow/add-service-reference-dialog.gif)

<span data-ttu-id="b54f9-123">Hizmet tarafından sunulan hizmet işlemleri olmadığını ve **Hizmetler** listesinde, Northwind Data Service tarafından sunulan varlıkları temsil eden öğeler olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="b54f9-123">Note that there are no service operations exposed by the service, and in the **Services** list there are items representing the entities exposed by the Northwind data service.</span></span> <span data-ttu-id="b54f9-124">Hizmet başvurusu eklendiğinde, bu varlıklar için sınıflar oluşturulacaktır ve istemci kodunda kullanılabilirler.</span><span class="sxs-lookup"><span data-stu-id="b54f9-124">When the service reference is added, classes will be generated for these entities and they can be used in the client code.</span></span> <span data-ttu-id="b54f9-125">Bu konudaki örnekler, sorguları gerçekleştirmek için bu sınıfları ve `NorthwindEntities` sınıfını kullanır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-125">The examples in this topic use these classes and the `NorthwindEntities` class to perform the queries.</span></span>

> [!NOTE]
> <span data-ttu-id="b54f9-126">Daha fazla bilgi için bkz. [veri hizmeti Istemci kitaplığı oluşturma (WCF veri Hizmetleri)](../data/wcf/generating-the-data-service-client-library-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="b54f9-126">For more information, see [Generating the Data Service Client Library (WCF Data Services)](../data/wcf/generating-the-data-service-client-library-wcf-data-services.md).</span></span>

### <a name="using-asynchronous-methods"></a><span data-ttu-id="b54f9-127">Zaman uyumsuz yöntemler kullanma</span><span class="sxs-lookup"><span data-stu-id="b54f9-127">Using asynchronous methods</span></span>

<span data-ttu-id="b54f9-128">Web üzerinden kaynaklara erişirken oluşabilecek olası gecikme sorunlarını gidermek için WCF Veri Hizmetleri zaman uyumsuz olarak erişmenizi öneririz.</span><span class="sxs-lookup"><span data-stu-id="b54f9-128">To address possible latency issues that may occur when accessing resources over the Web, we recommend accessing WCF Data Services asynchronously.</span></span> <span data-ttu-id="b54f9-129">WCF Veri Hizmetleri istemci kitaplıkları sorguları çağırmak için zaman uyumsuz yöntemler içerir ve Windows Workflow Foundation (WF) zaman uyumsuz etkinlikleri yazmak için <xref:System.Activities.AsyncCodeActivity> sınıfını sağlar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-129">The WCF Data Services client libraries include asynchronous methods for invoking queries, and Windows Workflow Foundation (WF) provides the <xref:System.Activities.AsyncCodeActivity> class for authoring asynchronous activities.</span></span> <span data-ttu-id="b54f9-130"><xref:System.Activities.AsyncCodeActivity> türetilmiş etkinlikler, zaman uyumsuz yöntemlere sahip .NET Framework sınıflarından yararlanmak için yazılabilir veya zaman uyumsuz olarak yürütülecek kod bir yönteme yerleştirilebilir ve bir temsilci kullanılarak çağrılabilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-130"><xref:System.Activities.AsyncCodeActivity> derived activities can be written to take advantage of .NET Framework classes that have asynchronous methods, or the code to be executed asynchronously can be put into a method and invoked by using a delegate.</span></span> <span data-ttu-id="b54f9-131">Bu bölümde, <xref:System.Activities.AsyncCodeActivity> türetilmiş bir etkinliğin iki örneği sunulmaktadır; biri, WCF Veri Hizmetleri istemci kitaplıklarının zaman uyumsuz yöntemlerini ve bir temsilciyi kullanan birini kullanır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-131">This section provides two examples of an <xref:System.Activities.AsyncCodeActivity> derived activity; one that uses the asynchronous methods of the WCF Data Services client libraries and one that uses a delegate.</span></span>

> [!NOTE]
> <span data-ttu-id="b54f9-132">Daha fazla bilgi için bkz. [zaman uyumsuz işlemler (WCF veri Hizmetleri)](../data/wcf/asynchronous-operations-wcf-data-services.md) ve [zaman uyumsuz etkinlikler oluşturma](creating-asynchronous-activities-in-wf.md).</span><span class="sxs-lookup"><span data-stu-id="b54f9-132">For more information, see [Asynchronous Operations (WCF Data Services)](../data/wcf/asynchronous-operations-wcf-data-services.md) and [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).</span></span>

### <a name="using-client-library-asynchronous-methods"></a><span data-ttu-id="b54f9-133">İstemci kitaplığı zaman uyumsuz yöntemlerini kullanma</span><span class="sxs-lookup"><span data-stu-id="b54f9-133">Using client library asynchronous methods</span></span>

<span data-ttu-id="b54f9-134"><xref:System.Data.Services.Client.DataServiceQuery%601> sınıfı, bir OData hizmetini zaman uyumsuz olarak sorgulamak için <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> ve <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> yöntemler sağlar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-134">The <xref:System.Data.Services.Client.DataServiceQuery%601> class provides <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> and <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> methods for querying an OData service asynchronously.</span></span> <span data-ttu-id="b54f9-135">Bu yöntemler <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> çağrılabilir ve <xref:System.Activities.AsyncCodeActivity> türetilen bir sınıfın geçersiz kılmaları <xref:System.Activities.AsyncCodeActivity.EndExecute%2A>.</span><span class="sxs-lookup"><span data-stu-id="b54f9-135">These methods can be called from the <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> overrides of an <xref:System.Activities.AsyncCodeActivity> derived class.</span></span> <span data-ttu-id="b54f9-136"><xref:System.Activities.AsyncCodeActivity> <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> geçersiz kılma döndüğünde, iş akışı boşta geçebilir (ancak kalıcı değil) ve zaman uyumsuz iş tamamlandığında, <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> çalışma zamanı tarafından çağrılır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-136">When the <xref:System.Activities.AsyncCodeActivity> <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override returns, the workflow can go idle (but not persist), and when the asynchronous work is completed, <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> is invoked by the runtime.</span></span>

<span data-ttu-id="b54f9-137">Aşağıdaki örnekte, iki giriş bağımsız değişkeni olan bir `OrdersByCustomer` etkinliği tanımlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-137">In the following example, an `OrdersByCustomer` activity is defined that has two input arguments.</span></span> <span data-ttu-id="b54f9-138">`CustomerId` bağımsız değişkeni döndürülecek siparişleri tanımlayan müşteriyi temsil eder ve `ServiceUri` bağımsız değişkeni Sorgulanacak OData hizmetinin URI 'sini temsil eder.</span><span class="sxs-lookup"><span data-stu-id="b54f9-138">The `CustomerId` argument represents the customer who identifies which orders to return, and the `ServiceUri` argument represents the URI of the OData service to be queried.</span></span> <span data-ttu-id="b54f9-139">Etkinlik `AsyncCodeActivity<IEnumerable<Order>>` türetildiğinden, sorgunun sonuçlarını döndürmek için kullanılan bir <xref:System.Activities.Activity%601.Result%2A> çıkış bağımsız değişkeni de vardır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-139">Because the activity derives from `AsyncCodeActivity<IEnumerable<Order>>` there is also a <xref:System.Activities.Activity%601.Result%2A> output argument that is used to return the results of the query.</span></span> <span data-ttu-id="b54f9-140"><xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override, belirtilen müşterinin tüm emirlerini seçen bir LINQ sorgusu oluşturur.</span><span class="sxs-lookup"><span data-stu-id="b54f9-140">The <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override creates a LINQ query that selects all orders of the specified customer.</span></span> <span data-ttu-id="b54f9-141">Bu sorgu, geçirilen <xref:System.Activities.AsyncCodeActivityContext><xref:System.Activities.AsyncCodeActivityContext.UserState%2A> olarak belirtilir ve sonra sorgunun <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-141">This query is specified as the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A> of the passed <xref:System.Activities.AsyncCodeActivityContext>, and then the query's <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> method is called.</span></span> <span data-ttu-id="b54f9-142">Sorgunun <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> geçirilen geri çağırma ve durumun, etkinliğin <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> yöntemine geçirilmiş olanlardır olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="b54f9-142">Note that the callback and state that are passed into the query's <xref:System.Data.Services.Client.DataServiceQuery%601.BeginExecute%2A> are the ones that are passed in to the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> method.</span></span> <span data-ttu-id="b54f9-143">Sorgunun yürütülmesi bittiğinde, etkinliğin <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> yöntemi çağrılır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-143">When the query has finished executing, the activity's <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> method is invoked.</span></span> <span data-ttu-id="b54f9-144">Sorgu <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>alınır ve ardından sorgunun <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> yöntemi çağırılır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-144">The query is retrieved from the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, and then the query's <xref:System.Data.Services.Client.DataServiceQuery%601.EndExecute%2A> method is called.</span></span> <span data-ttu-id="b54f9-145">Bu yöntem, belirtilen varlık türünün bir <xref:System.Collections.Generic.IEnumerable%601> döndürür; Bu durumda `Order`.</span><span class="sxs-lookup"><span data-stu-id="b54f9-145">This method returns an <xref:System.Collections.Generic.IEnumerable%601> of the specified entity type; in this case `Order`.</span></span> <span data-ttu-id="b54f9-146">`IEnumerable<Order>` <xref:System.Activities.AsyncCodeActivity%601>genel türü olduğundan, bu <xref:System.Collections.IEnumerable> etkinliğin <xref:System.Activities.Activity%601.Result%2A> <xref:System.Activities.OutArgument%601> olarak ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-146">Since `IEnumerable<Order>` is the generic type of the <xref:System.Activities.AsyncCodeActivity%601>, this <xref:System.Collections.IEnumerable> is set as the <xref:System.Activities.Activity%601.Result%2A> <xref:System.Activities.OutArgument%601> of the activity.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#100](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#100)]

<span data-ttu-id="b54f9-147">Aşağıdaki örnekte, `OrdersByCustomer` etkinliği belirtilen müşteri için siparişlerin bir listesini alır ve ardından <xref:System.Activities.Statements.ForEach%601> bir etkinlik döndürülen siparişleri numaralandırır ve her bir siparişin tarihini konsola yazar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-147">In the following example, the `OrdersByCustomer` activity retrieves a list of orders for the specified customer, and then a <xref:System.Activities.Statements.ForEach%601> activity enumerates the returned orders and writes the date of each order to the console.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#10](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#10)]

<span data-ttu-id="b54f9-148">Bu iş akışı çağrıldığında, konsola aşağıdaki veriler yazılır:</span><span class="sxs-lookup"><span data-stu-id="b54f9-148">When this workflow is invoked, the following data is written to the console:</span></span>

```console
Calling WCF Data Service...
8/25/1997
10/3/1997
10/13/1997
1/15/1998
3/16/1998
4/9/1998
```

> [!NOTE]
> <span data-ttu-id="b54f9-149">OData sunucusuyla bağlantı kurulamazsa, aşağıdaki özel duruma benzer bir özel durum alırsınız:</span><span class="sxs-lookup"><span data-stu-id="b54f9-149">If a connection to the OData server cannot be established, you will get an exception similar to the following exception:</span></span>
>
> <span data-ttu-id="b54f9-150">İşlenmeyen özel durum: System. InvalidOperationException: Bu istek işlenirken bir hata oluştu.</span><span class="sxs-lookup"><span data-stu-id="b54f9-150">Unhandled Exception: System.InvalidOperationException: An error occurred while processing this request.</span></span> <span data-ttu-id="b54f9-151">---> System .net. WebException: uzak sunucuya bağlanılamıyor---> System .net. Sockets. SocketException: bağlı olan taraf bir süre sonra düzgün bir şekilde yanıt vermediğinden veya bağlantı kurulamadığı için bağlantı girişimi başarısız oldu bağlı konak yanıt veremediği için.</span><span class="sxs-lookup"><span data-stu-id="b54f9-151">---> System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.</span></span>

<span data-ttu-id="b54f9-152">Sorgu tarafından döndürülen verilerin herhangi bir ek işlemesi gerekliyse, etkinliğin <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> geçersiz kılması durumunda yapılabilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-152">If any additional processing of the data returned by the query is required, it can be done in the activity's <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> override.</span></span> <span data-ttu-id="b54f9-153">Hem <xref:System.Activities.AsyncCodeActivity%601.BeginExecute%2A> hem de <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> iş akışı iş parçacığı kullanılarak çağrılır ve bu geçersiz Kılmalarda bulunan tüm kodlar zaman uyumsuz olarak çalışmaz.</span><span class="sxs-lookup"><span data-stu-id="b54f9-153">Both <xref:System.Activities.AsyncCodeActivity%601.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> are invoked by using the workflow thread, and any code in these overrides does not run asynchronously.</span></span> <span data-ttu-id="b54f9-154">Ek işlem kapsamlı veya uzun süre çalışıyorsa veya sorgu sonuçları disk belleğine alınerirse, sorguyu yürütmek ve zaman uyumsuz olarak ek işlem gerçekleştirmek için bir temsilci kullanan sonraki bölümde ele alınan yaklaşımı göz önünde bulundurmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-154">If the additional processing is extensive or long-running, or the query results are paged, you should consider the approach discussed in the next section, which uses a delegate to execute the query and perform additional processing asynchronously.</span></span>

### <a name="using-a-delegate"></a><span data-ttu-id="b54f9-155">Temsilci kullanma</span><span class="sxs-lookup"><span data-stu-id="b54f9-155">Using a delegate</span></span>

<span data-ttu-id="b54f9-156">Bir .NET Framework sınıfın zaman uyumsuz yöntemini çağırmaya ek olarak, <xref:System.Activities.AsyncCodeActivity>tabanlı bir etkinlik, yöntemlerinden birindeki zaman uyumsuz mantığı da tanımlayabilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-156">In addition to invoking the asynchronous method of a .NET Framework class, an <xref:System.Activities.AsyncCodeActivity>-based activity can also define the asynchronous logic in one of its methods.</span></span> <span data-ttu-id="b54f9-157">Bu yöntem, etkinliğin <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> geçersiz kılmada bir temsilci kullanılarak belirtilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-157">This method is specified by using a delegate in the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override.</span></span> <span data-ttu-id="b54f9-158">Yöntem döndüğünde, çalışma zamanı etkinliğin <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> geçersiz kılmayı çağırır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-158">When the method returns, the runtime invokes the activity's <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> override.</span></span> <span data-ttu-id="b54f9-159">Bir iş akışından OData hizmeti çağrılırken, bu yöntem hizmeti sorgulamak ve ek işleme sağlamak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-159">When calling an OData service from a workflow, this method can be used to query the service and provide any additional processing.</span></span>

<span data-ttu-id="b54f9-160">Aşağıdaki örnekte, bir `ListCustomers` etkinliği tanımlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-160">In the following example, a `ListCustomers` activity is defined.</span></span> <span data-ttu-id="b54f9-161">Bu etkinlik, örnek Northwind veri hizmetini sorgular ve Northwind veritabanındaki tüm müşterileri içeren bir `List<Customer>` döndürür.</span><span class="sxs-lookup"><span data-stu-id="b54f9-161">This activity queries the sample Northwind data service and returns a `List<Customer>` that contains all of the customers in the Northwind database.</span></span> <span data-ttu-id="b54f9-162">Zaman uyumsuz çalışma `GetCustomers` yöntemi tarafından gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-162">The asynchronous work is performed by the `GetCustomers` method.</span></span> <span data-ttu-id="b54f9-163">Bu yöntem, tüm müşteriler için hizmeti sorgular ve sonra bunları bir `List<Customer>`kopyalar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-163">This method queries the service for all customers, and then copies them into a `List<Customer>`.</span></span> <span data-ttu-id="b54f9-164">Sonra sonuçların disk belleğine alınmış olup olmadığını denetler.</span><span class="sxs-lookup"><span data-stu-id="b54f9-164">It then checks to see if the results are paged.</span></span> <span data-ttu-id="b54f9-165">Bu durumda, bir sonraki sonuç sayfasında hizmeti sorgular, bunları listeye ekler ve tüm müşteri verileri alınana kadar devam eder.</span><span class="sxs-lookup"><span data-stu-id="b54f9-165">If so, it queries the service for the next page of results, adds them to the list, and continues until all of the customer data has been retrieved.</span></span>

> [!NOTE]
> <span data-ttu-id="b54f9-166">WCF Veri Hizmetleri disk belleği hakkında daha fazla bilgi için bkz. [nasıl yapılır: disk belleğine yükleme (WCF veri Hizmetleri)](../data/wcf/how-to-load-paged-results-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="b54f9-166">For more information about paging in WCF Data Services, see [How to: Load Paged Results (WCF Data Services)](../data/wcf/how-to-load-paged-results-wcf-data-services.md).</span></span>

<span data-ttu-id="b54f9-167">Tüm müşteriler eklendikten sonra liste döndürülür.</span><span class="sxs-lookup"><span data-stu-id="b54f9-167">Once all customers are added, the list is returned.</span></span> <span data-ttu-id="b54f9-168">`GetCustomers` Yöntemi etkinliğin <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> geçersiz kılmada belirtilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-168">The `GetCustomers` method is specified in the activity's <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> override.</span></span> <span data-ttu-id="b54f9-169">Yöntemin bir dönüş değeri olduğundan, yöntemi belirtmek için bir `Func<string, List<Customer>>` oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="b54f9-169">Since the method has a return value, a `Func<string, List<Customer>>` is created to specify the method.</span></span>

> [!NOTE]
> <span data-ttu-id="b54f9-170">Zaman uyumsuz çalışmayı gerçekleştiren yöntemin dönüş değeri yoksa, <xref:System.Func%601>yerine bir <xref:System.Action> kullanılır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-170">If the method that performs the asynchronous work does not have a return value, an <xref:System.Action> is used instead of a <xref:System.Func%601>.</span></span> <span data-ttu-id="b54f9-171">Her iki yaklaşımı kullanarak zaman uyumsuz bir örnek oluşturma örnekleri için bkz. [zaman uyumsuz etkinlikler oluşturma](creating-asynchronous-activities-in-wf.md).</span><span class="sxs-lookup"><span data-stu-id="b54f9-171">For examples of creating an asynchronous example using both approaches, see [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).</span></span>

<span data-ttu-id="b54f9-172">Bu <xref:System.Func%601> <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>atanır ve `BeginInvoke` çağrılır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-172">This <xref:System.Func%601> is assigned to the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, and then `BeginInvoke` is called.</span></span> <span data-ttu-id="b54f9-173">Çağrılacak yöntemin etkinliğin bağımsız değişken ortamına erişimi olmadığından, `ServiceUri` bağımsız değişkeninin değeri ilk parametre olarak geçirilir, geri çağırma ve <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A>iletilen durumuyla birlikte.</span><span class="sxs-lookup"><span data-stu-id="b54f9-173">Since the method to be invoked does not have access to the activity's environment of arguments, the value of the `ServiceUri` argument is passed as the first parameter, together with the callback and state that were passed into <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A>.</span></span> <span data-ttu-id="b54f9-174">`GetCustomers` döndüğünde, çalışma zamanı <xref:System.Activities.AsyncCodeActivity.EndExecute%2A>çağırır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-174">When `GetCustomers` returns, the runtime invokes <xref:System.Activities.AsyncCodeActivity.EndExecute%2A>.</span></span> <span data-ttu-id="b54f9-175"><xref:System.Activities.AsyncCodeActivity.EndExecute%2A> kod, <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>temsilciyi alır, `EndInvoke`çağırır ve `GetCustomers` yönteminden döndürülen müşterilerin listesi olan sonucu döndürür.</span><span class="sxs-lookup"><span data-stu-id="b54f9-175">The code in <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> retrieves the delegate from the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A>, calls `EndInvoke`, and returns the result, which is the list of customers returned from the `GetCustomers` method.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#200](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#200)]

<span data-ttu-id="b54f9-176">Aşağıdaki örnekte, `ListCustomers` etkinliği müşterilerin bir listesini alır ve ardından <xref:System.Activities.Statements.ForEach%601> bir etkinlik bunları numaralandırır ve her müşterinin şirket adını ve iletişim adını konsola yazar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-176">In the following example, the `ListCustomers` activity retrieves a list of customers, and then a <xref:System.Activities.Statements.ForEach%601> activity enumerates them and writes the company name and contact name of each customer to the console.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#20](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#20)]

<span data-ttu-id="b54f9-177">Bu iş akışı çağrıldığında, konsola aşağıdaki veriler yazılır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-177">When this workflow is invoked, the following data is written to the console.</span></span> <span data-ttu-id="b54f9-178">Bu sorgu birçok müşteri döndürdüğünden, burada çıktının yalnızca bir kısmı görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-178">Since this query returns many customers, only part of the output is displayed here.</span></span>

```console
Calling WCF Data Service...
Alfreds Futterkiste, Contact: Maria Anders
Ana Trujillo Emparedados y helados, Contact: Ana Trujillo
Antonio Moreno Taquería, Contact: Antonio Moreno
Around the Horn, Contact: Thomas Hardy
Berglunds snabbköp, Contact: Christina Berglund
...
```

## <a name="consuming-an-odata-feed-without-using-the-client-libraries"></a><span data-ttu-id="b54f9-179">İstemci kitaplıklarını kullanmadan bir OData akışını kullanma</span><span class="sxs-lookup"><span data-stu-id="b54f9-179">Consuming an OData feed without using the client libraries</span></span>

<span data-ttu-id="b54f9-180">OData, verileri URI 'Ler tarafından adreslenebilir kaynaklar olarak kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-180">OData exposes data as resources that are addressable by URIs.</span></span> <span data-ttu-id="b54f9-181">İstemci kitaplıklarını kullandığınızda bu URI 'Ler sizin için oluşturulur, ancak istemci kitaplıklarını kullanmak zorunda değilsiniz.</span><span class="sxs-lookup"><span data-stu-id="b54f9-181">When you use the client libraries these URIs are created for you, but you do not have to use the client libraries.</span></span> <span data-ttu-id="b54f9-182">İsterseniz, OData hizmetlerine istemci kitaplıkları kullanılmadan doğrudan erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-182">If desired, OData services can be accessed directly without using the client libraries.</span></span> <span data-ttu-id="b54f9-183">İstemci kitaplıklarını kullanmadığınız durumlarda hizmetin konumu ve istenen veriler URI tarafından belirtilir ve sonuçlar HTTP isteğine yanıt olarak döndürülür.</span><span class="sxs-lookup"><span data-stu-id="b54f9-183">When not using the client libraries the location of the service and the desired data are specified by the URI and the results are returned in the response to the HTTP request.</span></span> <span data-ttu-id="b54f9-184">Bu ham veriler daha sonra, istenen şekilde işlenebilir veya yönetilebilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-184">This raw data can then be processed or manipulated in the desired manner.</span></span> <span data-ttu-id="b54f9-185">Bir OData sorgusunun sonuçlarını almanın bir yolu <xref:System.Net.WebClient> sınıfını kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-185">One way to retrieve the results of an OData query is by using the <xref:System.Net.WebClient> class.</span></span> <span data-ttu-id="b54f9-186">Bu örnekte, anahtar ALFKI tarafından temsil edilen müşterinin iletişim adı alınır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-186">In this example, the contact name for the customer represented by the key ALFKI is retrieved.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#2](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#2)]

<span data-ttu-id="b54f9-187">Bu kod çalıştırıldığında, konsola aşağıdaki çıktı görüntülenir:</span><span class="sxs-lookup"><span data-stu-id="b54f9-187">When this code is run, the following output is displayed to the console:</span></span>

```console
Raw data returned:
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<ContactName xmlns="http://schemas.microsoft.com/ado/2007/08/dataservices">Maria Anders</ContactName>
```

<span data-ttu-id="b54f9-188">Bir iş akışında, bu örnekteki kod <xref:System.Activities.CodeActivity>tabanlı bir özel etkinliğin <xref:System.Activities.CodeActivity.Execute%2A> geçersiz kılması içine eklenebilir, ancak aynı işlevsellik <xref:System.Activities.Expressions.InvokeMethod%601> etkinliği kullanılarak da gerçekleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-188">In a workflow, the code from this example could be incorporated into the <xref:System.Activities.CodeActivity.Execute%2A> override of a <xref:System.Activities.CodeActivity>-based custom activity, but the same functionality can also be accomplished by using the <xref:System.Activities.Expressions.InvokeMethod%601> activity.</span></span> <span data-ttu-id="b54f9-189"><xref:System.Activities.Expressions.InvokeMethod%601> etkinliği, iş akışı yazarlarının bir sınıfın statik ve örnek yöntemlerini çağırmasına ve ayrıca belirtilen yöntemi zaman uyumsuz olarak çağırma seçeneğine sahiptir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-189">The <xref:System.Activities.Expressions.InvokeMethod%601> activity enables workflow authors to invoke static and instance methods of a class, and also has an option to invoke the specified method asynchronously.</span></span> <span data-ttu-id="b54f9-190">Aşağıdaki örnekte, bir <xref:System.Activities.Expressions.InvokeMethod%601> etkinliği <xref:System.Net.WebClient> sınıfının <xref:System.Net.WebClient.DownloadString%2A> yöntemini çağıracak ve müşterilerin listesini döndürecek şekilde yapılandırılmıştır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-190">In the following example, an <xref:System.Activities.Expressions.InvokeMethod%601> activity is configured to call the <xref:System.Net.WebClient.DownloadString%2A> method of the <xref:System.Net.WebClient> class and return a list of customers.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#3](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#3)]

<span data-ttu-id="b54f9-191"><xref:System.Activities.Expressions.InvokeMethod%601>, bir sınıfın hem statik hem de örnek yöntemlerini çağırabilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-191"><xref:System.Activities.Expressions.InvokeMethod%601> can call both static and instance methods of a class.</span></span> <span data-ttu-id="b54f9-192"><xref:System.Net.WebClient.DownloadString%2A>, <xref:System.Net.WebClient> sınıfının bir örnek yöntemi olduğundan, <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A>için <xref:System.Net.WebClient> sınıfının yeni bir örneği belirtilir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-192">Since <xref:System.Net.WebClient.DownloadString%2A> is an instance method of the <xref:System.Net.WebClient> class, a new instance of the <xref:System.Net.WebClient> class is specified for the <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A>.</span></span> <span data-ttu-id="b54f9-193">`DownloadString` <xref:System.Activities.Expressions.InvokeMethod%601.MethodName%2A>olarak belirtilir, sorguyu içeren URI <xref:System.Activities.Expressions.InvokeMethod%601.Parameters%2A> koleksiyonda belirtilir ve dönüş değeri <xref:System.Activities.Activity%601.Result%2A> değere atanır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-193">`DownloadString` is specified as the <xref:System.Activities.Expressions.InvokeMethod%601.MethodName%2A>, the URI that contains the query is specified in the <xref:System.Activities.Expressions.InvokeMethod%601.Parameters%2A> collection, and the return value is assigned to the <xref:System.Activities.Activity%601.Result%2A> value.</span></span> <span data-ttu-id="b54f9-194"><xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A> değeri `true`olarak ayarlanır, bu da yöntem çağrısının iş akışıyla ilgili olarak zaman uyumsuz olarak çalışacağı anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-194">The <xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A> value is set to `true`, which means that the method invocation will run asynchronously with regard to the workflow.</span></span> <span data-ttu-id="b54f9-195">Aşağıdaki örnekte, belirli bir müşterinin siparişlerinin listesi için örnek Northwind veri hizmetini sorgulamak üzere <xref:System.Activities.Expressions.InvokeMethod%601> etkinliğini kullanan bir iş akışı oluşturulur ve ardından döndürülen veriler konsola yazılır.</span><span class="sxs-lookup"><span data-stu-id="b54f9-195">In the following example, a workflow is constructed that uses the <xref:System.Activities.Expressions.InvokeMethod%601> activity to query the sample Northwind data service for a list of orders for a specific customer, and then the returned data is written to the console.</span></span>

[!code-csharp[CFX_WCFDataServicesActivityExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_WCFDataServicesActivityExample/cs/Program.cs#1)]

<span data-ttu-id="b54f9-196">Bu iş akışı çağrıldığında, konsola aşağıdaki çıktı görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-196">When this workflow is invoked, the following output is displayed to the console.</span></span> <span data-ttu-id="b54f9-197">Bu sorgu birkaç sipariş döndürdüğünden, burada çıktının yalnızca bir kısmı görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="b54f9-197">Since this query returns several orders, only part of the output is displayed here.</span></span>

```console
Calling WCF Data Service...
Raw data returned:

<?xml version="1.0" encoding="utf-8" standalone="yes"?>*
<feed
xml:base="http://services.odata.org/Northwind/Northwind.svc/"
xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices"
xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"
xmlns="http://www.w3.org/2005/Atom">
<title type="text">Orders\</title>
<id>http://services.odata.org/Northwind/Northwind.svc/Customers('ALFKI')/Orders\</id>
<updated>2010-05-19T19:37:07Z\</updated>
<link rel="self" title="Orders" href="Orders" />
<entry>
<id>http://services.odata.org/Northwind/Northwind.svc/Orders(10643)\</id>
<title type="text">\</title>
<updated>2010-05-19T19:37:07Z\</updated>
<author>
<name />
</author>
<link rel="edit" title="Order" href="Orders(10643)" />
<link rel="http://schemas.microsoft.com/ado/2007/08/dataservices/related/Customer" type="application/atom+xml;type=entry" title="Customer" href="Orders(10643)/Customer" />
...
```

<span data-ttu-id="b54f9-198">Bu örnek, iş akışı uygulama yazarlarının bir OData hizmetinden döndürülen ham verileri tüketmek için kullanabileceği bir yöntem sağlar.</span><span class="sxs-lookup"><span data-stu-id="b54f9-198">This example provides one method that workflow application authors can use to consume the raw data returned from an OData service.</span></span> <span data-ttu-id="b54f9-199">URI 'Ler kullanarak WCF Veri Hizmetleri erişme hakkında daha fazla bilgi için bkz. [veri hizmeti kaynaklarına erişme (WCF veri Hizmetleri)](../data/wcf/accessing-data-service-resources-wcf-data-services.md) ve [OData: URI kuralları](https://www.odata.org/documentation/odata-version-2-0/uri-conventions/).</span><span class="sxs-lookup"><span data-stu-id="b54f9-199">For more information about accessing WCF Data Services using URIs, see [Accessing Data Service Resources (WCF Data Services)](../data/wcf/accessing-data-service-resources-wcf-data-services.md) and [OData: URI Conventions](https://www.odata.org/documentation/odata-version-2-0/uri-conventions/).</span></span>
