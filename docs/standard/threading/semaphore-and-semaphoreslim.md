---
title: Semafor ve SemaphoreSlim
description: Semafor & SemaphoreSlim hakkında bilgi edinin. Sınıf semaforu, Win32 semafor nesnesinin etrafında ince bir sarmalayıcıdır. SemaphoreSlim sınıfı hızlı bir hafif semaforun.
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- counting semaphores
- semaphores
- threading [.NET Framework], cross-process synchronization
- Semaphore class, about Semaphore class
- SemaphoreSlim class, about SemaphoreSlim class
- threading [.NET Framework], Semaphore class
ms.assetid: 7722a333-b974-47a2-a7c0-f09097fb644e
ms.openlocfilehash: 21f0d7e3fb446a7b750c45cfe8ef3f087a77888a
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 06/09/2020
ms.locfileid: "84600457"
---
# <a name="semaphore-and-semaphoreslim"></a><span data-ttu-id="5b5fd-105">Semafor ve SemaphoreSlim</span><span class="sxs-lookup"><span data-stu-id="5b5fd-105">Semaphore and SemaphoreSlim</span></span>
<span data-ttu-id="5b5fd-106"><xref:System.Threading.Semaphore?displayProperty=nameWithType>Sınıf, adlandırılmış (systemwide) veya yerel semaforu temsil eder.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-106">The <xref:System.Threading.Semaphore?displayProperty=nameWithType> class represents a named (systemwide) or local semaphore.</span></span> <span data-ttu-id="5b5fd-107">Bu, Win32 semafor nesnesinin etrafında ince bir sarmalayıcıdır.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-107">It is a thin wrapper around the Win32 semaphore object.</span></span> <span data-ttu-id="5b5fd-108">Win32 semaforları, bir kaynak havuzuna erişimi denetlemek için kullanılabilen semafor sayısını saymaktadır.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-108">Win32 semaphores are counting semaphores, which can be used to control access to a pool of resources.</span></span>  
  
 <span data-ttu-id="5b5fd-109">Bu <xref:System.Threading.SemaphoreSlim> sınıf, bekleme süreleri çok kısa olması beklendiğinde tek bir işlem içinde bekleme için kullanılabilen hafif ve hızlı bir semaforu temsil eder.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-109">The <xref:System.Threading.SemaphoreSlim> class represents a lightweight, fast semaphore that can be used for waiting within a single process when wait times are expected to be very short.</span></span> <span data-ttu-id="5b5fd-110"><xref:System.Threading.SemaphoreSlim>ortak dil çalışma zamanı (CLR) tarafından belirtilen eşitleme temelleri için mümkün olduğunca fazla kullanır.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-110"><xref:System.Threading.SemaphoreSlim> relies as much as possible on synchronization primitives provided by the common language runtime (CLR).</span></span> <span data-ttu-id="5b5fd-111">Bununla birlikte, Ayrıca, birden fazla semaforda beklemeyi desteklemek için gereken geç, çekirdek tabanlı bekleme tanıtıcıları de sağlar.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-111">However, it also provides lazily initialized, kernel-based wait handles as necessary to support waiting on multiple semaphores.</span></span> <span data-ttu-id="5b5fd-112"><xref:System.Threading.SemaphoreSlim>Ayrıca, iptal belirteçleri kullanımını destekler, ancak adlandırılmış semaforları veya eşitleme için bir bekleme tanıtıcısının kullanımını desteklemez.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-112"><xref:System.Threading.SemaphoreSlim> also supports the use of cancellation tokens, but it does not support named semaphores or the use of a wait handle for synchronization.</span></span>  
  
## <a name="managing-a-limited-resource"></a><span data-ttu-id="5b5fd-113">Sınırlı bir kaynağı yönetme</span><span class="sxs-lookup"><span data-stu-id="5b5fd-113">Managing a Limited Resource</span></span>  
 <span data-ttu-id="5b5fd-114">İş parçacıkları, bir nesne söz konusu olduğunda sınıfından devralınan yöntemini çağırarak veya bir nesne <xref:System.Threading.WaitHandle.WaitOne%2A> <xref:System.Threading.WaitHandle> <xref:System.Threading.Semaphore?displayProperty=nameWithType> <xref:System.Threading.SemaphoreSlim.Wait%2A?displayProperty=nameWithType> durumunda ya da <xref:System.Threading.SemaphoreSlim.WaitAsync%2A?displayProperty=nameWithType> yöntemi <xref:System.Threading.SemaphoreSlim> olan semafor girer.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-114">Threads enter the semaphore by calling the <xref:System.Threading.WaitHandle.WaitOne%2A> method, which is inherited from the <xref:System.Threading.WaitHandle> class, in the case of a <xref:System.Threading.Semaphore?displayProperty=nameWithType> object, or the <xref:System.Threading.SemaphoreSlim.Wait%2A?displayProperty=nameWithType> or <xref:System.Threading.SemaphoreSlim.WaitAsync%2A?displayProperty=nameWithType> method, in the case of a <xref:System.Threading.SemaphoreSlim> object.</span></span> <span data-ttu-id="5b5fd-115">Çağrı döndüğünde, semaforda sayı azaltılır.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-115">When the call returns, the count on the semaphore is decremented.</span></span> <span data-ttu-id="5b5fd-116">Bir iş parçacığı istediğinde ve sayı sıfır olduğunda, iş parçacığı engeller.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-116">When a thread requests entry and the count is zero, the thread blocks.</span></span> <span data-ttu-id="5b5fd-117">İş parçacıkları veya metodunu çağırarak semaforu serbest bırakarak <xref:System.Threading.Semaphore.Release%2A?displayProperty=nameWithType> <xref:System.Threading.SemaphoreSlim.Release%2A?displayProperty=nameWithType> engellenen iş parçacıklarının girmesine izin verilir.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-117">As threads release the semaphore by calling the <xref:System.Threading.Semaphore.Release%2A?displayProperty=nameWithType> or <xref:System.Threading.SemaphoreSlim.Release%2A?displayProperty=nameWithType> method, blocked threads are allowed to enter.</span></span> <span data-ttu-id="5b5fd-118">Engellenen iş parçacıkları için semaforu girmesi için ilk giriş, ilk çıkar (FıFO) veya son giriş, ilk çıkar (LıFO) gibi garantili bir sıra yoktur.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-118">There is no guaranteed order, such as first-in, first-out (FIFO) or last-in, first-out (LIFO), for blocked threads to enter the semaphore.</span></span>  
  
 <span data-ttu-id="5b5fd-119">Bir iş parçacığı <xref:System.Threading.Semaphore?displayProperty=nameWithType> nesnenin <xref:System.Threading.WaitHandle.WaitOne%2A> metodunu ya da <xref:System.Threading.SemaphoreSlim> nesnenin <xref:System.Threading.SemaphoreSlim.Wait%2A> yöntemini sürekli çağırarak semaforu birden çok kez girebilir.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-119">A thread can enter the semaphore multiple times by calling the <xref:System.Threading.Semaphore?displayProperty=nameWithType> object's <xref:System.Threading.WaitHandle.WaitOne%2A> method or the  <xref:System.Threading.SemaphoreSlim> object's <xref:System.Threading.SemaphoreSlim.Wait%2A> method repeatedly.</span></span> <span data-ttu-id="5b5fd-120">Semaforu serbest bırakmak için, iş parçacığı <xref:System.Threading.Semaphore.Release?displayProperty=nameWithType> ya da <xref:System.Threading.SemaphoreSlim.Release?displayProperty=nameWithType> yöntem aşırı yüklemesini aynı sayıda çağırabilir veya <xref:System.Threading.Semaphore.Release%28System.Int32%29?displayProperty=nameWithType> ya da <xref:System.Threading.SemaphoreSlim.Release%28System.Int32%29?displayProperty=nameWithType> yöntem aşırı yüklemesini çağırabilir ve yayımlanacak girdi sayısını belirtebilir.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-120">To release the semaphore, the thread can either call the <xref:System.Threading.Semaphore.Release?displayProperty=nameWithType> or <xref:System.Threading.SemaphoreSlim.Release?displayProperty=nameWithType> method overload the same number of times, or call the <xref:System.Threading.Semaphore.Release%28System.Int32%29?displayProperty=nameWithType> or <xref:System.Threading.SemaphoreSlim.Release%28System.Int32%29?displayProperty=nameWithType> method overload and specify the number of entries to be released.</span></span>  
  
### <a name="semaphores-and-thread-identity"></a><span data-ttu-id="5b5fd-121">Semaforlar ve Iş parçacığı kimliği</span><span class="sxs-lookup"><span data-stu-id="5b5fd-121">Semaphores and Thread Identity</span></span>  
 <span data-ttu-id="5b5fd-122">İki semafor türü,,, <xref:System.Threading.WaitHandle.WaitOne%2A> <xref:System.Threading.SemaphoreSlim.Wait%2A> <xref:System.Threading.Semaphore.Release%2A> ve yöntemlerine yapılan çağrılar üzerinde iş parçacığı kimliğini zorlamaz <xref:System.Threading.SemaphoreSlim.Release%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="5b5fd-122">The two semaphore types do not enforce thread identity on calls to the <xref:System.Threading.WaitHandle.WaitOne%2A>, <xref:System.Threading.SemaphoreSlim.Wait%2A>, <xref:System.Threading.Semaphore.Release%2A>, and <xref:System.Threading.SemaphoreSlim.Release%2A?displayProperty=nameWithType> methods.</span></span> <span data-ttu-id="5b5fd-123">Örneğin, Semaforlar için ortak bir kullanım senaryosunda bir üretici iş parçacığı ve bir tüketici iş parçacığı ve bir iş parçacığı her zaman semafor sayısını arttırılarak diğer her zaman azaltılır.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-123">For example, a common usage scenario for semaphores involves a producer thread and a consumer thread, with one thread always incrementing the semaphore count and the other always decrementing it.</span></span>  
  
 <span data-ttu-id="5b5fd-124">Bir iş parçacığının semaforu çok fazla kez serbest bırakmadığından emin olmak programcı sorumluluğundadır.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-124">It is the programmer's responsibility to ensure that a thread does not release the semaphore too many times.</span></span> <span data-ttu-id="5b5fd-125">Örneğin, bir semaforun en fazla iki sayısına sahip olduğunu ve A iş parçacığı A ve iş parçacığı B 'nin her ikisi de semaforu girmelerini sağladığını varsayalım.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-125">For example, suppose a semaphore has a maximum count of two, and that thread A and thread B both enter the semaphore.</span></span> <span data-ttu-id="5b5fd-126">B iş parçacığında bir programlama hatası, iki kez çağrı yapmasına neden olursa `Release` her iki çağrı de başarılı olur.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-126">If a programming error in thread B causes it to call  `Release` twice, both calls succeed.</span></span> <span data-ttu-id="5b5fd-127">Semaforda bulunan sayı dolu ve iş parçacığı sonunda çağrı yaptığı zaman `Release` bir <xref:System.Threading.SemaphoreFullException> atılır.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-127">The count on the semaphore is full, and when thread A eventually calls `Release`, a <xref:System.Threading.SemaphoreFullException> is thrown.</span></span>  
  
## <a name="named-semaphores"></a><span data-ttu-id="5b5fd-128">Adlandırılmış Semaforlar</span><span class="sxs-lookup"><span data-stu-id="5b5fd-128">Named Semaphores</span></span>  
 <span data-ttu-id="5b5fd-129">Windows işletim sistemi, Semaforlar adlara sahip olmasına izin verir.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-129">The Windows operating system allows semaphores to have names.</span></span> <span data-ttu-id="5b5fd-130">Adlandırılmış semafor sistem genelinde olur.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-130">A named semaphore is system wide.</span></span> <span data-ttu-id="5b5fd-131">Diğer bir deyişle, adlandırılmış semafor oluşturulduktan sonra, tüm süreçlerdeki tüm iş parçacıkları tarafından görülebilir.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-131">That is, once the named semaphore is created, it is visible to all threads in all processes.</span></span> <span data-ttu-id="5b5fd-132">Bu nedenle, adlandırılmış semafor, işlem etkinliklerini ve iş parçacıklarını eşitlemesi için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-132">Thus, named semaphore can be used to synchronize the activities of processes as well as threads.</span></span>  
  
 <span data-ttu-id="5b5fd-133"><xref:System.Threading.Semaphore>Bir adı belirten oluşturuculardan birini kullanarak, adlandırılmış bir sistem semaforu temsil eden bir nesne oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-133">You can create a <xref:System.Threading.Semaphore> object that represents a named system semaphore by using one of the constructors that specifies a name.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="5b5fd-134">Adlandırılmış Semaforlar sistem genelinde olduğundan, <xref:System.Threading.Semaphore> aynı adlı semaforu temsil eden birden çok nesne olması mümkündür.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-134">Because named semaphores are system wide, it is possible to have multiple <xref:System.Threading.Semaphore> objects that represent the same named semaphore.</span></span> <span data-ttu-id="5b5fd-135">Her bir oluşturucuyu veya yöntemini her çağırdığınızda <xref:System.Threading.Semaphore.OpenExisting%2A?displayProperty=nameWithType> Yeni bir <xref:System.Threading.Semaphore> nesne oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-135">Each time you call a constructor or the <xref:System.Threading.Semaphore.OpenExisting%2A?displayProperty=nameWithType> method, a new <xref:System.Threading.Semaphore> object is created.</span></span> <span data-ttu-id="5b5fd-136">Aynı adın belirtilmesi, aynı adlı semaforu temsil eden birden çok nesne oluşturur.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-136">Specifying the same name repeatedly creates multiple objects that represent the same named semaphore.</span></span>  
  
 <span data-ttu-id="5b5fd-137">Adlandırılmış Semaforlar kullanırken dikkatli olun.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-137">Be careful when you use named semaphores.</span></span> <span data-ttu-id="5b5fd-138">Sistem genelinde olduklarından aynı adı kullanan başka bir işlem, semaforu beklenmedik bir şekilde girebilirler.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-138">Because they are system wide, another process that uses the same name can enter your semaphore unexpectedly.</span></span> <span data-ttu-id="5b5fd-139">Aynı bilgisayarda çalışan kötü amaçlı kod bunu bir hizmet reddi saldırısı temeli olarak kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-139">Malicious code executing on the same computer could use this as the basis of a denial-of-service attack.</span></span>  
  
 <span data-ttu-id="5b5fd-140"><xref:System.Threading.Semaphore>Tercihen bir nesneyi belirten bir Oluşturucu kullanarak adlandırılmış semaforu temsil eden bir nesneyi korumak için erişim denetimi güvenliği ' ni kullanın <xref:System.Security.AccessControl.SemaphoreSecurity?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="5b5fd-140">Use access control security to protect a <xref:System.Threading.Semaphore> object that represents a named semaphore, preferably by using a constructor that specifies a <xref:System.Security.AccessControl.SemaphoreSecurity?displayProperty=nameWithType> object.</span></span> <span data-ttu-id="5b5fd-141">Yöntemi kullanarak erişim denetimi güvenliği de uygulayabilirsiniz <xref:System.Threading.Semaphore.SetAccessControl%2A?displayProperty=nameWithType> , ancak bu, semaforun oluşturulduğu zaman ve koruduğu zaman arasında bir güvenlik açığı penceresi bırakır.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-141">You can also apply access control security using the <xref:System.Threading.Semaphore.SetAccessControl%2A?displayProperty=nameWithType> method, but this leaves a window of vulnerability between the time the semaphore is created and the time it is protected.</span></span> <span data-ttu-id="5b5fd-142">Erişim denetimi güvenliği ile Semaforlar koruma kötü amaçlı saldırıları önlemeye yardımcı olur, ancak istemeyerek ad çakışmalarının sorununu çözmez.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-142">Protecting semaphores with access control security helps prevent malicious attacks, but does not solve the problem of unintentional name collisions.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5b5fd-143">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="5b5fd-143">See also</span></span>

- <xref:System.Threading.Semaphore>
- <xref:System.Threading.SemaphoreSlim>
- [<span data-ttu-id="5b5fd-144">İş parçacığı nesneleri ve özellikleri</span><span class="sxs-lookup"><span data-stu-id="5b5fd-144">Threading Objects and Features</span></span>](threading-objects-and-features.md)
