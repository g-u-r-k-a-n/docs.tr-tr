---
title: Tür Kitaplığını Derleme Olarak İçeri Aktarma
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
ms.openlocfilehash: e1a21175bcabc72b86a328d4f73ecec37140c304
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/30/2019
ms.locfileid: "73107591"
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="dcb5e-102">Tür Kitaplığını Derleme Olarak İçeri Aktarma</span><span class="sxs-lookup"><span data-stu-id="dcb5e-102">Importing a Type Library as an Assembly</span></span>

<span data-ttu-id="dcb5e-103">COM tür tanımları genellikle bir tür kitaplığında bulunur.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-103">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="dcb5e-104">Buna karşılık, CLS uyumlu derleyiciler bir derlemede tür meta verileri üretir.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-104">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="dcb5e-105">Tür bilgilerinin iki kaynağı oldukça farklıdır.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-105">The two sources of type information are quite different.</span></span> <span data-ttu-id="dcb5e-106">Bu konu, bir tür kitaplığından meta veri oluşturma tekniklerini açıklamaktadır.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-106">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="dcb5e-107">Elde edilen derlemeye birlikte çalışma derlemesi denir ve içerdiği tür bilgileri .NET Framework uygulamaların COM türlerini kullanmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-107">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>

<span data-ttu-id="dcb5e-108">Bu tür bilgilerini uygulamanız için kullanılabilir hale getirmek için iki yol vardır:</span><span class="sxs-lookup"><span data-stu-id="dcb5e-108">There are two ways to make this type information available to your application:</span></span>

- <span data-ttu-id="dcb5e-109">Yalnızca tasarım zamanı birlikte çalışma derlemelerini kullanarak: .NET Framework 4 ' ten başlayarak, derleyicinin birlikte çalışma derlemesinden tür bilgilerini çalıştırılabilire katıştırmasını isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-109">Using design-time-only interop assemblies: Beginning with the .NET Framework 4, you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="dcb5e-110">Derleyici yalnızca uygulamanızın kullandığı tür bilgilerini katıştırır.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-110">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="dcb5e-111">Birlikte çalışma derlemesini uygulamanızla birlikte dağıtmanız gerekmez.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-111">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="dcb5e-112">Önerilen yöntem budur.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-112">This is the recommended technique.</span></span>

- <span data-ttu-id="dcb5e-113">Birlikte çalışma derlemelerini dağıtma: birlikte çalışma derlemesine standart bir başvuru oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-113">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="dcb5e-114">Bu durumda, birlikte çalışma derlemesinin uygulamanızla birlikte dağıtılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-114">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="dcb5e-115">Bu tekniği kullandıysanız ve özel bir COM bileşeni kullanmıyorsanız, her zaman yönetilen kodunuzda birleştirmek istediğiniz COM bileşeninin yazarı tarafından yayımlanan birincil birlikte çalışma derlemesine (PIA) başvurun.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-115">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="dcb5e-116">Birincil birlikte çalışma derlemelerini üretme ve kullanma hakkında daha fazla bilgi için bkz. [birincil birlikte çalışma derlemeleri](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="dcb5e-116">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>

<span data-ttu-id="dcb5e-117">Yalnızca tasarım zamanı birlikte çalışma derlemelerini kullandığınızda, COM bileşeninin yazarı tarafından yayımlanan birincil birlikte çalışma derlemesinden tür bilgilerini ekleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-117">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="dcb5e-118">Bununla birlikte, birincil birlikte çalışma derlemesini uygulamanızla birlikte dağıtmanız gerekmez.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-118">However, you do not have to deploy the primary interop assembly with your application.</span></span>

<span data-ttu-id="dcb5e-119">Çoğu uygulama bir COM bileşeninin tüm özelliklerini kullanmadığından, yalnızca tasarım zamanı birlikte çalışma derlemelerini kullanmak uygulamanızın boyutunu azaltır.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-119">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="dcb5e-120">Derleyici tür bilgilerini katıştıran çok verimlidir; uygulamanız bir COM arabiriminde yöntemlerin yalnızca bazılarını kullanıyorsa, derleyici kullanılmayan yöntemleri eklemez.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-120">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="dcb5e-121">Gömülü tür bilgilerine sahip bir uygulama, başka bir uygulamayla etkileşime geçtiğinde veya bir birincil birlikte çalışma derlemesi kullanan bir uygulamayla etkileşime geçtiğinde, ortak dil çalışma zamanı, iki tür aynı ad aynı COM türünü temsil eder.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-121">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="dcb5e-122">COM nesnelerini kullanmak için bu kuralları bilmeniz gerekmez.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-122">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="dcb5e-123">Ancak kurallarla ilgileniyorsanız, bkz. [tür denklik ve katıştırılmış birlikte çalışma türleri](type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="dcb5e-123">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](type-equivalence-and-embedded-interop-types.md).</span></span>

## <a name="generating-metadata"></a><span data-ttu-id="dcb5e-124">Meta veriler üretiliyor</span><span class="sxs-lookup"><span data-stu-id="dcb5e-124">Generating Metadata</span></span>

<span data-ttu-id="dcb5e-125">COM tür kitaplıkları, Krelib. tlb gibi. tlb uzantılı tek başına dosyalar olabilir.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-125">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="dcb5e-126">Bazı tür kitaplıkları bir. dll veya. exe dosyasının kaynak bölümüne katıştırılır.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-126">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="dcb5e-127">Kitaplık bilgisi türündeki diğer kaynaklar. olb ve. ocx dosyalarıdır.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-127">Other sources of type library information are .olb and .ocx files.</span></span>

<span data-ttu-id="dcb5e-128">Hedef COM türü uygulamasını içeren tür kitaplığını bulduktan sonra, tür meta verilerini içeren bir birlikte çalışma derlemesi oluşturmak için aşağıdaki seçeneklere sahip olursunuz:</span><span class="sxs-lookup"><span data-stu-id="dcb5e-128">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>

- <span data-ttu-id="dcb5e-129">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="dcb5e-129">Visual Studio</span></span>

  <span data-ttu-id="dcb5e-130">Visual Studio, bir tür kitaplığındaki COM türlerini otomatik olarak bir derlemedeki meta verilere dönüştürür.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-130">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="dcb5e-131">Yönergeler için bkz. [nasıl yapılır: tür kitaplıklarına başvurular ekleme](how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="dcb5e-131">For instructions, see [How to: Add References to Type Libraries](how-to-add-references-to-type-libraries.md).</span></span>

- [<span data-ttu-id="dcb5e-132">Tür kitaplığı alma programı (Tlbimp. exe)</span><span class="sxs-lookup"><span data-stu-id="dcb5e-132">Type Library Importer (Tlbimp.exe)</span></span>](../tools/tlbimp-exe-type-library-importer.md)

  <span data-ttu-id="dcb5e-133">Tür kitaplığı alma programı, elde edilen birlikte çalışma dosyasındaki meta verileri ayarlamak için komut satırı seçenekleri sağlar, türleri varolan bir tür kitaplığından içeri aktarır ve bir birlikte çalışma derlemesi ve bir ad alanı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-133">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="dcb5e-134">Yönergeler için bkz. [nasıl yapılır: tür kitaplıklarından birlikte çalışma derlemeleri oluşturma](how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="dcb5e-134">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>

- <span data-ttu-id="dcb5e-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> sınıfı</span><span class="sxs-lookup"><span data-stu-id="dcb5e-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>

  <span data-ttu-id="dcb5e-136">Bu sınıf, bir tür kitaplığındaki ortak sınıfları ve arabirimleri derleme içindeki meta verilere dönüştürmek için yöntemler sağlar.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-136">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="dcb5e-137">Tlbimp. exe ile aynı meta veri çıkışını üretir.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-137">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="dcb5e-138">Ancak, Tlbimp. exe ' den farklı olarak <xref:System.Runtime.InteropServices.TypeLibConverter> sınıfı, bellek içi bir tür kitaplığını meta verilere dönüştürebilir.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-138">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>

- <span data-ttu-id="dcb5e-139">Özel sarmalayıcılar</span><span class="sxs-lookup"><span data-stu-id="dcb5e-139">Custom wrappers</span></span>

  <span data-ttu-id="dcb5e-140">Bir tür kitaplığı kullanılamadığında veya yanlış olduğunda, yönetilen kaynak kodunda sınıfın veya arabirimin yinelenen tanımını oluşturmak için bir seçenek vardır.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-140">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="dcb5e-141">Ardından, bir derlemede meta veri üretmek için çalışma zamanını hedefleyen bir derleyici ile kaynak kodu derleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-141">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>

  <span data-ttu-id="dcb5e-142">COM türlerini el ile tanımlamak için aşağıdaki öğelere erişiminizin olması gerekir:</span><span class="sxs-lookup"><span data-stu-id="dcb5e-142">To define COM types manually, you must have access to the following items:</span></span>

  - <span data-ttu-id="dcb5e-143">Tanımlanmakta olan coclass 'ları ve arabirimlerin kesin açıklamaları.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-143">Precise descriptions of the coclasses and interfaces being defined.</span></span>

  - <span data-ttu-id="dcb5e-144">Uygun .NET Framework sınıf tanımlarını oluşturabilen C# derleyici gibi bir derleyici.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-144">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>

  - <span data-ttu-id="dcb5e-145">Kitaplık-derleme dönüştürme kuralları türü hakkında bilgi.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-145">Knowledge of the type library-to-assembly conversion rules.</span></span>

  <span data-ttu-id="dcb5e-146">Özel sarmalayıcı yazmak gelişmiş bir tekniktir.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-146">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="dcb5e-147">Özel bir sarmalayıcı oluşturma hakkında daha fazla bilgi için bkz. [Standart sarmalayıcıları özelleştirme](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="dcb5e-147">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span></span>

 <span data-ttu-id="dcb5e-148">COM birlikte çalışabilirlik içeri aktarma işlemi hakkında daha fazla bilgi için bkz. [tür kitaplığına derleme dönüştürme Özeti](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="dcb5e-148">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span></span>

## <a name="see-also"></a><span data-ttu-id="dcb5e-149">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="dcb5e-149">See also</span></span>

- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [<span data-ttu-id="dcb5e-150">COM Bileşenlerini .NET Framework'te Gösterme</span><span class="sxs-lookup"><span data-stu-id="dcb5e-150">Exposing COM Components to the .NET Framework</span></span>](exposing-com-components.md)
- <span data-ttu-id="dcb5e-151">[Tür kitaplığını derlemeye dönüştürme Özeti](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="dcb5e-151">[Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="dcb5e-152">Tlbimp.exe (Tür Kitaplığı İçeri Aktarıcı)</span><span class="sxs-lookup"><span data-stu-id="dcb5e-152">Tlbimp.exe (Type Library Importer)</span></span>](../tools/tlbimp-exe-type-library-importer.md)
- <span data-ttu-id="dcb5e-153">[Standart sarmalayıcıları özelleştirme](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="dcb5e-153">[Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span></span>
- <span data-ttu-id="dcb5e-154">[Yönetilen kodda COM türlerini kullanma](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="dcb5e-154">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="dcb5e-155">Birlikte Çalışma Projesi Derleme</span><span class="sxs-lookup"><span data-stu-id="dcb5e-155">Compiling an Interop Project</span></span>](compiling-an-interop-project.md)
- [<span data-ttu-id="dcb5e-156">Birlikte Çalışma Uygulamasını Dağıtma</span><span class="sxs-lookup"><span data-stu-id="dcb5e-156">Deploying an Interop Application</span></span>](deploying-an-interop-application.md)
- [<span data-ttu-id="dcb5e-157">Nasıl yapılır: Tür Kitaplıklarına Başvurular Ekleme</span><span class="sxs-lookup"><span data-stu-id="dcb5e-157">How to: Add References to Type Libraries</span></span>](how-to-add-references-to-type-libraries.md)
- [<span data-ttu-id="dcb5e-158">Nasıl yapılır: Tür Kitaplıklarından Birlikte Çalışma Bütünleştirilmiş Kodları Oluşturma</span><span class="sxs-lookup"><span data-stu-id="dcb5e-158">How to: Generate Interop Assemblies from Type Libraries</span></span>](how-to-generate-interop-assemblies-from-type-libraries.md)
