---
title: Kaynaklar ve Kod
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
ms.openlocfilehash: 3d504467c137c1e3f494e120217957661f4e75a3
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/03/2019
ms.locfileid: "73458761"
---
# <a name="resources-and-code"></a><span data-ttu-id="ea2e8-102">Kaynaklar ve Kod</span><span class="sxs-lookup"><span data-stu-id="ea2e8-102">Resources and Code</span></span>
<span data-ttu-id="ea2e8-103">Bu genel bakış, [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] kaynaklarına [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] söz dizimi yerine kod kullanarak nasıl erişilebileceğini veya oluşturulandığına yoğunlaşır.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="ea2e8-104">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] sözdizimi perspektifinden genel kaynak kullanımı ve kaynakları hakkında daha fazla bilgi için bkz. [xaml kaynakları](xaml-resources.md).</span><span class="sxs-lookup"><span data-stu-id="ea2e8-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](xaml-resources.md).</span></span>  

<a name="accessing"></a>   
## <a name="accessing-resources-from-code"></a><span data-ttu-id="ea2e8-105">Koddan kaynaklara erişme</span><span class="sxs-lookup"><span data-stu-id="ea2e8-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="ea2e8-106">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] aracılığıyla tanımlandıklarında kaynakları tanımlayan anahtarlar, kaynak kodda istekte bulunan belirli kaynakları almak için de kullanılır.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="ea2e8-107">Koddan bir kaynağı almanın en kolay yolu, uygulamanızdaki çerçeve düzeyindeki nesnelerden <xref:System.Windows.FrameworkElement.FindResource%2A> veya <xref:System.Windows.FrameworkElement.TryFindResource%2A> yöntemini çağırmanız olabilir.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="ea2e8-108">Bu Yöntemler arasındaki davranış farkı, istenen anahtar bulunamazsa ne olur?</span><span class="sxs-lookup"><span data-stu-id="ea2e8-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="ea2e8-109"><xref:System.Windows.FrameworkElement.FindResource%2A> bir özel durum oluşturur; <xref:System.Windows.FrameworkElement.TryFindResource%2A> bir özel durum oluşturmaz, ancak `null`döndürür.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="ea2e8-110">Her yöntem, kaynak anahtarını bir giriş parametresi olarak alır ve gevşek yazılmış bir nesne döndürür.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="ea2e8-111">Genellikle, kaynak anahtarı bir dizedir, ancak zaman zaman dize olmayan kullanımlar vardır; Ayrıntılar için [nesneleri anahtarlar olarak kullanma](#objectaskey) bölümüne bakın.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="ea2e8-112">Genellikle, döndürülen nesneyi, kaynak isteğinde bulunduğunuzu ayarladığınız özelliğin gerektirdiği türe atamalısınız.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="ea2e8-113">Kod kaynağı çözümleme için arama mantığı, dinamik kaynak başvurusu [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] durumuyla aynıdır.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="ea2e8-114">Kaynak araması çağıran öğeden başlar, ardından mantıksal ağaçta ardışık üst öğelere devam eder.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="ea2e8-115">Arama, gerektiğinde uygulama kaynakları, Temalar ve sistem kaynakları ile devam eder.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="ea2e8-116">Kaynak için bir kod isteği, kaynak sözlüklerinde, [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]yüklenen kaynak sözlüğünde daha sonra yapılmış olabilecek ve ayrıca gerçek zamanlı sistem kaynağı değişikliklerinde çalışma zamanı değişiklikleri için uygun şekilde hesaba sahip olur.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="ea2e8-117">Aşağıda, bir kaynağı anahtara göre bulan ve döndürülen değeri bir <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olay işleyicisi olarak uygulanan bir özelliği ayarlamak için kullanan kısa bir örnek verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="ea2e8-118">Kaynak başvurusunu atamaya yönelik alternatif bir yöntem <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="ea2e8-119">Bu yöntem iki parametre alır: kaynağın anahtarı ve kaynak değerinin atanması gereken öğe örneğinde bulunan belirli bir bağımlılık özelliği için tanımlayıcı.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="ea2e8-120">İşlevsellik, bu yöntem aynıdır ve herhangi bir dönüş değeri ataması gerektirmeyen avantajına sahiptir.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="ea2e8-121">Yine de kaynaklara programlı bir şekilde erişmenin başka bir yolu da <xref:System.Windows.FrameworkElement.Resources%2A> özelliğinin içeriğine sözlük olarak erişmektedir.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="ea2e8-122">Bu özelliğin içerdiği sözlüğe erişmek Ayrıca mevcut koleksiyonlara yeni kaynaklar ekleyebilmesinin yanı sıra, belirli bir anahtar adının koleksiyonda zaten alınmış olup olmadığını ve diğer sözlük/toplama işlemlerini denetleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="ea2e8-123">Bir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uygulamasını tamamen kodda yazıyorsanız, kodda tüm koleksiyonu da oluşturabilir, ona anahtar atayabilir ve ardından tamamlanmış koleksiyonu, oluşturulan bir öğenin <xref:System.Windows.FrameworkElement.Resources%2A> özelliğine atayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="ea2e8-124">Bu, sonraki bölümde açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="ea2e8-125">Dizin olarak belirli bir anahtar kullanarak herhangi bir verili <xref:System.Windows.FrameworkElement.Resources%2A> koleksiyonu içinde dizin oluşturabilirsiniz, ancak kaynağa bu şekilde erişmenin, kaynak çözümleme 'nin normal çalışma zamanı kurallarını izlemez olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="ea2e8-126">Yalnızca belirli bir koleksiyona erişiyorsunuz.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="ea2e8-127">Kaynak arama, istenen anahtarda geçerli bir nesne bulunmazsa, köke veya uygulamaya geçiş yapılmaz.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="ea2e8-128">Ancak, bu yaklaşım, anahtar arama kapsamı daha kısıtlandığı için bazı durumlarda performans avantajlarına sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="ea2e8-129">Kaynak sözlüğüyle doğrudan nasıl çalışılacağı hakkında daha fazla ayrıntı için <xref:System.Windows.ResourceDictionary> sınıfına bakın.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>   
## <a name="creating-resources-with-code"></a><span data-ttu-id="ea2e8-130">Kodla kaynak oluşturma</span><span class="sxs-lookup"><span data-stu-id="ea2e8-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="ea2e8-131">Kodda bir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uygulamasının tamamını oluşturmak isterseniz, kodda bu uygulamada herhangi bir kaynak oluşturmak da isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="ea2e8-132">Bunu elde etmek için yeni bir <xref:System.Windows.ResourceDictionary> örneği oluşturun ve ardından <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>yapılan birbirini izleyen çağrıları kullanarak tüm kaynakları sözlüğe ekleyin.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="ea2e8-133">Ardından, bu nedenle oluşturulan <xref:System.Windows.ResourceDictionary>, bir sayfa kapsamında bulunan bir öğe üzerinde <xref:System.Windows.FrameworkElement.Resources%2A> özelliğini veya <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>ayarlamak için kullanın.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="ea2e8-134">Ayrıca, <xref:System.Windows.ResourceDictionary> bağımsız bir nesne olarak bir öğeye eklemeden de koruyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="ea2e8-135">Ancak bunu yaparsanız, içindeki kaynaklara, genel bir sözlükte olduğu gibi öğe anahtarı ile erişmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="ea2e8-136">Öğe `Resources` özelliğine eklenmemiş bir <xref:System.Windows.ResourceDictionary>, öğe ağacının bir parçası olarak bulunmaz ve <xref:System.Windows.FrameworkElement.FindResource%2A> ve ilgili yöntemler tarafından kullanılabilecek bir arama dizisinde kapsam içermez.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>   
## <a name="using-objects-as-keys"></a><span data-ttu-id="ea2e8-137">Nesneleri anahtar olarak kullanma</span><span class="sxs-lookup"><span data-stu-id="ea2e8-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="ea2e8-138">Çoğu kaynak kullanımları, kaynağın anahtarını bir dize olacak şekilde ayarlar.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="ea2e8-139">Ancak, çeşitli [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] özellikleri, anahtarları belirtmek için bir dize türü kullanmaz, bunun yerine bu parametre bir nesnedir.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="ea2e8-140">Kaynağı bir nesne tarafından anahtarlaştırma özelliği, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] stili ve tema desteği tarafından kullanılır.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="ea2e8-141">Diğer bir biçimde stilli olmayan bir denetim için varsayılan stil olan temalardaki stiller, her biri için uygulanmaları gereken denetimin <xref:System.Type> anahtarlanır.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="ea2e8-142">Türüne göre anahtarlan, her denetim türünün varsayılan örneklerinde çalışacak güvenilir bir arama mekanizması sağlar ve tür, yansıma tarafından algılanır ve türetilmiş türün varsayılan stili olmasa bile, türetilmiş sınıfların stillendirilmesini için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="ea2e8-143">[X:Type Işaretleme uzantısını](../../xaml-services/x-type-markup-extension.md)kullanarak [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] tanımlanan bir kaynak için <xref:System.Type> anahtarı belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../xaml-services/x-type-markup-extension.md).</span></span> <span data-ttu-id="ea2e8-144">[ComponentResourceKey Biçimlendirme Uzantısı](componentresourcekey-markup-extension.md)gibi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] özelliklerini destekleyen diğer dize olmayan anahtar kullanımları için de benzer uzantılar vardır.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ea2e8-145">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="ea2e8-145">See also</span></span>

- [<span data-ttu-id="ea2e8-146">XAML Kaynakları</span><span class="sxs-lookup"><span data-stu-id="ea2e8-146">XAML Resources</span></span>](xaml-resources.md)
- [<span data-ttu-id="ea2e8-147">Stil ve Şablon Oluşturma</span><span class="sxs-lookup"><span data-stu-id="ea2e8-147">Styling and Templating</span></span>](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
