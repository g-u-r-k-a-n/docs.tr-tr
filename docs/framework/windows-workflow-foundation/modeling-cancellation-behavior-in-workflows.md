---
title: İş Akışlarında İptal Davranışını Modelleme
ms.date: 03/30/2017
ms.assetid: d48f6cf3-cdde-4dd3-8265-a665acf32a03
ms.openlocfilehash: 8738afa838f1d0ca36b7fd6def00f0794bcf47ac
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79143050"
---
# <a name="modeling-cancellation-behavior-in-workflows"></a><span data-ttu-id="e48ab-102">İş Akışlarında İptal Davranışını Modelleme</span><span class="sxs-lookup"><span data-stu-id="e48ab-102">Modeling Cancellation Behavior in Workflows</span></span>
<span data-ttu-id="e48ab-103"><xref:System.Activities.Statements.Parallel> Etkinlikler, örneğin, ev sahibi aradığında <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> `true` <xref:System.Activities.WorkflowApplication.Cancel%2A>iş akışı dışında veya dolduğunda eksik dalları iptal eden bir etkinlik tarafından bir iş akışı içinde iptal edilebilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-103">Activities can be canceled inside a workflow, for example by a <xref:System.Activities.Statements.Parallel> activity canceling incomplete branches when its <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> evaluates to `true`, or from outside the workflow, if the host calls <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span></span> <span data-ttu-id="e48ab-104">İptal işleme sağlamak için, iş <xref:System.Activities.Statements.CancellationScope> akışı yazarları <xref:System.Activities.Statements.CompensableActivity> etkinliği, etkinliği kullanabilir veya iptal mantığı sağlayan özel etkinlikler oluşturabilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-104">To provide cancellation handling, workflow authors can use the <xref:System.Activities.Statements.CancellationScope> activity, the <xref:System.Activities.Statements.CompensableActivity> activity, or create custom activities that provide cancellation logic.</span></span> <span data-ttu-id="e48ab-105">Bu konu, iş akışlarındaki iptale genel bir bakış sağlar.</span><span class="sxs-lookup"><span data-stu-id="e48ab-105">This topic provides an overview of cancellation in workflows.</span></span>  
  
## <a name="cancellation-compensation-and-transactions"></a><span data-ttu-id="e48ab-106">İptal, Tazminat ve İşlemler</span><span class="sxs-lookup"><span data-stu-id="e48ab-106">Cancellation, Compensation, and Transactions</span></span>  
 <span data-ttu-id="e48ab-107">Hareketler, işlem işleminin herhangi bir bölümünde herhangi bir hata oluşursa, uygulamanız için yapılan tüm değişiklikleri iptal etme (geri alma) olanağı sağlar.</span><span class="sxs-lookup"><span data-stu-id="e48ab-107">Transactions give your application the ability to abort (roll back) all changes executed within the transaction if any errors occur during any part of the transaction process.</span></span> <span data-ttu-id="e48ab-108">Ancak, iptal edilmesi veya geri alınması gereken tüm işler, uzun süren çalışma veya işlem kaynaklarını içermeyen çalışma gibi hareketler için uygun değildir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-108">However, not all work that may need to be canceled or undone is appropriate for transactions, such as long-running work or work that does not involve transactional resources.</span></span> <span data-ttu-id="e48ab-109">İş akışında sonraki bir hata varsa, daha önce tamamlanmış işlem dışı çalışmayı geri alamak için bir model sağlar.</span><span class="sxs-lookup"><span data-stu-id="e48ab-109">Compensation provides a model for undoing previously completed non-transactional work if there is a subsequent failure in the workflow.</span></span> <span data-ttu-id="e48ab-110">İptal, tamamlanmamış işlem dışı işleri işlemek için iş akışı ve etkinlik yazarları için bir model sağlar.</span><span class="sxs-lookup"><span data-stu-id="e48ab-110">Cancellation provides a model for workflow and activity authors to handle non-transactional work that was not completed.</span></span> <span data-ttu-id="e48ab-111">Bir etkinlik yürütmesini tamamlamadıysa ve iptal edilirse, varsa iptal mantığı çağrılır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-111">If an activity has not completed its execution and it is canceled, its cancellation logic will be invoked if it is available.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="e48ab-112">İşlemler ve tazminatlar hakkında daha fazla bilgi [için, Bkz. İşlemler](workflow-transactions.md) ve [Tazminatlar.](compensation.md)</span><span class="sxs-lookup"><span data-stu-id="e48ab-112">For more information about transactions and compensation, see [Transactions](workflow-transactions.md) and [Compensation](compensation.md).</span></span>  
  
## <a name="using-cancellationscope"></a><span data-ttu-id="e48ab-113">CancellationScope Kullanma</span><span class="sxs-lookup"><span data-stu-id="e48ab-113">Using CancellationScope</span></span>  
 <span data-ttu-id="e48ab-114">Etkinlik, <xref:System.Activities.Statements.CancellationScope> alt etkinlikleri içerebilecek iki <xref:System.Activities.Statements.CancellationScope.Body%2A> <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>bölümden oluşur: ve.</span><span class="sxs-lookup"><span data-stu-id="e48ab-114">The <xref:System.Activities.Statements.CancellationScope> activity has two sections that can contain child activities: <xref:System.Activities.Statements.CancellationScope.Body%2A> and <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>.</span></span> <span data-ttu-id="e48ab-115">Etkinlik <xref:System.Activities.Statements.CancellationScope.Body%2A> mantığını oluşturan etkinliklerin yerleştirildiği <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> yer, etkinlik için iptal mantığı sağlayan etkinliklerin yerleştirildiği yerdir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-115">The <xref:System.Activities.Statements.CancellationScope.Body%2A> is where the activities that make up the logic of the activity are placed, and the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> is where the activities that provide cancellation logic for the activity are placed.</span></span> <span data-ttu-id="e48ab-116">Bir etkinlik yalnızca tamamlanmadıysa iptal edilebilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-116">An activity can be canceled only if it has not completed.</span></span> <span data-ttu-id="e48ab-117"><xref:System.Activities.Statements.CancellationScope> Etkinlik söz konusu olduğunda, tamamlanma, faaliyetlerin tamamlanması anlamına <xref:System.Activities.Statements.CancellationScope.Body%2A>gelir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-117">In the case of the <xref:System.Activities.Statements.CancellationScope> activity, completion refers to the completion of the activities in the <xref:System.Activities.Statements.CancellationScope.Body%2A>.</span></span> <span data-ttu-id="e48ab-118">İptal isteği zamanlanmış sayılsa ve etkinlikler <xref:System.Activities.Statements.CancellationScope.Body%2A> <xref:System.Activities.Statements.CancellationScope> tamamlanmamışsa, bu durum işaretlenir <xref:System.Activities.ActivityInstanceState.Canceled> ve <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> etkinlikler yürütülür.</span><span class="sxs-lookup"><span data-stu-id="e48ab-118">If a cancellation request is scheduled and the activities in the <xref:System.Activities.Statements.CancellationScope.Body%2A> have not completed, then the <xref:System.Activities.Statements.CancellationScope> will be marked as <xref:System.Activities.ActivityInstanceState.Canceled> and the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> activities will be executed.</span></span>  
  
### <a name="canceling-a-workflow-from-the-host"></a><span data-ttu-id="e48ab-119">Ana Bilgisayar'dan İş Akışını İptal Etme</span><span class="sxs-lookup"><span data-stu-id="e48ab-119">Canceling a Workflow from the Host</span></span>  
 <span data-ttu-id="e48ab-120">Ana bilgisayar, iş akışını barındıran <xref:System.Activities.WorkflowApplication.Cancel%2A> <xref:System.Activities.WorkflowApplication> örneğin yöntemini çağırarak iş akışını iptal edebilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-120">A host can cancel a workflow by calling the <xref:System.Activities.WorkflowApplication.Cancel%2A> method of the <xref:System.Activities.WorkflowApplication> instance that is hosting the workflow.</span></span> <span data-ttu-id="e48ab-121">Aşağıdaki örnekte bir iş akışı oluşturulur. <xref:System.Activities.Statements.CancellationScope></span><span class="sxs-lookup"><span data-stu-id="e48ab-121">In the following example a workflow is created that has a <xref:System.Activities.Statements.CancellationScope>.</span></span> <span data-ttu-id="e48ab-122">İş akışı çağrılır ve sonra ana bilgisayar <xref:System.Activities.WorkflowApplication.Cancel%2A>' dan ' '</span><span class="sxs-lookup"><span data-stu-id="e48ab-122">The workflow is invoked, and then the host makes a call to <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span></span> <span data-ttu-id="e48ab-123">İş akışının ana yürütülmesi durdurulur, <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> <xref:System.Activities.Statements.CancellationScope> çağrılan ve daha sonra iş akışı bir durum <xref:System.Activities.ActivityInstanceState.Canceled>ile tamamlar .</span><span class="sxs-lookup"><span data-stu-id="e48ab-123">The main execution of the workflow is stopped, the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> of the <xref:System.Activities.Statements.CancellationScope> is invoked, and then the workflow completes with a status of <xref:System.Activities.ActivityInstanceState.Canceled>.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#35](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#35)]  
  
 <span data-ttu-id="e48ab-124">Bu iş akışı çağrıldığında, aşağıdaki çıktı konsola görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-124">When this workflow is invoked, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="e48ab-125">**İş akışını başlatılır.**</span><span class="sxs-lookup"><span data-stu-id="e48ab-125">**Starting the workflow.**</span></span>  
<span data-ttu-id="e48ab-126">**İptalHandler çağrıldı.** 
 **İş akışı b30ebb30-df46-4d90-a211-e31c38d8db3c İptal edildi.**</span><span class="sxs-lookup"><span data-stu-id="e48ab-126">**CancellationHandler invoked.**
**Workflow b30ebb30-df46-4d90-a211-e31c38d8db3c Canceled.**</span></span>
> [!NOTE]
> <span data-ttu-id="e48ab-127">Bir <xref:System.Activities.Statements.CancellationScope> etkinlik iptal edildiğinde <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> ve çağrıldığında, uygun iptal mantığını sağlamak için iptal edilen etkinliğin iptal edilmeden önce yaptığı ilerlemeyi belirlemek iş akışı yazarının sorumluluğundadır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-127">When a <xref:System.Activities.Statements.CancellationScope> activity is canceled and the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> invoked, it is the responsibility of the workflow author to determine the progress that the canceled activity made before it was canceled in order to provide the appropriate cancellation logic.</span></span> <span data-ttu-id="e48ab-128">İptal <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> edilen etkinliğin ilerlemesi hakkında herhangi bir bilgi sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="e48ab-128">The <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> does not provide any information about the progress of the canceled activity.</span></span>  
  
 <span data-ttu-id="e48ab-129">İşlenmemiş bir özel durum iş akışının kökünü aşar ve <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> işleyici döndürürse, <xref:System.Activities.UnhandledExceptionAction.Cancel>iş akışı ana bilgisayardan da iptal edilebilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-129">A workflow can also be canceled from the host if an unhandled exception bubbles up past the root of the workflow and the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler returns <xref:System.Activities.UnhandledExceptionAction.Cancel>.</span></span> <span data-ttu-id="e48ab-130">Bu örnekte iş akışı başlar ve <xref:System.ApplicationException>sonra bir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-130">In this example the workflow starts and then throws an <xref:System.ApplicationException>.</span></span> <span data-ttu-id="e48ab-131">Bu özel durum iş akışı tarafından <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> işlenmemiş ve bu nedenle işleyici çağrılır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-131">This exception is unhandled by the workflow and so the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler is invoked.</span></span> <span data-ttu-id="e48ab-132">İşleyici çalışma saatini iş akışını iptal etmek için <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> bildirir ve <xref:System.Activities.Statements.CancellationScope> şu anda çalıştırılatan etkinliğin çağrılması çağrılır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-132">The handler instructs the runtime to cancel the workflow, and the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> of the currently executing <xref:System.Activities.Statements.CancellationScope> activity is invoked.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#36](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#36)]  
  
 <span data-ttu-id="e48ab-133">Bu iş akışı çağrıldığında, aşağıdaki çıktı konsola görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-133">When this workflow is invoked, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="e48ab-134">**İş akışını başlatılır.**</span><span class="sxs-lookup"><span data-stu-id="e48ab-134">**Starting the workflow.**</span></span>  
<span data-ttu-id="e48ab-135">**OnUnhandledException in Workflow 6bb2d5d6-f49a-4c6d-a988-478afb86dbe9**
**Bir UygulamaException atıldı.** 
 **İptalHandler çağrıldı.** 
 **İş Akışı 6bb2d5d6-f49a-4c6d-a988-478afb86dbe9 İptal edildi.**</span><span class="sxs-lookup"><span data-stu-id="e48ab-135">**OnUnhandledException in Workflow 6bb2d5d6-f49a-4c6d-a988-478afb86dbe9**
**An ApplicationException was thrown.**
**CancellationHandler invoked.**
**Workflow 6bb2d5d6-f49a-4c6d-a988-478afb86dbe9 Canceled.**</span></span>
### <a name="canceling-an-activity-from-inside-a-workflow"></a><span data-ttu-id="e48ab-136">Bir İş Akışı İçinden Bir Etkinliği İptal Etme</span><span class="sxs-lookup"><span data-stu-id="e48ab-136">Canceling an Activity from Inside a Workflow</span></span>  
 <span data-ttu-id="e48ab-137">Bir etkinlik, üst öğesi tarafından da iptal edilebilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-137">An activity can also be canceled by its parent.</span></span> <span data-ttu-id="e48ab-138">Örneğin, bir <xref:System.Activities.Statements.Parallel> etkinliğin birden çok yürütme <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> dalı varsa `true` ve onun değerlendirmeleri sonra eksik dalları iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-138">For example, if a <xref:System.Activities.Statements.Parallel> activity has multiple executing branches and its <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> evaluates to `true` then its incomplete branches will be canceled.</span></span> <span data-ttu-id="e48ab-139">Bu örnekte <xref:System.Activities.Statements.Parallel> iki dalı olan bir etkinlik oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="e48ab-139">In this example a <xref:System.Activities.Statements.Parallel> activity is created that has two branches.</span></span> <span data-ttu-id="e48ab-140">Herhangi <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> bir `true` şubesi <xref:System.Activities.Statements.Parallel> tamamlanır tamamlanmaz tamamlanacak şekilde ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-140">Its <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> is set to `true` so the <xref:System.Activities.Statements.Parallel> completes as soon as any one of its branches is completed.</span></span> <span data-ttu-id="e48ab-141">Bu örnekte şube 2 tamamlanır ve böylece şube 1 iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-141">In this example branch 2 completes, and so branch 1 is canceled.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#37](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#37)]  
  
 <span data-ttu-id="e48ab-142">Bu iş akışı çağrıldığında, aşağıdaki çıktı konsola görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-142">When this workflow is invoked, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="e48ab-143">**Şube 1 başlıyor.**</span><span class="sxs-lookup"><span data-stu-id="e48ab-143">**Branch 1 starting.**</span></span>  
<span data-ttu-id="e48ab-144">**Şube 2 tamamlandı.** 
 **Şube 1 iptal edildi.** 
 **İş Akışı e0685e24-18ef-4a47-acf3-5c638732f3be Tamamlandı.**</span><span class="sxs-lookup"><span data-stu-id="e48ab-144">**Branch 2 complete.**
**Branch 1 canceled.**
**Workflow e0685e24-18ef-4a47-acf3-5c638732f3be Completed.**</span></span>  <span data-ttu-id="e48ab-145">Bir özel durum, etkinliğin kökünü aşar ancak iş akışında daha yüksek bir düzeyde işlenirse etkinlikler de iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-145">Activities are also canceled if an exception bubbles up past the root of the activity but is handled at a higher level in the workflow.</span></span> <span data-ttu-id="e48ab-146">Bu örnekte, iş akışının ana mantığı <xref:System.Activities.Statements.Sequence> bir etkinlikten oluşur.</span><span class="sxs-lookup"><span data-stu-id="e48ab-146">In this example, the main logic of the workflow consists of a <xref:System.Activities.Statements.Sequence> activity.</span></span> <span data-ttu-id="e48ab-147">Bir <xref:System.Activities.Statements.Sequence> <xref:System.Activities.Statements.TryCatch> etkinlik tarafından <xref:System.Activities.Statements.CancellationScope.Body%2A> bulunan <xref:System.Activities.Statements.CancellationScope> bir etkinliğin olarak belirtilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-147">The <xref:System.Activities.Statements.Sequence> is specified as the <xref:System.Activities.Statements.CancellationScope.Body%2A> of a <xref:System.Activities.Statements.CancellationScope> activity which is contained by a <xref:System.Activities.Statements.TryCatch> activity.</span></span> <span data-ttu-id="e48ab-148">Bir özel durum gövdesinden <xref:System.Activities.Statements.Sequence>atılır , üst <xref:System.Activities.Statements.TryCatch> etkinlik tarafından <xref:System.Activities.Statements.Sequence> işlenir ve iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-148">An exception is thrown from the body of the <xref:System.Activities.Statements.Sequence>, is handled by the parent <xref:System.Activities.Statements.TryCatch> activity, and the <xref:System.Activities.Statements.Sequence> is canceled.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#39](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#39)]  
  
 <span data-ttu-id="e48ab-149">Bu iş akışı çağrıldığında, aşağıdaki çıktı konsola görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-149">When this workflow is invoked, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="e48ab-150">**Dizi başlangıç.**</span><span class="sxs-lookup"><span data-stu-id="e48ab-150">**Sequence starting.**</span></span>  
<span data-ttu-id="e48ab-151">**Sıra iptal edildi.** 
 **İstisna yakalandı.** 
 **İş Akışı e3c18939-121e-4c43-af1c-ba1ce977ce55 Tamamlandı.**</span><span class="sxs-lookup"><span data-stu-id="e48ab-151">**Sequence canceled.**
**Exception caught.**
**Workflow e3c18939-121e-4c43-af1c-ba1ce977ce55 Completed.**</span></span>
### <a name="throwing-exceptions-from-a-cancellationhandler"></a><span data-ttu-id="e48ab-152">İptalHandler'dan İstisnaları Atma</span><span class="sxs-lookup"><span data-stu-id="e48ab-152">Throwing Exceptions from a CancellationHandler</span></span>  
 <span data-ttu-id="e48ab-153">A'dan <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> <xref:System.Activities.Statements.CancellationScope> atılan tüm özel durumlar iş akışı için ölümcüldür.</span><span class="sxs-lookup"><span data-stu-id="e48ab-153">Any exceptions thrown from the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> of a <xref:System.Activities.Statements.CancellationScope> are fatal to the workflow.</span></span> <span data-ttu-id="e48ab-154">Bir özel durum dan kaçan bir <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>olasılık varsa, <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> bu özel durumları yakalamak ve işlemek için a <xref:System.Activities.Statements.TryCatch> kullanın.</span><span class="sxs-lookup"><span data-stu-id="e48ab-154">If there is a possibility of exceptions escaping from a <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>, use a <xref:System.Activities.Statements.TryCatch> in the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> to catch and handle these exceptions.</span></span>  
  
### <a name="cancellation-using-compensableactivity"></a><span data-ttu-id="e48ab-155">Telafi Etkinliği kullanarak iptal</span><span class="sxs-lookup"><span data-stu-id="e48ab-155">Cancellation using CompensableActivity</span></span>  
 <span data-ttu-id="e48ab-156"><xref:System.Activities.Statements.CancellationScope> Etkinlik gibi, <xref:System.Activities.Statements.CompensableActivity> bir <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="e48ab-156">Like the <xref:System.Activities.Statements.CancellationScope> activity, the <xref:System.Activities.Statements.CompensableActivity> has a <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A>.</span></span> <span data-ttu-id="e48ab-157">A <xref:System.Activities.Statements.CompensableActivity> iptal edilirse, içinde <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A> herhangi bir etkinlik çağrılır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-157">If a <xref:System.Activities.Statements.CompensableActivity> is canceled, any activities in its <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A> are invoked.</span></span> <span data-ttu-id="e48ab-158">Bu kısmen tamamlanmış telafi edilebilir iş geri getirmek için yararlı olabilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-158">This can be useful for undoing partially completed compensable work.</span></span> <span data-ttu-id="e48ab-159">Tazminat ve iptal <xref:System.Activities.Statements.CompensableActivity> için nasıl kullanılacağı hakkında bilgi için [Tazminat'a](compensation.md)bakın.</span><span class="sxs-lookup"><span data-stu-id="e48ab-159">For information about how to use <xref:System.Activities.Statements.CompensableActivity> for compensation and cancellation, see [Compensation](compensation.md).</span></span>  
  
## <a name="cancellation-using-custom-activities"></a><span data-ttu-id="e48ab-160">Özel Etkinlikler kullanılarak İptal</span><span class="sxs-lookup"><span data-stu-id="e48ab-160">Cancellation using Custom Activities</span></span>  
 <span data-ttu-id="e48ab-161">Özel etkinlik yazarları, özel etkinliklerine iptal mantığını birkaç farklı şekilde uygulayabilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-161">Custom activity authors can implement cancellation logic into their custom activities in several different ways.</span></span> <span data-ttu-id="e48ab-162">Türeyen <xref:System.Activities.Activity> özel etkinlikler, etkinliğin gövdesine <xref:System.Activities.Statements.CancellationScope> iptal mantığı içeren bir veya başka bir özel etkinlik yerleştirerek iptal mantığını uygulayabilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-162">Custom activities that derive from <xref:System.Activities.Activity> can implement cancellation logic by placing a <xref:System.Activities.Statements.CancellationScope> or other custom activity that contains cancellation logic in the body of the activity.</span></span> <span data-ttu-id="e48ab-163"><xref:System.Activities.AsyncCodeActivity>ve <xref:System.Activities.NativeActivity> türetilen faaliyetler kendi <xref:System.Activities.NativeActivity.Cancel%2A> yöntemini geçersiz kılabilir ve burada iptal mantığı sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-163"><xref:System.Activities.AsyncCodeActivity> and <xref:System.Activities.NativeActivity> derived activities can override their respective <xref:System.Activities.NativeActivity.Cancel%2A> method and provide cancellation logic there.</span></span> <span data-ttu-id="e48ab-164"><xref:System.Activities.CodeActivity>türetilen faaliyetler iptal için herhangi bir hüküm sağlamaz, çünkü çalışma zamanı <xref:System.Activities.CodeActivity.Execute%2A> yöntemi aradığında tüm çalışmaları tek bir yürütme patlamasında gerçekleştirilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-164"><xref:System.Activities.CodeActivity> derived activities do not provide any provision for cancellation because all their work is performed in a single burst of execution when the runtime calls the <xref:System.Activities.CodeActivity.Execute%2A> method.</span></span> <span data-ttu-id="e48ab-165">Yürütme yöntemi henüz çağrılmazsa ve <xref:System.Activities.CodeActivity> tabanlı bir etkinlik iptal edilirse, etkinlik <xref:System.Activities.ActivityInstanceState.Canceled> bir <xref:System.Activities.CodeActivity.Execute%2A> durumla kapanır ve yöntem çağrılmaz.</span><span class="sxs-lookup"><span data-stu-id="e48ab-165">If the execute method has not yet been called and a <xref:System.Activities.CodeActivity> based activity is canceled, the activity closes with a status of <xref:System.Activities.ActivityInstanceState.Canceled> and the <xref:System.Activities.CodeActivity.Execute%2A> method is not called.</span></span>  
  
### <a name="cancellation-using-nativeactivity"></a><span data-ttu-id="e48ab-166">NativeActivity kullanarak iptal</span><span class="sxs-lookup"><span data-stu-id="e48ab-166">Cancellation using NativeActivity</span></span>  
 <span data-ttu-id="e48ab-167"><xref:System.Activities.NativeActivity>türetilen etkinlikler özel <xref:System.Activities.NativeActivity.Cancel%2A> iptal mantığı sağlamak için yöntemi geçersiz kılabilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-167"><xref:System.Activities.NativeActivity> derived activities can override the <xref:System.Activities.NativeActivity.Cancel%2A> method to provide custom cancellation logic.</span></span> <span data-ttu-id="e48ab-168">Bu yöntem geçersiz kılınmazsa, varsayılan iş akışı iptali mantığı uygulanır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-168">If this method is not overridden, then the default workflow cancellation logic is applied.</span></span> <span data-ttu-id="e48ab-169">Varsayılan iptal yöntemi geçersiz kılmayan <xref:System.Activities.NativeActivity> <xref:System.Activities.NativeActivity.Cancel%2A> veya <xref:System.Activities.NativeActivity.Cancel%2A> yöntemi temel <xref:System.Activities.NativeActivity> <xref:System.Activities.NativeActivity.Cancel%2A> yöntemi çağıran bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-169">Default cancellation is the process that occurs for a <xref:System.Activities.NativeActivity> that does not override the <xref:System.Activities.NativeActivity.Cancel%2A> method or whose <xref:System.Activities.NativeActivity.Cancel%2A> method calls the base <xref:System.Activities.NativeActivity> <xref:System.Activities.NativeActivity.Cancel%2A> method.</span></span> <span data-ttu-id="e48ab-170">Bir etkinlik iptal edildiğinde, çalışma zamanı iptal için etkinliği işaretler ve belirli temizlemeleri otomatik olarak işler.</span><span class="sxs-lookup"><span data-stu-id="e48ab-170">When an activity is canceled, the runtime flags the activity for cancellation and automatically handles certain cleanup.</span></span> <span data-ttu-id="e48ab-171">Etkinlik yalnızca bekleyen yer imleri varsa, yer imleri kaldırılır ve <xref:System.Activities.ActivityInstanceState.Canceled>etkinlik .</span><span class="sxs-lookup"><span data-stu-id="e48ab-171">If the activity only has outstanding bookmarks, the bookmarks will be removed and the activity will be marked as <xref:System.Activities.ActivityInstanceState.Canceled>.</span></span> <span data-ttu-id="e48ab-172">İptal edilen etkinliğin olağanüstü alt etkinlikleri de iptal edilecektir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-172">Any outstanding child activities of the canceled activity will in turn be canceled.</span></span> <span data-ttu-id="e48ab-173">Ek alt etkinlikler zamanlamaya yönelik herhangi bir girişim, girişimin yoksayılmasına neden olur ve etkinlik <xref:System.Activities.ActivityInstanceState.Canceled>.</span><span class="sxs-lookup"><span data-stu-id="e48ab-173">Any attempt to schedule additional child activities will result in the attempt being ignored and the activity will be marked as <xref:System.Activities.ActivityInstanceState.Canceled>.</span></span> <span data-ttu-id="e48ab-174">Olağanüstü alt etkinlik veya <xref:System.Activities.ActivityInstanceState.Canceled> <xref:System.Activities.ActivityInstanceState.Faulted> durumda tamamlanırsa, etkinlik . <xref:System.Activities.ActivityInstanceState.Canceled></span><span class="sxs-lookup"><span data-stu-id="e48ab-174">If any outstanding child activity completes in the <xref:System.Activities.ActivityInstanceState.Canceled> or <xref:System.Activities.ActivityInstanceState.Faulted> state, then the activity will be marked as <xref:System.Activities.ActivityInstanceState.Canceled>.</span></span> <span data-ttu-id="e48ab-175">İptal isteğinin yoksayılmasına dikkat edin.</span><span class="sxs-lookup"><span data-stu-id="e48ab-175">Note that a cancellation request can be ignored.</span></span> <span data-ttu-id="e48ab-176">Bir etkinlikte bekleyen yer imleri veya yürütme alt etkinlikleri yoksa ve iptal için işaretlendikten sonra ek iş öğeleri zamanlamazsa, başarıyla tamamlanır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-176">If an activity does not have any outstanding bookmarks or executing child activities and does not schedule any additional work items after being flagged for cancellation, it will complete successfully.</span></span> <span data-ttu-id="e48ab-177">Bu varsayılan iptal birçok senaryo için yeterlidir, ancak ek iptal mantığı gerekiyorsa, yerleşik iptal etkinlikleri veya özel etkinlikler kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-177">This default cancellation suffices for many scenarios, but if additional cancellation logic is needed, then the built-in cancellation activities or custom activities can be used.</span></span>  
  
 <span data-ttu-id="e48ab-178">Aşağıdaki örnekte, <xref:System.Activities.NativeActivity.Cancel%2A> tabanlı bir <xref:System.Activities.NativeActivity> özel `ParallelForEach` etkinliğin geçersiz kılınmı tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-178">In the following example, the <xref:System.Activities.NativeActivity.Cancel%2A> override of a <xref:System.Activities.NativeActivity> based custom `ParallelForEach` activity is defined.</span></span> <span data-ttu-id="e48ab-179">Etkinlik iptal edildiğinde, bu geçersiz kılma, etkinliğin iptal mantığını işler.</span><span class="sxs-lookup"><span data-stu-id="e48ab-179">When the activity is canceled, this override handles the cancellation logic for the activity.</span></span> <span data-ttu-id="e48ab-180">Bu örnek, [Genel Olmayan ParallelForEach](./samples/non-generic-parallelforeach.md) örneğinin bir parçasıdır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-180">This example is part of the [Non-Generic ParallelForEach](./samples/non-generic-parallelforeach.md) sample.</span></span>  
  
```csharp  
protected override void Cancel(NativeActivityContext context)  
{  
    // If we do not have a completion condition then we can just  
    // use default logic.  
    if (this.CompletionCondition == null)  
    {  
        base.Cancel(context);  
    }  
    else  
    {  
        context.CancelChildren();  
    }  
}  
```  
  
 <span data-ttu-id="e48ab-181"><xref:System.Activities.NativeActivity>türemiş faaliyetler, <xref:System.Activities.NativeActivityContext.IsCancellationRequested%2A> mülkü inceleyerek iptal talebinde bulunulup bulunulan olmadığını belirleyebilir ve <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> yöntemi arayarak kendilerini iptal edilmiş olarak işaretleyebilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-181"><xref:System.Activities.NativeActivity> derived activities can determine if cancellation has been requested by inspecting the <xref:System.Activities.NativeActivityContext.IsCancellationRequested%2A> property, and mark themselves as canceled by calling the <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> method.</span></span> <span data-ttu-id="e48ab-182">Arama <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> hemen etkinliği tamamlamaz.</span><span class="sxs-lookup"><span data-stu-id="e48ab-182">Calling <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> does not immediately complete the activity.</span></span> <span data-ttu-id="e48ab-183">Her zamanki gibi, çalışma zamanı artık bekleyen iş olduğunda etkinliği <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> tamamlar, ancak <xref:System.Activities.ActivityInstanceState.Canceled> son <xref:System.Activities.ActivityInstanceState.Closed>durum yerine '' olarak adlandırılırsa.</span><span class="sxs-lookup"><span data-stu-id="e48ab-183">As usual, the runtime will complete the activity when it has no more outstanding work, but if <xref:System.Activities.NativeActivityContext.MarkCanceled%2A> is called the final state will be <xref:System.Activities.ActivityInstanceState.Canceled> instead of <xref:System.Activities.ActivityInstanceState.Closed>.</span></span>  
  
### <a name="cancellation-using-asynccodeactivity"></a><span data-ttu-id="e48ab-184">AsyncCodeActivity kullanarak iptal</span><span class="sxs-lookup"><span data-stu-id="e48ab-184">Cancellation using AsyncCodeActivity</span></span>  
 <span data-ttu-id="e48ab-185"><xref:System.Activities.AsyncCodeActivity>tabanlı etkinlikler de <xref:System.Activities.AsyncCodeActivity.Cancel%2A> yöntemi geçersiz kılarak özel iptal mantığı sağlayabilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-185"><xref:System.Activities.AsyncCodeActivity> based activities can also provide custom cancellation logic by overriding the <xref:System.Activities.AsyncCodeActivity.Cancel%2A> method.</span></span> <span data-ttu-id="e48ab-186">Bu yöntem geçersiz kılınmazsa, etkinlik iptal edilirse iptal işlemi yapılmaz.</span><span class="sxs-lookup"><span data-stu-id="e48ab-186">If this method is not overridden, then no cancellation handling is performed if the activity is canceled.</span></span> <span data-ttu-id="e48ab-187">Aşağıdaki örnekte, <xref:System.Activities.AsyncCodeActivity.Cancel%2A> tabanlı bir <xref:System.Activities.AsyncCodeActivity> özel `ExecutePowerShell` etkinliğin geçersiz kılınmı tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="e48ab-187">In the following example, the <xref:System.Activities.AsyncCodeActivity.Cancel%2A> override of an <xref:System.Activities.AsyncCodeActivity> based custom `ExecutePowerShell` activity is defined.</span></span> <span data-ttu-id="e48ab-188">Etkinlik iptal edildiğinde, istenen iptal davranışını gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-188">When the activity is canceled, it performs the desired cancellation behavior.</span></span>
  
 [!code-csharp[CFX_WorkflowApplicationExample#1020](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#1020)]  
  
 <span data-ttu-id="e48ab-189"><xref:System.Activities.AsyncCodeActivity>türemiş faaliyetler, <xref:System.Activities.AsyncCodeActivityContext.IsCancellationRequested%2A> mülkü inceleyerek iptal talebinde bulunulup bulunulan olmadığını belirleyebilir ve <xref:System.Activities.AsyncCodeActivityContext.MarkCanceled%2A> yöntemi arayarak kendilerini iptal edilmiş olarak işaretleyebilir.</span><span class="sxs-lookup"><span data-stu-id="e48ab-189"><xref:System.Activities.AsyncCodeActivity> derived activities can determine if cancellation has been requested by inspecting the <xref:System.Activities.AsyncCodeActivityContext.IsCancellationRequested%2A> property, and mark themselves as canceled by calling the <xref:System.Activities.AsyncCodeActivityContext.MarkCanceled%2A> method.</span></span>
