---
title: Win32'de Ev sahibi WPF içeriği
titleSuffix: ''
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
ms.openlocfilehash: 8a5d556abf49c9c1f49e7853e752ebc5248d1101
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79186064"
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="4eb11-102">İzlenecek yol: Win32'de WPF Barındırma</span><span class="sxs-lookup"><span data-stu-id="4eb11-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="4eb11-103">uygulamaları oluşturmak için zengin bir ortam sağlar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-103">provides a rich environment for creating applications.</span></span> <span data-ttu-id="4eb11-104">Ancak, Win32 koduna önemli bir yatırımınız olduğunda, özgün [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] kodunuzu yeniden yazmak yerine uygulamanız için işlevsellik eklemek daha etkili olabilir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-104">However, when you have a substantial investment in Win32 code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="4eb11-105">Win32 penceresinde [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik barındırma için basit bir mekanizma sağlar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-105">provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span>  
  
 <span data-ttu-id="4eb11-106">Bu öğretici, win32 penceresinde içerik barındıran [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] bir [Win32 Pencere Örneğinde WPF İçeriği Barındırma,](https://github.com/Microsoft/WPF-Samples/tree/master/Migration%20and%20Interoperability/Win32HostingWPFPage)örnek bir uygulama, Hosting nasıl açıklanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Migration%20and%20Interoperability/Win32HostingWPFPage), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span> <span data-ttu-id="4eb11-107">Bu örneği herhangi bir Win32 penceresini barındıracak şekilde genişletebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-107">You can extend this sample to host any Win32 window.</span></span> <span data-ttu-id="4eb11-108">Yönetilen ve yönetilmeyen kodun karıştırılması içerdiğinden, uygulama C++/CLI dilinde yazılır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-108">Because it involves mixing managed and unmanaged code, the application is written in C++/CLI.</span></span>  

<a name="requirements"></a>
## <a name="requirements"></a><span data-ttu-id="4eb11-109">Gereksinimler</span><span class="sxs-lookup"><span data-stu-id="4eb11-109">Requirements</span></span>  
 <span data-ttu-id="4eb11-110">Bu öğretici hem de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Win32 programlama ile temel bir aşinalık varsayar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Win32 programming.</span></span> <span data-ttu-id="4eb11-111">Programlamaya temel [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] bir giriş için [başlarken](../getting-started/index.md)bakın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../getting-started/index.md).</span></span> <span data-ttu-id="4eb11-112">Win32 programlama bir giriş için, charles Petzold tarafından özellikle *Programlama Windows,* konuyla ilgili çok sayıda kitap herhangi bir referans gerekir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-112">For an introduction to Win32 programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="4eb11-113">Bu öğreticiye eşlik eden örnek C++/CLI'de uygulandığından, bu öğretici Windows API'sini programlamak için C++'ın kullanımı yla ve yönetilen kod programlama anlayışına aşinalığı varsayar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-113">Because the sample that accompanies this tutorial is implemented in C++/CLI, this tutorial assumes familiarity with the use of C++ to program the Windows API plus an understanding of managed code programming.</span></span> <span data-ttu-id="4eb11-114">C++/CLI'ye aşinalık yararlıdır, ancak gerekli değildir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-114">Familiarity with C++/CLI is helpful but not essential.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4eb11-115">Bu öğretici, ilişkili örnekten bir dizi kod örneği içerir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="4eb11-116">Ancak, okunabilirlik için, tam örnek kodu içermez.</span><span class="sxs-lookup"><span data-stu-id="4eb11-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="4eb11-117">Örnek kodun tamamı için [Win32 Pencere Örneğinde WPF İçeriği barındırma'ya](https://github.com/Microsoft/WPF-Samples/tree/master/Migration%20and%20Interoperability/Win32HostingWPFPage)bakın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Migration%20and%20Interoperability/Win32HostingWPFPage).</span></span>  
  
<a name="basic_procedure"></a>
## <a name="the-basic-procedure"></a><span data-ttu-id="4eb11-118">Temel Prosedür</span><span class="sxs-lookup"><span data-stu-id="4eb11-118">The Basic Procedure</span></span>  
 <span data-ttu-id="4eb11-119">Bu bölümde, win32 penceresinde [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği barındırmak için kullandığınız temel yordam özetlanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span> <span data-ttu-id="4eb11-120">Kalan bölümlerher adımın ayrıntılarını açıklar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="4eb11-121">Win32 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] penceresinde içerik barındırmanın <xref:System.Windows.Interop.HwndSource> anahtarı sınıftır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a Win32 window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="4eb11-122">Bu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sınıf, içeriği Win32 penceresinde sarar ve alt penceresiolarak [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] içeriğinize dahil edilmesine izin verir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="4eb11-123">Aşağıdaki yaklaşım Win32'yi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tek bir uygulamada birleştirir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-123">The following approach combines the Win32 and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1. <span data-ttu-id="4eb11-124">İçeriğinizi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] yönetilen bir sınıf olarak uygulayın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2. <span data-ttu-id="4eb11-125">C++/CLI içeren bir Windows uygulaması uygulayın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-125">Implement a Windows application with C++/CLI.</span></span> <span data-ttu-id="4eb11-126">Varolan bir uygulama ve yönetilmeyen bir C++ koduyla başlıyorsanız, proje ayarlarınızı derleyici `/clr` bayrağını içerecek şekilde değiştirerek genellikle yönetilen kodu aramasını etkinleştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-126">If you are starting with an existing application and unmanaged C++ code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3. <span data-ttu-id="4eb11-127">İş parçacığı modelini tek dişli daire (STA) olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4. <span data-ttu-id="4eb11-128">Pencere yordamınızda [WM_CREATE](/windows/desktop/winmsg/wm-create)bildirimini işleyebilir ve aşağıdakileri yapın:</span><span class="sxs-lookup"><span data-stu-id="4eb11-128">Handle the [WM_CREATE](/windows/desktop/winmsg/wm-create)notification in your window procedure and do the following:</span></span>  
  
    1. <span data-ttu-id="4eb11-129">Parametresi <xref:System.Windows.Interop.HwndSource> olarak ana pencere ile yeni bir nesne oluşturun. `parent`</span><span class="sxs-lookup"><span data-stu-id="4eb11-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2. <span data-ttu-id="4eb11-130">İçerik sınıfınızın [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] bir örneğini oluşturun.</span><span class="sxs-lookup"><span data-stu-id="4eb11-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3. <span data-ttu-id="4eb11-131">İçerik nesnesine [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Interop.HwndSource.RootVisual%2A> <xref:System.Windows.Interop.HwndSource>bir başvuru ata.</span><span class="sxs-lookup"><span data-stu-id="4eb11-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4. <span data-ttu-id="4eb11-132">İçerik için HWND'yi alın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-132">Get the HWND for the content.</span></span> <span data-ttu-id="4eb11-133">Nesnenin <xref:System.Windows.Interop.HwndSource.Handle%2A> <xref:System.Windows.Interop.HwndSource> özelliği pencere tutamacı (HWND) içerir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="4eb11-134">Uygulamanızın yönetilmeyen bölümünde kullanabileceğiniz bir HWND almak için, bir HWND döküm. `Handle.ToPointer()`</span><span class="sxs-lookup"><span data-stu-id="4eb11-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5. <span data-ttu-id="4eb11-135">İçeriğinize başvuruda bulunabilmek için statik alan [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeren yönetilen bir sınıf uygulayın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="4eb11-136">Bu sınıf, Win32 kodunuzdan [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğe bir başvuru almanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your Win32 code.</span></span>  
  
6. <span data-ttu-id="4eb11-137">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği statik alana atayın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7. <span data-ttu-id="4eb11-138">Olaylardan birine [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] veya daha fazlasına bir işleyici ekleyerek içerikten bildirimler alın. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="4eb11-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8. <span data-ttu-id="4eb11-139">Özellikleri ayarlamak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] için statik alanda depoladığınız başvuruyu kullanarak içerikle iletişim kurun.</span><span class="sxs-lookup"><span data-stu-id="4eb11-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4eb11-140">İçeriğinizi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uygulamak [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] için de kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="4eb11-141">Ancak, dinamik bağlantı kitaplığı (DLL) olarak ayrı ayrı derlemeniz ve Win32 uygulamanızdan DLL'ye başvurmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-141">However, you will have to compile it separately as a dynamic-link library (DLL) and reference that DLL from your Win32 application.</span></span> <span data-ttu-id="4eb11-142">Yordamın geri kalanı yukarıda özetlenen benzer.</span><span class="sxs-lookup"><span data-stu-id="4eb11-142">The remainder of the procedure is similar to that outlined above.</span></span>

<a name="implementing_the_application"></a>
## <a name="implementing-the-host-application"></a><span data-ttu-id="4eb11-143">Ana Bilgisayar Uygulamasının Uygulanması</span><span class="sxs-lookup"><span data-stu-id="4eb11-143">Implementing the Host Application</span></span>
 <span data-ttu-id="4eb11-144">Bu bölümde, temel [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] bir Win32 uygulamasında içeriğin nasıl barındırılanması açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic Win32 application.</span></span> <span data-ttu-id="4eb11-145">İçeriğin kendisi Yönetilen bir sınıf olarak C++/CLI'de uygulanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-145">The content itself is implemented in C++/CLI as a managed class.</span></span> <span data-ttu-id="4eb11-146">Çoğunlukla, basit [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programlama.</span><span class="sxs-lookup"><span data-stu-id="4eb11-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="4eb11-147">[WPF İçeriğinin Uygulanmasında](#implementing_the_wpf_page)içerik uygulamasının temel yönleri tartışılmıştır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>

- [<span data-ttu-id="4eb11-148">Temel Uygulama</span><span class="sxs-lookup"><span data-stu-id="4eb11-148">The Basic Application</span></span>](#the_basic_application)

- [<span data-ttu-id="4eb11-149">WPF İçeriğinin Barındırılıca</span><span class="sxs-lookup"><span data-stu-id="4eb11-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)

- [<span data-ttu-id="4eb11-150">WPF İçeriğine Başvuru Tutma</span><span class="sxs-lookup"><span data-stu-id="4eb11-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)

- [<span data-ttu-id="4eb11-151">WPF İçeriği ile iletişim kurma</span><span class="sxs-lookup"><span data-stu-id="4eb11-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)

<a name="the_basic_application"></a>
### <a name="the-basic-application"></a><span data-ttu-id="4eb11-152">Temel Uygulama</span><span class="sxs-lookup"><span data-stu-id="4eb11-152">The Basic Application</span></span>
 <span data-ttu-id="4eb11-153">Ana bilgisayar uygulamasının başlangıç noktası Visual Studio 2005 şablonu oluşturmaktı.</span><span class="sxs-lookup"><span data-stu-id="4eb11-153">The starting point for the host application was to create a Visual Studio 2005 template.</span></span>

1. <span data-ttu-id="4eb11-154">Visual Studio 2005'i açın ve **Dosya** menüsünden **Yeni Proje'yi** seçin.</span><span class="sxs-lookup"><span data-stu-id="4eb11-154">Open Visual Studio 2005, and select **New Project** from the **File** menu.</span></span>

2. <span data-ttu-id="4eb11-155">Visual C++ proje türleri listesinden **Win32'yi** seçin.</span><span class="sxs-lookup"><span data-stu-id="4eb11-155">Select **Win32** from the list of Visual C++ project types.</span></span> <span data-ttu-id="4eb11-156">Varsayılan diliniz C++değilse, bu proje türlerini **Diğer Diller**altında bulabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-156">If your default language is not C++, you will find these project types under **Other Languages**.</span></span>

3. <span data-ttu-id="4eb11-157">**Win32 Project** şablonu seçin, projeye bir ad atayın ve **Win32 Uygulama Sihirbazı'nı**başlatmak için **Tamam'ı** tıklatın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>

4. <span data-ttu-id="4eb11-158">Sihirbazın varsayılan ayarlarını kabul edin ve projeyi başlatmak için **Bitir'i** tıklatın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>

 <span data-ttu-id="4eb11-159">Şablon, aşağıdakiler de dahil olmak üzere temel bir Win32 uygulaması oluşturur:</span><span class="sxs-lookup"><span data-stu-id="4eb11-159">The template creates a basic Win32 application, including:</span></span>

- <span data-ttu-id="4eb11-160">Uygulama için bir giriş noktası.</span><span class="sxs-lookup"><span data-stu-id="4eb11-160">An entry point for the application.</span></span>

- <span data-ttu-id="4eb11-161">İlişkili bir pencere yordamı (WndProc) ile bir pencere.</span><span class="sxs-lookup"><span data-stu-id="4eb11-161">A window, with an associated window procedure (WndProc).</span></span>

- <span data-ttu-id="4eb11-162">**Dosya** ve **Yardım** başlıklarını içeren bir menü.</span><span class="sxs-lookup"><span data-stu-id="4eb11-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="4eb11-163">**Dosya** menüsünde uygulamayı kapatan bir **Çıkış** öğesi vardır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="4eb11-164">**Yardım** menüsünde basit bir iletişim kutusu başlatan Bir **Hakkında** öğesi vardır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>

 <span data-ttu-id="4eb11-165">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği barındırmak için kod yazmaya başlamadan önce, temel şablonda iki değişiklik yapmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>

 <span data-ttu-id="4eb11-166">Bunlardan ilki, projeyi yönetilen kod olarak derlemektir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="4eb11-167">Varsayılan olarak, proje yönetilmeyen kod olarak derler.</span><span class="sxs-lookup"><span data-stu-id="4eb11-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="4eb11-168">Ancak, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] yönetilen kodda uygulandığından, projenin buna göre derlemesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>

1. <span data-ttu-id="4eb11-169">**Çözüm Gezgini'nde** proje adını sağ tıklatın ve Özellik **Sayfaları** iletişim kutusunu başlatmak için bağlam menüsünden **Özellikler'i** seçin.</span><span class="sxs-lookup"><span data-stu-id="4eb11-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>

2. <span data-ttu-id="4eb11-170">Sol bölmedeki ağaç görünümünden **Yapılandırma Özellikleri'ni** seçin.</span><span class="sxs-lookup"><span data-stu-id="4eb11-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>

3. <span data-ttu-id="4eb11-171">Sağ bölmedeki **Proje Varsayılanları** listesinden **Ortak Dil Çalışma Zamanı** desteğini seçin.</span><span class="sxs-lookup"><span data-stu-id="4eb11-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>

4. <span data-ttu-id="4eb11-172">Açılan liste kutusundan **Ortak Dil Çalışma Süresi Desteği'ni (/clr)** seçin.</span><span class="sxs-lookup"><span data-stu-id="4eb11-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>

> [!NOTE]
> <span data-ttu-id="4eb11-173">Bu derleyici bayrağı, uygulamanızda yönetilen kodu kullanmanıza olanak tanır, ancak yönetilmeyen kodunuz eskisi gibi derlenecektir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>

 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="4eb11-174">tek dişli daire (STA) iş parçacığı modelini kullanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-174">uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="4eb11-175">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik koduyla düzgün çalışabilmek için, giriş noktasına bir öznitelik uygulayarak uygulamanın iş parçacığı modelini STA olarak ayarlamanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>

 [!code-cpp[Win32HostingWPFPage#WinMain](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]

<a name="hosting_the_wpf_page"></a>
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="4eb11-176">WPF İçeriğinin Barındırılıca</span><span class="sxs-lookup"><span data-stu-id="4eb11-176">Hosting the WPF Content</span></span>
 <span data-ttu-id="4eb11-177">İçerik [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] basit bir adres giriş uygulamasıdır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="4eb11-178">Kullanıcı adını, <xref:System.Windows.Controls.TextBox> adresi ve benzeri bilgileri almak için çeşitli denetimlerden oluşur.</span><span class="sxs-lookup"><span data-stu-id="4eb11-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="4eb11-179">Ayrıca iki <xref:System.Windows.Controls.Button> denetim, **Tamam** ve **İptal**vardır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="4eb11-180">Kullanıcı **Tamam'ı**tıklattığında, düğmenin <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olay işleyicisi <xref:System.Windows.Controls.TextBox> denetimlerden verileri toplar, karşılık gelen özelliklere atar `OnButtonClicked`ve özel bir olay yükseltir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="4eb11-181">Kullanıcı **İptal'i**tıklattığında işleyici `OnButtonClicked`yalnızca yükseltir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="4eb11-182">Olay bağımsız değişken `OnButtonClicked` nesnesi, hangi düğmenin tıklatıldığını gösteren bir Boolean alanı içerir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>

 <span data-ttu-id="4eb11-183">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği barındıracak kod, ana bilgisayar penceresindeki [bildirimin WM_CREATE](/windows/desktop/winmsg/wm-create) için bir işleyici olarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](/windows/desktop/winmsg/wm-create) notification on the host window.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCreate](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]

 <span data-ttu-id="4eb11-184">Yöntem `GetHwnd` boyut ve konum bilgilerinin yanı sıra üst pencere tutamacını alır ve barındırılan içeriğin pencere tutamacını döndürür. [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="4eb11-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

> [!NOTE]
> <span data-ttu-id="4eb11-185">Ad alanı `#using` için bir yönerge kullanamazsınız. `System::Windows::Interop`</span><span class="sxs-lookup"><span data-stu-id="4eb11-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="4eb11-186">Bunu yapmak, bu ad <xref:System.Windows.Interop.MSG> alanındaki yapı ile winuser.h'de beyan edilen MSG yapısı arasında bir ad çarpışması oluşturur.</span><span class="sxs-lookup"><span data-stu-id="4eb11-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="4eb11-187">Bunun yerine, bu ad alanının içeriğine erişmek için tam nitelikli adlar kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>

 [!code-cpp[Win32HostingWPFPage#GetHwnd](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]

 <span data-ttu-id="4eb11-188">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği doğrudan uygulama pencerenizde barındıramazsınız.</span><span class="sxs-lookup"><span data-stu-id="4eb11-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="4eb11-189">Bunun yerine, önce <xref:System.Windows.Interop.HwndSource> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği sarmak için bir nesne oluşturursunuz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="4eb11-190">Bu nesne temelde bir içeriği barındırmak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] için tasarlanmış bir penceredir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="4eb11-191"><xref:System.Windows.Interop.HwndSource> Uygulamanızın bir parçası olan win32 penceresinin alt öğesi olarak oluşturarak nesneyi üst pencerede barındırArsınız.</span><span class="sxs-lookup"><span data-stu-id="4eb11-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a Win32 window that is part of your application.</span></span> <span data-ttu-id="4eb11-192">Oluşturucu parametreleri, <xref:System.Windows.Interop.HwndSource> Win32 alt penceresi oluşturduğunuzda CreateWindow'a geçeceğiniz bilgilerin çoğunu içerir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a Win32 child window.</span></span>

 <span data-ttu-id="4eb11-193">Daha sonra içerik nesnesinin bir örneğini [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] oluşturursunuz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="4eb11-194">Bu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] durumda, içerik c++/CLI kullanılarak `WPFPage`ayrı bir sınıf olarak uygulanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using C++/CLI.</span></span> <span data-ttu-id="4eb11-195">Ayrıca [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriği [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4eb11-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="4eb11-196">Ancak, bunu yapmak için ayrı bir proje kurmak [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ve bir DLL olarak içerik oluşturmak gerekir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a DLL.</span></span> <span data-ttu-id="4eb11-197">Projenize söz söz etüt dll'ye bir başvuru ekleyebilir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ve bu başvuruyu içeriğin bir örneğini oluşturmak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-197">You can add a reference to that DLL to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>

 <span data-ttu-id="4eb11-198">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriğin özelliğine bir başvuru [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Interop.HwndSource.RootVisual%2A> atayarak içeriği alt pencerenizde <xref:System.Windows.Interop.HwndSource>görüntülersiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>

 <span data-ttu-id="4eb11-199">Bir sonraki kod satırı, `WPFButtonClicked`içerik [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] `OnButtonClicked` olayına bir olay işleyicisi bağlar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="4eb11-200">Kullanıcı **Tamam** veya **İptal** düğmesini tıklattığında bu işleyici çağrılır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="4eb11-201">Bu olay işleyicisinin daha fazla tartışılması için [communicating_with_the_WPF içeriğe](#communicating_with_the_page) bakın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>

 <span data-ttu-id="4eb11-202">Gösterilen kodun son satırı, nesneyle ilişkili pencere tutamacını <xref:System.Windows.Interop.HwndSource> (HWND) döndürür.</span><span class="sxs-lookup"><span data-stu-id="4eb11-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="4eb11-203">Örnek bunu yapmasa da, barındırılan pencereye ileti göndermek için Win32 kodunuzdan bu tutamacı kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-203">You can use this handle from your Win32 code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="4eb11-204">Nesne, <xref:System.Windows.Interop.HwndSource> her ileti aldığında bir olayı yükseltir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="4eb11-205">İletileri işlemek için, <xref:System.Windows.Interop.HwndSource.AddHook%2A> ileti işleyicisi eklemek için yöntemi arayın ve sonra bu işleyicideki iletileri işle.</span><span class="sxs-lookup"><span data-stu-id="4eb11-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>

<a name="holding_a_reference"></a>
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="4eb11-206">WPF İçeriğine Başvuru Tutma</span><span class="sxs-lookup"><span data-stu-id="4eb11-206">Holding a Reference to the WPF Content</span></span>
 <span data-ttu-id="4eb11-207">Birçok uygulama [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] için, içerikle daha sonra iletişim kurmak isteyeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="4eb11-208">Örneğin, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik özelliklerini değiştirmek veya nesnenin <xref:System.Windows.Interop.HwndSource> farklı [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik barındırmasını isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="4eb11-209">Bunu yapmak için <xref:System.Windows.Interop.HwndSource> nesneye veya [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğe bir başvuru yapmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="4eb11-210">Pencere <xref:System.Windows.Interop.HwndSource> tutamacını [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] yok edene kadar nesne ve ilişkili içeriği bellekte kalır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="4eb11-211">Ancak, <xref:System.Windows.Interop.HwndSource> nesneye atadığınız değişken, pencere yordamından döner dönmez kapsam dışına çıkar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="4eb11-212">Win32 uygulamaları ile bu sorunu ele almak için alışılmış yolu statik veya genel değişken kullanmaktır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-212">The customary way to handle this issue with Win32 applications is to use a static or global variable.</span></span> <span data-ttu-id="4eb11-213">Ne yazık ki, yönetilen bir nesneyi bu tür değişkenlere atayamazsınız.</span><span class="sxs-lookup"><span data-stu-id="4eb11-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="4eb11-214">Nesneyle <xref:System.Windows.Interop.HwndSource> ilişkili pencere tutamacını genel veya statik bir değişkene atayabilirsiniz, ancak bu doe nesnenin kendisine erişim sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>

 <span data-ttu-id="4eb11-215">Bu sorunun en basit çözümü, erişmeniz gereken yönetilen nesnelere başvuru tutmak için statik alanlar kümesi içeren yönetilen bir sınıf uygulamaktır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="4eb11-216">Örnek, `WPFPageHost` [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğe bir başvuru yutmak için sınıfı ve daha sonra kullanıcı tarafından değiştirilebilen bazı özelliklerinin başlangıç değerlerini kullanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="4eb11-217">Bu üstbilgide tanımlanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-217">This is defined in the header.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageHost](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]

 <span data-ttu-id="4eb11-218">İşlevin `GetHwnd` ikinci bölümü, kapsam devam ederken `myPage` daha sonra kullanmak üzere bu alanlara değerler atar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>

<a name="communicating_with_the_page"></a>
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="4eb11-219">WPF İçeriği ile iletişim kurma</span><span class="sxs-lookup"><span data-stu-id="4eb11-219">Communicating with the WPF Content</span></span>
 <span data-ttu-id="4eb11-220">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerikle iki tür iletişim vardır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="4eb11-221">Kullanıcı **Ok** veya [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] **İptal** düğmelerini tıklattığında uygulama içerikten bilgi alır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="4eb11-222">Uygulama ayrıca, [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] kullanıcının arka plan [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rengi veya varsayılan yazı tipi boyutu gibi çeşitli içerik özelliklerini değiştirmesine olanak tanıyan bir uygulama da vardır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>

 <span data-ttu-id="4eb11-223">Yukarıda belirtildiği gibi, kullanıcı ya düğmeyi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tıklattığında `OnButtonClicked` içerik bir olay ortaya çıkarır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="4eb11-224">Uygulama, bu bildirimleri almak için bu olaya bir işleyici bağlar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="4eb11-225">**Tamam** düğmesi tıklanırsa, işleyici [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] kullanıcı bilgilerini içerikten alır ve statik denetimler kümesinde görüntüler.</span><span class="sxs-lookup"><span data-stu-id="4eb11-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]

 <span data-ttu-id="4eb11-226">İşleyici, içerikten özel bir [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] olay `MyPageEventArgs`bağımsız değişken nesnesi alır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="4eb11-227">**Tamam** düğmesi `IsOK` tıklandığında ve `true` `false` **İptal** düğmesi tıklandığında nesnenin özelliği ayarlanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>

 <span data-ttu-id="4eb11-228">**Tamam** düğmesi tıklatıldıysa, işleyici kapsayıcı sınıfından [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğe bir başvuru alır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="4eb11-229">Daha sonra ilişkili [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik özellikleri tarafından tutulan kullanıcı bilgilerini toplar ve üst penceredeki bilgileri görüntülemek için statik denetimleri kullanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="4eb11-230">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik verileri yönetilen bir dize biçiminde olduğundan, Win32 denetimi tarafından kullanılmak üzere marshaled gerekir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a Win32 control.</span></span> <span data-ttu-id="4eb11-231">**İptal** düğmesi tıklatılırsa, işleyici statik denetimlerden verileri temizler.</span><span class="sxs-lookup"><span data-stu-id="4eb11-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>

 <span data-ttu-id="4eb11-232">Uygulama, [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] kullanıcının [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğin arka plan rengini değiştirmesine olanak tanıyan bir radyo düğmesi kümesi ve yazı tipiyle ilgili birkaç özellik sağlar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="4eb11-233">Aşağıdaki örnek, uygulamanın pencere yordamından (WndProc) ve arka plan rengi de dahil olmak üzere farklı iletilerde çeşitli özellikler belirleyen ileti işlemesinden bir alıntıdır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="4eb11-234">Diğerleri benzer ve gösterilmez.</span><span class="sxs-lookup"><span data-stu-id="4eb11-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="4eb11-235">Ayrıntılar ve bağlam için tam örneğe bakın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-235">See the complete sample for details and context.</span></span>

 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]

 <span data-ttu-id="4eb11-236">Arka plan rengini ayarlamak için, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğe`hostedPage`() bir başvuru alın `WPFPageHost` ve arka plan rengi özelliğini uygun renge ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="4eb11-237">Örnek üç renk seçeneği kullanır: orijinal renk, açık yeşil veya açık somon.</span><span class="sxs-lookup"><span data-stu-id="4eb11-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="4eb11-238">Özgün arka plan rengi `WPFPageHost` sınıfta statik bir alan olarak depolanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="4eb11-239">Diğer ikisini ayarlamak için, yeni <xref:System.Windows.Media.SolidColorBrush> bir nesne oluşturun ve oluşturucuya <xref:System.Windows.Media.Colors> nesneden statik bir renk değeri geçirin.</span><span class="sxs-lookup"><span data-stu-id="4eb11-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>

<a name="implementing_the_wpf_page"></a>
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="4eb11-240">WPF Sayfasının Uygulanması</span><span class="sxs-lookup"><span data-stu-id="4eb11-240">Implementing the WPF Page</span></span>
 <span data-ttu-id="4eb11-241">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçeriği gerçek uygulama hakkında hiçbir bilgi sahibi olmadan barındırabilir ve kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="4eb11-242">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik ayrı bir DLL'de paketlenmiş olsaydı, herhangi bir ortak dil çalışma zamanı (CLR) dilinde oluşturulmuş olabilir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate DLL, it could have been built in any common language runtime (CLR) language.</span></span> <span data-ttu-id="4eb11-243">Aşağıda, örnekte kullanılan C++/CLI uygulamasının kısa bir bölümü geçilir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-243">Following is a brief walkthrough of the C++/CLI implementation that is used in the sample.</span></span> <span data-ttu-id="4eb11-244">Bu bölüm aşağıdaki alt bölümleri içerir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-244">This section contains the following subsections.</span></span>

- [<span data-ttu-id="4eb11-245">Düzen</span><span class="sxs-lookup"><span data-stu-id="4eb11-245">Layout</span></span>](#page_layout)

- [<span data-ttu-id="4eb11-246">Verileri Ana Bilgisayar Penceresine Döndürme</span><span class="sxs-lookup"><span data-stu-id="4eb11-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)

- [<span data-ttu-id="4eb11-247">WPF Özelliklerini Ayarlama</span><span class="sxs-lookup"><span data-stu-id="4eb11-247">Setting the WPF Properties</span></span>](#set_page_properties)

<a name="page_layout"></a>
### <a name="layout"></a><span data-ttu-id="4eb11-248">Düzen</span><span class="sxs-lookup"><span data-stu-id="4eb11-248">Layout</span></span>
 <span data-ttu-id="4eb11-249">İçerikteki [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] öğeler, ilişkili <xref:System.Windows.Controls.TextBox> <xref:System.Windows.Controls.Label> denetimleri içeren beş denetimden oluşur: Ad, Adres, Şehir, Eyalet ve Zip.</span><span class="sxs-lookup"><span data-stu-id="4eb11-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="4eb11-250">Ayrıca iki <xref:System.Windows.Controls.Button> denetim vardır, **Tamam** ve **İptal**</span><span class="sxs-lookup"><span data-stu-id="4eb11-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>

 <span data-ttu-id="4eb11-251">İçerik [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] `WPFPage` sınıfta uygulanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="4eb11-252">Düzen bir <xref:System.Windows.Controls.Grid> düzen öğesi ile işlenir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="4eb11-253">Sınıf, etkili <xref:System.Windows.Controls.Grid> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içerik kök öğesi yapar devralır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>

 <span data-ttu-id="4eb11-254">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] İçerik oluşturucu gerekli genişliği ve yüksekliği alır <xref:System.Windows.Controls.Grid> ve buna göre boyutlar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="4eb11-255">Daha sonra, sırasıyla nesne tabanına <xref:System.Windows.Controls.ColumnDefinition> <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> ve <xref:System.Windows.Controls.Grid.RowDefinitions%2A> koleksiyonlara bir <xref:System.Windows.Controls.Grid> dizi ve <xref:System.Windows.Controls.RowDefinition> nesne oluşturarak temel düzeni tanımlar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="4eb11-256">Bu, hücrelerin içeriği tarafından belirlenen boyutları ile beş satır ve yedi sütunlu bir ızgara tanımlar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]

 <span data-ttu-id="4eb11-257">Daha sonra, oluşturucu [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] öğeleri <xref:System.Windows.Controls.Grid>ekler.</span><span class="sxs-lookup"><span data-stu-id="4eb11-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="4eb11-258">İlk öğe, ızgaranın ilk satırında ortalanan bir <xref:System.Windows.Controls.Label> denetim olan başlık metnidir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]

 <span data-ttu-id="4eb11-259">Sonraki satır Ad <xref:System.Windows.Controls.Label> denetimini <xref:System.Windows.Controls.TextBox> ve ilişkili denetimini içerir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="4eb11-260">Aynı kod her etiket/textbox çifti için kullanıldığından, bir çift özel yönteme yerleştirilir ve beş etiket/textbox çifti için de kullanılır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="4eb11-261">Yöntemler uygun denetimi oluşturur ve <xref:System.Windows.Controls.Grid> sınıfı <xref:System.Windows.Controls.Grid.SetColumn%2A> statik <xref:System.Windows.Controls.Grid.SetRow%2A> olarak çağırır ve denetimleri uygun hücreye yerleştirmek için yöntemler çağırır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="4eb11-262">Denetim oluşturulduktan sonra, örnek, <xref:System.Windows.Controls.UIElementCollection.Add%2A> denetimi <xref:System.Windows.Controls.Panel.Children%2A> <xref:System.Windows.Controls.Grid> ızgaraya eklemek için özelliğindeki yöntemi çağırır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="4eb11-263">Kalan etiket/textbox çiftleri eklemek için kod benzer.</span><span class="sxs-lookup"><span data-stu-id="4eb11-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="4eb11-264">Ayrıntılar için örnek koduna bakın.</span><span class="sxs-lookup"><span data-stu-id="4eb11-264">See the sample code for details.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]

 <span data-ttu-id="4eb11-265">Bu iki yöntemin uygulanması aşağıdaki gibidir:</span><span class="sxs-lookup"><span data-stu-id="4eb11-265">The implementation of the two methods is as follows:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]

 <span data-ttu-id="4eb11-266">Son olarak, örnek **Tamam** ve **İptal** düğmelerini ekler ve <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olaylarına bir olay işleyicisi ekler.</span><span class="sxs-lookup"><span data-stu-id="4eb11-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]

<a name="returning_data_to_window"></a>
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="4eb11-267">Verileri Ana Bilgisayar Penceresine Döndürme</span><span class="sxs-lookup"><span data-stu-id="4eb11-267">Returning the Data to the Host Window</span></span>
 <span data-ttu-id="4eb11-268">Her iki düğme tıklatıldığında, <xref:System.Windows.Controls.Primitives.ButtonBase.Click> olayı yükseltilir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="4eb11-269">Ana bilgisayar penceresi yalnızca bu olaylara işleyiciler ekleyebilir <xref:System.Windows.Controls.TextBox> ve verileri doğrudan denetimlerden alabilir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="4eb11-270">Örnek biraz daha az doğrudan bir yaklaşım kullanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="4eb11-271">İçeriğin <xref:System.Windows.Controls.Primitives.ButtonBase.Click> içini [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] işler ve içeriği bildirmek `OnButtonClicked` [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] için özel bir olay yükseltir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="4eb11-272">Bu, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] içeriğin ana bilgisayara bildirmeden önce bazı parametre doğrulaması yapmasına olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="4eb11-273">İşleyici, metni <xref:System.Windows.Controls.TextBox> denetimlerden alır ve ana bilgisayar ın bilgileri alabileceği ortak özelliklere atar.</span><span class="sxs-lookup"><span data-stu-id="4eb11-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>

 <span data-ttu-id="4eb11-274">WPFPage.h'deki olay bildirimi:</span><span class="sxs-lookup"><span data-stu-id="4eb11-274">The event declaration, in WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]

 <span data-ttu-id="4eb11-275"><xref:System.Windows.Controls.Primitives.ButtonBase.Click> Olay işleyicisi, WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="4eb11-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]

<a name="set_page_properties"></a>
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="4eb11-276">WPF Özelliklerini Ayarlama</span><span class="sxs-lookup"><span data-stu-id="4eb11-276">Setting the WPF Properties</span></span>
 <span data-ttu-id="4eb11-277">Win32 ana bilgisayarı, kullanıcının [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] çeşitli içerik özelliklerini değiştirmesine olanak tanır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-277">The Win32 host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="4eb11-278">Win32 tarafında, sadece özellikleri değişen bir konudur.</span><span class="sxs-lookup"><span data-stu-id="4eb11-278">From the Win32 side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="4eb11-279">Tüm denetimler [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] için yazı tiplerini denetleyen tek bir genel özellik olmadığından, içerik sınıfındaki uygulama biraz daha karmaşıktır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="4eb11-280">Bunun yerine, her denetim için uygun özellik özellikleri 'ayarlanmış erişimci değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="4eb11-281">Aşağıdaki örnek, `DefaultFontFamily` özelliğin kodunu gösterir.</span><span class="sxs-lookup"><span data-stu-id="4eb11-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="4eb11-282">Özelliği ayarlamak, çeşitli denetimlerin <xref:System.Windows.Controls.Control.FontFamily%2A> özelliklerini ayarlayan özel bir yöntem çağırır.</span><span class="sxs-lookup"><span data-stu-id="4eb11-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>

 <span data-ttu-id="4eb11-283">Kaynak:</span><span class="sxs-lookup"><span data-stu-id="4eb11-283">From WPFPage.h:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]

 <span data-ttu-id="4eb11-284">Kaynak: WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="4eb11-284">From WPFPage.cpp:</span></span>

 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](~/samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]

## <a name="see-also"></a><span data-ttu-id="4eb11-285">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="4eb11-285">See also</span></span>

- <xref:System.Windows.Interop.HwndSource>
- [<span data-ttu-id="4eb11-286">WPF ve Win32 Birlikte Çalışması</span><span class="sxs-lookup"><span data-stu-id="4eb11-286">WPF and Win32 Interoperation</span></span>](wpf-and-win32-interoperation.md)
