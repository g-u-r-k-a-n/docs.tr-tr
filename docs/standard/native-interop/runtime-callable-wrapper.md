---
title: Çalışma Zamanı Aranabilir Sarmalayıcısı
description: CLR, bir .NET istemcisiyle COM nesnesi arasındaki çağrıları yöneten, çalışma zamanında çağrılabilir bir sarmalayıcı aracılığıyla COM nesneleri sunar.
ms.date: 03/30/2017
helpviewer_keywords:
- COM interop, COM wrappers
- RCW
- COM wrappers
- runtime callable wrappers
- interoperation with unmanaged code, COM wrappers
ms.assetid: 7e542583-1e31-4e10-b523-8cf2f29cb4a4
ms.openlocfilehash: 985f6e5057a06ac9dcadc0e2c1e4d7743d96f035
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/24/2020
ms.locfileid: "95730233"
---
# <a name="runtime-callable-wrapper"></a><span data-ttu-id="e4e0c-103">Çalışma Zamanı Aranabilir Sarmalayıcısı</span><span class="sxs-lookup"><span data-stu-id="e4e0c-103">Runtime Callable Wrapper</span></span>

<span data-ttu-id="e4e0c-104">Ortak dil çalışma zamanı, COM nesnelerini, çalışma zamanı çağrılabilir sarmalayıcı (RCW) adlı bir ara sunucu üzerinden kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-104">The common language runtime exposes COM objects through a proxy called the runtime callable wrapper (RCW).</span></span> <span data-ttu-id="e4e0c-105">RCW, .NET istemcilerine sıradan bir nesne gibi görünse de, birincil işlevi bir .NET istemcisiyle COM nesnesi arasındaki çağrıları sıralayamaz.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-105">Although the RCW appears to be an ordinary object to .NET clients, its primary function is to marshal calls between a .NET client and a COM object.</span></span>  
  
 <span data-ttu-id="e4e0c-106">Çalışma zamanı, bu nesnede bulunan başvuruların sayısından bağımsız olarak her bir COM nesnesi için tam olarak bir RCW oluşturur.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-106">The runtime creates exactly one RCW for each COM object, regardless of the number of references that exist on that object.</span></span> <span data-ttu-id="e4e0c-107">Çalışma zamanı her bir nesne için işlem başına tek bir RCW tutar.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-107">The runtime maintains a single RCW per process for each object.</span></span>  <span data-ttu-id="e4e0c-108">Bir uygulama etki alanında veya grupta bir RCW oluşturup daha sonra başka bir uygulama etki alanına veya gruba bir başvuru geçirirseniz, ilk nesneye yönelik bir ara sunucu kullanılacaktır.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-108">If you create an RCW in one application domain or apartment, and then pass a reference to another application domain or apartment, a proxy to the first object will be used.</span></span>  <span data-ttu-id="e4e0c-109">Aşağıdaki çizimde gösterildiği gibi, herhangi bir sayıda yönetilen istemci, INEW ve INewer arabirimlerini sunan COM nesnelerine bir başvuru tutabilir.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-109">As the following illustration shows, any number of managed clients can hold a reference to the COM objects that expose INew and INewer interfaces.</span></span>  

<span data-ttu-id="e4e0c-110">Aşağıdaki görüntüde, çalışma zamanında çağrılabilir sarmalayıcı aracılığıyla COM nesnelerine erişme işlemi gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="e4e0c-110">The following image shows the process for accessing COM objects through the runtime callable wrapper:</span></span>

 ![RCW aracılığıyla COM nesnelerine erişme işlemi.](./media/runtime-callable-wrapper/runtime-callable-wrapper.gif)  

 <span data-ttu-id="e4e0c-112">Bir tür kitaplığından türetilmiş meta verileri kullanarak, çalışma zamanı hem çağrılan COM nesnesini hem de bu nesne için bir sarmalayıcı oluşturur.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-112">Using metadata derived from a type library, the runtime creates both the COM object being called and a wrapper for that object.</span></span> <span data-ttu-id="e4e0c-113">Her RCW, nesne sarmaladığı COM nesnesinde bir arabirim işaretçileri önbelleği tutar ve RCW artık gerekmiyorsa COM nesnesinde başvurusunu yayınlar.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-113">Each RCW maintains a cache of interface pointers on the COM object it wraps and releases its reference on the COM object when the RCW is no longer needed.</span></span> <span data-ttu-id="e4e0c-114">Çalışma zamanı RCW üzerinde çöp toplama işlemi gerçekleştirir.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-114">The runtime performs garbage collection on the RCW.</span></span>  
  
 <span data-ttu-id="e4e0c-115">Diğer etkinliklerin yanı sıra, RCW, Sarmalanan nesne adına yönetilen ve yönetilmeyen kod arasında veri sıraladığında.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-115">Among other activities, the RCW marshals data between managed and unmanaged code, on behalf of the wrapped object.</span></span> <span data-ttu-id="e4e0c-116">Özellikle, RCW, istemci ve sunucu aralarında geçen verilerin farklı temsillerine sahip olduğunda, yöntem bağımsız değişkenleri ve yöntem dönüş değerleri için sıralama sağlar.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-116">Specifically, the RCW provides marshaling for method arguments and method return values whenever the client and server have different representations of the data passed between them.</span></span>  
  
 <span data-ttu-id="e4e0c-117">Standart sarmalayıcı, yerleşik sıralama kurallarını uygular.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-117">The standard wrapper enforces built-in marshaling rules.</span></span> <span data-ttu-id="e4e0c-118">Örneğin, bir .NET istemcisi bir dize türünü yönetilmeyen bir nesneye bir bağımsız değişkenin parçası olarak geçirdiğinde, sarmalayıcı dizeyi bir BSTR türüne dönüştürür.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-118">For example, when a .NET client passes a String type as part of an argument to an unmanaged object, the wrapper converts the string to a BSTR type.</span></span> <span data-ttu-id="e4e0c-119">COM nesnesi, yönetilen çağıranına bir BSTR döndürmelidir, çağıran bir dize alır.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-119">Should the COM object return a BSTR to its managed caller, the caller receives a String.</span></span> <span data-ttu-id="e4e0c-120">Hem istemci hem de sunucu onlara tanıdık gelen verileri gönderir ve alır.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-120">Both the client and the server send and receive data that is familiar to them.</span></span> <span data-ttu-id="e4e0c-121">Diğer türler dönüştürme gerektirmez.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-121">Other types require no conversion.</span></span> <span data-ttu-id="e4e0c-122">Örneğin, standart bir sarmalayıcı, türü dönüştürmeden yönetilen ve yönetilmeyen kod arasında her zaman 4 baytlık bir tamsayı geçilecektir.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-122">For instance, a standard wrapper will always pass a 4-byte integer between managed and unmanaged code without converting the type.</span></span>  
  
## <a name="marshaling-selected-interfaces"></a><span data-ttu-id="e4e0c-123">Seçili arabirimler sıralanıyor</span><span class="sxs-lookup"><span data-stu-id="e4e0c-123">Marshaling selected interfaces</span></span>  

 <span data-ttu-id="e4e0c-124">[Çalışma zamanı çağrılabilir sarmalayıcı](runtime-callable-wrapper.md) (RCW) birincil hedefi, yönetilen ve yönetilmeyen programlama modelleri arasındaki farkları gizmaktır.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-124">The primary goal of the [runtime callable wrapper](runtime-callable-wrapper.md) (RCW) is to hide the differences between the managed and unmanaged programming models.</span></span> <span data-ttu-id="e4e0c-125">Sorunsuz bir geçiş oluşturmak için RCW, aşağıdaki çizimde gösterildiği gibi, seçili COM arabirimlerini .NET istemcisine göstermeden tüketir.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-125">To create a seamless transition, the RCW consumes selected COM interfaces without exposing them to the .NET client, as shown in the following illustration.</span></span>

 <span data-ttu-id="e4e0c-126">Aşağıdaki görüntüde COM arabirimleri ve çalışma zamanı çağrılabilir sarmalayıcı gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="e4e0c-126">The following image shows COM interfaces and the runtime callable wrapper:</span></span>
  
 ![Arabirimleri olan çalışma zamanı çağrılabilir sarmalayıcının ekran görüntüsü.](./media/runtime-callable-wrapper/runtime-callable-wrapper-interfaces.gif)  
  
 <span data-ttu-id="e4e0c-128">Erken bağlantılı bir nesne olarak oluşturulduğunda RCW belirli bir türdür.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-128">When created as an early-bound object, the RCW is a specific type.</span></span> <span data-ttu-id="e4e0c-129">COM nesnesinin uyguladığı arabirimleri uygular ve nesne arabirimlerinden yöntemleri, özellikleri ve olayları gösterir.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-129">It implements the interfaces that the COM object implements and exposes the methods, properties, and events from the object's interfaces.</span></span> <span data-ttu-id="e4e0c-130">Çizimde RCW, INEW arabirimini kullanıma sunar, ancak **IUnknown** ve **IDispatch** arabirimlerini kullanır.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-130">In the illustration, the RCW exposes the INew interface but consumes the **IUnknown** and **IDispatch** interfaces.</span></span> <span data-ttu-id="e4e0c-131">Ayrıca, RCW, .NET istemcisine INew arabiriminin tüm üyelerini kullanıma sunar.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-131">Further, the RCW exposes all members of the INew interface to the .NET client.</span></span>  
  
 <span data-ttu-id="e4e0c-132">RCW, sarmaladığı nesne tarafından açığa çıkarılan aşağıdaki tabloda listelenen arabirimleri kullanır.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-132">The RCW consumes the interfaces listed in the following table, which are exposed by the object it wraps.</span></span>  
  
|<span data-ttu-id="e4e0c-133">Arabirim</span><span class="sxs-lookup"><span data-stu-id="e4e0c-133">Interface</span></span>|<span data-ttu-id="e4e0c-134">Açıklama</span><span class="sxs-lookup"><span data-stu-id="e4e0c-134">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="e4e0c-135">**IDispatch**</span><span class="sxs-lookup"><span data-stu-id="e4e0c-135">**IDispatch**</span></span>|<span data-ttu-id="e4e0c-136">Yansıma aracılığıyla COM nesnelerine geç bağlama için.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-136">For late binding to COM objects through reflection.</span></span>|  
|<span data-ttu-id="e4e0c-137">**IErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="e4e0c-137">**IErrorInfo**</span></span>|<span data-ttu-id="e4e0c-138">Hatanın metinsel bir açıklamasını, kaynağını, bir yardım dosyasını, yardım bağlamını ve hatayı tanımlayan arabirimin GUID 'sini (her zaman .NET sınıfları için **GUID_NULL** ) sağlar.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-138">Provides a textual description of the error, its source, a Help file, Help context, and the GUID of the interface that defined the error (always **GUID_NULL** for .NET classes).</span></span>|  
|<span data-ttu-id="e4e0c-139">**IProvideClassInfo**</span><span class="sxs-lookup"><span data-stu-id="e4e0c-139">**IProvideClassInfo**</span></span>|<span data-ttu-id="e4e0c-140">Sarmalanan COM nesnesi **IProvideClassInfo** uyguluyorsa, RCW daha iyi tür kimliği sağlamak için bu arabirimden tür bilgilerini ayıklar.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-140">If the COM object being wrapped implements **IProvideClassInfo**, the RCW extracts the type information from this interface to provide better type identity.</span></span>|  
|<span data-ttu-id="e4e0c-141">**IUnknown**</span><span class="sxs-lookup"><span data-stu-id="e4e0c-141">**IUnknown**</span></span>|<span data-ttu-id="e4e0c-142">Nesne kimliği, tür zorlaması ve ömür yönetimi için:</span><span class="sxs-lookup"><span data-stu-id="e4e0c-142">For object identity, type coercion, and lifetime management:</span></span><br /><br /> <span data-ttu-id="e4e0c-143">-Nesne kimliği</span><span class="sxs-lookup"><span data-stu-id="e4e0c-143">-   Object identity</span></span><br />     <span data-ttu-id="e4e0c-144">Çalışma zamanı, her nesne için **IUnknown** arabiriminin DEĞERINI karşılaştırarak com nesneleri arasında ayrım yapar.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-144">The runtime distinguishes between COM objects by comparing the value of the **IUnknown** interface for each object.</span></span><br /><span data-ttu-id="e4e0c-145">-Tür zorlaması</span><span class="sxs-lookup"><span data-stu-id="e4e0c-145">-   Type coercion</span></span><br />     <span data-ttu-id="e4e0c-146">RCW, **QueryInterface** yöntemi tarafından gerçekleştirilen dinamik tür bulmayı tanır.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-146">The RCW recognizes the dynamic type discovery performed by the **QueryInterface** method.</span></span><br /><span data-ttu-id="e4e0c-147">-Ömür yönetimi</span><span class="sxs-lookup"><span data-stu-id="e4e0c-147">-   Lifetime management</span></span><br />     <span data-ttu-id="e4e0c-148">**QueryInterface** metodunu kullanarak, RCW, çalışma zamanı sarmalayıcı üzerinde çöp toplama işlemi gerçekleştirene kadar yönetilmeyen nesneye bir başvuru alır ve bu başvuruyu barındırır.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-148">Using the **QueryInterface** method, the RCW gets and holds a reference to an unmanaged object until the runtime performs garbage collection on the wrapper, which releases the unmanaged object.</span></span>|  
  
 <span data-ttu-id="e4e0c-149">RCW isteğe bağlı olarak, sarmaladığı nesne tarafından açığa çıkarılan aşağıdaki tabloda listelenen arabirimleri kullanır.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-149">The RCW optionally consumes the interfaces listed in the following table, which are exposed by the object it wraps.</span></span>  
  
|<span data-ttu-id="e4e0c-150">Arabirim</span><span class="sxs-lookup"><span data-stu-id="e4e0c-150">Interface</span></span>|<span data-ttu-id="e4e0c-151">Açıklama</span><span class="sxs-lookup"><span data-stu-id="e4e0c-151">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="e4e0c-152">**Inewctionpoint** ve **IConnectionPointContainer**</span><span class="sxs-lookup"><span data-stu-id="e4e0c-152">**IConnectionPoint** and **IConnectionPointContainer**</span></span>|<span data-ttu-id="e4e0c-153">RCW, bağlantı noktası olay stilini kullanıma sunan nesneleri temsilci tabanlı olaylara dönüştürür.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-153">The RCW converts objects that expose the connection-point event style to delegate-based events.</span></span>|  
|<span data-ttu-id="e4e0c-154">**IDispatchEx** (yalnızca .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="e4e0c-154">**IDispatchEx** (.NET Framework Only)</span></span> |<span data-ttu-id="e4e0c-155">Sınıf **IDispatchEx** uygularsa, RCW, **Ida** uygular.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-155">If the class implements **IDispatchEx**, the RCW implements **IExpando**.</span></span> <span data-ttu-id="e4e0c-156">**IDispatchEx** **arabirimi IDispatch arabiriminin bir** uzantısıdır. Bu, **IDispatch**'in aksine numaralandırma, ekleme, silme ve büyük/küçük harf duyarlı üyelerin çağrılmasını mümkün değildir.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-156">The **IDispatchEx** interface is an extension of the **IDispatch** interface that, unlike **IDispatch**, enables enumeration, addition, deletion, and case-sensitive calling of members.</span></span>|  
|<span data-ttu-id="e4e0c-157">**IEnumVariant**</span><span class="sxs-lookup"><span data-stu-id="e4e0c-157">**IEnumVARIANT**</span></span>|<span data-ttu-id="e4e0c-158">Numaralandırmalar destekleyen COM türlerinin koleksiyonlar olarak değerlendirilmesini sağlar.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-158">Enables COM types that support enumerations to be treated as collections.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e4e0c-159">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="e4e0c-159">See also</span></span>

- [<span data-ttu-id="e4e0c-160">COM sarmalayıcıları</span><span class="sxs-lookup"><span data-stu-id="e4e0c-160">COM Wrappers</span></span>](com-wrappers.md)
- [<span data-ttu-id="e4e0c-161">COM Aranabilir Sarmalayıcısı</span><span class="sxs-lookup"><span data-stu-id="e4e0c-161">COM Callable Wrapper</span></span>](com-callable-wrapper.md)
- <span data-ttu-id="e4e0c-162">[Tür kitaplığını derlemeye dönüştürme Özeti](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="e4e0c-162">[Type Library to Assembly Conversion Summary](/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="e4e0c-163">Tür Kitaplığını Derleme Olarak İçeri Aktarma</span><span class="sxs-lookup"><span data-stu-id="e4e0c-163">Importing a Type Library as an Assembly</span></span>](../../framework/interop/importing-a-type-library-as-an-assembly.md)
