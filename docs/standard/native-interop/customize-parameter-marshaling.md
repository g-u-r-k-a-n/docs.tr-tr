---
title: Parametre hazırlamayı özelleştirme-.NET
description: .NET 'in parametrelerinizi yerel bir gösterimde nasıl sıraladığında nasıl özelleştireceğinizi öğrenin.
ms.date: 01/18/2019
ms.openlocfilehash: ff646ad942cf051ce90cd75b24c8562e536182d9
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 03/14/2020
ms.locfileid: "79400367"
---
# <a name="customizing-parameter-marshaling"></a><span data-ttu-id="1e776-103">Parametre hazırlamayı özelleştirme</span><span class="sxs-lookup"><span data-stu-id="1e776-103">Customizing parameter marshaling</span></span>

<span data-ttu-id="1e776-104">.NET çalışma zamanının varsayılan parametre sıralama davranışı istediğiniz şeyi gerçekleştirmezse, kullanım parametrelerinizin nasıl sıralanmasını özelleştirmek <xref:System.Runtime.InteropServices.MarshalAsAttribute?displayProperty=nameWithType> için özniteliğini kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="1e776-104">When the .NET runtime's default parameter marshaling behavior doesn't do what you want, use can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute?displayProperty=nameWithType> attribute to customize how your parameters are marshaled.</span></span>

## <a name="customizing-string-parameters"></a><span data-ttu-id="1e776-105">Dize parametrelerini özelleştirme</span><span class="sxs-lookup"><span data-stu-id="1e776-105">Customizing string parameters</span></span>

<span data-ttu-id="1e776-106">.NET, dizeleri sıralama için çeşitli biçimlere sahiptir.</span><span class="sxs-lookup"><span data-stu-id="1e776-106">.NET has a variety of formats for marshaling strings.</span></span> <span data-ttu-id="1e776-107">Bu yöntemler, C stili dizeler ve Windows merkezli dize biçimleri üzerinde ayrı bölümlere ayrılır.</span><span class="sxs-lookup"><span data-stu-id="1e776-107">These methods are split into distinct sections on C-style strings and Windows-centric string formats.</span></span>

### <a name="c-style-strings"></a><span data-ttu-id="1e776-108">C stili dizeler</span><span class="sxs-lookup"><span data-stu-id="1e776-108">C-Style strings</span></span>

<span data-ttu-id="1e776-109">Bu biçimlerin her biri, yerel koda null ile sonlandırılmış bir dize geçirir.</span><span class="sxs-lookup"><span data-stu-id="1e776-109">Each of these formats passes a null-terminated string to native code.</span></span> <span data-ttu-id="1e776-110">Bunlar yerel dizenin kodlamasına göre farklılık gösterir.</span><span class="sxs-lookup"><span data-stu-id="1e776-110">They differ by the encoding of the native string.</span></span>

| <span data-ttu-id="1e776-111">`System.Runtime.InteropServices.UnmanagedType`deeri</span><span class="sxs-lookup"><span data-stu-id="1e776-111">`System.Runtime.InteropServices.UnmanagedType` value</span></span> | <span data-ttu-id="1e776-112">Encoding</span><span class="sxs-lookup"><span data-stu-id="1e776-112">Encoding</span></span> |
|------------------------------------------------------|----------|
| <span data-ttu-id="1e776-113">LPStr</span><span class="sxs-lookup"><span data-stu-id="1e776-113">LPStr</span></span> | <span data-ttu-id="1e776-114">ANSI</span><span class="sxs-lookup"><span data-stu-id="1e776-114">ANSI</span></span> |
| <span data-ttu-id="1e776-115">LPUTF8Str</span><span class="sxs-lookup"><span data-stu-id="1e776-115">LPUTF8Str</span></span> | <span data-ttu-id="1e776-116">UTF-8</span><span class="sxs-lookup"><span data-stu-id="1e776-116">UTF-8</span></span> |
| <span data-ttu-id="1e776-117">LPWStr</span><span class="sxs-lookup"><span data-stu-id="1e776-117">LPWStr</span></span> | <span data-ttu-id="1e776-118">UTF-16</span><span class="sxs-lookup"><span data-stu-id="1e776-118">UTF-16</span></span> |
| <span data-ttu-id="1e776-119">LPTStr</span><span class="sxs-lookup"><span data-stu-id="1e776-119">LPTStr</span></span> | <span data-ttu-id="1e776-120">UTF-16</span><span class="sxs-lookup"><span data-stu-id="1e776-120">UTF-16</span></span> |

<span data-ttu-id="1e776-121"><xref:System.Runtime.InteropServices.UnmanagedType.VBByRefStr?displayProperty=nameWithType> Biçim biraz farklıdır.</span><span class="sxs-lookup"><span data-stu-id="1e776-121">The <xref:System.Runtime.InteropServices.UnmanagedType.VBByRefStr?displayProperty=nameWithType> format is slightly different.</span></span> <span data-ttu-id="1e776-122">Benzer `LPWStr`şekilde, DIZEYI, UTF-16 ' d e kodlanmış yerel bir C stili dizeye göre sıralamalıdır.</span><span class="sxs-lookup"><span data-stu-id="1e776-122">Like `LPWStr`, it marshals the string to a native C-style string encoded in UTF-16.</span></span> <span data-ttu-id="1e776-123">Ancak, yönetilen imza dizeyi başvuruya göre geçirirseniz ve eşleşen yerel imza, dizeyi değere göre alır.</span><span class="sxs-lookup"><span data-stu-id="1e776-123">However, the managed signature has you pass in the string by reference and the matching native signature takes the string by value.</span></span> <span data-ttu-id="1e776-124">Bu ayrım, bir dizeyi değere göre alan ve bir `StringBuilder`kullanarak yerinde değiştiren yerel bir API kullanmanıza olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="1e776-124">This distinction allows you to use a native API that takes a string by value and modifies it in-place without having to use a `StringBuilder`.</span></span> <span data-ttu-id="1e776-125">Eşleşmeyen yerel ve yönetilen imzalarla karışıklık oluşmasına yol açacağımız için bu biçimi kullanarak el ile karşı öneriyoruz.</span><span class="sxs-lookup"><span data-stu-id="1e776-125">We recommend against manually using this format since it's prone to cause confusion with the mismatching native and managed signatures.</span></span>

### <a name="windows-centric-string-formats"></a><span data-ttu-id="1e776-126">Windows merkezli dize biçimleri</span><span class="sxs-lookup"><span data-stu-id="1e776-126">Windows-centric string formats</span></span>

<span data-ttu-id="1e776-127">COM veya OLE arabirimleriyle etkileşim kurarken, yerel işlevlerin dizeleri bağımsız değişken olarak `BSTR` ele geçirmesine da fark edeceksiniz.</span><span class="sxs-lookup"><span data-stu-id="1e776-127">When interacting with COM or OLE interfaces, you'll likely find that the native functions take strings as `BSTR` arguments.</span></span> <span data-ttu-id="1e776-128"><xref:System.Runtime.InteropServices.UnmanagedType.BStr?displayProperty=nameWithType> Yönetilmeyen türü bir dizeyi bir `BSTR`olarak sıralamak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e776-128">You can use the <xref:System.Runtime.InteropServices.UnmanagedType.BStr?displayProperty=nameWithType> unmanaged type to marshal a string as a `BSTR`.</span></span>

<span data-ttu-id="1e776-129">WinRT API 'Leri ile etkileşim ediyorsanız, bir dizeyi bir <xref:System.Runtime.InteropServices.UnmanagedType.HString?displayProperty=nameWithType> `HSTRING`olarak sıralamak için biçimini kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e776-129">If you're interacting with WinRT APIs, you can use the <xref:System.Runtime.InteropServices.UnmanagedType.HString?displayProperty=nameWithType> format to marshal a string as an `HSTRING`.</span></span>

## <a name="customizing-array-parameters"></a><span data-ttu-id="1e776-130">Dizi parametrelerini özelleştirme</span><span class="sxs-lookup"><span data-stu-id="1e776-130">Customizing array parameters</span></span>

<span data-ttu-id="1e776-131">.NET ayrıca dizi parametrelerini sıralamak için birçok yol sağlar.</span><span class="sxs-lookup"><span data-stu-id="1e776-131">.NET also provides you multiple ways to marshal array parameters.</span></span> <span data-ttu-id="1e776-132">C stili dizi alan bir API arıyorsanız, <xref:System.Runtime.InteropServices.UnmanagedType.LPArray?displayProperty=nameWithType> yönetilmeyen türü kullanın.</span><span class="sxs-lookup"><span data-stu-id="1e776-132">If you're calling an API that takes a C-style array, use the <xref:System.Runtime.InteropServices.UnmanagedType.LPArray?displayProperty=nameWithType> unmanaged type.</span></span> <span data-ttu-id="1e776-133">Dizideki değerlerin özelleştirilmiş sıralama ihtiyacı varsa, bu <xref:System.Runtime.InteropServices.MarshalAsAttribute.ArraySubType> alanı `[MarshalAs]` özniteliği üzerinde kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e776-133">If the values in the array need customized marshaling, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute.ArraySubType> field on the `[MarshalAs]` attribute for that.</span></span>

<span data-ttu-id="1e776-134">COM API 'Leri kullanıyorsanız, muhtemelen dizi parametrelerinizi s olarak `SAFEARRAY*`sıralıyoruz.</span><span class="sxs-lookup"><span data-stu-id="1e776-134">If you're using COM APIs, you'll likely have to marshal your array parameters as `SAFEARRAY*`s.</span></span> <span data-ttu-id="1e776-135">Bunu yapmak için <xref:System.Runtime.InteropServices.UnmanagedType.SafeArray?displayProperty=nameWithType> yönetilmeyen türü kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e776-135">To do so, you can use the <xref:System.Runtime.InteropServices.UnmanagedType.SafeArray?displayProperty=nameWithType> unmanaged type.</span></span> <span data-ttu-id="1e776-136">Öğelerinin varsayılan türü, `SAFEARRAY` [alanları özelleştirmek `object` ](./customize-struct-marshaling.md#marshaling-systemobjects)için tablosunda görülebilir.</span><span class="sxs-lookup"><span data-stu-id="1e776-136">The default type of the elements of the `SAFEARRAY` can be seen in the table on [customizing `object` fields](./customize-struct-marshaling.md#marshaling-systemobjects).</span></span> <span data-ttu-id="1e776-137">Öğesinin tam öğe türünü <xref:System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType?displayProperty=nameWithType> özelleştirmek <xref:System.Runtime.InteropServices.MarshalAsAttribute.SafeArrayUserDefinedSubType?displayProperty=nameWithType> için ve alanlarını kullanabilirsiniz `SAFEARRAY`.</span><span class="sxs-lookup"><span data-stu-id="1e776-137">You can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType?displayProperty=nameWithType> and <xref:System.Runtime.InteropServices.MarshalAsAttribute.SafeArrayUserDefinedSubType?displayProperty=nameWithType> fields to customize the exact element type of the `SAFEARRAY`.</span></span>

## <a name="customizing-boolean-or-decimal-parameters"></a><span data-ttu-id="1e776-138">Boole veya ondalık parametrelerini özelleştirme</span><span class="sxs-lookup"><span data-stu-id="1e776-138">Customizing boolean or decimal parameters</span></span>

<span data-ttu-id="1e776-139">Boolean veya Decimal parametrelerini hazırlama hakkında bilgi için bkz. [Yapı hazırlamayı özelleştirme](customize-struct-marshaling.md).</span><span class="sxs-lookup"><span data-stu-id="1e776-139">For information on marshaling boolean or decimal parameters, see [Customizing structure marshaling](customize-struct-marshaling.md).</span></span>

## <a name="customizing-object-parameters-windows-only"></a><span data-ttu-id="1e776-140">Nesne parametrelerini özelleştirme (yalnızca Windows)</span><span class="sxs-lookup"><span data-stu-id="1e776-140">Customizing object parameters (Windows-only)</span></span>

<span data-ttu-id="1e776-141">Windows 'da, .NET çalışma zamanı, yerel koda nesne parametrelerini sıralamak için çeşitli yollar sağlar.</span><span class="sxs-lookup"><span data-stu-id="1e776-141">On Windows, the .NET runtime provides a number of different ways to marshal object parameters to native code.</span></span>

### <a name="marshaling-as-specific-com-interfaces"></a><span data-ttu-id="1e776-142">Belirli COM arabirimleri olarak hazırlama</span><span class="sxs-lookup"><span data-stu-id="1e776-142">Marshaling as specific COM interfaces</span></span>

<span data-ttu-id="1e776-143">API 'niz bir COM nesnesine bir işaretçi alırsa, .NET 'e bu özel arabirimler olarak sıralama yapmak için `UnmanagedType` aşağıdaki biçimlerden herhangi `object`birini yazılı bir parametre üzerinde kullanabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="1e776-143">If your API takes a pointer to a COM object, you can use any of the following `UnmanagedType` formats on an `object`-typed parameter to tell .NET to marshal as these specific interfaces:</span></span>

- `IUnknown`
- `IDispatch`
- `IInspectable`

<span data-ttu-id="1e776-144">Ayrıca, tür işaretlenmişse `[ComVisible(true)]` veya `object` türü sıraaktarıyorsanız, nesnenizin com görünümü için, nesneyi com çağrılabilir bir <xref:System.Runtime.InteropServices.UnmanagedType.Interface?displayProperty=nameWithType> sarmalayıcı olarak sıralamak üzere biçimini kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e776-144">Additionally, if your type is marked `[ComVisible(true)]` or you're marshaling the `object` type, you can use the <xref:System.Runtime.InteropServices.UnmanagedType.Interface?displayProperty=nameWithType> format to marshal your object as a COM callable wrapper for the COM view of your type.</span></span>

### <a name="marshaling-to-a-variant"></a><span data-ttu-id="1e776-145">Bir`VARIANT`</span><span class="sxs-lookup"><span data-stu-id="1e776-145">Marshaling to a `VARIANT`</span></span>

<span data-ttu-id="1e776-146">Yerel API `VARIANT`'Niz bir Win32 alırsa, nesnelerinizi s olarak <xref:System.Runtime.InteropServices.UnmanagedType.Struct?displayProperty=nameWithType> `object` `VARIANT`sıralamak için parametresindeki biçimi kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e776-146">If your native API takes a Win32 `VARIANT`, you can use the <xref:System.Runtime.InteropServices.UnmanagedType.Struct?displayProperty=nameWithType> format on your `object` parameter to marshal your objects as `VARIANT`s.</span></span> <span data-ttu-id="1e776-147">.NET türleri ve `VARIANT` türleri arasındaki eşleme için [alanları özelleştirmeye `object` ](customize-struct-marshaling.md#marshaling-systemobjects) yönelik belgelere bakın.</span><span class="sxs-lookup"><span data-stu-id="1e776-147">See the documentation on [customizing `object` fields](customize-struct-marshaling.md#marshaling-systemobjects) for a mapping between .NET types and `VARIANT` types.</span></span>

### <a name="custom-marshalers"></a><span data-ttu-id="1e776-148">Özel sıralayıcılar</span><span class="sxs-lookup"><span data-stu-id="1e776-148">Custom marshalers</span></span>

<span data-ttu-id="1e776-149">Yerel bir COM arabirimini farklı bir yönetilen türe proje yapmak istiyorsanız, kendi özel sıralama kodunuzu sağlamak `UnmanagedType.CustomMarshaler` <xref:System.Runtime.InteropServices.ICustomMarshaler> için biçimini ve uygulamasını kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="1e776-149">If you want to project a native COM interface into a different managed type, you can use the `UnmanagedType.CustomMarshaler` format and an implementation of <xref:System.Runtime.InteropServices.ICustomMarshaler> to provide your own custom marshaling code.</span></span>
