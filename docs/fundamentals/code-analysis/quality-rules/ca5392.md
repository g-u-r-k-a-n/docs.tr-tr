---
title: 'CA5392: P/Invoke için Defaultdllımportsearchpaths özniteliğini kullanın (kod analizi)'
description: Kod Analizi kuralı CA5392, nedenler, ihlallerin nasıl düzeltileceğini ve ne zaman bastıralınacağını içeren bilgiler sağlar.
ms.date: 05/28/2020
ms.topic: reference
author: LLLXXXCCC
ms.author: linche
f1_keywords:
- CA5392
ms.openlocfilehash: de78778fa325f9e070d6708ad3a005c41fe5710e
ms.sourcegitcommit: 4f5f1855849cb02c3b610c7006ac21d7429f3348
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 01/15/2021
ms.locfileid: "98235436"
---
# <a name="ca5392-use-defaultdllimportsearchpaths-attribute-for-pinvokes"></a><span data-ttu-id="cf207-103">CA5392: P/Invokes için DefaultDllImportSearchPaths özniteliğini kullanın</span><span class="sxs-lookup"><span data-stu-id="cf207-103">CA5392: Use DefaultDllImportSearchPaths attribute for P/Invokes</span></span>

| | <span data-ttu-id="cf207-104">Değer</span><span class="sxs-lookup"><span data-stu-id="cf207-104">Value</span></span> |
|-|-|
| <span data-ttu-id="cf207-105">**Kural Kimliği**</span><span class="sxs-lookup"><span data-stu-id="cf207-105">**Rule ID**</span></span> |<span data-ttu-id="cf207-106">CA5392</span><span class="sxs-lookup"><span data-stu-id="cf207-106">CA5392</span></span>|
| <span data-ttu-id="cf207-107">**Kategori**</span><span class="sxs-lookup"><span data-stu-id="cf207-107">**Category**</span></span> |<span data-ttu-id="cf207-108">Microsoft.Security</span><span class="sxs-lookup"><span data-stu-id="cf207-108">Microsoft.Security</span></span>|
| <span data-ttu-id="cf207-109">**Düzeltilme veya kırılmamış**</span><span class="sxs-lookup"><span data-stu-id="cf207-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="cf207-110">Kırılmamış</span><span class="sxs-lookup"><span data-stu-id="cf207-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="cf207-111">Nedeni</span><span class="sxs-lookup"><span data-stu-id="cf207-111">Cause</span></span>

<span data-ttu-id="cf207-112"><xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute> [Platform çağırma (P/Invoke)](../../../standard/native-interop/pinvoke.md) işlevi için belirtilmemiş.</span><span class="sxs-lookup"><span data-stu-id="cf207-112">The <xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute> is not specified for a [Platform Invoke (P/Invoke)](../../../standard/native-interop/pinvoke.md) function.</span></span>

## <a name="rule-description"></a><span data-ttu-id="cf207-113">Kural açıklaması</span><span class="sxs-lookup"><span data-stu-id="cf207-113">Rule description</span></span>

<span data-ttu-id="cf207-114">Varsayılan olarak, yoklama kullanan P/Invoke işlevleri <xref:System.Runtime.InteropServices.DllImportAttribute> , kitaplığa yüklenecek geçerli çalışma dizini de dahil olmak üzere bir dizi dizin sağlar.</span><span class="sxs-lookup"><span data-stu-id="cf207-114">By default, P/Invoke functions using <xref:System.Runtime.InteropServices.DllImportAttribute> probe a number of directories, including the current working directory for the library to load.</span></span> <span data-ttu-id="cf207-115">Bu, belirli uygulamalar için bir güvenlik sorunu olabilir ve bu, DLL ele geçirme için önde gelen.</span><span class="sxs-lookup"><span data-stu-id="cf207-115">This can be a security issue for certain applications, leading to DLL hijacking.</span></span>

<span data-ttu-id="cf207-116">Örneğin, içeri aktarılan ile aynı ada sahip kötü amaçlı bir DLL, varsayılan olarak ilk olarak aranabilecek geçerli çalışma dizinine yerleştirilirse, kötü amaçlı DLL yüklenecektir.</span><span class="sxs-lookup"><span data-stu-id="cf207-116">For example, if a malicious DLL with the same name as the imported one is placed under the current working directory, which will be searched firstly by default, then the malicious DLL could be loaded.</span></span>

<span data-ttu-id="cf207-117">Daha fazla bilgi için bkz. [kitaplığı güvenli yükleme](https://msrc-blog.microsoft.com/2014/05/13/load-library-safely/).</span><span class="sxs-lookup"><span data-stu-id="cf207-117">For more information, see [Load Library Safely](https://msrc-blog.microsoft.com/2014/05/13/load-library-safely/).</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="cf207-118">İhlalleri çözme</span><span class="sxs-lookup"><span data-stu-id="cf207-118">How to fix violations</span></span>

<span data-ttu-id="cf207-119"><xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute>Derleme veya yöntem IÇIN DLL arama yolunu açıkça belirtmek üzere kullanın.</span><span class="sxs-lookup"><span data-stu-id="cf207-119">Use <xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute> to specify the DLL search path explicitly for the assembly or the method.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="cf207-120">Uyarıların ne zaman bastırılamıyor</span><span class="sxs-lookup"><span data-stu-id="cf207-120">When to suppress warnings</span></span>

<span data-ttu-id="cf207-121">Şu durumlarda bu kuralı gizlemek güvenlidir:</span><span class="sxs-lookup"><span data-stu-id="cf207-121">It's safe to suppress this rule if:</span></span>

- <span data-ttu-id="cf207-122">Yüklenen derlemenin istediğiniz gibi olduğundan emin olursunuz.</span><span class="sxs-lookup"><span data-stu-id="cf207-122">You're sure the loaded assembly is what you want.</span></span> <span data-ttu-id="cf207-123">Örneğin, uygulamanız güvenilen bir sunucuda çalışır ve dosyalara tamamen güvenmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="cf207-123">For example, your application runs on a trusted server and you completely trust the files.</span></span>
- <span data-ttu-id="cf207-124">İçeri aktarılan derleme, user32.dll gibi yaygın olarak kullanılan bir sistem derlemesidir ve arama yolu stratejisi [bilinen dll mekanizmasından](/archive/blogs/larryosterman/what-are-known-dlls-anyway)sonraki bir durum değildir.</span><span class="sxs-lookup"><span data-stu-id="cf207-124">The imported assembly is a commonly used system assembly, like user32.dll, and the search path strategy follows the [Known DLLs mechanism](/archive/blogs/larryosterman/what-are-known-dlls-anyway).</span></span>

## <a name="pseudo-code-examples"></a><span data-ttu-id="cf207-125">Sözde kod örnekleri</span><span class="sxs-lookup"><span data-stu-id="cf207-125">Pseudo-code examples</span></span>

```csharp
using System;
using System.Runtime.InteropServices;

class ExampleClass
{
    [DllImport("The3rdAssembly.dll")]
    public static extern int MessageBox(IntPtr hWnd, String text, String caption, uint type);

    public void ExampleMethod()
    {
        MessageBox(new IntPtr(0), "Hello World!", "Hello Dialog", 0);
    }
}
```

### <a name="solution"></a><span data-ttu-id="cf207-126">Çözüm</span><span class="sxs-lookup"><span data-stu-id="cf207-126">Solution</span></span>

```csharp
using System;
using System.Runtime.InteropServices;

class ExampleClass
{
    [DllImport("The3rdAssembly.dll")]
    [DefaultDllImportSearchPaths(DllImportSearchPath.UserDirectories)]
    public static extern int MessageBox(IntPtr hWnd, String text, String caption, uint type);

    public void ExampleMethod()
    {
        MessageBox(new IntPtr(0), "Hello World!", "Hello Dialog", 0);
    }
}
```

## <a name="related-rules"></a><span data-ttu-id="cf207-127">İlgili kurallar</span><span class="sxs-lookup"><span data-stu-id="cf207-127">Related rules</span></span>

[<span data-ttu-id="cf207-128">CA5393: Güvenli olmayan DllImportSearchPath değeri kullanmayın</span><span class="sxs-lookup"><span data-stu-id="cf207-128">CA5393: Do not use unsafe DllImportSearchPath value</span></span>](ca5393.md)
