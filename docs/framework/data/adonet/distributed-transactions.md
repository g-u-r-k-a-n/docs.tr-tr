---
description: 'Daha fazla bilgi edinin: dağıtılmış Işlemler'
title: Dağıtılmış İşlemler
ms.date: 03/30/2017
ms.assetid: 718b257c-bcb2-408e-b004-a7b0adb1c176
ms.openlocfilehash: 611fe4e2139e69e9501a3ea04a6aa62425e06728
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99651125"
---
# <a name="distributed-transactions"></a><span data-ttu-id="28d36-103">Dağıtılmış İşlemler</span><span class="sxs-lookup"><span data-stu-id="28d36-103">Distributed Transactions</span></span>

<span data-ttu-id="28d36-104">İşlem, diğer şeyler arasında bir birim olarak başarılı (işleme) veya başarısız (iptal) bir ilgili görevler kümesidir.</span><span class="sxs-lookup"><span data-stu-id="28d36-104">A transaction is a set of related tasks that either succeeds (commit) or fails (abort) as a unit, among other things.</span></span> <span data-ttu-id="28d36-105">*Dağıtılmış işlem* , çeşitli kaynakları etkileyen bir işlemdir.</span><span class="sxs-lookup"><span data-stu-id="28d36-105">A *distributed transaction* is a transaction that affects several resources.</span></span> <span data-ttu-id="28d36-106">Dağıtılmış bir işlemin kaydedilmesi için tüm katılımcılar, verilerde yapılan değişikliklerin kalıcı olacağını garanti etmelidir.</span><span class="sxs-lookup"><span data-stu-id="28d36-106">For a distributed transaction to commit, all participants must guarantee that any change to data will be permanent.</span></span> <span data-ttu-id="28d36-107">Sistem kilitlenme veya diğer öngörülemeyen olayları rağmen değişiklikleri kalıcı gerekir.</span><span class="sxs-lookup"><span data-stu-id="28d36-107">Changes must persist despite system crashes or other unforeseen events.</span></span> <span data-ttu-id="28d36-108">Tek bir katılımcı bu garantiyi yapamazsa, tüm işlem başarısız olur ve işlemin kapsamındaki verilerde yapılan değişiklikler geri alınır.</span><span class="sxs-lookup"><span data-stu-id="28d36-108">If even a single participant fails to make this guarantee, the entire transaction fails, and any changes to data within the scope of the transaction are rolled back.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="28d36-109">İşlem etkinken bir işlem başlatıldığında bir işlemi gerçekleştirmeyi veya geri almayı denerseniz bir özel durum oluşturulur `DataReader` .</span><span class="sxs-lookup"><span data-stu-id="28d36-109">An exception will be thrown if you attempt to commit or roll back a transaction if a `DataReader` is started while the transaction is active.</span></span>  
  
## <a name="working-with-systemtransactions"></a><span data-ttu-id="28d36-110">System. Transactions ile çalışma</span><span class="sxs-lookup"><span data-stu-id="28d36-110">Working with System.Transactions</span></span>  

 <span data-ttu-id="28d36-111">.NET Framework, dağıtılmış işlemler ad alanındaki API aracılığıyla yönetilir <xref:System.Transactions> .</span><span class="sxs-lookup"><span data-stu-id="28d36-111">In the .NET Framework, distributed transactions are managed through the API in the <xref:System.Transactions> namespace.</span></span> <span data-ttu-id="28d36-112"><xref:System.Transactions>Birden çok kalıcı Kaynak Yöneticisi dahil edildiğinde API, dağıtılmış işlem Işlemesini Microsoft Dağıtılmış işlem Düzenleyicisi (MS DTC) gibi bir işlem izleyicisine devredebilir.</span><span class="sxs-lookup"><span data-stu-id="28d36-112">The <xref:System.Transactions> API will delegate distributed transaction handling to a transaction monitor such as the Microsoft Distributed Transaction Coordinator (MS DTC) when multiple persistent resource managers are involved.</span></span> <span data-ttu-id="28d36-113">Daha fazla bilgi için bkz. [Işlem temelleri](../transactions/transaction-fundamentals.md).</span><span class="sxs-lookup"><span data-stu-id="28d36-113">For more information, see [Transaction Fundamentals](../transactions/transaction-fundamentals.md).</span></span>  
  
 <span data-ttu-id="28d36-114">ADO.NET 2,0 `EnlistTransaction` , bir örnekteki bağlantıyı listeleyen yöntemi kullanarak dağıtılmış bir işlemde bir dağıtım için destek sunmuştur <xref:System.Transactions.Transaction> .</span><span class="sxs-lookup"><span data-stu-id="28d36-114">ADO.NET 2.0 introduced support for enlisting in a distributed transaction using the `EnlistTransaction` method, which enlists a connection in a <xref:System.Transactions.Transaction> instance.</span></span> <span data-ttu-id="28d36-115">Önceki ADO.NET sürümlerinde, Dağıtılmış işlemlerde açık kayıt, `EnlistDistributedTransaction` bir örneğin bir bağlantıyı listeleme yöntemi kullanılarak <xref:System.EnterpriseServices.ITransaction> , geriye dönük uyumluluk için desteklenen bir bağlantı yöntemi kullanılarak gerçekleştirildi.</span><span class="sxs-lookup"><span data-stu-id="28d36-115">In previous versions of ADO.NET, explicit enlistment in distributed transactions was performed using the `EnlistDistributedTransaction` method of a connection to enlist a connection in a <xref:System.EnterpriseServices.ITransaction> instance, which is supported for backwards compatibility.</span></span> <span data-ttu-id="28d36-116">Enterprise Services işlemleri hakkında daha fazla bilgi için bkz. [Enterprise Services ve com+ işlemleri Ile birlikte çalışabilirlik](../transactions/interoperability-with-enterprise-services-and-com-transactions.md).</span><span class="sxs-lookup"><span data-stu-id="28d36-116">For more information on Enterprise Services transactions, see [Interoperability with Enterprise Services and COM+ Transactions](../transactions/interoperability-with-enterprise-services-and-com-transactions.md).</span></span>  
  
 <span data-ttu-id="28d36-117"><xref:System.Transactions>SQL Server veritabanına karşı SQL Server için .NET Framework sağlayıcısıyla bir işlem kullanırken, hafif bir şekilde <xref:System.Transactions.Transaction> otomatik olarak kullanılacaktır.</span><span class="sxs-lookup"><span data-stu-id="28d36-117">When using a <xref:System.Transactions> transaction with the .NET Framework Provider for SQL Server against a SQL Server database, a lightweight <xref:System.Transactions.Transaction> will automatically be used.</span></span> <span data-ttu-id="28d36-118">Daha sonra işlem, tam bir dağıtılmış işleme gereken şekilde yükseltilebilir.</span><span class="sxs-lookup"><span data-stu-id="28d36-118">The transaction can then be promoted to a full distributed transaction on an as-needed basis.</span></span> <span data-ttu-id="28d36-119">Daha fazla bilgi için bkz. [System. Transactions tümleştirmesi SQL Server](system-transactions-integration-with-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="28d36-119">For more information, see [System.Transactions Integration with SQL Server](system-transactions-integration-with-sql-server.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="28d36-120">Bir Oracle veritabanının tek seferde katılabileceğiniz en fazla dağıtılmış işlem sayısı, varsayılan olarak 10 ' a ayarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="28d36-120">The maximum number of distributed transactions that an Oracle database can participate in at one time is set to 10 by default.</span></span> <span data-ttu-id="28d36-121">Bir Oracle veritabanına bağlıyken 10 işlemden sonra bir özel durum oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="28d36-121">After the 10th transaction when connected to an Oracle database, an exception is thrown.</span></span> <span data-ttu-id="28d36-122">Oracle, `DDL` Dağıtılmış bir işlemin içini desteklemez.</span><span class="sxs-lookup"><span data-stu-id="28d36-122">Oracle does not support `DDL` inside of a distributed transaction.</span></span>  
  
## <a name="automatically-enlisting-in-a-distributed-transaction"></a><span data-ttu-id="28d36-123">Dağıtılmış bir Işlemde otomatik olarak aşağı kaydetme</span><span class="sxs-lookup"><span data-stu-id="28d36-123">Automatically Enlisting in a Distributed Transaction</span></span>  

 <span data-ttu-id="28d36-124">Otomatik kayıt, ADO.NET bağlantılarını tümleştirmenin varsayılan (ve tercih edilen) yoludur `System.Transactions` .</span><span class="sxs-lookup"><span data-stu-id="28d36-124">Automatic enlistment is the default (and preferred) way of integrating ADO.NET connections with `System.Transactions`.</span></span> <span data-ttu-id="28d36-125">Bir bağlantı nesnesi, bir işlemin etkin olduğunu belirlerse, bu bir işlemin etkin olduğunu belirlerse, `System.Transaction` Bu da `Transaction.Current` null olmayan anlamına gelir.</span><span class="sxs-lookup"><span data-stu-id="28d36-125">A connection object will automatically enlist in an existing distributed transaction if it determines that a transaction is active, which, in `System.Transaction` terms, means that `Transaction.Current` is not null.</span></span> <span data-ttu-id="28d36-126">Bağlantı açıldığında otomatik işlem kaydı gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="28d36-126">Automatic transaction enlistment occurs when the connection is opened.</span></span> <span data-ttu-id="28d36-127">İşlem kapsamı içinde bir komut yürütülürse bile bu durum gerçekleşmeyecektir.</span><span class="sxs-lookup"><span data-stu-id="28d36-127">It will not happen after that even if a command is executed inside of a transaction scope.</span></span> <span data-ttu-id="28d36-128">`Enlist=false`Bir için bağlantı dizesi parametresi olarak <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType> veya bir `OLE DB Services=-7` bağlantı dizesi parametresi olarak belirterek, mevcut hareketlerdeki otomatik kaydı devre dışı bırakabilirsiniz <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="28d36-128">You can disable auto-enlistment in existing transactions by specifying `Enlist=false` as a connection string parameter for a <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A?displayProperty=nameWithType>, or `OLE DB Services=-7` as a connection string parameter for an <xref:System.Data.OleDb.OleDbConnection.ConnectionString%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="28d36-129">Oracle ve ODBC bağlantı dizesi parametreleri hakkında daha fazla bilgi için bkz <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A?displayProperty=nameWithType> <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A?displayProperty=nameWithType> . ve.</span><span class="sxs-lookup"><span data-stu-id="28d36-129">For more information on Oracle and ODBC connection string parameters, see <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A?displayProperty=nameWithType> and <xref:System.Data.Odbc.OdbcConnection.ConnectionString%2A?displayProperty=nameWithType>.</span></span>  
  
## <a name="manually-enlisting-in-a-distributed-transaction"></a><span data-ttu-id="28d36-130">Dağıtılmış bir Işlemde el ile kaydetme</span><span class="sxs-lookup"><span data-stu-id="28d36-130">Manually Enlisting in a Distributed Transaction</span></span>  

 <span data-ttu-id="28d36-131">Otomatik kayıt devre dışıysa veya bağlantı açıldıktan sonra başlatılan bir işlemi listelemesi gerekiyorsa, `EnlistTransaction` <xref:System.Data.Common.DbConnection> üzerinde çalıştığınız sağlayıcının nesne yöntemini kullanarak var olan bir dağıtılmış işlemde listeleme yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="28d36-131">If auto-enlistment is disabled or you need to enlist a transaction that was started after the connection was opened, you can enlist in an existing distributed transaction using the `EnlistTransaction` method of the <xref:System.Data.Common.DbConnection> object for the provider you are working with.</span></span> <span data-ttu-id="28d36-132">Varolan bir dağıtılmış işlemde en iyi şekilde, işlem yapıldığından veya geri alınırsa, veri kaynağındaki kod tarafından yapılan değişikliklerin de yürütülmesi veya geri alınması gerekir.</span><span class="sxs-lookup"><span data-stu-id="28d36-132">Enlisting in an existing distributed transaction ensures that, if the transaction is committed or rolled back, modifications made by the code at the data source will be committed or rolled back as well.</span></span>  
  
 <span data-ttu-id="28d36-133">Dağıtılmış işlemlere son kaydetme, özellikle iş nesneleri havuzında uygulanabilir.</span><span class="sxs-lookup"><span data-stu-id="28d36-133">Enlisting in distributed transactions is particularly applicable when pooling business objects.</span></span> <span data-ttu-id="28d36-134">Bir iş nesnesi açık bağlantıyla havuza alınmış ise, otomatik işlem kaydı yalnızca bağlantı açıldığında gerçekleşir.</span><span class="sxs-lookup"><span data-stu-id="28d36-134">If a business object is pooled with an open connection, automatic transaction enlistment only occurs when that connection is opened.</span></span> <span data-ttu-id="28d36-135">Havuza alınan iş nesnesi kullanılarak birden çok işlem gerçekleştirilirse, bu nesnenin açık bağlantısı yeni başlatılan işlemlerde otomatik olarak listelenmeyecektir.</span><span class="sxs-lookup"><span data-stu-id="28d36-135">If multiple transactions are performed using the pooled business object, the open connection for that object will not automatically enlist in newly initiated transactions.</span></span> <span data-ttu-id="28d36-136">Bu durumda, bağlantı için otomatik işlem kaydı devre dışı bırakabilir ve kullanarak işlem sırasında bağlantı listeleme yapabilirsiniz `EnlistTransaction` .</span><span class="sxs-lookup"><span data-stu-id="28d36-136">In this case, you can disable automatic transaction enlistment for the connection and enlist the connection in transactions using `EnlistTransaction`.</span></span>  
  
 <span data-ttu-id="28d36-137">`EnlistTransaction` mevcut işleme başvuru olan türde tek bir bağımsız değişken alır <xref:System.Transactions.Transaction> .</span><span class="sxs-lookup"><span data-stu-id="28d36-137">`EnlistTransaction` takes a single argument of type <xref:System.Transactions.Transaction> that is a reference to the existing transaction.</span></span> <span data-ttu-id="28d36-138">Bağlantı yöntemini çağırdıktan sonra `EnlistTransaction` , bağlantı kullanılarak veri kaynağında yapılan tüm değişiklikler işleme dahil edilir.</span><span class="sxs-lookup"><span data-stu-id="28d36-138">After calling the connection's `EnlistTransaction` method, all modifications made at the data source using the connection are included in the transaction.</span></span> <span data-ttu-id="28d36-139">Null değer geçirilmesi, bağlantının geçerli dağıtılmış işlem listesinden listesini kaldırır.</span><span class="sxs-lookup"><span data-stu-id="28d36-139">Passing a null value unenlists the connection from its current distributed transaction enlistment.</span></span> <span data-ttu-id="28d36-140">Çağrılmadan önce bağlantının açılması gerektiğini unutmayın `EnlistTransaction` .</span><span class="sxs-lookup"><span data-stu-id="28d36-140">Note that the connection must be opened before calling `EnlistTransaction`.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="28d36-141">Bir bağlantı bir işleme açık olarak kaydedildikten sonra, ilk işlem tamamlanana kadar kaydı kaldırılamaz veya başka bir işlemde kayıtlı olamaz.</span><span class="sxs-lookup"><span data-stu-id="28d36-141">Once a connection is explicitly enlisted on a transaction, it cannot be un-enlisted or enlisted in another transaction until the first transaction finishes.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="28d36-142">`EnlistTransaction` bağlantı, bağlantının yöntemiyle zaten bir işlem başlamışsa bir özel durum oluşturur <xref:System.Data.Common.DbConnection.BeginTransaction%2A> .</span><span class="sxs-lookup"><span data-stu-id="28d36-142">`EnlistTransaction` throws an exception if the connection has already begun a transaction using the connection's <xref:System.Data.Common.DbConnection.BeginTransaction%2A> method.</span></span> <span data-ttu-id="28d36-143">Bununla birlikte, işlem veri kaynağında başlatılan yerel bir işlem ise (örneğin, açıkça bir kullanarak BEGIN TRANSACTION deyimin yürütülmesi <xref:System.Data.SqlClient.SqlCommand> ), `EnlistTransaction` yerel işlemi geri alarak var olan dağıtılmış işlemde istenen şekilde Listeleme işlemini geri alacak.</span><span class="sxs-lookup"><span data-stu-id="28d36-143">However, if the transaction is a local transaction started at the data source (for example, executing the BEGIN TRANSACTION statement explicitly using a <xref:System.Data.SqlClient.SqlCommand>), `EnlistTransaction` will roll back the local transaction and enlist in the existing distributed transaction as requested.</span></span> <span data-ttu-id="28d36-144">Yerel işlemin geri alındığı ve kullanılarak başlatılmamış tüm yerel işlemleri yönetmesi gerektiğini fark edersiniz <xref:System.Data.Common.DbConnection.BeginTransaction%2A> .</span><span class="sxs-lookup"><span data-stu-id="28d36-144">You will not receive notice that the local transaction was rolled back, and must manage any local transactions not started using <xref:System.Data.Common.DbConnection.BeginTransaction%2A>.</span></span> <span data-ttu-id="28d36-145">SQL Server ile SQL Server () için .NET Framework Veri Sağlayıcısı kullanıyorsanız `SqlClient` , listeleme girişimi bir özel durum oluşturur.</span><span class="sxs-lookup"><span data-stu-id="28d36-145">If you are using the .NET Framework Data Provider for SQL Server (`SqlClient`) with SQL Server, an attempt to enlist will throw an exception.</span></span> <span data-ttu-id="28d36-146">Diğer tüm durumlar algılanacaktır.</span><span class="sxs-lookup"><span data-stu-id="28d36-146">All other cases will go undetected.</span></span>  
  
## <a name="promotable-transactions-in-sql-server"></a><span data-ttu-id="28d36-147">SQL Server promotable Işlemleri</span><span class="sxs-lookup"><span data-stu-id="28d36-147">Promotable Transactions in SQL Server</span></span>  

 <span data-ttu-id="28d36-148">SQL Server, yerel bir hafif işlemin yalnızca gerekli olması durumunda otomatik olarak dağıtılmış bir işleme yükseltibileceği promotable işlemlerini destekler.</span><span class="sxs-lookup"><span data-stu-id="28d36-148">SQL Server supports promotable transactions in which a local lightweight transaction can be automatically promoted to a distributed transaction only if it is required.</span></span> <span data-ttu-id="28d36-149">Bir promotable işlemi, eklenen ek yük gerekmediği takdirde dağıtılmış bir işlemin ek yükünü çağırmaz.</span><span class="sxs-lookup"><span data-stu-id="28d36-149">A promotable transaction does not invoke the added overhead of a distributed transaction unless the added overhead is required.</span></span> <span data-ttu-id="28d36-150">Daha fazla bilgi ve bir kod örneği için bkz. [SQL Server Ile System. Transactions tümleştirmesi](system-transactions-integration-with-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="28d36-150">For more information and a code sample, see [System.Transactions Integration with SQL Server](system-transactions-integration-with-sql-server.md).</span></span>  
  
## <a name="configuring-distributed-transactions"></a><span data-ttu-id="28d36-151">Dağıtılmış Işlemleri yapılandırma</span><span class="sxs-lookup"><span data-stu-id="28d36-151">Configuring Distributed Transactions</span></span>  

 <span data-ttu-id="28d36-152">Dağıtılmış işlemleri kullanabilmeniz için ağ üzerinden MS DTC 'yi etkinleştirmeniz gerekebilir.</span><span class="sxs-lookup"><span data-stu-id="28d36-152">You may need to enable the MS DTC over the network in order to use distributed transactions.</span></span> <span data-ttu-id="28d36-153">Windows Güvenlik Duvarı etkinse, MS DTC hizmetinin ağı kullanması veya MS DTC bağlantı noktasını açması gerekir.</span><span class="sxs-lookup"><span data-stu-id="28d36-153">If have the Windows Firewall enabled, you must allow the MS DTC service to use the network or open the MS DTC port.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="28d36-154">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="28d36-154">See also</span></span>

- [<span data-ttu-id="28d36-155">İşlemler ve Eşzamanlılık</span><span class="sxs-lookup"><span data-stu-id="28d36-155">Transactions and Concurrency</span></span>](transactions-and-concurrency.md)
- [<span data-ttu-id="28d36-156">SQL Server ile System.Transactions Tümleştirmesi</span><span class="sxs-lookup"><span data-stu-id="28d36-156">System.Transactions Integration with SQL Server</span></span>](system-transactions-integration-with-sql-server.md)
- [<span data-ttu-id="28d36-157">ADO.NET’e Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="28d36-157">ADO.NET Overview</span></span>](ado-net-overview.md)
