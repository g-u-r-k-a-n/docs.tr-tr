---
title: Veri hizmeti bağlamını yönetme (WCF Veri Hizmetleri)
ms.date: 03/30/2017
ms.assetid: 15b19d09-7de7-4638-9556-6ef396cc45ec
ms.openlocfilehash: 104b87a9fdfc1e461b708acf7a75c8327ad182af
ms.sourcegitcommit: 79a2d6a07ba4ed08979819666a0ee6927bbf1b01
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74568934"
---
# <a name="managing-the-data-service-context-wcf-data-services"></a>Veri hizmeti bağlamını yönetme (WCF Veri Hizmetleri)
<xref:System.Data.Services.Client.DataServiceContext> sınıfı, belirtilen bir veri hizmetine göre desteklenen işlemleri kapsüller. OData Hizmetleri durum bilgisiz olmasına karşın bağlam değildir. Bu nedenle, değişiklik yönetimi gibi özellikleri desteklemek için veri hizmeti ile etkileşimler arasında istemcideki durumu korumak için <xref:System.Data.Services.Client.DataServiceContext> sınıfını kullanabilirsiniz. Bu sınıf Ayrıca kimlikleri yönetir ve değişiklikleri izler.  
  
## <a name="merge-options-and-identity-resolution"></a>Birleştirme seçenekleri ve kimlik çözümlemesi  
 Bir <xref:System.Data.Services.Client.DataServiceQuery%601> yürütüldüğünde, yanıt akışındaki varlıklar nesnelere uygulanır. Daha fazla bilgi için bkz. [nesne materialization](object-materialization-wcf-data-services.md). Yanıt iletisindeki girdilerin nesnelere nasıl gerçekleştirildiği, kimlik çözümlemesine göre yapılır ve sorgu yürütüldüğü birleştirme seçeneğine bağlıdır. Tek bir <xref:System.Data.Services.Client.DataServiceContext>kapsamında birden çok sorgu veya yükleme isteği yürütüldüğünde, WCF Veri Hizmetleri istemci yalnızca belirli bir anahtar değeri olan bir nesnenin tek bir örneğini izler. Kimlik çözümlemesi yapmak için kullanılan bu anahtar, benzersiz olarak bir varlığı tanımlar.  
  
 Varsayılan olarak, istemci, yanıt akışındaki bir girişi yalnızca <xref:System.Data.Services.Client.DataServiceContext>tarafından izlenmeyen varlıklar için bir nesneye çıkarır. Bu, önbellekte bulunan nesnelerdeki değişikliklerin üzerine yazılmayacağı anlamına gelir. Bu davranış sorgular ve yükleme işlemleri için <xref:System.Data.Services.Client.MergeOption> bir değer belirtilerek denetlenir. Bu seçenek, <xref:System.Data.Services.Client.DataServiceContext><xref:System.Data.Services.Client.DataServiceContext.MergeOption%2A> özelliği ayarlanarak belirtilir. Varsayılan birleştirme seçeneği değeri <xref:System.Data.Services.Client.MergeOption.AppendOnly>. Bu, yalnızca izlenmekte olmayan varlıklar için nesneleri çıkarır, bu da mevcut nesnelerin üzerine yazılmayacağı anlamına gelir. İstemci üzerindeki nesnelerde yapılan değişikliklerin, veri hizmetindeki güncelleştirmeler tarafından üzerine yazılmasını önlemenin bir diğer yolu <xref:System.Data.Services.Client.MergeOption.PreserveChanges>belirtmektir. <xref:System.Data.Services.Client.MergeOption.OverwriteChanges>belirttiğinizde, istemci üzerindeki nesnelerin değerleri, bu nesnelerde değişiklik yapılmış olsa bile yanıt akışındaki girişlerden en son değerlerle değiştirilir. <xref:System.Data.Services.Client.MergeOption.NoTracking> birleştirme seçeneği kullanıldığında, <xref:System.Data.Services.Client.DataServiceContext> istemci nesnelerinde yapılan değişiklikleri veri hizmetine gönderemiyor. Bu seçenekle, değişikliklerin her zaman veri hizmetindeki değerlerle üzerine yazılır.  
  
## <a name="managing-concurrency"></a>Eşzamanlılık yönetimi  
 OData, veri hizmetinin güncelleştirme çakışmalarını algılamasını sağlayan iyimser eşzamanlılığı destekler. Veri hizmeti sağlayıcısı, veri hizmetinin bir eşzamanlılık belirteci kullanarak varlıklara yapılan değişiklikleri denetlemesi için bu şekilde yapılandırılabilir. Bu belirteç, bir kaynağın değişip değişmediğini anlamak üzere veri hizmeti tarafından doğrulanan bir varlık türünün bir veya daha fazla özelliğini içerir. Veri hizmetine gönderilen isteklerin eTag üstbilgisine dahil edilen eşzamanlılık belirteçleri, WCF Veri Hizmetleri istemcisi tarafından sizin için yönetilir. Daha fazla bilgi için bkz. [veri hizmetini güncelleştirme](updating-the-data-service-wcf-data-services.md).  
  
 <xref:System.Data.Services.Client.DataServiceContext>, <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A>, <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A>ve <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A>kullanılarak veya bir <xref:System.Data.Services.Client.DataServiceCollection%601>tarafından el ile bildirilen nesnelerde yapılan değişiklikleri izler. <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> yöntemi çağrıldığında, istemci değişiklikleri veri hizmetine geri gönderir. <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>, istemcideki veri değişiklikleri veri hizmetindeki değişikliklerle çakışıyorsa başarısız olabilir. Bu gerçekleştiğinde, güncelleştirme verilerini almak için varlık kaynağını yeniden sorgumalısınız. Veri hizmetindeki değişikliklerin üzerine yazmak için, <xref:System.Data.Services.Client.MergeOption.PreserveChanges> birleştirme seçeneğini kullanarak sorguyu yürütün. <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> yeniden çağırdığınızda, istemci üzerinde korunan değişiklikler, veri hizmetindeki kaynakta başka değişiklikler yapılmadığından, veri hizmetine kalıcı hale getirilir.  
  
## <a name="saving-changes"></a>Değişiklikler kaydediliyor  
 Değişiklikler <xref:System.Data.Services.Client.DataServiceContext> örneğinde izlenir, ancak anında sunucuya gönderilmez. Belirtilen bir etkinlik için gerekli değişikliklerle işiniz bittiğinde, tüm değişiklikleri veri hizmetine göndermek için <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> çağırın. <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> işlemi tamamlandıktan sonra bir <xref:System.Data.Services.Client.DataServiceResponse> nesnesi döndürülür. <xref:System.Data.Services.Client.DataServiceResponse> nesnesi, kalıcı veya denenen değişiklikleri temsil eden bir dizi <xref:System.Data.Services.Client.EntityDescriptor> veya <xref:System.Data.Services.Client.LinkDescriptor> örnekleri içeren bir <xref:System.Data.Services.Client.OperationResponse> nesneleri dizisi içerir. Veri hizmetinde bir varlık oluşturulduğunda veya değiştirildiğinde <xref:System.Data.Services.Client.EntityDescriptor>, önceki örnekteki oluşturulan `ProductID` değeri gibi sunucu tarafından oluşturulan tüm özellik değerleri de dahil olmak üzere, güncelleştirilmiş varlığa bir başvuru içerir. İstemci kitaplığı, .NET Framework nesnesini bu yeni değerlere sahip olacak şekilde otomatik olarak güncelleştirir.  
  
 Başarılı ekleme ve güncelleştirme işlemleri için, işlemle ilişkili <xref:System.Data.Services.Client.EntityDescriptor> veya <xref:System.Data.Services.Client.LinkDescriptor> nesnesinin State özelliği <xref:System.Data.Services.Client.EntityStates.Unchanged> olarak ayarlanır ve yeni değerler <xref:System.Data.Services.Client.MergeOption.OverwriteChanges>kullanılarak birleştirilir. Veri hizmetinde bir INSERT, Update veya delete işlemi başarısız olduğunda, varlık durumu <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> çağrılmadan önce olduğu gibi kalır ve <xref:System.Data.Services.Client.OperationResponse> <xref:System.Data.Services.Client.OperationResponse.Error%2A> özelliği hata hakkında bilgi içeren bir <xref:System.Data.Services.Client.DataServiceRequestException> olarak ayarlanır. Daha fazla bilgi için bkz. [veri hizmetini güncelleştirme](updating-the-data-service-wcf-data-services.md).  
  
### <a name="setting-the-http-method-for-updates"></a>Güncelleştirmeler için HTTP yöntemini ayarlama  
 Varsayılan olarak, .NET Framework istemci kitaplığı, güncelleştirmeleri varolan varlıklara BIRLEŞTIRME istekleri olarak gönderir. BIRLEŞTIRME isteği varlığın seçili özelliklerini güncelleştirir; ancak istemci her zaman BIRLEŞTIRME isteğindeki tüm özellikleri, hatta değişmemiş özellikleri içerir. OData protokolü Ayrıca, varlıkları güncelleştirmek için PUT istekleri göndermeyi destekler. Bir PUT isteğinde, mevcut bir varlık temelde, istemcinin özellik değerleriyle birlikte varlığın yeni bir örneğiyle değiştirilmiştir. PUT isteklerini kullanmak için, <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>çağrılırken <xref:System.Data.Services.Client.SaveChangesOptions> numaralandırmasında <xref:System.Data.Services.Client.SaveChangesOptions.ReplaceOnUpdate> bayrağını ayarlayın.  
  
> [!NOTE]
> Bir PUT isteği, istemci varlığın tüm özellikleri hakkında bilgi sahibi olmadığında BIRLEŞTIRME isteğinden farklı davranabilecektir. Bu durum, bir varlık türünü istemcideki yeni bir türe yansıtılabilen ortaya çıkabilir. Ayrıca, hizmet veri modelindeki varlığa yeni özellikler eklendiğinde ve <xref:System.Data.Services.Client.DataServiceContext> <xref:System.Data.Services.Client.DataServiceContext.IgnoreMissingProperties%2A> özelliğinin bu tür istemci eşleme hatalarını yoksayması için `true` olarak ayarlandığı durumlarda da meydana gelebilir. Bu durumlarda, bir PUT isteği, istemci için bilinmeyen tüm özellikleri varsayılan değerlerine sıfırlayacaktır.  
  
### <a name="post-tunneling"></a>Tünel SONRASı  
 Varsayılan olarak, istemci kitaplığı POST, GET, PUT/MERGE/PATCH ve DELETE için karşılık gelen HTTP yöntemlerini kullanarak bir OData hizmetine oluşturma, okuma, güncelleştirme ve silme istekleri gönderir. Bu, temsili durum aktarımının (REST) temel ilkelerini barındırır. Ancak, her Web sunucusu uygulamasında HTTP yöntemlerinin tam kümesini desteklememektedir. Bazı durumlarda, desteklenen yöntemler yalnızca GET ve POST ile sınırlandırılmış olabilir. Bu, bir güvenlik duvarı gibi bir aracı belirli yöntemlerle istekleri engellediğinde meydana gelebilir. GET ve POST yöntemleri en sık desteklendiğinden, OData bir POST isteği kullanarak desteklenmeyen HTTP yöntemlerini yürütmek için bir yol önerir. *Yöntem tünel oluşturma* veya *gönderi tüneli*olarak bilinen bu, istemcinin özel `X-HTTP-Method` üstbilgisinde BELIRTILEN gerçek yöntemle bir post isteği göndermesini sağlar. İstekler için GÖNDERI tünelini etkinleştirmek üzere <xref:System.Data.Services.Client.DataServiceContext> örneğindeki <xref:System.Data.Services.Client.DataServiceContext.UsePostTunneling%2A> özelliğini `true`olarak ayarlayın.  
  
## <a name="see-also"></a>Ayrıca bkz.

- [WCF Veri Hizmetleri İstemci Kitaplığı](wcf-data-services-client-library.md)
- [Veri Hizmetini Güncelleştirme](updating-the-data-service-wcf-data-services.md)
- [Zaman Uyumsuz İşlemler](asynchronous-operations-wcf-data-services.md)
- [Toplu İşlemler](batching-operations-wcf-data-services.md)
