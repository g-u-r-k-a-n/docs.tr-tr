---
description: 'Hakkında daha fazla bilgi edinin: her biri Için... Next açıklaması (Visual Basic)'
title: For Each...Next Deyimi
ms.date: 07/20/2015
f1_keywords:
- vb.ForEach
- vb.ForEachNext
- vb.Each
- ForEachNext
helpviewer_keywords:
- infinite loops
- Next statement [Visual Basic], For Each...Next
- endless loops
- loop structures [Visual Basic], For Each...Next
- loops, endless
- Each keyword [Visual Basic]
- instructions, repeating
- For Each statement [Visual Basic]
- collections, instruction repetition
- loops, infinite
- For Each...Next statements
- For keyword [Visual Basic], For Each...Next statements
- Exit statement [Visual Basic], For Each...Next statements
- iteration
ms.assetid: ebce3120-95c3-42b1-b70b-fa7da40c75e2
ms.openlocfilehash: ff7afb5e3b505ebe2326343063a7884dc4f567b1
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99769110"
---
# <a name="for-eachnext-statement-visual-basic"></a><span data-ttu-id="975b2-103">For Each...Next Deyimi (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="975b2-103">For Each...Next Statement (Visual Basic)</span></span>

<span data-ttu-id="975b2-104">Bir koleksiyondaki her öğe için bir deyim grubunu yineler.</span><span class="sxs-lookup"><span data-stu-id="975b2-104">Repeats a group of statements for each element in a collection.</span></span>

## <a name="syntax"></a><span data-ttu-id="975b2-105">Syntax</span><span class="sxs-lookup"><span data-stu-id="975b2-105">Syntax</span></span>

```vb
For Each element [ As datatype ] In group
    [ statements ]
    [ Continue For ]
    [ statements ]
    [ Exit For ]
    [ statements ]
Next [ element ]
```

## <a name="parts"></a><span data-ttu-id="975b2-106">Bölümler</span><span class="sxs-lookup"><span data-stu-id="975b2-106">Parts</span></span>

|<span data-ttu-id="975b2-107">Süre</span><span class="sxs-lookup"><span data-stu-id="975b2-107">Term</span></span>|<span data-ttu-id="975b2-108">Tanım</span><span class="sxs-lookup"><span data-stu-id="975b2-108">Definition</span></span>|
|---|---|
|`element`|<span data-ttu-id="975b2-109">`For Each`İfadesinde gereklidir.</span><span class="sxs-lookup"><span data-stu-id="975b2-109">Required in the `For Each` statement.</span></span> <span data-ttu-id="975b2-110">`Next`Deyimde isteğe bağlı.</span><span class="sxs-lookup"><span data-stu-id="975b2-110">Optional in the `Next` statement.</span></span> <span data-ttu-id="975b2-111">Değişken.</span><span class="sxs-lookup"><span data-stu-id="975b2-111">Variable.</span></span> <span data-ttu-id="975b2-112">Koleksiyonun öğeleri arasında yineleme yapmak için kullanılır.</span><span class="sxs-lookup"><span data-stu-id="975b2-112">Used to iterate through the elements of the collection.</span></span>|
|`datatype`|<span data-ttu-id="975b2-113">Açık ise [`Option Infer`](option-infer-statement.md) (varsayılan) veya zaten bildirilirse, isteğe bağlıdır `element` ; `Option Infer` kapalıysa ve önceden bildirilmemiş olması gerekir `element` .</span><span class="sxs-lookup"><span data-stu-id="975b2-113">Optional if [`Option Infer`](option-infer-statement.md) is on (the default) or `element` is already declared; required if `Option Infer` is off and `element` isn't already declared.</span></span> <span data-ttu-id="975b2-114">Veri türü `element` .</span><span class="sxs-lookup"><span data-stu-id="975b2-114">The data type of `element`.</span></span>|
|`group`|<span data-ttu-id="975b2-115">Gereklidir.</span><span class="sxs-lookup"><span data-stu-id="975b2-115">Required.</span></span> <span data-ttu-id="975b2-116">Bir koleksiyon türü veya nesne olan türü olan bir değişken.</span><span class="sxs-lookup"><span data-stu-id="975b2-116">A variable with a type that's a collection type or Object.</span></span> <span data-ttu-id="975b2-117">Tekrarlanması gereken koleksiyona başvurur `statements` .</span><span class="sxs-lookup"><span data-stu-id="975b2-117">Refers to the collection over which the `statements` are to be repeated.</span></span>|
|`statements`|<span data-ttu-id="975b2-118">İsteğe bağlı.</span><span class="sxs-lookup"><span data-stu-id="975b2-118">Optional.</span></span> <span data-ttu-id="975b2-119">`For Each` `Next` İçindeki ve içindeki her öğe için çalışan arasında bir veya daha fazla deyim `group` .</span><span class="sxs-lookup"><span data-stu-id="975b2-119">One or more statements between `For Each` and `Next` that run on each item in `group`.</span></span>|
|`Continue For`|<span data-ttu-id="975b2-120">İsteğe bağlı.</span><span class="sxs-lookup"><span data-stu-id="975b2-120">Optional.</span></span> <span data-ttu-id="975b2-121">Denetimi döngünün başlangıcına aktarır `For Each` .</span><span class="sxs-lookup"><span data-stu-id="975b2-121">Transfers control to the start of the `For Each` loop.</span></span>|
|`Exit For`|<span data-ttu-id="975b2-122">İsteğe bağlı.</span><span class="sxs-lookup"><span data-stu-id="975b2-122">Optional.</span></span> <span data-ttu-id="975b2-123">Denetimi döngünün dışına aktarır `For Each` .</span><span class="sxs-lookup"><span data-stu-id="975b2-123">Transfers control out of the `For Each` loop.</span></span>|
|`Next`|<span data-ttu-id="975b2-124">Gereklidir.</span><span class="sxs-lookup"><span data-stu-id="975b2-124">Required.</span></span> <span data-ttu-id="975b2-125">Döngünün tanımını sonlandırır `For Each` .</span><span class="sxs-lookup"><span data-stu-id="975b2-125">Terminates the definition of the `For Each` loop.</span></span>|

## <a name="simple-example"></a><span data-ttu-id="975b2-126">Basit örnek</span><span class="sxs-lookup"><span data-stu-id="975b2-126">Simple Example</span></span>

<span data-ttu-id="975b2-127">Bir `For Each` `Next` koleksiyonun veya dizinin her öğesi için bir deyim kümesini yinelemek istediğinizde bir... döngüsü kullanın.</span><span class="sxs-lookup"><span data-stu-id="975b2-127">Use a `For Each`...`Next` loop when you want to repeat a set of statements for each element of a collection or array.</span></span>

> [!TIP]
> <span data-ttu-id="975b2-128">[İçin A... Sonraki Ifade](for-next-statement.md) , bir döngünün her yinelemesini bir denetim değişkeniyle ilişkilendirebileceğiniz ve değişkenin ilk ve son değerlerini belirleyebileceğiniz zaman iyi şekilde kullanılır.</span><span class="sxs-lookup"><span data-stu-id="975b2-128">A [For...Next Statement](for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values.</span></span> <span data-ttu-id="975b2-129">Bununla birlikte, bir koleksiyonla ilgilendiğinizde, ilk ve son değer kavramı anlamlı değildir ve koleksiyonun kaç öğe olduğunu bilmeniz gerekmez.</span><span class="sxs-lookup"><span data-stu-id="975b2-129">However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has.</span></span> <span data-ttu-id="975b2-130">Bu tür bir durumda,... `For Each` `Next` döngüsü genellikle daha iyi bir seçimdir.</span><span class="sxs-lookup"><span data-stu-id="975b2-130">In this kind of case, a `For Each`...`Next` loop is often a better choice.</span></span>

<span data-ttu-id="975b2-131">Aşağıdaki örnekte, `For Each` ...`Next`</span><span class="sxs-lookup"><span data-stu-id="975b2-131">In the following example, the `For Each`…`Next`</span></span> <span data-ttu-id="975b2-132">ifade, bir liste koleksiyonunun tüm öğeleri boyunca yinelenir.</span><span class="sxs-lookup"><span data-stu-id="975b2-132">statement iterates through all the elements of a List collection.</span></span>

[!code-vb[VbVbalrStatements#121](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#121)]

<span data-ttu-id="975b2-133">Daha fazla örnek için bkz. [koleksiyonlar](../../../standard/collections/index.md) ve [diziler](../../programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="975b2-133">For more examples, see [Collections](../../../standard/collections/index.md) and [Arrays](../../programming-guide/language-features/arrays/index.md).</span></span>

## <a name="nested-loops"></a><span data-ttu-id="975b2-134">İç içe döngüler</span><span class="sxs-lookup"><span data-stu-id="975b2-134">Nested Loops</span></span>

<span data-ttu-id="975b2-135">Bir `For Each` döngüyü diğerinin içine yerleştirerek döngüleri iç içe geçirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-135">You can nest `For Each` loops by putting one loop within another.</span></span>

<span data-ttu-id="975b2-136">Aşağıdaki örnek iç içe geçmiş `For Each` ...`Next`</span><span class="sxs-lookup"><span data-stu-id="975b2-136">The following example demonstrates nested `For Each`…`Next`</span></span> <span data-ttu-id="975b2-137">yapıları.</span><span class="sxs-lookup"><span data-stu-id="975b2-137">structures.</span></span>

[!code-vb[VbVbalrStatements#122](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#122)]

<span data-ttu-id="975b2-138">Döngüleri iç içe aktardığınızda her döngünün benzersiz bir `element` değişkeni olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="975b2-138">When you nest loops, each loop must have a unique `element` variable.</span></span>

<span data-ttu-id="975b2-139">Ayrıca, farklı türlerde denetim yapılarını birbirleriyle iç içe geçirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-139">You can also nest different kinds of control structures within each other.</span></span> <span data-ttu-id="975b2-140">Daha fazla bilgi için bkz. [Iç Içe denetim yapıları](../../programming-guide/language-features/control-flow/nested-control-structures.md).</span><span class="sxs-lookup"><span data-stu-id="975b2-140">For more information, see [Nested Control Structures](../../programming-guide/language-features/control-flow/nested-control-structures.md).</span></span>

## <a name="exit-for-and-continue-for"></a><span data-ttu-id="975b2-141">İçin çık ve devam et</span><span class="sxs-lookup"><span data-stu-id="975b2-141">Exit For and Continue For</span></span>

<span data-ttu-id="975b2-142">[Exit for](exit-statement.md) deyimleri yürütmenin uygulamadan çıkmasına neden olur `For` ...`Next`</span><span class="sxs-lookup"><span data-stu-id="975b2-142">The [Exit For](exit-statement.md) statement causes execution to exit the `For`…`Next`</span></span> <span data-ttu-id="975b2-143">öğesini Loop ve deyimden sonraki deyime aktarır `Next` .</span><span class="sxs-lookup"><span data-stu-id="975b2-143">loop and transfers control to the statement that follows the `Next` statement.</span></span>

<span data-ttu-id="975b2-144">`Continue For`İfade, denetimi döngünün bir sonraki yinelemesine hemen aktarır.</span><span class="sxs-lookup"><span data-stu-id="975b2-144">The `Continue For` statement transfers control immediately to the next iteration of the loop.</span></span> <span data-ttu-id="975b2-145">Daha fazla bilgi için bkz. [Continue bildirisi](continue-statement.md).</span><span class="sxs-lookup"><span data-stu-id="975b2-145">For more information, see [Continue Statement](continue-statement.md).</span></span>

<span data-ttu-id="975b2-146">Aşağıdaki örnek, ve deyimlerinin nasıl kullanılacağını göstermektedir `Continue For` `Exit For` .</span><span class="sxs-lookup"><span data-stu-id="975b2-146">The following example shows how to use the `Continue For` and `Exit For` statements.</span></span>

[!code-vb[VbVbalrStatements#123](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#123)]

<span data-ttu-id="975b2-147">`Exit For`Bir döngüye herhangi bir sayıda deyim yerleştirebilirsiniz `For Each` .</span><span class="sxs-lookup"><span data-stu-id="975b2-147">You can put any number of `Exit For` statements in a `For Each` loop.</span></span> <span data-ttu-id="975b2-148">İç içe döngüler içinde kullanıldığında `For Each` `Exit For` yürütmenin en içteki döngüden çıkmasına ve denetimi bir sonraki daha yüksek iç içe geçme düzeyine aktarmasına neden olur.</span><span class="sxs-lookup"><span data-stu-id="975b2-148">When used within nested `For Each` loops, `Exit For` causes execution to exit the innermost loop and transfers control to the next higher level of nesting.</span></span>

<span data-ttu-id="975b2-149">`Exit For` genellikle bir koşul değerlendirmesinden sonra, örneğin bir `If` .. `Then` . ...`Else` yapısı.</span><span class="sxs-lookup"><span data-stu-id="975b2-149">`Exit For` is often used after an evaluation of some condition, for example, in an `If`...`Then`...`Else` structure.</span></span> <span data-ttu-id="975b2-150">`Exit For`Aşağıdaki koşullar için kullanmak isteyebilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="975b2-150">You might want to use `Exit For` for the following conditions:</span></span>

- <span data-ttu-id="975b2-151">Tekrarlamaya devam etmek gereksiz veya imkansız.</span><span class="sxs-lookup"><span data-stu-id="975b2-151">Continuing to iterate is unnecessary or impossible.</span></span> <span data-ttu-id="975b2-152">Bunun nedeni hatalı bir değer veya sonlandırma isteği olabilir.</span><span class="sxs-lookup"><span data-stu-id="975b2-152">This might be caused by an erroneous value or a termination request.</span></span>

- <span data-ttu-id="975b2-153">Bir özel durum içinde yakalandı `Try` .. `Catch` . ...`Finally`. `Exit For` Bloğunun sonunda kullanabilirsiniz `Finally` .</span><span class="sxs-lookup"><span data-stu-id="975b2-153">An exception is caught in a `Try`...`Catch`...`Finally`. You might use `Exit For` at the end of the `Finally` block.</span></span>

- <span data-ttu-id="975b2-154">Sonsuz bir döngü vardır. Bu bir döngü, büyük veya hatta sonsuz bir sayı çalıştırabilir.</span><span class="sxs-lookup"><span data-stu-id="975b2-154">There an endless loop, which is a loop that could run a large or even infinite number of times.</span></span> <span data-ttu-id="975b2-155">Böyle bir koşulu tespit ediyorsanız, `Exit For` döngüyü atlamak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-155">If you detect such a condition, you can use `Exit For` to escape the loop.</span></span> <span data-ttu-id="975b2-156">Daha fazla bilgi için bkz [. do... Loop deyimleri](do-loop-statement.md).</span><span class="sxs-lookup"><span data-stu-id="975b2-156">For more information, see [Do...Loop Statement](do-loop-statement.md).</span></span>

## <a name="iterators"></a><span data-ttu-id="975b2-157">Yineleyiciler</span><span class="sxs-lookup"><span data-stu-id="975b2-157">Iterators</span></span>

<span data-ttu-id="975b2-158">Bir koleksiyon üzerinde özel bir yineleme gerçekleştirmek için bir *Yineleyici* kullanırsınız.</span><span class="sxs-lookup"><span data-stu-id="975b2-158">You use an *iterator* to perform a custom iteration over a collection.</span></span> <span data-ttu-id="975b2-159">Yineleyici bir işlev veya `Get` erişimci olabilir.</span><span class="sxs-lookup"><span data-stu-id="975b2-159">An iterator can be a function or a `Get` accessor.</span></span> <span data-ttu-id="975b2-160">`Yield`Tek seferde koleksiyonun her bir öğesini döndürmek için bir ifade kullanır.</span><span class="sxs-lookup"><span data-stu-id="975b2-160">It uses a `Yield` statement to return each element of the collection one at a time.</span></span>

<span data-ttu-id="975b2-161">Bir ifadeyi kullanarak bir yineleyici çağırın `For Each...Next` .</span><span class="sxs-lookup"><span data-stu-id="975b2-161">You call an iterator by using a `For Each...Next` statement.</span></span> <span data-ttu-id="975b2-162">Döngünün her yinelemesi `For Each` yineleyiciyi çağırır.</span><span class="sxs-lookup"><span data-stu-id="975b2-162">Each iteration of the `For Each` loop calls the iterator.</span></span> <span data-ttu-id="975b2-163">`Yield`Yineleyiciden bir ifadeye ulaşıldığında, `Yield` deyimdeki ifade döndürülür ve koddaki geçerli konum korunur.</span><span class="sxs-lookup"><span data-stu-id="975b2-163">When a `Yield` statement is reached in the iterator, the expression in the `Yield` statement is returned, and the current location in code is retained.</span></span> <span data-ttu-id="975b2-164">Bu konumdan, yineleyici bir sonraki sefer çağrıldığında yürütme yeniden başlatılır.</span><span class="sxs-lookup"><span data-stu-id="975b2-164">Execution is restarted from that location the next time that the iterator is called.</span></span>

<span data-ttu-id="975b2-165">Aşağıdaki örnek bir yineleyici işlevi kullanır.</span><span class="sxs-lookup"><span data-stu-id="975b2-165">The following example uses an iterator function.</span></span> <span data-ttu-id="975b2-166">Yineleyici işlevinin, `Yield` için içindeki bir ifade vardır [... Sonraki](for-next-statement.md) döngü.</span><span class="sxs-lookup"><span data-stu-id="975b2-166">The iterator function has a `Yield` statement that's inside a [For…Next](for-next-statement.md) loop.</span></span> <span data-ttu-id="975b2-167">`ListEvenNumbers`Yönteminde, `For Each` ifade gövdesinin her yinelemesi bir sonraki ifadeye devam eden Yineleyici işlevine bir çağrı oluşturur `Yield` .</span><span class="sxs-lookup"><span data-stu-id="975b2-167">In the `ListEvenNumbers` method, each iteration of the `For Each` statement body creates a call to the iterator function, which proceeds to the next `Yield` statement.</span></span>

[!code-vb[VbVbalrStatements#127](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#127)]

<span data-ttu-id="975b2-168">Daha fazla bilgi için bkz. [yineleyiciler](../../programming-guide/concepts/iterators.md), [yield ekstresi](yield-statement.md)ve [Yineleyici](../modifiers/iterator.md).</span><span class="sxs-lookup"><span data-stu-id="975b2-168">For more information, see [Iterators](../../programming-guide/concepts/iterators.md), [Yield Statement](yield-statement.md), and [Iterator](../modifiers/iterator.md).</span></span>

## <a name="technical-implementation"></a><span data-ttu-id="975b2-169">Teknik Uygulama</span><span class="sxs-lookup"><span data-stu-id="975b2-169">Technical Implementation</span></span>

<span data-ttu-id="975b2-170">Bir... `For Each``Next`</span><span class="sxs-lookup"><span data-stu-id="975b2-170">When a `For Each`…`Next`</span></span> <span data-ttu-id="975b2-171">deyimin çalışması Visual Basic, döngü başlamadan önce koleksiyonu yalnızca bir kez değerlendirir.</span><span class="sxs-lookup"><span data-stu-id="975b2-171">statement runs, Visual Basic evaluates the collection only one time, before the loop starts.</span></span> <span data-ttu-id="975b2-172">Deyiminiz değişiklikleri veya değişiklik engelleriyorsa `element` `group` , bu değişiklikler döngünün yinelemesini etkilemez.</span><span class="sxs-lookup"><span data-stu-id="975b2-172">If your statement block changes `element` or `group`, these changes don't affect the iteration of the loop.</span></span>

<span data-ttu-id="975b2-173">Koleksiyondaki tüm öğeler üzerinde kapsamlı olarak atandığında `element` , `For Each` döngü duraklar ve deyimden sonraki deyime geçer `Next` .</span><span class="sxs-lookup"><span data-stu-id="975b2-173">When all the elements in the collection have been successively assigned to `element`, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span>

<span data-ttu-id="975b2-174">[Seçenek çıkarımı](option-infer-statement.md) açık ise (varsayılan ayarı) Visual Basic derleyici, veri türünü çıkarsalabilir `element` .</span><span class="sxs-lookup"><span data-stu-id="975b2-174">If [Option Infer](option-infer-statement.md) is on (its default setting), the Visual Basic compiler can infer the data type of `element`.</span></span> <span data-ttu-id="975b2-175">Kapalıysa ve `element` döngü dışında bildirilmediyse, bunu bildiriminde bildirmeniz gerekir `For Each` .</span><span class="sxs-lookup"><span data-stu-id="975b2-175">If it is off and `element` hasn't been declared outside the loop, you must declare it in the `For Each` statement.</span></span> <span data-ttu-id="975b2-176">Açıkça veri türünü bildirmek için `element` bir `As` yan tümce kullanın.</span><span class="sxs-lookup"><span data-stu-id="975b2-176">To declare the data type of `element` explicitly, use an `As` clause.</span></span> <span data-ttu-id="975b2-177">Öğe veri türü `For Each` ... yapı dışında tanımlanmamışsa `Next` , kapsamı döngünün gövdesidir.</span><span class="sxs-lookup"><span data-stu-id="975b2-177">Unless the data type of element is defined outside the `For Each`...`Next` construct, its scope is the body of the loop.</span></span> <span data-ttu-id="975b2-178">`element`Döngüsünün dışında ve içinde bildiremezsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-178">Note that you cannot declare `element` both outside and inside the loop.</span></span>

<span data-ttu-id="975b2-179">İsteğe bağlı olarak `element` `Next` deyimde belirtebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-179">You can optionally specify `element` in the `Next` statement.</span></span> <span data-ttu-id="975b2-180">Bu, özellikle iç içe döngüler varsa programınızın okunabilirliğini geliştirir `For Each` .</span><span class="sxs-lookup"><span data-stu-id="975b2-180">This improves the readability of your program, especially if you have nested `For Each` loops.</span></span> <span data-ttu-id="975b2-181">Karşılık gelen ifadede görünen değişkenle aynı değişkeni belirtmeniz gerekir `For Each` .</span><span class="sxs-lookup"><span data-stu-id="975b2-181">You must specify the same variable as the one that appears in the corresponding `For Each` statement.</span></span>

<span data-ttu-id="975b2-182">Bir döngünün içindeki değerini değiştirmeyi önlemek isteyebilirsiniz `element` .</span><span class="sxs-lookup"><span data-stu-id="975b2-182">You might want to avoid changing the value of `element` inside a loop.</span></span> <span data-ttu-id="975b2-183">Bunu yapmak, kodunuzun okunmasını ve hata ayıklamasını daha zor hale getirir.</span><span class="sxs-lookup"><span data-stu-id="975b2-183">Doing this can make it more difficult to read and debug your code.</span></span> <span data-ttu-id="975b2-184">Değerini değiştirmek `group` , döngü ilk kez girildiğinde belirlenen koleksiyonu veya öğelerini etkilemez.</span><span class="sxs-lookup"><span data-stu-id="975b2-184">Changing the value of `group` doesn't affect the collection or its elements, which were determined when the loop was first entered.</span></span>

<span data-ttu-id="975b2-185">Döngüleri iç içe aktardığınızda, `Next` iç düzeyden önce bir dış iç içe düzeyi ifadesine karşılaşılırsa `Next` , derleyici bir hata bildirir.</span><span class="sxs-lookup"><span data-stu-id="975b2-185">When you're nesting loops, if a `Next` statement of an outer nesting level is encountered before the `Next` of an inner level, the compiler signals an error.</span></span> <span data-ttu-id="975b2-186">Ancak, derleyici bu çakışan hatayı yalnızca her ifadede belirtirseniz tespit edebilir `element` `Next` .</span><span class="sxs-lookup"><span data-stu-id="975b2-186">However, the compiler can detect this overlapping error only if you specify `element` in every `Next` statement.</span></span>

<span data-ttu-id="975b2-187">Kodunuz belirli bir sırada bir koleksiyonun geçiş yöntemine bağımlıysa, `For Each` `Next` koleksiyonun sunduğu Numaralandırıcı nesnesinin özelliklerini bilmiyorsanız,... Loop en iyi seçim değildir.</span><span class="sxs-lookup"><span data-stu-id="975b2-187">If your code depends on traversing a collection in a particular order, a `For Each`...`Next` loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes.</span></span> <span data-ttu-id="975b2-188">Çapraz geçiş sırası Visual Basic, ancak <xref:System.Collections.IEnumerator.MoveNext%2A> Numaralandırıcı nesnesinin yöntemine göre belirlenir.</span><span class="sxs-lookup"><span data-stu-id="975b2-188">The order of traversal isn't determined by Visual Basic, but by the <xref:System.Collections.IEnumerator.MoveNext%2A> method of the enumerator object.</span></span> <span data-ttu-id="975b2-189">Bu nedenle, koleksiyonda hangi öğenin döndürüleceğini `element` veya belirli bir öğeden sonra döndürülecek bir sonraki olduğunu tahmin edemeyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-189">Therefore, you might not be able to predict which element of the collection is the first to be returned in `element`, or which is the next to be returned after a given element.</span></span> <span data-ttu-id="975b2-190">`For`... `Next` Veya `Do` .. `Loop` . gibi farklı bir döngü yapısı kullanarak daha güvenilir sonuçlar elde edebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-190">You might achieve more reliable results using a different loop structure, such as `For`...`Next` or `Do`...`Loop`.</span></span>

<span data-ttu-id="975b2-191">Çalışma zamanının içindeki öğeleri ' a dönüştürebilmelidir `group` `element` .</span><span class="sxs-lookup"><span data-stu-id="975b2-191">The runtime must be able to convert the elements in `group` to `element`.</span></span> <span data-ttu-id="975b2-192">[ `Option Strict` ] İfadesinde, hem genişletme hem de daraltma dönüştürmelerine izin verilip verilmeyeceğini ( `Option Strict` kapalı, varsayılan değeri) veya yalnızca genişletme dönüştürmelerine izin verilip verilmeyeceğini ( `Option Strict` açık olduğunu) denetler.</span><span class="sxs-lookup"><span data-stu-id="975b2-192">The [`Option Strict`] statement controls whether both widening and narrowing conversions are allowed (`Option Strict` is off, its default value), or whether only widening conversions are allowed (`Option Strict` is on).</span></span> <span data-ttu-id="975b2-193">Daha fazla bilgi için bkz. [daraltma dönüştürmeleri](#narrowing-conversions).</span><span class="sxs-lookup"><span data-stu-id="975b2-193">For more information, see [Narrowing conversions](#narrowing-conversions).</span></span>

<span data-ttu-id="975b2-194">Veri türü, `group` bir koleksiyona veya Numaralandırılabilir bir diziye başvuran bir başvuru türü olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="975b2-194">The data type of `group` must be a reference type that refers to a collection or an array that's enumerable.</span></span> <span data-ttu-id="975b2-195">En yaygın olarak bu `group` <xref:System.Collections.IEnumerable> , `System.Collections` ad alanının arabirimini veya <xref:System.Collections.Generic.IEnumerable%601> `System.Collections.Generic` ad alanının arabirimini uygulayan bir nesneye başvurur.</span><span class="sxs-lookup"><span data-stu-id="975b2-195">Most commonly this means that `group` refers to an object that implements the <xref:System.Collections.IEnumerable> interface of the `System.Collections` namespace or the <xref:System.Collections.Generic.IEnumerable%601> interface of the `System.Collections.Generic` namespace.</span></span> <span data-ttu-id="975b2-196">`System.Collections.IEnumerable`<xref:System.Collections.IEnumerable.GetEnumerator%2A>koleksiyon için bir Numaralandırıcı nesnesi döndüren yöntemini tanımlar.</span><span class="sxs-lookup"><span data-stu-id="975b2-196">`System.Collections.IEnumerable` defines the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method, which returns an enumerator object for the collection.</span></span> <span data-ttu-id="975b2-197">Numaralandırıcı nesnesi `System.Collections.IEnumerator` `System.Collections` ad alanı arabirimini uygular ve <xref:System.Collections.IEnumerator.Current%2A> özelliğini ve <xref:System.Collections.IEnumerator.Reset%2A> ve <xref:System.Collections.IEnumerator.MoveNext%2A> yöntemlerini gösterir.</span><span class="sxs-lookup"><span data-stu-id="975b2-197">The enumerator object implements the `System.Collections.IEnumerator` interface of the `System.Collections` namespace and exposes the <xref:System.Collections.IEnumerator.Current%2A> property and the <xref:System.Collections.IEnumerator.Reset%2A> and <xref:System.Collections.IEnumerator.MoveNext%2A> methods.</span></span> <span data-ttu-id="975b2-198">Visual Basic, koleksiyonu çapraz geçirmek için bunları kullanır.</span><span class="sxs-lookup"><span data-stu-id="975b2-198">Visual Basic uses these to traverse the collection.</span></span>

### <a name="narrowing-conversions"></a><span data-ttu-id="975b2-199">Daraltma dönüştürmeleri</span><span class="sxs-lookup"><span data-stu-id="975b2-199">Narrowing Conversions</span></span>

<span data-ttu-id="975b2-200">Ne zaman `Option Strict` ayarlandığında `On` , daraltma dönüştürmeleri normalde derleyici hatalarına neden olur.</span><span class="sxs-lookup"><span data-stu-id="975b2-200">When `Option Strict` is set to `On`, narrowing conversions ordinarily cause compiler errors.</span></span> <span data-ttu-id="975b2-201">Ancak, ' `For Each` deki öğelerinden dönüşümler, `group` çalışma zamanında `element` değerlendirilir ve gerçekleştirilir ve daraltma dönüştürmelerinden kaynaklanan derleyici hataları bastırılır.</span><span class="sxs-lookup"><span data-stu-id="975b2-201">In a `For Each` statement, however, conversions from the elements in `group` to `element` are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.</span></span>

<span data-ttu-id="975b2-202">Aşağıdaki örnekte, ' `m` `n` `Option Strict` a ' a dönüştürme bir `Long` daraltma dönüştürmesi olduğundan, için başlangıç değeri olarak atama, tarihinde derleme yapmaz `Integer` .</span><span class="sxs-lookup"><span data-stu-id="975b2-202">In the following example, the assignment of `m` as the initial value for `n` doesn't compile when `Option Strict` is on because the conversion of a `Long` to an `Integer` is a narrowing conversion.</span></span> <span data-ttu-id="975b2-203">Ancak,, öğesine atama, ' den ' e `For Each` `number` aynı dönüştürmeyi gerektirse de, hiçbir derleyici hatası raporlanır `Long` `Integer` .</span><span class="sxs-lookup"><span data-stu-id="975b2-203">In the `For Each` statement, however, no compiler error is reported, even though the assignment to `number` requires the same conversion from `Long` to `Integer`.</span></span> <span data-ttu-id="975b2-204">`For Each`Büyük bir sayı içeren ifadede, büyük sayıya uygulandığında bir çalışma zamanı hatası oluşur <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> .</span><span class="sxs-lookup"><span data-stu-id="975b2-204">In the `For Each` statement that contains a large number, a run-time error occurs when <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> is applied to the large number.</span></span>

[!code-vb[VbVbalrStatements#89](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class3.vb#89)]

### <a name="ienumerator-calls"></a><span data-ttu-id="975b2-205">IEnumerator çağrıları</span><span class="sxs-lookup"><span data-stu-id="975b2-205">IEnumerator Calls</span></span>

<span data-ttu-id="975b2-206">Bir `For Each` ... `Next` döngüsünün yürütülmesi başladığında, `group` geçerli bir koleksiyon nesnesine başvuran Visual Basic doğrular.</span><span class="sxs-lookup"><span data-stu-id="975b2-206">When execution of a `For Each`...`Next` loop starts, Visual Basic verifies that `group` refers to a valid collection object.</span></span> <span data-ttu-id="975b2-207">Aksi takdirde, bir özel durum oluşturur.</span><span class="sxs-lookup"><span data-stu-id="975b2-207">If not, it throws an exception.</span></span> <span data-ttu-id="975b2-208">Aksi takdirde, <xref:System.Collections.IEnumerator.MoveNext%2A> <xref:System.Collections.IEnumerator.Current%2A> ilk öğeyi döndürmek için yöntemini ve Numaralandırıcı nesnesinin özelliğini çağırır.</span><span class="sxs-lookup"><span data-stu-id="975b2-208">Otherwise, it calls the <xref:System.Collections.IEnumerator.MoveNext%2A> method and the <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object to return the first element.</span></span> <span data-ttu-id="975b2-209">Eğer `MoveNext` bir sonraki öğe olmadığını gösteriyorsa, diğer bir deyişle, koleksiyon boşsa, `For Each` döngü duraklar ve denetimi deyimden sonraki ifadeye geçirir `Next` .</span><span class="sxs-lookup"><span data-stu-id="975b2-209">If `MoveNext` indicates that there is no next element, that is, if the collection is empty, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span> <span data-ttu-id="975b2-210">Aksi takdirde, Visual Basic `element` ilk öğesine ayarlar ve ekstre bloğunu çalıştırır.</span><span class="sxs-lookup"><span data-stu-id="975b2-210">Otherwise, Visual Basic sets `element` to the first element and runs the statement block.</span></span>

<span data-ttu-id="975b2-211">Her Visual Basic `Next` deyimle karşılaştığında, ifadeye geri döner `For Each` .</span><span class="sxs-lookup"><span data-stu-id="975b2-211">Each time Visual Basic encounters the `Next` statement, it returns to the `For Each` statement.</span></span> <span data-ttu-id="975b2-212">Yeniden çağırır `MoveNext` ve bir `Current` sonraki öğesini döndürür ve sonra da bloğu çalıştırır veya sonuca bağlı olarak döngüyü sonlandırır.</span><span class="sxs-lookup"><span data-stu-id="975b2-212">Again it calls `MoveNext` and `Current` to return the next element, and again it either runs the block or stops the loop depending on the result.</span></span> <span data-ttu-id="975b2-213">Bu işlem `MoveNext` , bir sonraki öğe veya bir deyimin karşılaştığı anlamına gelene kadar devam eder `Exit For` .</span><span class="sxs-lookup"><span data-stu-id="975b2-213">This process continues until `MoveNext` indicates that there is no next element or an `Exit For` statement is encountered.</span></span>

<span data-ttu-id="975b2-214">**Koleksiyonu değiştirme.**</span><span class="sxs-lookup"><span data-stu-id="975b2-214">**Modifying the Collection.**</span></span> <span data-ttu-id="975b2-215">Normal olarak döndürülen Numaralandırıcı nesnesi <xref:System.Collections.IEnumerable.GetEnumerator%2A> herhangi bir öğeyi ekleyerek, silerek, değiştirerek veya yeniden sıralayarak koleksiyonu değiştirmenize izin vermez.</span><span class="sxs-lookup"><span data-stu-id="975b2-215">The enumerator object returned by <xref:System.Collections.IEnumerable.GetEnumerator%2A> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements.</span></span> <span data-ttu-id="975b2-216">`For Each`... Döngüsünü başlattıktan sonra koleksiyonu değiştirirseniz `Next` , Numaralandırıcı nesnesi geçersiz hale gelir ve bir sonraki erişim denemesi <xref:System.InvalidOperationException> özel duruma neden olur.</span><span class="sxs-lookup"><span data-stu-id="975b2-216">If you change the collection after you have initiated a `For Each`...`Next` loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <xref:System.InvalidOperationException> exception.</span></span>

<span data-ttu-id="975b2-217">Ancak, bu değişikliğin engellenmesi Visual Basic tarafından belirlenir, ancak bunun yerine <xref:System.Collections.IEnumerable> arabirimin uygulanması.</span><span class="sxs-lookup"><span data-stu-id="975b2-217">However, this blocking of modification isn't determined by Visual Basic, but rather by the implementation of the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="975b2-218">`IEnumerable`Yineleme sırasında değişikliklere izin veren bir şekilde uygulanması mümkündür.</span><span class="sxs-lookup"><span data-stu-id="975b2-218">It is possible to implement `IEnumerable` in a way that allows for modification during iteration.</span></span> <span data-ttu-id="975b2-219">Bu tür dinamik değişikliği yapmayı düşünüyorsanız, kullanmakta olduğunuz koleksiyonda uygulamanın özelliklerini anladığınızdan emin olun `IEnumerable` .</span><span class="sxs-lookup"><span data-stu-id="975b2-219">If you are considering doing such dynamic modification, make sure that you understand the characteristics of the `IEnumerable` implementation on the collection you are using.</span></span>

<span data-ttu-id="975b2-220">**Koleksiyon öğelerini değiştirme.**</span><span class="sxs-lookup"><span data-stu-id="975b2-220">**Modifying Collection Elements.**</span></span> <span data-ttu-id="975b2-221"><xref:System.Collections.IEnumerator.Current%2A>Numaralandırıcı nesnesinin özelliği [salt okunur](../modifiers/readonly.md)ve her koleksiyon öğesinin yerel bir kopyasını döndürür.</span><span class="sxs-lookup"><span data-stu-id="975b2-221">The <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object is [ReadOnly](../modifiers/readonly.md), and it returns a local copy of each collection element.</span></span> <span data-ttu-id="975b2-222">Bu, öğeleri bir `For Each` ... döngüsünde değiştiremeyeceğiniz anlamına gelir `Next` .</span><span class="sxs-lookup"><span data-stu-id="975b2-222">This means that you cannot modify the elements themselves in a `For Each`...`Next` loop.</span></span> <span data-ttu-id="975b2-223">Yaptığınız herhangi bir değişiklik yalnızca yerel kopyayı etkiler `Current` ve temel koleksiyona geri yansıtılmaz.</span><span class="sxs-lookup"><span data-stu-id="975b2-223">Any modification you make affects only the local copy from `Current` and isn't reflected back into the underlying collection.</span></span> <span data-ttu-id="975b2-224">Ancak, bir öğe bir başvuru türü ise, gösterdiği örnek üyelerini değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-224">However, if an element is a reference type, you can modify the members of the instance to which it points.</span></span> <span data-ttu-id="975b2-225">Aşağıdaki örnek `BackColor` her bir öğenin üyesini değiştirir `thisControl` .</span><span class="sxs-lookup"><span data-stu-id="975b2-225">The following example modifies the `BackColor` member of each `thisControl` element.</span></span> <span data-ttu-id="975b2-226">Ancak, `thisControl` kendisini değiştiremezsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-226">You cannot, however, modify `thisControl` itself.</span></span>

```vb
Sub LightBlueBackground(thisForm As System.Windows.Forms.Form)
    For Each thisControl In thisForm.Controls
        thisControl.BackColor = System.Drawing.Color.LightBlue
    Next thisControl
End Sub
```

<span data-ttu-id="975b2-227">Önceki örnek, `BackColor` `thisControl` kendisini değiştiremese de, her öğenin üyesini değiştirebilir `thisControl` .</span><span class="sxs-lookup"><span data-stu-id="975b2-227">The previous example can modify the `BackColor` member of each `thisControl` element, although it cannot modify `thisControl` itself.</span></span>

<span data-ttu-id="975b2-228">**Dizileri geçme.**</span><span class="sxs-lookup"><span data-stu-id="975b2-228">**Traversing Arrays.**</span></span> <span data-ttu-id="975b2-229"><xref:System.Array>Sınıfı <xref:System.Collections.IEnumerable> arabirimini uyguladığından, tüm diziler yöntemini kullanıma sunar <xref:System.Array.GetEnumerator%2A> .</span><span class="sxs-lookup"><span data-stu-id="975b2-229">Because the <xref:System.Array> class implements the <xref:System.Collections.IEnumerable> interface, all arrays expose the <xref:System.Array.GetEnumerator%2A> method.</span></span> <span data-ttu-id="975b2-230">Bu,... döngüsü ile bir dizi içinde yineleyebilir `For Each` `Next` .</span><span class="sxs-lookup"><span data-stu-id="975b2-230">This means that you can iterate through an array with a `For Each`...`Next` loop.</span></span> <span data-ttu-id="975b2-231">Ancak, yalnızca dizi öğelerini okuyabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-231">However, you can only read the array elements.</span></span> <span data-ttu-id="975b2-232">Bunları değiştiremezsiniz.</span><span class="sxs-lookup"><span data-stu-id="975b2-232">You cannot change them.</span></span>

## <a name="example"></a><span data-ttu-id="975b2-233">Örnek</span><span class="sxs-lookup"><span data-stu-id="975b2-233">Example</span></span>

<span data-ttu-id="975b2-234">Aşağıdaki örnek, C:\ içindeki tüm klasörleri listeler. sınıfını kullanarak Dizin <xref:System.IO.DirectoryInfo> .</span><span class="sxs-lookup"><span data-stu-id="975b2-234">The following example lists all the folders in the C:\ directory by using the <xref:System.IO.DirectoryInfo> class.</span></span>

[!code-vb[VbVbalrStatements#124](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#124)]

## <a name="example"></a><span data-ttu-id="975b2-235">Örnek</span><span class="sxs-lookup"><span data-stu-id="975b2-235">Example</span></span>

<span data-ttu-id="975b2-236">Aşağıdaki örnek bir koleksiyonu sıralamak için bir yordam gösterir.</span><span class="sxs-lookup"><span data-stu-id="975b2-236">The following example illustrates a procedure for sorting a collection.</span></span> <span data-ttu-id="975b2-237">Örnek, `Car` içinde depolanan bir sınıfın örneklerini sıralar <xref:System.Collections.Generic.List%601> .</span><span class="sxs-lookup"><span data-stu-id="975b2-237">The example sorts instances of a `Car` class that are stored in a <xref:System.Collections.Generic.List%601>.</span></span> <span data-ttu-id="975b2-238">`Car`Sınıfı, <xref:System.IComparable%601> yönteminin uygulanması için arabirimini uygular <xref:System.IComparable%601.CompareTo%2A> .</span><span class="sxs-lookup"><span data-stu-id="975b2-238">The `Car` class implements the <xref:System.IComparable%601> interface, which requires that the <xref:System.IComparable%601.CompareTo%2A> method be implemented.</span></span>

<span data-ttu-id="975b2-239">Yöntemine yapılan her çağrı, <xref:System.IComparable%601.CompareTo%2A> sıralama için kullanılan tek bir karşılaştırma yapar.</span><span class="sxs-lookup"><span data-stu-id="975b2-239">Each call to the <xref:System.IComparable%601.CompareTo%2A> method makes a single comparison that's used for sorting.</span></span> <span data-ttu-id="975b2-240">Yöntemdeki Kullanıcı tarafından yazılan kod, `CompareTo` geçerli nesnenin her bir karşılaştırması için başka bir nesneyle ilgili bir değer döndürür.</span><span class="sxs-lookup"><span data-stu-id="975b2-240">User-written code in the `CompareTo` method returns a value for each comparison of the current object with another object.</span></span> <span data-ttu-id="975b2-241">Geçerli nesne diğer nesneden daha küçükse döndürülen değer sıfırdan küçük, geçerli nesne diğer nesneden büyükse sıfırdan büyük ve eşitse sıfır.</span><span class="sxs-lookup"><span data-stu-id="975b2-241">The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal.</span></span> <span data-ttu-id="975b2-242">Bu, büyük, küçüktür ve eşittir ölçütlerine göre kod içinde tanımlamanızı sağlar.</span><span class="sxs-lookup"><span data-stu-id="975b2-242">This enables you to define in code the criteria for greater than, less than, and equal.</span></span>

<span data-ttu-id="975b2-243">Yönteminde, `ListCars` `cars.Sort()` ifade listeyi sıralar.</span><span class="sxs-lookup"><span data-stu-id="975b2-243">In the `ListCars` method, the `cars.Sort()` statement sorts the list.</span></span> <span data-ttu-id="975b2-244">Öğesinin yöntemine yapılan bu çağrı, <xref:System.Collections.Generic.List%601.Sort%2A> <xref:System.Collections.Generic.List%601> `CompareTo` yönteminin içindeki nesneler için otomatik olarak çağrılmasına neden olur `Car` `List` .</span><span class="sxs-lookup"><span data-stu-id="975b2-244">This call to the <xref:System.Collections.Generic.List%601.Sort%2A> method of the <xref:System.Collections.Generic.List%601> causes the `CompareTo` method to be called automatically for the `Car` objects in the `List`.</span></span>

[!code-vb[VbVbalrStatements#125](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#125)]

## <a name="see-also"></a><span data-ttu-id="975b2-245">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="975b2-245">See also</span></span>

- [<span data-ttu-id="975b2-246">Koleksiyonlar</span><span class="sxs-lookup"><span data-stu-id="975b2-246">Collections</span></span>](../../../standard/collections/index.md)
- [<span data-ttu-id="975b2-247">For...Next Deyimi</span><span class="sxs-lookup"><span data-stu-id="975b2-247">For...Next Statement</span></span>](for-next-statement.md)
- [<span data-ttu-id="975b2-248">Döngü Yapıları</span><span class="sxs-lookup"><span data-stu-id="975b2-248">Loop Structures</span></span>](../../programming-guide/language-features/control-flow/loop-structures.md)
- [<span data-ttu-id="975b2-249">While...End While Deyimi</span><span class="sxs-lookup"><span data-stu-id="975b2-249">While...End While Statement</span></span>](while-end-while-statement.md)
- [<span data-ttu-id="975b2-250">Do...Loop Deyimi</span><span class="sxs-lookup"><span data-stu-id="975b2-250">Do...Loop Statement</span></span>](do-loop-statement.md)
- [<span data-ttu-id="975b2-251">Genişletme ve Daraltma Dönüşümleri</span><span class="sxs-lookup"><span data-stu-id="975b2-251">Widening and Narrowing Conversions</span></span>](../../programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)
- [<span data-ttu-id="975b2-252">Nesne Başlatıcıları: Adlandırılmış ve Anonim Türler</span><span class="sxs-lookup"><span data-stu-id="975b2-252">Object Initializers: Named and Anonymous Types</span></span>](../../programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="975b2-253">Koleksiyon Başlatıcıları</span><span class="sxs-lookup"><span data-stu-id="975b2-253">Collection Initializers</span></span>](../../programming-guide/language-features/collection-initializers/index.md)
- [<span data-ttu-id="975b2-254">Diziler</span><span class="sxs-lookup"><span data-stu-id="975b2-254">Arrays</span></span>](../../programming-guide/language-features/arrays/index.md)
