---
title: WF 'de zaman uyumsuz etkinlikler oluşturma
description: AsyncCodeActivity kullanarak özel zaman uyumsuz etkinlikler oluşturmayı öğrenin ve bu da türetilmiş etkinliklerin zaman uyumsuz yürütme mantığını uygulamasına olanak sağlar.
ms.date: 03/30/2017
ms.assetid: 497e81ed-5eef-460c-ba55-fae73c05824f
ms.openlocfilehash: f7ce0c0157791b34723feff185aed24bb56a4b3f
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 05/15/2020
ms.locfileid: "83421533"
---
# <a name="creating-asynchronous-activities-in-wf"></a><span data-ttu-id="e3293-103">WF 'de zaman uyumsuz etkinlikler oluşturma</span><span class="sxs-lookup"><span data-stu-id="e3293-103">Creating Asynchronous Activities in WF</span></span>
<span data-ttu-id="e3293-104"><xref:System.Activities.AsyncCodeActivity>, türetilmiş etkinliklerin zaman uyumsuz yürütme mantığını uygulamasına olanak sağlayan bir temel sınıf olan etkinlik yazarlarına sahiptir.</span><span class="sxs-lookup"><span data-stu-id="e3293-104"><xref:System.Activities.AsyncCodeActivity> provides activity authors a base class to use that enables derived activities to implement asynchronous execution logic.</span></span> <span data-ttu-id="e3293-105">Bu, iş akışı Zamanlayıcı iş parçacığını tutmadan zaman uyumsuz çalışma gerçekleştirmesi gereken özel etkinlikler için yararlıdır ve paralel olarak çalıştırılabilecek etkinlikleri engeller.</span><span class="sxs-lookup"><span data-stu-id="e3293-105">This is useful for custom activities that must perform asynchronous work without holding the workflow scheduler thread and blocking any activities that may be able to run in parallel.</span></span> <span data-ttu-id="e3293-106">Bu konu, kullanarak özel zaman uyumsuz etkinliklerin nasıl oluşturulacağı hakkında genel bakış sağlar <xref:System.Activities.AsyncCodeActivity> .</span><span class="sxs-lookup"><span data-stu-id="e3293-106">This topic provides an overview of how to create custom asynchronous activities using <xref:System.Activities.AsyncCodeActivity>.</span></span>  
  
## <a name="using-asynccodeactivity"></a><span data-ttu-id="e3293-107">AsyncCodeActivity kullanma</span><span class="sxs-lookup"><span data-stu-id="e3293-107">Using AsyncCodeActivity</span></span>  
 <span data-ttu-id="e3293-108"><xref:System.Activities?displayProperty=nameWithType>farklı etkinlik yazma gereksinimleri için farklı temel sınıflara sahip özel etkinlik yazarları sağlar.</span><span class="sxs-lookup"><span data-stu-id="e3293-108"><xref:System.Activities?displayProperty=nameWithType> provides custom activity authors with different base classes for different activity authoring requirements.</span></span> <span data-ttu-id="e3293-109">Her biri belirli bir anlam taşır ve ilgili sözleşmeye bir iş akışı yazarı (ve etkinlik çalışma zamanı) sağlar.</span><span class="sxs-lookup"><span data-stu-id="e3293-109">Each one carries a particular semantic and provides a workflow author (and the activity runtime) a corresponding contract.</span></span> <span data-ttu-id="e3293-110"><xref:System.Activities.AsyncCodeActivity>Tabanlı etkinlik, zamanlayıcı iş parçacığına göre zaman uyumsuz olarak iş yapan ve yürütme mantığı yönetilen kodda ifade edilen bir etkinliktir.</span><span class="sxs-lookup"><span data-stu-id="e3293-110">An <xref:System.Activities.AsyncCodeActivity> based activity is an activity that performs work asynchronously relative to the scheduler thread and whose execution logic is expressed in managed code.</span></span> <span data-ttu-id="e3293-111">Zaman uyumsuz olarak geçecek bir sonuç olarak, <xref:System.Activities.AsyncCodeActivity> yürütme sırasında boşta bir nokta alabilir.</span><span class="sxs-lookup"><span data-stu-id="e3293-111">As a result of going asynchronous, an <xref:System.Activities.AsyncCodeActivity> may induce an idle point during execution.</span></span> <span data-ttu-id="e3293-112">Zaman uyumsuz çalışmanın geçici doğası nedeniyle, <xref:System.Activities.AsyncCodeActivity> Etkinlik yürütme süresi boyunca her zaman kalıcı olmayan bir blok oluşturur.</span><span class="sxs-lookup"><span data-stu-id="e3293-112">Due to the volatile nature of asynchronous work, an <xref:System.Activities.AsyncCodeActivity> always creates a no persist block for the duration of the activity’s execution.</span></span> <span data-ttu-id="e3293-113">Bu, iş akışı çalışma zamanının zaman uyumsuz çalışmanın ortasındaki iş akışı örneğini kalıcı hale getirme ve ayrıca zaman uyumsuz kod yürütülürken iş akışı örneğinin kaldırılmasını önler.</span><span class="sxs-lookup"><span data-stu-id="e3293-113">This prevents the workflow runtime from persisting the workflow instance in the middle of the asynchronous work, and also prevents the workflow instance from unloading while the asynchronous code is executing.</span></span>  
  
### <a name="asynccodeactivity-methods"></a><span data-ttu-id="e3293-114">AsyncCodeActivity yöntemleri</span><span class="sxs-lookup"><span data-stu-id="e3293-114">AsyncCodeActivity Methods</span></span>  
 <span data-ttu-id="e3293-115">Öğesinden türetilen etkinlikler <xref:System.Activities.AsyncCodeActivity> , <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> ve yöntemlerini özel kodla geçersiz kılarak zaman uyumsuz yürütme mantığı oluşturabilir <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> .</span><span class="sxs-lookup"><span data-stu-id="e3293-115">Activities that derive from <xref:System.Activities.AsyncCodeActivity> can create asynchronous execution logic by overriding the <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> methods with custom code.</span></span> <span data-ttu-id="e3293-116">Çalışma zamanı tarafından çağrıldığında, bu yöntemler geçirilir <xref:System.Activities.AsyncCodeActivityContext> .</span><span class="sxs-lookup"><span data-stu-id="e3293-116">When called by the runtime, these methods are passed an <xref:System.Activities.AsyncCodeActivityContext>.</span></span> <span data-ttu-id="e3293-117"><xref:System.Activities.AsyncCodeActivityContext>Etkinlik yazarının <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> /  <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> bağlam özelliğinde paylaşılan durum sağlamasına izin verir <xref:System.Activities.AsyncCodeActivityContext.UserState%2A> .</span><span class="sxs-lookup"><span data-stu-id="e3293-117"><xref:System.Activities.AsyncCodeActivityContext> allows the activity author to provide shared state across <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A>/ <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> in the context’s <xref:System.Activities.AsyncCodeActivityContext.UserState%2A> property.</span></span> <span data-ttu-id="e3293-118">Aşağıdaki örnekte, bir `GenerateRandom` etkinlik zaman uyumsuz olarak rastgele bir sayı üretir.</span><span class="sxs-lookup"><span data-stu-id="e3293-118">In the following example, a `GenerateRandom` activity generates a random number asynchronously.</span></span>  
  
 [!code-csharp[CFX_ActivityExample#8](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#8)]  
  
 <span data-ttu-id="e3293-119">Önceki örnek etkinlik öğesinden türetilir <xref:System.Activities.AsyncCodeActivity%601> ve yükseltilmiş bir `OutArgument<int>` ada sahiptir `Result` .</span><span class="sxs-lookup"><span data-stu-id="e3293-119">The previous example activity derives from <xref:System.Activities.AsyncCodeActivity%601>, and has an elevated `OutArgument<int>` named `Result`.</span></span> <span data-ttu-id="e3293-120">Yöntemi tarafından döndürülen değer `GetRandom` ayıklanır ve <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> geçersiz kılma tarafından döndürülür ve bu değer değer olarak ayarlanır `Result` .</span><span class="sxs-lookup"><span data-stu-id="e3293-120">The value returned by the `GetRandom` method is extracted and returned by the <xref:System.Activities.AsyncCodeActivity%601.EndExecute%2A> override, and this value is set as the `Result` value.</span></span> <span data-ttu-id="e3293-121">Sonuç döndürmeyen zaman uyumsuz etkinlikler öğesinden türetilmelidir <xref:System.Activities.AsyncCodeActivity> .</span><span class="sxs-lookup"><span data-stu-id="e3293-121">Asynchronous activities that do not return a result should derive from <xref:System.Activities.AsyncCodeActivity>.</span></span> <span data-ttu-id="e3293-122">Aşağıdaki örnekte, `DisplayRandom` öğesinden türetilen bir etkinlik tanımlanmıştır <xref:System.Activities.AsyncCodeActivity> .</span><span class="sxs-lookup"><span data-stu-id="e3293-122">In the following example, a `DisplayRandom` activity is defined which derives from <xref:System.Activities.AsyncCodeActivity>.</span></span> <span data-ttu-id="e3293-123">Bu etkinlik etkinlik gibidir, `GetRandom` ancak bir sonuç döndürmek yerine konsola bir ileti görüntülenir.</span><span class="sxs-lookup"><span data-stu-id="e3293-123">This activity is like the `GetRandom` activity but instead of returning a result it displays a message to the console.</span></span>  
  
 [!code-csharp[CFX_ActivityExample#11](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#11)]  
  
 <span data-ttu-id="e3293-124">Dönüş değeri olmadığından, `DisplayRandom` <xref:System.Action> temsilcisini çağırmak için bir yerine bir kullanın, <xref:System.Func%602> ve temsilci hiçbir değer döndürmez.</span><span class="sxs-lookup"><span data-stu-id="e3293-124">Note that because there is no return value, `DisplayRandom` uses an <xref:System.Action> instead of a <xref:System.Func%602> to invoke its delegate, and the delegate returns no value.</span></span>  
  
 <span data-ttu-id="e3293-125"><xref:System.Activities.AsyncCodeActivity>Ayrıca bir <xref:System.Activities.AsyncCodeActivity.Cancel%2A> geçersiz kılma sağlar.</span><span class="sxs-lookup"><span data-stu-id="e3293-125"><xref:System.Activities.AsyncCodeActivity> also provides a <xref:System.Activities.AsyncCodeActivity.Cancel%2A> override.</span></span> <span data-ttu-id="e3293-126">Ancak <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> gerekli geçersiz kılmalar, <xref:System.Activities.AsyncCodeActivity.Cancel%2A> isteğe bağlıdır ve geçersiz kılınabilir, böylece etkinlik iptal edildiğinde veya iptal edildiğinde etkinliğin bekleyen zaman uyumsuz durumunu temizleyebilir.</span><span class="sxs-lookup"><span data-stu-id="e3293-126">While <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> are required overrides, <xref:System.Activities.AsyncCodeActivity.Cancel%2A> is optional, and can be overridden so the activity can clean up its outstanding asynchronous state when it is being canceled or aborted.</span></span> <span data-ttu-id="e3293-127">Temizleme olasılığı varsa ve ise, `AsyncCodeActivity.ExecutingActivityInstance.IsCancellationRequested` `true` etkinlik çağırmalıdır <xref:System.Activities.AsyncCodeActivityContext.MarkCanceled%2A> .</span><span class="sxs-lookup"><span data-stu-id="e3293-127">If clean up is possible and `AsyncCodeActivity.ExecutingActivityInstance.IsCancellationRequested` is `true`, the activity should call <xref:System.Activities.AsyncCodeActivityContext.MarkCanceled%2A>.</span></span> <span data-ttu-id="e3293-128">Bu yöntemden oluşturulan özel durumlar, iş akışı örneği için önemli değildir.</span><span class="sxs-lookup"><span data-stu-id="e3293-128">Any exceptions thrown from this method are fatal to the workflow instance.</span></span>  
  
 [!code-csharp[CFX_ActivityExample#10](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#10)]  
  
### <a name="invoking-asynchronous-methods-on-a-class"></a><span data-ttu-id="e3293-129">Bir sınıfta zaman uyumsuz yöntemleri çağırma</span><span class="sxs-lookup"><span data-stu-id="e3293-129">Invoking Asynchronous Methods on a Class</span></span>  
 <span data-ttu-id="e3293-130">.NET Framework sınıfların birçoğu zaman uyumsuz işlevsellik sağlar ve bu işlevsellik, bir tabanlı etkinlik kullanılarak zaman uyumsuz olarak çağrılabilir <xref:System.Activities.AsyncCodeActivity> .</span><span class="sxs-lookup"><span data-stu-id="e3293-130">Many of the classes in the .NET Framework provide asynchronous functionality, and this functionality can be asynchronously invoked by using an <xref:System.Activities.AsyncCodeActivity> based activity.</span></span> <span data-ttu-id="e3293-131">Aşağıdaki örnekte, sınıfını kullanarak zaman uyumsuz olarak bir dosya oluşturan bir etkinlik oluşturulur <xref:System.IO.FileStream> .</span><span class="sxs-lookup"><span data-stu-id="e3293-131">In the following example, an activity is created that asynchronously creates a file by using the <xref:System.IO.FileStream> class.</span></span>  
  
 [!code-csharp[CFX_ActivityExample#12](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#12)]  
  
### <a name="sharing-state-between-the-beginexecute-and-endexecute-methods"></a><span data-ttu-id="e3293-132">BeginExecute ve Endexyürüme yöntemleri arasında durum paylaşma</span><span class="sxs-lookup"><span data-stu-id="e3293-132">Sharing State Between the BeginExecute and EndExecute Methods</span></span>  
 <span data-ttu-id="e3293-133">Önceki örnekte, <xref:System.IO.FileStream> içinde oluşturulan nesnesine ' <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> de erişildi <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> .</span><span class="sxs-lookup"><span data-stu-id="e3293-133">In the previous example, the <xref:System.IO.FileStream> object that was created in <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> was accessed in the <xref:System.Activities.AsyncCodeActivity.EndExecute%2A>.</span></span> <span data-ttu-id="e3293-134">Bu, `file` değişkeni <xref:System.Activities.AsyncCodeActivityContext.UserState%2A?displayProperty=nameWithType> içindeki özelliğinde geçirildiğinden mümkündür <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> .</span><span class="sxs-lookup"><span data-stu-id="e3293-134">This is possible because the `file` variable was passed in the <xref:System.Activities.AsyncCodeActivityContext.UserState%2A?displayProperty=nameWithType> property in <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A>.</span></span> <span data-ttu-id="e3293-135">Bu, ve arasında durum paylaşmak için doğru yöntemdir <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> .</span><span class="sxs-lookup"><span data-stu-id="e3293-135">This is the correct method for sharing state between <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity.EndExecute%2A>.</span></span> <span data-ttu-id="e3293-136">`FileWriter` <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> Etkinlik nesnesine birden çok etkinlik örneği tarafından başvurulduğundan, türetilmiş sınıfta (Bu durumda) bir üye değişkeni kullanmak hatalıdır.</span><span class="sxs-lookup"><span data-stu-id="e3293-136">It is incorrect to use a member variable in the derived class (`FileWriter` in this case) to share state between <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> and <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> because the activity object may be referenced by multiple activity instances.</span></span> <span data-ttu-id="e3293-137">Durumu paylaşmak için bir üye değişkeni kullanılmaya çalışılması, bir <xref:System.Activities.ActivityInstance> veya başka bir değerden bir veya daha fazla değerin kullanılmasına neden olabilir <xref:System.Activities.ActivityInstance> .</span><span class="sxs-lookup"><span data-stu-id="e3293-137">Attempting to use a member variable to share state can result in values from one <xref:System.Activities.ActivityInstance> overwriting or consuming values from another <xref:System.Activities.ActivityInstance>.</span></span>  
  
### <a name="accessing-argument-values"></a><span data-ttu-id="e3293-138">Bağımsız değişken değerlerine erişme</span><span class="sxs-lookup"><span data-stu-id="e3293-138">Accessing Argument Values</span></span>  
 <span data-ttu-id="e3293-139">Öğesinin ortamı, <xref:System.Activities.AsyncCodeActivity> etkinlikte tanımlanan bağımsız değişkenlerden oluşur.</span><span class="sxs-lookup"><span data-stu-id="e3293-139">The environment of an <xref:System.Activities.AsyncCodeActivity> consists of the arguments defined on the activity.</span></span> <span data-ttu-id="e3293-140">Bu bağımsız değişkenlere <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A> / <xref:System.Activities.AsyncCodeActivity.EndExecute%2A> parametresi kullanılarak geçersiz kılmalardan erişilebilir <xref:System.Activities.AsyncCodeActivityContext> .</span><span class="sxs-lookup"><span data-stu-id="e3293-140">These arguments can be accessed from the <xref:System.Activities.AsyncCodeActivity.BeginExecute%2A>/<xref:System.Activities.AsyncCodeActivity.EndExecute%2A> overrides using the <xref:System.Activities.AsyncCodeActivityContext> parameter.</span></span> <span data-ttu-id="e3293-141">Bağımsız değişkenlere, temsilciden erişilemez, ancak bağımsız değişken değerleri veya istenen herhangi bir veri, parametreleri kullanılarak temsilciye geçirilebilir.</span><span class="sxs-lookup"><span data-stu-id="e3293-141">The arguments cannot be accessed in the delegate, but the argument values or any other desired data can be passed in to the delegate using its parameters.</span></span> <span data-ttu-id="e3293-142">Aşağıdaki örnekte, bağımsız değişkeninden iç sınırı alan rastgele bir sayı üreten etkinlik tanımlanmıştır `Max` .</span><span class="sxs-lookup"><span data-stu-id="e3293-142">In the following example, a random number-generating activity is defined that obtains the inclusive upper bound from its `Max` argument.</span></span> <span data-ttu-id="e3293-143">Bağımsız değişkenin değeri, temsilci çağrıldığında zaman uyumsuz koda geçirilir.</span><span class="sxs-lookup"><span data-stu-id="e3293-143">The value of the argument is passed in to the asynchronous code when the delegate is invoked.</span></span>  
  
 [!code-csharp[CFX_ActivityExample#9](~/samples/snippets/csharp/VS_Snippets_CFX/CFX_ActivityExample/cs/Program.cs#9)]  
  
### <a name="scheduling-actions-or-child-activities-using-asynccodeactivity"></a><span data-ttu-id="e3293-144">AsyncCodeActivity kullanarak eylemleri veya alt etkinlikleri zamanlama</span><span class="sxs-lookup"><span data-stu-id="e3293-144">Scheduling Actions or Child Activities Using AsyncCodeActivity</span></span>  
 <span data-ttu-id="e3293-145"><xref:System.Activities.AsyncCodeActivity>türetilmiş özel etkinlikler iş akışı iş parçacığına göre zaman uyumsuz olarak iş yapmak için bir yöntem sağlar, ancak alt etkinlikleri veya eylemleri zamanlama olanağı sağlamaz.</span><span class="sxs-lookup"><span data-stu-id="e3293-145"><xref:System.Activities.AsyncCodeActivity> derived custom activities  provide a method for performing work asynchronously with regard to the workflow thread, but do not provide the ability to schedule child activities or actions.</span></span> <span data-ttu-id="e3293-146">Ancak, zaman uyumsuz davranış bileşim aracılığıyla alt etkinliklerin planlanmasıyla birleştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="e3293-146">However, asynchronous behavior can be incorporated with scheduling of child activities through composition.</span></span> <span data-ttu-id="e3293-147">Zaman uyumsuz bir etkinlik oluşturulabilir ve daha sonra <xref:System.Activities.Activity> <xref:System.Activities.NativeActivity> alt etkinliklerin veya eylemlerin zaman uyumsuz davranışını ve zamanlamasını sağlamak için bir veya türetilmiş etkinlik ile oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="e3293-147">An asynchronous activity can be created, and then composed with an <xref:System.Activities.Activity> or <xref:System.Activities.NativeActivity> derived activity to provide asynchronous behavior and scheduling of child activities or actions.</span></span> <span data-ttu-id="e3293-148">Örneğin, ' den türetilen bir etkinlik oluşturulabilir <xref:System.Activities.Activity> ve uygulamanın, <xref:System.Activities.Statements.Sequence> zaman uyumsuz etkinliği ve etkinliğin mantığını uygulayan diğer etkinlikleri içeren bir etkinliği vardır.</span><span class="sxs-lookup"><span data-stu-id="e3293-148">For example, an activity could be created that derives from <xref:System.Activities.Activity>, and has as its implementation a <xref:System.Activities.Statements.Sequence> containing the asynchronous activity as well the other activities that implement the logic of the activity.</span></span> <span data-ttu-id="e3293-149">Ve kullanarak etkinlik oluşturmaya yönelik daha fazla örnek için <xref:System.Activities.Activity> <xref:System.Activities.NativeActivity> bkz. [nasıl yapılır: etkinlik](how-to-create-an-activity.md) ve [etkinlik yazma seçenekleri](activity-authoring-options-in-wf.md)oluşturma.</span><span class="sxs-lookup"><span data-stu-id="e3293-149">For more examples of composing activities using <xref:System.Activities.Activity> and <xref:System.Activities.NativeActivity>, see [How to: Create an Activity](how-to-create-an-activity.md) and [Activity Authoring Options](activity-authoring-options-in-wf.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e3293-150">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="e3293-150">See also</span></span>

- <xref:System.Action>
- <xref:System.Func%602>
