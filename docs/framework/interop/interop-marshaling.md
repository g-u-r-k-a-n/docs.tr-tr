---
title: Birlikte Çalışma Hazırlama
ms.date: 03/30/2017
helpviewer_keywords:
- marshaling, COM interop
- interop marshaling
- interop marshaling, about interop marshaling
ms.assetid: 115f7a2f-d422-4605-ab36-13a8dd28142a
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: fce84d6f84b26b59634e624089ba874c4bbdc877
ms.sourcegitcommit: ad800f019ac976cb669e635fb0ea49db740e6890
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 10/29/2019
ms.locfileid: "73039578"
---
# <a name="interop-marshaling"></a><span data-ttu-id="53fd0-102">Birlikte Çalışma Hazırlama</span><span class="sxs-lookup"><span data-stu-id="53fd0-102">Interop Marshaling</span></span>

<span data-ttu-id="53fd0-103">Birlikte çalışma sıralama, verilerin Yöntem bağımsız değişkenlerine nasıl geçtiğini ve çağrılar sırasında yönetilen ve yönetilmeyen bellek arasında değer döndürme şeklini yönetir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-103">Interop marshaling governs how data is passed in method arguments and return values between managed and unmanaged memory during calls.</span></span> <span data-ttu-id="53fd0-104">Birlikte çalışabilirlik sıralaması, ortak dil çalışma zamanının sıralama hizmeti tarafından gerçekleştirilen bir çalışma zamanı etkinliğidir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-104">Interop marshaling is a run-time activity performed by the common language runtime's marshaling service.</span></span>

<span data-ttu-id="53fd0-105">Çoğu veri türü hem yönetilen hem de yönetilmeyen bellekte ortak temsiller vardır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-105">Most data types have common representations in both managed and unmanaged memory.</span></span> <span data-ttu-id="53fd0-106">Birlikte çalışma sıralayıcısı sizin için bu türleri işler.</span><span class="sxs-lookup"><span data-stu-id="53fd0-106">The interop marshaler handles these types for you.</span></span> <span data-ttu-id="53fd0-107">Diğer türler, yönetilen bellekte belirsiz veya hiç gösterilemez.</span><span class="sxs-lookup"><span data-stu-id="53fd0-107">Other types can be ambiguous or not represented at all in managed memory.</span></span>

<span data-ttu-id="53fd0-108">Belirsiz bir tür, tek bir yönetilen türle eşlenen birden çok yönetilmeyen temsilden ya da bir dizinin boyutu gibi eksik tür bilgilerine sahip olabilir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-108">An ambiguous type can have either multiple unmanaged representations that map to a single managed type, or missing type information, such as the size of an array.</span></span> <span data-ttu-id="53fd0-109">Belirsiz türler için sıralayıcı, birden fazla temsilin bulunduğu varsayılan bir temsili ve alternatif gösterimleri sağlar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-109">For ambiguous types, the marshaler provides a default representation and alternative representations where multiple representations exist.</span></span> <span data-ttu-id="53fd0-110">Sıralayıcıya, belirsiz bir tür sıralama yapmak için açık yönergeler sağlayabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="53fd0-110">You can supply explicit instructions to the marshaler on how it is to marshal an ambiguous type.</span></span>

## <a name="platform-invoke-and-com-interop-models"></a><span data-ttu-id="53fd0-111">Platform çağırma ve COM birlikte çalışma modelleri</span><span class="sxs-lookup"><span data-stu-id="53fd0-111">Platform Invoke and COM Interop Models</span></span>

<span data-ttu-id="53fd0-112">Ortak dil çalışma zamanı, yönetilmeyen kod ile birlikte çalışmak için iki mekanizma sağlar:</span><span class="sxs-lookup"><span data-stu-id="53fd0-112">The common language runtime provides two mechanisms for interoperating with unmanaged code:</span></span>

- <span data-ttu-id="53fd0-113">Yönetilen kodun yönetilmeyen bir kitaplıktan aktarılmış işlevleri çağırmasına olanak sağlayan platform çağırma.</span><span class="sxs-lookup"><span data-stu-id="53fd0-113">Platform invoke, which enables managed code to call functions exported from an unmanaged library.</span></span>
- <span data-ttu-id="53fd0-114">Yönetilen kodun arabirimler aracılığıyla bileşen nesne modeli (COM) nesneleriyle etkileşime geçmesini sağlayan COM birlikte çalışma.</span><span class="sxs-lookup"><span data-stu-id="53fd0-114">COM interop, which enables managed code to interact with Component Object Model (COM) objects through interfaces.</span></span>

<span data-ttu-id="53fd0-115">Hem platform Invoke hem de COM birlikte çalışması, yöntem bağımsız değişkenlerini çağıran ve çağrılan ve geri dönüş arasında doğru şekilde taşımak için birlikte çalışabilirlik sıralamasını kullanır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-115">Both platform invoke and COM interop use interop marshaling to accurately move method arguments between caller and callee and back, if required.</span></span> <span data-ttu-id="53fd0-116">Aşağıdaki çizimde gösterildiği gibi, platform çağırma yöntemi, yönetilen 'den yönetilmeyen koda ve [geri çağırma işlevlerinin](callback-functions.md) dahil olduğu durumlar dışında, hiçbir zaman başka bir şekilde yapılır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-116">As the following illustration shows, a platform invoke method call flows from managed to unmanaged code and never the other way, except when [callback functions](callback-functions.md) are involved.</span></span> <span data-ttu-id="53fd0-117">Platform çağırma çağrıları yalnızca yönetilene yönetilmeyen koda akabilse de, veriler giriş veya çıkış parametreleri olarak her iki yönde de akabilir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-117">Even though platform invoke calls can flow only from managed to unmanaged code, data can flow in both directions as input or output parameters.</span></span> <span data-ttu-id="53fd0-118">COM birlikte çalışma yöntemi çağrıları her iki yönde de akabilir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-118">COM interop method calls can flow in either direction.</span></span>

<span data-ttu-id="53fd0-119">![Platform çağırma](./media/interop-marshaling/interop-marshaling-invoke-and-com.png "Platform çağırma ve COM birlikte çalışma çağrı akışı")</span><span class="sxs-lookup"><span data-stu-id="53fd0-119">![Platform invoke](./media/interop-marshaling/interop-marshaling-invoke-and-com.png "Platform invoke and COM interop call flow")</span></span>

<span data-ttu-id="53fd0-120">En düşük düzeyde, her iki mekanizma de aynı birlikte çalışma sıralama hizmetini kullanır; Ancak, belirli veri türleri yalnızca COM birlikte çalışma veya platform çağırma tarafından desteklenir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-120">At the lowest level, both mechanisms use the same interop marshaling service; however, certain data types are supported exclusively by COM interop or platform invoke.</span></span> <span data-ttu-id="53fd0-121">Ayrıntılar için bkz. [varsayılan sıralama davranışı](default-marshaling-behavior.md).</span><span class="sxs-lookup"><span data-stu-id="53fd0-121">For details, see [Default Marshaling Behavior](default-marshaling-behavior.md).</span></span>

## <a name="marshaling-and-com-apartments"></a><span data-ttu-id="53fd0-122">Hazırlama ve COM Apartments</span><span class="sxs-lookup"><span data-stu-id="53fd0-122">Marshaling and COM Apartments</span></span>

<span data-ttu-id="53fd0-123">Birlikte çalışma sıralayıcısı, verileri ortak dil çalışma zamanı yığını ve yönetilmeyen yığın arasında sıralar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-123">The interop marshaler marshals data between the common language runtime heap and the unmanaged heap.</span></span> <span data-ttu-id="53fd0-124">Sıralama, çağıran ve çağrılan aynı veri örneğinde çalışamadığında oluşur.</span><span class="sxs-lookup"><span data-stu-id="53fd0-124">Marshaling occurs whenever the caller and callee cannot operate on the same instance of data.</span></span> <span data-ttu-id="53fd0-125">Birlikte çalışma sıralayıcısı, çağıran ve çağrılan tarafından verilerin kendilerine ait bir kopyasına sahip olsalar bile aynı verilerde çalışıyor olmasını mümkün kılar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-125">The interop marshaler makes it possible for the caller and callee to appear to be operating on the same data even if they have their own copy of the data.</span></span>

<span data-ttu-id="53fd0-126">COM Ayrıca, verileri COM apartmanları veya farklı COM işlemleri arasında sıraladığında bir Sıralayıcı içerir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-126">COM also has a marshaler that marshals data between COM apartments or different COM processes.</span></span> <span data-ttu-id="53fd0-127">Aynı COM grubu içindeki yönetilen ve yönetilmeyen kod arasında çağrılırken, birlikte çalışma sıralayıcısı dahil tek Sıralayıcı olur.</span><span class="sxs-lookup"><span data-stu-id="53fd0-127">When calling between managed and unmanaged code within the same COM apartment, the interop marshaler is the only marshaler involved.</span></span> <span data-ttu-id="53fd0-128">Yönetilen kod ve yönetilmeyen kod arasında farklı bir COM grubu ya da farklı bir işlemde çağrılırken, birlikte çalışma sıralayıcısı ve COM sıralayıcısı dahil edilir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-128">When calling between managed code and unmanaged code in a different COM apartment or a different process, both the interop marshaler and the COM marshaler are involved.</span></span>

### <a name="com-clients-and-managed-servers"></a><span data-ttu-id="53fd0-129">COM Istemcileri ve yönetilen sunucular</span><span class="sxs-lookup"><span data-stu-id="53fd0-129">COM Clients and Managed Servers</span></span>

<span data-ttu-id="53fd0-130">[Regasm. exe (derleme kayıt aracı)](../tools/regasm-exe-assembly-registration-tool.md) tarafından kaydedilmiş bir tür kitaplığına sahip aktarılmış bir yönetilen sunucu, `Both`olarak ayarlanmış bir `ThreadingModel` kayıt defteri girişi içerir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-130">An exported managed server with a type library registered by the [Regasm.exe (Assembly Registration Tool)](../tools/regasm-exe-assembly-registration-tool.md) has a `ThreadingModel` registry entry set to `Both`.</span></span> <span data-ttu-id="53fd0-131">Bu değer, sunucunun tek iş parçacıklı bir grupta (STA) veya çok iş parçacıklı grupta (MTA) etkinleştiribileceğini belirtir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-131">This value indicates that the server can be activated in a single-threaded apartment (STA) or a multithreaded apartment (MTA).</span></span> <span data-ttu-id="53fd0-132">Sunucu nesnesi, aşağıdaki tabloda gösterildiği gibi çağıranı ile aynı grupta oluşturulur:</span><span class="sxs-lookup"><span data-stu-id="53fd0-132">The server object is created in the same apartment as its caller, as shown in the following table:</span></span>

|<span data-ttu-id="53fd0-133">COM istemcisi</span><span class="sxs-lookup"><span data-stu-id="53fd0-133">COM client</span></span>|<span data-ttu-id="53fd0-134">.NET Server</span><span class="sxs-lookup"><span data-stu-id="53fd0-134">.NET server</span></span>|<span data-ttu-id="53fd0-135">Hazırlama gereksinimleri</span><span class="sxs-lookup"><span data-stu-id="53fd0-135">Marshaling requirements</span></span>|
|----------------|-----------------|-----------------------------|
|<span data-ttu-id="53fd0-136">A</span><span class="sxs-lookup"><span data-stu-id="53fd0-136">STA</span></span>|<span data-ttu-id="53fd0-137">`Both` STA olur.</span><span class="sxs-lookup"><span data-stu-id="53fd0-137">`Both` becomes STA.</span></span>|<span data-ttu-id="53fd0-138">Aynı apartman sıralaması.</span><span class="sxs-lookup"><span data-stu-id="53fd0-138">Same-apartment marshaling.</span></span>|
|<span data-ttu-id="53fd0-139">SıRAYA</span><span class="sxs-lookup"><span data-stu-id="53fd0-139">MTA</span></span>|<span data-ttu-id="53fd0-140">`Both` MTA olur.</span><span class="sxs-lookup"><span data-stu-id="53fd0-140">`Both` becomes MTA.</span></span>|<span data-ttu-id="53fd0-141">Aynı apartman sıralaması.</span><span class="sxs-lookup"><span data-stu-id="53fd0-141">Same-apartment marshaling.</span></span>|

<span data-ttu-id="53fd0-142">İstemci ve sunucu aynı grupta olduğundan, birlikte çalışma hazırlama hizmeti tüm veri sıralamasını otomatik olarak işler.</span><span class="sxs-lookup"><span data-stu-id="53fd0-142">Because the client and server are in the same apartment, the interop marshaling service automatically handles all data marshaling.</span></span> <span data-ttu-id="53fd0-143">Aşağıdaki çizimde, aynı COM stili apartman içinde yönetilen ve yönetilmeyen Heap 'ler arasında çalışan birlikte çalışma sıralama hizmeti gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-143">The following illustration shows the interop marshaling service operating between managed and unmanaged heaps within the same COM-style apartment.</span></span>

<span data-ttu-id="53fd0-144">![Yönetilen ve yönetilmeyen Heap 'ler arasında birlikte çalışabilirlik sıralaması](./media/interop-marshaling/interop-heaps-managed-and-unmanaged.gif "Aynı apartman sıralama işlemi")</span><span class="sxs-lookup"><span data-stu-id="53fd0-144">![Interop marshaling between managed and unmanaged heaps](./media/interop-marshaling/interop-heaps-managed-and-unmanaged.gif "Same-apartment marshaling process")</span></span>

<span data-ttu-id="53fd0-145">Yönetilen bir sunucuyu dışarı aktarmayı planlıyorsanız, COM istemcisinin sunucunun bulunduğu grubu belirlediğini unutmayın.</span><span class="sxs-lookup"><span data-stu-id="53fd0-145">If you plan to export a managed server, be aware that the COM client determines the apartment of the server.</span></span> <span data-ttu-id="53fd0-146">Bir MTA içinde başlatılan bir COM istemcisi tarafından çağrılan yönetilen bir sunucu, iş parçacığı güvenliği sağlamalıdır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-146">A managed server called by a COM client initialized in an MTA must ensure thread safety.</span></span>

### <a name="managed-clients-and-com-servers"></a><span data-ttu-id="53fd0-147">Yönetilen Istemciler ve COM sunucuları</span><span class="sxs-lookup"><span data-stu-id="53fd0-147">Managed Clients and COM Servers</span></span>

<span data-ttu-id="53fd0-148">Yönetilen istemci apartmanları için varsayılan ayar MTA ' dır; Ancak, .NET istemcisinin uygulama türü varsayılan ayarı değiştirebilir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-148">The default setting for managed client apartments is MTA; however, the application type of the .NET client can change the default setting.</span></span> <span data-ttu-id="53fd0-149">Örneğin, Visual Basic istemci grubu ayarı STA ' dır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-149">For example, a Visual Basic client apartment setting is STA.</span></span> <span data-ttu-id="53fd0-150">Yönetilen bir istemcinin Grup ayarını incelemek ve değiştirmek için <xref:System.STAThreadAttribute?displayProperty=nameWithType>, <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> özelliğini veya <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> özelliğini kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="53fd0-150">You can use the <xref:System.STAThreadAttribute?displayProperty=nameWithType>, the <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, the <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> property, or the <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> property to examine and change the apartment setting of a managed client.</span></span>

<span data-ttu-id="53fd0-151">Bileşenin yazarı bir COM sunucusunun iş parçacığı benzeşimini ayarlar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-151">The author of the component sets the thread affinity of a COM server.</span></span> <span data-ttu-id="53fd0-152">Aşağıdaki tabloda .NET istemcileri ve COM sunucuları için Grup ayarları birleşimleri gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-152">The following table shows the combinations of apartment settings for .NET clients and COM servers.</span></span> <span data-ttu-id="53fd0-153">Ayrıca, kombinasyonlar için elde edilen sıralama gereksinimlerini gösterir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-153">It also shows the resulting marshaling requirements for the combinations.</span></span>

|<span data-ttu-id="53fd0-154">.NET istemcisi</span><span class="sxs-lookup"><span data-stu-id="53fd0-154">.NET client</span></span>|<span data-ttu-id="53fd0-155">COM sunucusu</span><span class="sxs-lookup"><span data-stu-id="53fd0-155">COM server</span></span>|<span data-ttu-id="53fd0-156">Hazırlama gereksinimleri</span><span class="sxs-lookup"><span data-stu-id="53fd0-156">Marshaling requirements</span></span>|
|-----------------|----------------|-----------------------------|
|<span data-ttu-id="53fd0-157">MTA (varsayılan)</span><span class="sxs-lookup"><span data-stu-id="53fd0-157">MTA (default)</span></span>|<span data-ttu-id="53fd0-158">SıRAYA</span><span class="sxs-lookup"><span data-stu-id="53fd0-158">MTA</span></span><br /><br /> <span data-ttu-id="53fd0-159">A</span><span class="sxs-lookup"><span data-stu-id="53fd0-159">STA</span></span>|<span data-ttu-id="53fd0-160">Birlikte çalışma hazırlama.</span><span class="sxs-lookup"><span data-stu-id="53fd0-160">Interop marshaling.</span></span><br /><br /> <span data-ttu-id="53fd0-161">Birlikte çalışabilirlik ve COM sıralaması.</span><span class="sxs-lookup"><span data-stu-id="53fd0-161">Interop and COM marshaling.</span></span>|
|<span data-ttu-id="53fd0-162">A</span><span class="sxs-lookup"><span data-stu-id="53fd0-162">STA</span></span>|<span data-ttu-id="53fd0-163">SıRAYA</span><span class="sxs-lookup"><span data-stu-id="53fd0-163">MTA</span></span><br /><br /> <span data-ttu-id="53fd0-164">A</span><span class="sxs-lookup"><span data-stu-id="53fd0-164">STA</span></span>|<span data-ttu-id="53fd0-165">Birlikte çalışabilirlik ve COM sıralaması.</span><span class="sxs-lookup"><span data-stu-id="53fd0-165">Interop and COM marshaling.</span></span><br /><br /> <span data-ttu-id="53fd0-166">Birlikte çalışma hazırlama.</span><span class="sxs-lookup"><span data-stu-id="53fd0-166">Interop marshaling.</span></span>|

<span data-ttu-id="53fd0-167">Yönetilen bir istemci ve yönetilmeyen sunucu aynı Apartment ise, birlikte çalışma hazırlama hizmeti tüm veri sıralamasını işler.</span><span class="sxs-lookup"><span data-stu-id="53fd0-167">When a managed client and unmanaged server are in the same apartment, the interop marshaling service handles all data marshaling.</span></span> <span data-ttu-id="53fd0-168">Ancak, istemci ve sunucu farklı apartmanlar halinde başlatıldığında COM sıralaması de gereklidir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-168">However, when client and server are initialized in different apartments, COM marshaling is also required.</span></span> <span data-ttu-id="53fd0-169">Aşağıdaki çizimde bir gruplar arası çağrının öğeleri gösterilmektedir:</span><span class="sxs-lookup"><span data-stu-id="53fd0-169">The following illustration shows the elements of a cross-apartment call:</span></span>

<span data-ttu-id="53fd0-170">![COM sıralaması](./media/interop-marshaling/single-process-across-multi-apartment.gif ".NET istemcisiyle COM nesnesi arasında çapraz grup çağrısı")</span><span class="sxs-lookup"><span data-stu-id="53fd0-170">![COM marshaling](./media/interop-marshaling/single-process-across-multi-apartment.gif "Cross-apartment call between a .NET client and COM object")</span></span>

<span data-ttu-id="53fd0-171">Çapraz grup sıralaması için şunları yapabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="53fd0-171">For cross-apartment marshaling, you can do the following:</span></span>

- <span data-ttu-id="53fd0-172">Yalnızca sınır genelinde çok sayıda çağrı olduğunda dikkat çekici olan çapraz grup sıralaması yükünü kabul edin.</span><span class="sxs-lookup"><span data-stu-id="53fd0-172">Accept the overhead of the cross-apartment marshaling, which is noticeable only when there are many calls across the boundary.</span></span> <span data-ttu-id="53fd0-173">Grup sınırını başarıyla çapraz olarak aramak için COM bileşeninin tür kitaplığını kaydetmeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-173">You must register the type library of the COM component for calls to successfully cross the apartment boundary.</span></span>
- <span data-ttu-id="53fd0-174">İstemci iş parçacığını STA veya MTA olarak ayarlayarak ana iş parçacığını değiştirin.</span><span class="sxs-lookup"><span data-stu-id="53fd0-174">Alter the main thread by setting the client thread to STA or MTA.</span></span> <span data-ttu-id="53fd0-175">Örneğin, C# istemciniz çok SAYıDA sta com bileşeni çağırırsa, ana Iş parçacığını STA olarak ayarlayarak geçici grup sıralamasını önleyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="53fd0-175">For example, if your C# client calls many STA COM components, you can avoid cross-apartment marshaling by setting the main thread to STA.</span></span>

    > [!NOTE]
    > <span data-ttu-id="53fd0-176">Bir C# istemcinin Iş parçacığı STA olarak AYARLANDıĞıNDA, MTA COM bileşenlerine yapılan çağrılar, çapraz grup sıralaması gerektirir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-176">Once the thread of a C# client is set to STA, calls to MTA COM components will require cross-apartment marshaling.</span></span>

<span data-ttu-id="53fd0-177">Bir grup modelini açıkça seçme yönergeleri için bkz. [yönetilen ve yönetilmeyen Iş parçacığı](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5s8ee185(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="53fd0-177">For instructions on explicitly selecting an apartment model, see [Managed and Unmanaged Threading](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/5s8ee185(v=vs.100)).</span></span>

## <a name="marshaling-remote-calls"></a><span data-ttu-id="53fd0-178">Uzak çağrıları sıralama</span><span class="sxs-lookup"><span data-stu-id="53fd0-178">Marshaling Remote Calls</span></span>

<span data-ttu-id="53fd0-179">Çapraz grup sıralaması gibi, nesneler ayrı işlemlerde olduğunda yönetilen ve yönetilmeyen kod arasındaki her çağrıya COM sıralaması dahil edilir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-179">As with cross-apartment marshaling, COM marshaling is involved in each call between managed and unmanaged code whenever the objects reside in separate processes.</span></span> <span data-ttu-id="53fd0-180">Örneğin:</span><span class="sxs-lookup"><span data-stu-id="53fd0-180">For example:</span></span>

- <span data-ttu-id="53fd0-181">Uzak bir konakta yönetilen bir sunucuyu çağıran bir COM istemcisi Dağıtılmış COM (DCOM) kullanır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-181">A COM client that invokes a managed server on a remote host uses distributed COM (DCOM).</span></span>
- <span data-ttu-id="53fd0-182">Uzak bir konakta bir COM sunucusu çağıran yönetilen istemci DCOM kullanır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-182">A managed client that invokes a COM server on a remote host uses DCOM.</span></span>

<span data-ttu-id="53fd0-183">Aşağıdaki çizimde birlikte çalışabilirlik sıralaması ve COM sıralaması, işlem ve konak sınırları genelinde iletişim kanalları sağlar:</span><span class="sxs-lookup"><span data-stu-id="53fd0-183">The following illustration shows how interop marshaling and COM marshaling provide communications channels across process and host boundaries:</span></span>

<span data-ttu-id="53fd0-184">![COM sıralaması](./media/interop-marshaling/interop-and-com-marshaling.gif "Çapraz işlem sıralaması")</span><span class="sxs-lookup"><span data-stu-id="53fd0-184">![COM marshaling](./media/interop-marshaling/interop-and-com-marshaling.gif "Cross-process marshaling")</span></span>

### <a name="preserving-identity"></a><span data-ttu-id="53fd0-185">Kimlik koruma</span><span class="sxs-lookup"><span data-stu-id="53fd0-185">Preserving Identity</span></span>

<span data-ttu-id="53fd0-186">Ortak dil çalışma zamanı, yönetilen ve yönetilmeyen başvuruların kimliğini korur.</span><span class="sxs-lookup"><span data-stu-id="53fd0-186">The common language runtime preserves the identity of managed and unmanaged references.</span></span> <span data-ttu-id="53fd0-187">Aşağıdaki çizimde, doğrudan yönetilmeyen başvuruların (üst satır) ve işlem ve konak sınırları genelinde doğrudan yönetilen başvuruların (alt satır) akışı gösterilmektedir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-187">The following illustration shows the flow of direct unmanaged references (top row) and direct managed references (bottom row) across process and host boundaries.</span></span>

<span data-ttu-id="53fd0-188">![COM çağrılabilir sarmalayıcı ve çalışma zamanı çağrılabilir sarmalayıcı](./media/interop-marshaling/interop-direct-ref-across-process.gif "İşlem ve konak sınırları arasında başvuru geçirme")</span><span class="sxs-lookup"><span data-stu-id="53fd0-188">![COM callable wrapper and runtime callable wrapper](./media/interop-marshaling/interop-direct-ref-across-process.gif "Reference passing across process and host boundaries")</span></span>

<span data-ttu-id="53fd0-189">Bu çizimde:</span><span class="sxs-lookup"><span data-stu-id="53fd0-189">In this illustration:</span></span>

- <span data-ttu-id="53fd0-190">Yönetilmeyen istemci, uzak bir ana bilgisayardan bu başvuruyu alan yönetilen bir nesneden bir COM nesnesine başvuru alır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-190">An unmanaged client gets a reference to a COM object from a managed object that gets this reference from a remote host.</span></span> <span data-ttu-id="53fd0-191">Uzaktan iletişim mekanizması DCOM olur.</span><span class="sxs-lookup"><span data-stu-id="53fd0-191">The remoting mechanism is DCOM.</span></span>
- <span data-ttu-id="53fd0-192">Yönetilen istemci, bir uzak ana bilgisayardan bu başvuruyu alan bir COM nesnesinden yönetilen bir nesneye başvuru alır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-192">A managed client gets a reference to a managed object from a COM object that gets this reference from a remote host.</span></span> <span data-ttu-id="53fd0-193">Uzaktan iletişim mekanizması DCOM olur.</span><span class="sxs-lookup"><span data-stu-id="53fd0-193">The remoting mechanism is DCOM.</span></span>

    > [!NOTE]
    > <span data-ttu-id="53fd0-194">Yönetilen sunucunun dışarıya aktarılmış tür kitaplığı kayıtlı olmalıdır.</span><span class="sxs-lookup"><span data-stu-id="53fd0-194">The exported type library of the managed server must be registered.</span></span>

<span data-ttu-id="53fd0-195">Çağıran ve çağrılan arasındaki işlem sınırları sayısı ilgisizdir; işlem içi ve işlem dışı çağrılar için aynı doğrudan başvuru oluşur.</span><span class="sxs-lookup"><span data-stu-id="53fd0-195">The number of process boundaries between caller and callee is irrelevant; the same direct referencing occurs for in-process and out-of-process calls.</span></span>

### <a name="managed-remoting"></a><span data-ttu-id="53fd0-196">Yönetilen uzaktan erişim</span><span class="sxs-lookup"><span data-stu-id="53fd0-196">Managed Remoting</span></span>

<span data-ttu-id="53fd0-197">Çalışma zamanı ayrıca yönetilen uzaktan iletişim sağlar, bu da işlem ve konak sınırları arasında yönetilen nesneler arasında bir iletişim kanalı oluşturmak için kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="53fd0-197">The runtime also provides managed remoting, which you can use to establish a communications channel between managed objects across process and host boundaries.</span></span> <span data-ttu-id="53fd0-198">Yönetilen uzaktan iletişim, aşağıdaki çizimde gösterildiği gibi, iletişim kuran bileşenler arasında bir güvenlik duvarına uyum sağlayabilir:</span><span class="sxs-lookup"><span data-stu-id="53fd0-198">Managed remoting can accommodate a firewall between the communicating components, as the following illustration shows:</span></span>

<span data-ttu-id="53fd0-199">![SOAP veya TcpChannel](./media/interop-marshaling/interop-remote-soap-or-tcp.gif "SOAP veya TcpChannel sınıfı kullanarak güvenlik duvarları genelinde uzaktan çağrılar") SOAP veya TcpChannel sınıfı kullanarak güvenlik duvarları genelinde uzaktan çağrılar</span><span class="sxs-lookup"><span data-stu-id="53fd0-199">![SOAP or TcpChannel](./media/interop-marshaling/interop-remote-soap-or-tcp.gif "Remote calls across firewalls using SOAP or the TcpChannel class") Remote calls across firewalls using SOAP or the TcpChannel class</span></span>

<span data-ttu-id="53fd0-200">Bazı yönetilmeyen çağrılar, hizmet verilen bileşenler ve COM arasındaki çağrılar gibi SOAP üzerinden channe, olabilir.</span><span class="sxs-lookup"><span data-stu-id="53fd0-200">Some unmanaged calls can be channeled through SOAP, such as the calls between serviced components and COM.</span></span>

## <a name="related-topics"></a><span data-ttu-id="53fd0-201">İlgili Konular</span><span class="sxs-lookup"><span data-stu-id="53fd0-201">Related Topics</span></span>

|<span data-ttu-id="53fd0-202">Başlık</span><span class="sxs-lookup"><span data-stu-id="53fd0-202">Title</span></span>|<span data-ttu-id="53fd0-203">Açıklama</span><span class="sxs-lookup"><span data-stu-id="53fd0-203">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="53fd0-204">Varsayılan Hazırlama Davranışı</span><span class="sxs-lookup"><span data-stu-id="53fd0-204">Default Marshaling Behavior</span></span>](default-marshaling-behavior.md)|<span data-ttu-id="53fd0-205">Birlikte çalışma sıralama hizmetinin verileri sıralamak için kullandığı kuralları açıklar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-205">Describes the rules that the interop marshaling service uses to marshal data.</span></span>|
|[<span data-ttu-id="53fd0-206">Platform Çağırma ile Veri Hazırlama</span><span class="sxs-lookup"><span data-stu-id="53fd0-206">Marshaling Data with Platform Invoke</span></span>](marshaling-data-with-platform-invoke.md)|<span data-ttu-id="53fd0-207">Yöntem parametrelerinin nasıl bildirilemeyeceğini ve yönetilmeyen kitaplıklar tarafından dışarıya alınan işlevlere bağımsız değişkenlerin nasıl geçirileceğini açıklar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-207">Describes how to declare method parameters and pass arguments to functions exported by unmanaged libraries.</span></span>|
|[<span data-ttu-id="53fd0-208">COM Birlikte Çalışma ile Verileri Hazırlama</span><span class="sxs-lookup"><span data-stu-id="53fd0-208">Marshaling Data with COM Interop</span></span>](marshaling-data-with-com-interop.md)|<span data-ttu-id="53fd0-209">Sıralama davranışının değiştirmek için COM sarmalayıcılarının nasıl özelleştirileceğini açıklar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-209">Describes how to customize COM wrappers to alter marshaling behavior.</span></span>|
|[<span data-ttu-id="53fd0-210">Nasıl yapılır: Yönetilen Kodu DCOM’dan WCF’ye Geçirme</span><span class="sxs-lookup"><span data-stu-id="53fd0-210">How to: Migrate Managed-Code DCOM to WCF</span></span>](how-to-migrate-managed-code-dcom-to-wcf.md)|<span data-ttu-id="53fd0-211">DCOM 'dan WCF 'ye geçiş işlemini açıklar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-211">Describes how to migrate from DCOM to WCF.</span></span>|
|[<span data-ttu-id="53fd0-212">Nasıl yapılır: HRESULTs ve Özel Durumları Eşleme</span><span class="sxs-lookup"><span data-stu-id="53fd0-212">How to: Map HRESULTs and Exceptions</span></span>](how-to-map-hresults-and-exceptions.md)|<span data-ttu-id="53fd0-213">Özel özel durumların HRESULTs ile nasıl eşlenmesinin ve .NET Framework her HRESULT 'den karşılaştırılabilen özel durum sınıfına tüm eşlemeyi nasıl sağladığını açıklar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-213">Describes how to map custom exceptions to HRESULTs and provides the complete mapping from each HRESULT to its comparable exception class in the .NET Framework.</span></span>|
|<span data-ttu-id="53fd0-214">[Genel türler kullanılarak birlikte çalışma](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms229590(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="53fd0-214">[Interoperating Using Generic Types](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms229590(v=vs.100))</span></span>|<span data-ttu-id="53fd0-215">COM birlikte çalışabilirlik için genel türler kullanılırken hangi eylemlerin desteklendiğini açıklar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-215">Describes which actions are supported when using generic types for COM interoperability.</span></span>|
|[<span data-ttu-id="53fd0-216">Yönetilmeyen Kod ile Birlikte Çalışma</span><span class="sxs-lookup"><span data-stu-id="53fd0-216">Interoperating with Unmanaged Code</span></span>](index.md)|<span data-ttu-id="53fd0-217">Ortak dil çalışma zamanı tarafından sunulan birlikte çalışabilirlik hizmetlerini açıklar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-217">Describes interoperability services provided by the common language runtime.</span></span>|
|<span data-ttu-id="53fd0-218">[Gelişmiş COM birlikte çalışabilirlik](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="53fd0-218">[Advanced COM Interoperability](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))</span></span>|<span data-ttu-id="53fd0-219">.NET Framework uygulamanıza COM bileşenlerini ekleme hakkında daha fazla bilgi için bağlantılar sağlar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-219">Provides links to more information about incorporating COM components into your .NET Framework application.</span></span>|
|<span data-ttu-id="53fd0-220">[Birlikte çalışabilirlik için tasarım konuları](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/61aax4kh(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="53fd0-220">[Design Considerations for Interoperation](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/61aax4kh(v=vs.100))</span></span>|<span data-ttu-id="53fd0-221">Tümleşik COM bileşenleri yazmak için ipuçları sağlar.</span><span class="sxs-lookup"><span data-stu-id="53fd0-221">Provides tips for writing integrated COM components.</span></span>|

## <a name="reference"></a><span data-ttu-id="53fd0-222">Başvuru</span><span class="sxs-lookup"><span data-stu-id="53fd0-222">Reference</span></span>

<xref:System.Runtime.InteropServices?displayProperty=nameWithType>
