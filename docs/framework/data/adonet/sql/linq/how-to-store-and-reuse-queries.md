---
title: 'Nasıl yapılır: Sorguları Depolama ve Yeniden Kullanma'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: aae1cf3faf2ecb3d8e9511390cdaa1e004905bea
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 09/24/2020
ms.locfileid: "91197098"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="ddb46-102">Nasıl yapılır: Sorguları Depolama ve Yeniden Kullanma</span><span class="sxs-lookup"><span data-stu-id="ddb46-102">How to: Store and Reuse Queries</span></span>

<span data-ttu-id="ddb46-103">Yapısal olarak benzer sorguları birçok kez yürüten bir uygulamanız varsa, genellikle sorguyu bir kez derleyerek ve farklı parametrelerle birkaç kez yürüterek performansı artırabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ddb46-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="ddb46-104">Örneğin, bir uygulamanın belirli bir şehirde yer alan tüm müşterileri alması gerekebilir. burada şehir, bir formdaki Kullanıcı tarafından çalışma zamanında belirtilir.</span><span class="sxs-lookup"><span data-stu-id="ddb46-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="ddb46-105">Bu amaçla *derlenen sorguların* kullanımını destekler.</span><span class="sxs-lookup"><span data-stu-id="ddb46-105">supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="ddb46-106">Bu kullanım stili, derlenmiş sorgular için en yaygın kullanımı temsil eder.</span><span class="sxs-lookup"><span data-stu-id="ddb46-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="ddb46-107">Diğer yaklaşımlar mümkündür.</span><span class="sxs-lookup"><span data-stu-id="ddb46-107">Other approaches are possible.</span></span> <span data-ttu-id="ddb46-108">Örneğin, derlenmiş sorgular, tasarımcı tarafından oluşturulan kodu genişleten kısmi bir sınıfta statik üye olarak depolanabilir.</span><span class="sxs-lookup"><span data-stu-id="ddb46-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="ddb46-109">Örnek</span><span class="sxs-lookup"><span data-stu-id="ddb46-109">Example</span></span>  

 <span data-ttu-id="ddb46-110">Birçok senaryoda sorguları iş parçacığı sınırları genelinde yeniden kullanmak isteyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="ddb46-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="ddb46-111">Bu gibi durumlarda, derlenmiş sorguları statik değişkenlerde depolamak özellikle etkilidir.</span><span class="sxs-lookup"><span data-stu-id="ddb46-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="ddb46-112">Aşağıdaki kod örneği, `Queries` derlenmiş sorguları depolamak için tasarlanan bir sınıfı varsayar ve kesin bir şekilde yazılmış bir Northwind sınıfının olduğunu varsayar <xref:System.Data.Linq.DataContext> .</span><span class="sxs-lookup"><span data-stu-id="ddb46-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="ddb46-113">Örnek</span><span class="sxs-lookup"><span data-stu-id="ddb46-113">Example</span></span>  

 <span data-ttu-id="ddb46-114">Şu anda, türün genel bir bağımsız değişken olarak sağlanacak bir adı olmadığından, *anonim bir tür*döndüren sorgularda (statik değişkenler içinde) depolama alanı oluşturamazsınız.</span><span class="sxs-lookup"><span data-stu-id="ddb46-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="ddb46-115">Aşağıdaki örnek, sonucu temsil eden bir tür oluşturarak ve sonra genel bir bağımsız değişken olarak kullanarak soruna geçici bir çözüm nasıl kullanabileceğinizi gösterir.</span><span class="sxs-lookup"><span data-stu-id="ddb46-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="ddb46-116">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="ddb46-116">See also</span></span>

- <xref:System.Data.Linq.CompiledQuery>
- [<span data-ttu-id="ddb46-117">Sorgu Kavramları</span><span class="sxs-lookup"><span data-stu-id="ddb46-117">Query Concepts</span></span>](query-concepts.md)
- [<span data-ttu-id="ddb46-118">Veritabanını Sorgulama</span><span class="sxs-lookup"><span data-stu-id="ddb46-118">Querying the Database</span></span>](querying-the-database.md)
