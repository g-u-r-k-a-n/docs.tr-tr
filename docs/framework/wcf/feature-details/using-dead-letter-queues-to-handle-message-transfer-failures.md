---
description: 'Hakkında daha fazla bilgi edinin: Ileti aktarımı başarısızlıklarını Işlemek için Dead-Letter kuyrukları kullanma'
title: İleti Aktarımı Hatalarını İşlemek için Teslim Edilemeyen İletiler Sırası Kullanma
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 9e891c6a-d960-45ea-904f-1a00e202d61a
ms.openlocfilehash: 497da84d37cf7c82a2da09e4303b8e53e7e0b46c
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 02/06/2021
ms.locfileid: "99704452"
---
# <a name="using-dead-letter-queues-to-handle-message-transfer-failures"></a><span data-ttu-id="8f2d5-103">İleti Aktarımı Hatalarını İşlemek için Teslim Edilemeyen İletiler Sırası Kullanma</span><span class="sxs-lookup"><span data-stu-id="8f2d5-103">Using Dead-Letter Queues to Handle Message Transfer Failures</span></span>

<span data-ttu-id="8f2d5-104">Sıraya alınan iletiler teslim başarısız olabilir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-104">Queued messages can fail delivery.</span></span> <span data-ttu-id="8f2d5-105">Bu başarısız iletiler, teslim edilemeyen bir sıraya kaydedilir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-105">These failed messages are recorded in a dead-letter queue.</span></span> <span data-ttu-id="8f2d5-106">Başarısız teslimat, ağ hataları, silinen bir kuyruk, tam sıra, kimlik doğrulama hatası veya zaman içinde teslim etme hatası gibi nedenlerle neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-106">The failed delivery can be caused by reasons such as network failures, a deleted queue, a full queue, authentication failure, or a failure to deliver on time.</span></span>  
  
 <span data-ttu-id="8f2d5-107">Alınan uygulama, zaman zaman bir süre sonra kuyruktan okunmayan sırada, sıradaki iletiler kuyrukta kalabilirler.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-107">Queued messages can remain in the queue for a long time if the receiving application does not read them from the queue in a timely fashion.</span></span> <span data-ttu-id="8f2d5-108">Bu davranış zamana duyarlı iletiler için uygun olmayabilir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-108">This behavior may not be appropriate for time-sensitive messages.</span></span> <span data-ttu-id="8f2d5-109">Zamana duyarlı iletiler, sıradaki bağlamada ayarlanan yaşam süresi (TTL) özelliğine sahiptir ve bu, iletilerin süresi dolmadan önce kuyrukta ne kadar süreyle kalabileceğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-109">Time-sensitive messages have a Time to Live (TTL) property set in the queued binding, which indicates how long the messages can be in the queue before they must expire.</span></span> <span data-ttu-id="8f2d5-110">Süre dolmayan iletiler, teslim edilemeyen ileti sırası adlı özel bir kuyruğa gönderilir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-110">Expired messages are sent to a special queue called the dead-letter queue.</span></span> <span data-ttu-id="8f2d5-111">Ayrıca iletiler, bir kuyruk kotasının aşılması veya kimlik doğrulama hatası nedeniyle diğer nedenlerden dolayı atılacak bir sıraya alınabilir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-111">Messages can also be put in a dead-letter queue for other reasons, such as exceeding a queue quota or because of authentication failure.</span></span>  
  
 <span data-ttu-id="8f2d5-112">Genellikle, uygulamalar teslim edilemeyen ileti sırasından ve hata nedenlerinden iletileri okumak için maaş mantığı yazar.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-112">Generally, applications write compensation logic to read messages from the dead-letter queue and failure reasons.</span></span> <span data-ttu-id="8f2d5-113">Dengeleme mantığı, hatanın nedenine bağlıdır.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-113">The compensation logic depends on the cause of the failure.</span></span> <span data-ttu-id="8f2d5-114">Örneğin, kimlik doğrulama hatası durumunda iletiyle bağlantılı sertifikayı düzeltebilir ve iletiyi yeniden gönderebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-114">For example, in the case of authentication failure, you can correct the certificate attached with the message and resend the message.</span></span> <span data-ttu-id="8f2d5-115">Hedef kuyruk kotasına ulaşıldığından, teslim başarısız olursa, kota sorununun çözümlendiğini umuyoruz.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-115">If delivery failed because the target queue quota was reached, you can reattempt delivery in the hope that the quota problem was resolved.</span></span>  
  
 <span data-ttu-id="8f2d5-116">Çoğu sıraya alma sisteminde, bu sistemdeki tüm başarısız iletilerin depolandığı sistem genelinde bir atılacak ileti sırası vardır.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-116">Most queuing systems have a system-wide dead-letter queue where all failed messages from that system are stored.</span></span> <span data-ttu-id="8f2d5-117">Message Queuing (MSMQ), iki sistem genelinde atılacak ileti sırası sağlar: işlemsel sıraya teslim edilemeyen iletileri depolayan ve işlemsel olmayan sıraya teslim edilemeyen iletileri depolayan, sistem genelinde çok sayıda atılacak bir sıra olmayan bir işlem sistem genelinde atılacak mektup kuyruğu.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-117">Message Queuing (MSMQ) provides two system-wide dead-letter queues: a transactional system-wide dead-letter queue that stores messages that failed delivery to the transactional queue and a non-transactional system-wide dead-letter queue that stores messages that failed delivery to the non-transactional queue.</span></span> <span data-ttu-id="8f2d5-118">İki istemci iki farklı hizmete ileti gönderiyorsa ve bu nedenle WCF 'deki farklı kuyruklar, göndermek için aynı MSMQ hizmetini paylaşılıyorsa, sistem teslim edilemeyen ileti kuyruğunda ileti karışımı olması mümkündür.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-118">If two clients are sending messages to two different services, and therefore different queues in WCF are sharing the same MSMQ service to send, then it is possible to have a mix of messages in the system dead-letter queue.</span></span> <span data-ttu-id="8f2d5-119">Bu her zaman en uygun değildir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-119">This is not always optimal.</span></span> <span data-ttu-id="8f2d5-120">Birkaç durumda (güvenlik, örneğin), bir istemcinin eski ileti sırasından başka bir istemcinin iletilerini okumasını istemeyebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-120">In several cases (security, for example), you may not want one client to read another client's messages from a dead-letter queue.</span></span> <span data-ttu-id="8f2d5-121">Paylaşılan bir atılacak ileti sırası, istemcilerin gönderdikleri bir iletiyi bulmak için kuyruğa gözatmasını ve teslim edilemeyen ileti sırasındaki ileti sayısına bağlı olarak yüksek maliyetli olabilecek bir şekilde canlı olarak yapılmasını gerektirir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-121">A shared dead-letter queue also requires clients to browse through the queue to find a message that they sent, which can be prohibitively expensive based on the number of messages in the dead-letter queue.</span></span> <span data-ttu-id="8f2d5-122">Bu nedenle, WCF `NetMsmqBinding` `MsmqIntegrationBinding,` ve Windows VISTA 'da MSMQ, özel bir atılacak mektup kuyruğu (bazen uygulamaya özgü atılacak mektup kuyruğu olarak adlandırılır) sağlar.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-122">Therefore, in WCF`NetMsmqBinding`, `MsmqIntegrationBinding,` and MSMQ on Windows Vista provide a custom dead-letter queue (sometimes referred to as an application-specific dead-letter queue).</span></span>  
  
 <span data-ttu-id="8f2d5-123">Özel atılacak mektup kuyruğu, iletileri göndermek için aynı MSMQ hizmetini paylaşan istemciler arasında yalıtım sağlar.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-123">The custom dead-letter queue provides isolation between clients that share the same MSMQ service to send messages.</span></span>  
  
 <span data-ttu-id="8f2d5-124">Windows Server 2003 ve Windows XP 'de Windows Communication Foundation (WCF), sıraya alınan tüm istemci uygulamaları için sistem genelinde bir atılacak ileti sırası sağlar.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-124">On Windows Server 2003 and Windows XP, Windows Communication Foundation (WCF) provides a system-wide dead-letter queue for all queued client applications.</span></span> <span data-ttu-id="8f2d5-125">Windows Vista 'da WCF, her kuyruğa alınan istemci uygulaması için atılacak bir sıra sağlar.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-125">On Windows Vista, WCF provides a dead-letter queue for each queued client application.</span></span>  
  
## <a name="specifying-use-of-the-dead-letter-queue"></a><span data-ttu-id="8f2d5-126">Dead-Letter kuyruğunun kullanımını belirtme</span><span class="sxs-lookup"><span data-stu-id="8f2d5-126">Specifying Use of the Dead-Letter Queue</span></span>  

 <span data-ttu-id="8f2d5-127">Teslim edilemeyen bir sıra, gönderen uygulamanın kuyruk yöneticisidir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-127">A dead-letter queue is in the queue manager of the sending application.</span></span> <span data-ttu-id="8f2d5-128">Bu, zaman aşımına uğradı veya başarısız aktarım ya da teslim olan iletileri depolar.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-128">It stores messages that have expired or that have failed transfer or delivery.</span></span>  
  
 <span data-ttu-id="8f2d5-129">Bağlama, aşağıdaki atılacak ileti sırası özelliklerine sahiptir:</span><span class="sxs-lookup"><span data-stu-id="8f2d5-129">The binding has the following dead-letter queue properties:</span></span>  
  
- <xref:System.ServiceModel.MsmqBindingBase.DeadLetterQueue%2A>  
  
- <xref:System.ServiceModel.MsmqBindingBase.CustomDeadLetterQueue%2A>  
  
## <a name="reading-messages-from-the-dead-letter-queue"></a><span data-ttu-id="8f2d5-130">Dead-Letter kuyruğundan Iletileri okuma</span><span class="sxs-lookup"><span data-stu-id="8f2d5-130">Reading Messages from the Dead-Letter Queue</span></span>  

 <span data-ttu-id="8f2d5-131">Eski bir ileti sırasından gelen iletileri okuyan bir uygulama, aşağıdaki küçük farklılıklar dışında bir uygulama kuyruğundan okuyan bir WCF hizmetine benzerdir:</span><span class="sxs-lookup"><span data-stu-id="8f2d5-131">An application that reads messages out of a dead-letter queue is similar to a WCF service that reads from an application queue, except for the following minor differences:</span></span>  
  
- <span data-ttu-id="8f2d5-132">Sistem işlem dışı ileti sırasından iletileri okumak için Tekdüzen Kaynak tanımlayıcısı (URI) şu biçimde olmalıdır: net. MSMQ://localhost/System $;D Eadxyasası.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-132">To read messages from a system transactional dead-letter queue, the Uniform Resource Identifier (URI) must be of the form: net.msmq://localhost/system$;DeadXact.</span></span>  
  
- <span data-ttu-id="8f2d5-133">Bir sistem işlem dışı teslim edilemeyen ileti sırasından iletileri okumak için URI şu biçimde olmalıdır: net. MSMQ://localhost/System $;D eadLetter.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-133">To read messages from a system non-transactional dead-letter queue, the URI must be of the form: net.msmq://localhost/system$;DeadLetter.</span></span>  
  
- <span data-ttu-id="8f2d5-134">Özel bir atılacak ileti sırasından iletileri okumak için URI şu biçimde olmalıdır: net. MSMQ://localhost/private/ \<*custom-dlq-name*> burada *Custom-DLQ-Name* özel atılacak ileti sırasının adıdır.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-134">To read messages from a custom dead-letter queue, the URI must be of the form:net.msmq://localhost/private/\<*custom-dlq-name*> where *custom-dlq-name* is the name of the custom dead-letter queue.</span></span>  
  
 <span data-ttu-id="8f2d5-135">Kuyrukların nasıl kullanılacağı hakkında daha fazla bilgi için bkz. [hizmet uç noktaları ve sıra adresleme](service-endpoints-and-queue-addressing.md).</span><span class="sxs-lookup"><span data-stu-id="8f2d5-135">For more information about how to address queues, see [Service Endpoints and Queue Addressing](service-endpoints-and-queue-addressing.md).</span></span>  
  
 <span data-ttu-id="8f2d5-136">Alıcının WCF yığını, hizmetin iletideki adresle dinlediği adreslerle eşleşir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-136">The WCF stack on the receiver matches addresses that the service is listening on with the address on the message.</span></span> <span data-ttu-id="8f2d5-137">Adresler eşleşiyorsa ileti gönderilir; Aksi takdirde ileti gönderilir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-137">If the addresses match, the message is dispatched; if not, the message is not dispatched.</span></span> <span data-ttu-id="8f2d5-138">Bu, atılacak ileti sırasındaki iletiler genellikle teslim edilemeyen ileti sırası hizmetine değil hizmete değinilmesi nedeniyle, atılacak ileti sırasından okurken soruna neden olabilir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-138">This can cause problems when reading from the dead-letter queue, because messages in the dead-letter queue are typically addressed to the service and not the dead-letter queue service.</span></span> <span data-ttu-id="8f2d5-139">Bu nedenle, atılacak ileti sırasından okuma hizmeti, yığının, kümeden `ServiceBehavior` bağımsız olarak kuyruktaki tüm iletileri eşleşmesini sağlayan bir adres filtresi yüklemelidir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-139">Therefore, the service reading from the dead-letter queue must install an address filter `ServiceBehavior` that instructs the stack to match all messages in the queue independently of the addressee.</span></span> <span data-ttu-id="8f2d5-140">Özellikle, `ServiceBehavior` <xref:System.ServiceModel.AddressFilterMode.Any> atılacak ileti sırasından iletileri okumak için parametresi ile bir olarak eklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-140">Specifically, you must add a `ServiceBehavior` with the <xref:System.ServiceModel.AddressFilterMode.Any> parameter to the service reading messages from the dead-letter queue.</span></span>  
  
## <a name="poison-message-handling-from-the-dead-letter-queue"></a><span data-ttu-id="8f2d5-141">Dead-Letter sırasından zarar Iletisi Işleme</span><span class="sxs-lookup"><span data-stu-id="8f2d5-141">Poison Message Handling from the Dead-Letter Queue</span></span>  

 <span data-ttu-id="8f2d5-142">Zarar iletisi işleme, bazı koşullarla, atılacak ileti sıralarında kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-142">Poison message handling is available on dead-letter queues, with some conditions.</span></span> <span data-ttu-id="8f2d5-143">Sistem kuyruklarından alt sıralar oluşturabilmeniz için, sistem atılacak ileti sırasından okurken `ReceiveErrorHandling` olarak ayarlanamaz `Move` .</span><span class="sxs-lookup"><span data-stu-id="8f2d5-143">Because you cannot create sub-queues from system queues, when reading from the system dead-letter queue, the `ReceiveErrorHandling` cannot be set to `Move`.</span></span> <span data-ttu-id="8f2d5-144">Özel bir atılacak mektup sırasından okuyorsanız, alt kuyruklara sahip olabilirsiniz ve bu nedenle, `Move` zarar iletisi için geçerli bir değerlendirme olduğunu unutmayın.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-144">Note that if you are reading from a custom dead-letter queue, you can have sub-queues and, therefore, `Move` is a valid disposition for the poison message.</span></span>  
  
 <span data-ttu-id="8f2d5-145">`ReceiveErrorHandling`, Olarak ayarlandığında `Reject` , özel atılacak mektup sırasından okurken, zarar iletisi sistem atılacak ileti kuyruğuna konur.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-145">When `ReceiveErrorHandling` is set to `Reject`, when reading from the custom dead letter queue, the poison message is put in the system dead-letter queue.</span></span> <span data-ttu-id="8f2d5-146">Sistem teslim edilemeyen ileti sırasından okurken ileti bırakılır (temizlendi).</span><span class="sxs-lookup"><span data-stu-id="8f2d5-146">If reading from the system dead-letter queue, the message is dropped (purged).</span></span> <span data-ttu-id="8f2d5-147">MSMQ 'da bir sistem atılacak ileti sırasından reddetme, iletiyi bırakır (temizler).</span><span class="sxs-lookup"><span data-stu-id="8f2d5-147">A reject from a system dead-letter queue in MSMQ drops (purges) the message.</span></span>  
  
## <a name="example"></a><span data-ttu-id="8f2d5-148">Örnek</span><span class="sxs-lookup"><span data-stu-id="8f2d5-148">Example</span></span>  

 <span data-ttu-id="8f2d5-149">Aşağıdaki örnek, bir atılacak ileti sırasının nasıl oluşturulduğunu ve süre sonu iletileri işlemek için nasıl kullanılacağını gösterir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-149">The following example shows how to create a dead-letter queue and how to use it to process expired messages.</span></span> <span data-ttu-id="8f2d5-150">Örnek, [nasıl yapılır: WCF uç noktaları Ile sıraya alınmış Iletileri Exchange ile](how-to-exchange-queued-messages-with-wcf-endpoints.md)ilgili örneğe dayanır.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-150">The example is based on the example in [How to: Exchange Queued Messages with WCF Endpoints](how-to-exchange-queued-messages-with-wcf-endpoints.md).</span></span> <span data-ttu-id="8f2d5-151">Aşağıdaki örnek, her bir uygulama için bir atılacak ileti sırası kullanan sipariş işleme hizmetine istemci kodunun nasıl yazılacağını gösterir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-151">The following example shows how to write the client code to the order processing service that uses a dead-letter queue for each application.</span></span> <span data-ttu-id="8f2d5-152">Örnek ayrıca, teslim edilemeyen ileti sırasından iletileri nasıl işleyeceğini gösterir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-152">The example also shows how to process messages from the dead-letter queue.</span></span>  
  
 <span data-ttu-id="8f2d5-153">Aşağıda, her bir uygulama için atılacak ileti sırası belirten bir istemcinin kodu verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-153">The following is code for a client that specifies a dead-letter queue for each application.</span></span>  
  
 [!code-csharp[S_DeadLetter#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/s_deadletter/cs/client.cs#1)]
 [!code-vb[S_DeadLetter#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_deadletter/vb/client.vb#1)]  
  
 <span data-ttu-id="8f2d5-154">İstemci yapılandırma dosyasının kodu aşağıda verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-154">The following is code for the client configuration file.</span></span>  

 <span data-ttu-id="8f2d5-155">Aşağıda, bir hizmet işlem iletilerinin atılacak ileti sırasından kodu verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-155">The following is code for a service processing messages from a dead-letter queue.</span></span>  
  
 [!code-csharp[S_DeadLetter#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/s_deadletter/cs/dlservice.cs#3)]
 [!code-vb[S_DeadLetter#3](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_deadletter/vb/dlservice.vb#3)]  
  
 <span data-ttu-id="8f2d5-156">Aşağıda, atılacak ileti sırası hizmeti yapılandırma dosyasının kodu verilmiştir.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-156">The following is code for the dead-letter queue service configuration file.</span></span>  

## <a name="see-also"></a><span data-ttu-id="8f2d5-157">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="8f2d5-157">See also</span></span>

- [<span data-ttu-id="8f2d5-158">Kuyruklar Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="8f2d5-158">Queues Overview</span></span>](queues-overview.md)
- [<span data-ttu-id="8f2d5-159">Nasıl yapılır: WCF Uç Noktaları ile Kuyruğa Alınan İletileri Gönderme ve Alma</span><span class="sxs-lookup"><span data-stu-id="8f2d5-159">How to: Exchange Queued Messages with WCF Endpoints</span></span>](how-to-exchange-queued-messages-with-wcf-endpoints.md)
- [<span data-ttu-id="8f2d5-160">Zehirli İleti İşleme</span><span class="sxs-lookup"><span data-stu-id="8f2d5-160">Poison Message Handling</span></span>](poison-message-handling.md)
