---
title: Web Hizmetleri ile LINQ to SQL N Katmanı
ms.date: 03/30/2017
ms.assetid: 9cb10eb8-957f-4beb-a271-5f682016fed2
ms.openlocfilehash: dd1f756fae99fbae591b27aaefc7cc4ad7501bd6
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 09/24/2020
ms.locfileid: "91175297"
---
# <a name="linq-to-sql-n-tier-with-web-services"></a><span data-ttu-id="d95cc-102">Web Hizmetleri ile LINQ to SQL N Katmanı</span><span class="sxs-lookup"><span data-stu-id="d95cc-102">LINQ to SQL N-Tier with Web Services</span></span>

[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="d95cc-103">, özellikle de Web hizmeti gibi gevşek bağlanmış bir veri erişim katmanında (DAL) Orta katmanda kullanılmak üzere tasarlanmıştır.</span><span class="sxs-lookup"><span data-stu-id="d95cc-103">is designed especially for use on the middle tier in a loosely-coupled data access layer (DAL) such as a Web service.</span></span> <span data-ttu-id="d95cc-104">Sunu katmanı bir ASP.NET Web sayfasındaysa, <xref:System.Web.UI.WebControls.LinqDataSource> Kullanıcı arabirimi ve orta katman arasında veri aktarımını yönetmek için Web sunucusu denetimini kullanabilirsiniz [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d95cc-104">If the presentation tier is an ASP.NET Web page, then you use the <xref:System.Web.UI.WebControls.LinqDataSource> Web server control to manage the data transfer between the user interface and [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] on the middle-tier.</span></span> <span data-ttu-id="d95cc-105">Sunu katmanı bir ASP.NET sayfası değilse, hem orta katman hem de sunum katmanının, verilerin serileştirilmesi ve serisini kaldırma işini yönetmesi için bazı ek işler yapması gerekir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-105">If the presentation tier is not an ASP.NET page, then both the middle-tier and the presentation tier must do some additional work to manage the serialization and deserialization of data.</span></span>  
  
## <a name="setting-up-linq-to-sql-on-the-middle-tier"></a><span data-ttu-id="d95cc-106">Orta katmanda LINQ to SQL ayarlama</span><span class="sxs-lookup"><span data-stu-id="d95cc-106">Setting up LINQ to SQL on the Middle Tier</span></span>  

 <span data-ttu-id="d95cc-107">Bir Web hizmeti veya n katmanlı uygulamada, orta katman veri bağlamını ve varlık sınıflarını içerir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-107">In a Web service or n-tier application, the middle tier contains the data context and the entity classes.</span></span> <span data-ttu-id="d95cc-108">Bu sınıfları el ile veya SQLMetal.exe ya da Nesne İlişkisel Tasarımcısı kullanarak belgelerde başka bir yerde açıklandığı şekilde oluşturabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d95cc-108">You can create these classes manually, or by using either SQLMetal.exe or the Object Relational Designer as described elsewhere in the documentation.</span></span> <span data-ttu-id="d95cc-109">Tasarım zamanında, varlık sınıflarını seri hale getirilebilir hale getirme seçeneğiniz vardır.</span><span class="sxs-lookup"><span data-stu-id="d95cc-109">At design time, you have the option to make the entity classes serializable.</span></span> <span data-ttu-id="d95cc-110">Daha fazla bilgi için bkz. [nasıl yapılır: varlıkları seri hale getirme](how-to-make-entities-serializable.md).</span><span class="sxs-lookup"><span data-stu-id="d95cc-110">For more information, see [How to: Make Entities Serializable](how-to-make-entities-serializable.md).</span></span> <span data-ttu-id="d95cc-111">Başka bir seçenek de, seri hale getirilecek verileri kapsülleyen ayrı bir sınıf kümesi oluşturmak ve ardından LINQ sorgularınızda veri döndürdüğünüzde bu serileştirilebilir türler için proje oluşturmaktır.</span><span class="sxs-lookup"><span data-stu-id="d95cc-111">Another option is to create a separate set of classes that encapsulate the data to be serialized, and then project into those serializable types when you return data in your LINQ queries.</span></span>  
  
 <span data-ttu-id="d95cc-112">Daha sonra arabirimi, istemcilerin verileri almak, eklemek ve güncelleştirmek için çağıracağının yöntemleriyle tanımlarsınız.</span><span class="sxs-lookup"><span data-stu-id="d95cc-112">You then define the interface with the methods that the clients will call to retrieve, insert and update data.</span></span> <span data-ttu-id="d95cc-113">Arabirim yöntemleri LINQ sorgularınızı sarlar.</span><span class="sxs-lookup"><span data-stu-id="d95cc-113">The interface methods wrap your LINQ queries.</span></span> <span data-ttu-id="d95cc-114">Uzak yöntem çağrılarını ve verilerin serileştirmesini işlemek için herhangi bir tür serileştirme mekanizması kullanabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="d95cc-114">You can use any kind of serialization mechanism to handle the remote method calls and the serialization of data.</span></span> <span data-ttu-id="d95cc-115">Tek gereksinim, nesne modelinizde standart Northwind nesne modelindeki müşteriler ve siparişler arasındaki döngüsel veya çift yönlü ilişklarınız varsa, bunu destekleyen bir serileştirici kullanmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-115">The only requirement is that if you have cyclic or bi-directional relationships in your object model, such as that between Customers and Orders in the standard Northwind object model, then you must use a serializer that supports it.</span></span> <span data-ttu-id="d95cc-116">Windows Communication Foundation (WCF) <xref:System.Runtime.Serialization.DataContractSerializer> çift yönlü ilişkileri destekler, ancak WCF olmayan Web hizmetleriyle kullanılan XmlSerializer değildir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-116">The Windows Communication Foundation (WCF) <xref:System.Runtime.Serialization.DataContractSerializer> supports bi-directional relationships but the XmlSerializer that is used with non-WCF Web services does not.</span></span> <span data-ttu-id="d95cc-117">XmlSerializer 'ı kullanmayı seçerseniz, nesne modelinizin döngüsel ilişki olmadığından emin olmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-117">If you select to use the XmlSerializer, then you must make sure that your object model has no cyclic relationships.</span></span>  
  
 <span data-ttu-id="d95cc-118">Windows Communication Foundation hakkında daha fazla bilgi için bkz. [Visual Studio 'da Windows Communication Foundation Hizmetleri ve WCF veri Hizmetleri](/visualstudio/data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="d95cc-118">For more information about Windows Communication Foundation, see [Windows Communication Foundation Services and WCF Data Services in Visual Studio](/visualstudio/data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio).</span></span>  
  
 <span data-ttu-id="d95cc-119"><xref:System.Data.Linq.DataContext>Çalışma zamanı olaylarına bağlamak için ve varlık sınıflarında yer alan kısmi sınıfları ve yöntemleri kullanarak iş kurallarınızı veya diğer etki alanına özgü mantığınızı uygulayın [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d95cc-119">Implement your business rules or other domain-specific logic by using the partial classes and methods on the <xref:System.Data.Linq.DataContext> and entity classes to hook into [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] runtime events.</span></span> <span data-ttu-id="d95cc-120">Daha fazla bilgi için, bkz. [N katmanlı Iş mantığını uygulama](implementing-business-logic-linq-to-sql.md).</span><span class="sxs-lookup"><span data-stu-id="d95cc-120">For more information, see [Implementing N-Tier Business Logic](implementing-business-logic-linq-to-sql.md).</span></span>  
  
## <a name="defining-the-serializable-types"></a><span data-ttu-id="d95cc-121">Serileştirilebilir türleri tanımlama</span><span class="sxs-lookup"><span data-stu-id="d95cc-121">Defining the Serializable Types</span></span>  

 <span data-ttu-id="d95cc-122">İstemci veya sunu katmanının, orta katmandan alacak sınıflar için tür tanımlarına sahip olması gerekir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-122">The client or presentation tier must have type definitions for the classes that it will be receiving from the middle tier.</span></span> <span data-ttu-id="d95cc-123">Bu türler, varlık sınıflarının kendileri veya yalnızca belirli alanları, uzaktan iletişim için varlık sınıflarından sarmaya yönelik özel sınıflar olabilir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-123">Those types may be the entity classes themselves, or special classes that wrap only certain fields from the entity classes for remoting.</span></span> <span data-ttu-id="d95cc-124">Herhangi bir durumda, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] sunum katmanının bu tür tanımlarını nasıl edindiğini tamamen ortadan kaldırmamışlar.</span><span class="sxs-lookup"><span data-stu-id="d95cc-124">In any case, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] is completely unconcerned about how the presentation tier acquires those type definitions.</span></span> <span data-ttu-id="d95cc-125">Örneğin, sunu katmanı, türleri otomatik olarak oluşturmak için WCF kullanabilir veya bu türlerin tanımlandığı DLL 'nin bir kopyası olabilir ya da yalnızca kendi türlerin kendi sürümlerini tanımlayabilir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-125">For example, the presentation tier could use WCF to generate the types automatically, or it could have a copy of a DLL in which those types are defined, or it could just define its own versions of the types.</span></span>  
  
## <a name="retrieving-and-inserting-data"></a><span data-ttu-id="d95cc-126">Verileri alma ve ekleme</span><span class="sxs-lookup"><span data-stu-id="d95cc-126">Retrieving and Inserting Data</span></span>  

 <span data-ttu-id="d95cc-127">Orta katman, sunum katmanının verilere nasıl eriştiğini belirten bir arabirim tanımlar.</span><span class="sxs-lookup"><span data-stu-id="d95cc-127">The middle tier defines an interface that specifies how the presentation tier accesses the data.</span></span> <span data-ttu-id="d95cc-128">Örneğin `GetProductByID(int productID)` , veya `GetCustomers()` .</span><span class="sxs-lookup"><span data-stu-id="d95cc-128">For example `GetProductByID(int productID)`, or `GetCustomers()`.</span></span> <span data-ttu-id="d95cc-129">Orta katmanda, Yöntem gövdesi genellikle yeni bir örneğini oluşturur <xref:System.Data.Linq.DataContext> , bir veya daha fazla tablosunda bir sorgu yürütür.</span><span class="sxs-lookup"><span data-stu-id="d95cc-129">On the middle tier, the method body typically creates a new instance of the <xref:System.Data.Linq.DataContext>, executes a query against one or more of its table.</span></span> <span data-ttu-id="d95cc-130">Daha sonra orta katman sonucu <xref:System.Collections.Generic.IEnumerable%601> , bir `T` varlık sınıfı ya da serileştirme için kullanılan başka bir tür olan olarak döndürür.</span><span class="sxs-lookup"><span data-stu-id="d95cc-130">The middle tier then returns the result as an <xref:System.Collections.Generic.IEnumerable%601>, where `T` is either an entity class or another type that is used for serialization.</span></span> <span data-ttu-id="d95cc-131">Sunu katmanı hiçbir şekilde doğrudan orta katmana sorgu değişkenleri göndermez veya almaz.</span><span class="sxs-lookup"><span data-stu-id="d95cc-131">The presentation tier never sends or receives query variables directly to or from the middle tier.</span></span> <span data-ttu-id="d95cc-132">İki katmanda değer, nesne ve somut veri koleksiyonları değiş tokuş.</span><span class="sxs-lookup"><span data-stu-id="d95cc-132">The two tiers exchange values, objects, and collections of concrete data.</span></span> <span data-ttu-id="d95cc-133">Bir koleksiyon aldıktan sonra, sunum katmanı gerekirse sorgulamak için LINQ to Objects kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-133">After it has received a collection, the presentation tier can use LINQ to Objects to query it if necessary.</span></span>  
  
 <span data-ttu-id="d95cc-134">Veri eklenirken sunum katmanı yeni bir nesne oluşturabilir ve bunu Orta katmana gönderebilir ya da orta katman, sağladığı değerlere göre nesneyi oluşturabilir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-134">When inserting data, the presentation tier can construct a new object and send it to the middle tier, or it can have the middle tier construct the object based on values that it provides.</span></span> <span data-ttu-id="d95cc-135">Genel olarak, n katmanlı uygulamalarda veri alma ve ekleme işlemi, 2 katmanlı uygulamalardaki işlemden çok farklı değildir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-135">In general, retrieving and inserting data in n-tier applications does not differ much from the process in 2-tier applications.</span></span> <span data-ttu-id="d95cc-136">Daha fazla bilgi için bkz. [Veritabanını sorgulama](querying-the-database.md) ve [veri değişikliklerini oluşturma ve gönderme](making-and-submitting-data-changes.md).</span><span class="sxs-lookup"><span data-stu-id="d95cc-136">For more information, see [Querying the Database](querying-the-database.md) and [Making and Submitting Data Changes](making-and-submitting-data-changes.md).</span></span>  
  
## <a name="tracking-changes-for-updates-and-deletes"></a><span data-ttu-id="d95cc-137">Güncelleştirmeler ve silmeler için değişiklikleri izleme</span><span class="sxs-lookup"><span data-stu-id="d95cc-137">Tracking Changes for Updates and Deletes</span></span>  

 [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="d95cc-138">, zaman damgalarına (RowVersions olarak da adlandırılır) ve özgün değerlere göre iyimser eşzamanlılık destekler.</span><span class="sxs-lookup"><span data-stu-id="d95cc-138">supports optimistic concurrency based on timestamps (also named RowVersions) and on original values.</span></span> <span data-ttu-id="d95cc-139">Veritabanı tablolarında zaman damgaları varsa, güncelleştirmeler ve silmeler, orta katman veya sunu katmanında çok fazla iş gerektirir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-139">If the database tables have timestamps, then updates and deletions require little extra work on either the middle-tier or presentation tier.</span></span> <span data-ttu-id="d95cc-140">Ancak, iyimser eşzamanlılık denetimleri için özgün değerleri kullanmanız gerekiyorsa, sunu katmanı bu değerleri izlemekten ve güncelleştirme yaptığında geri göndermekten sorumludur.</span><span class="sxs-lookup"><span data-stu-id="d95cc-140">However, if you must use original values for optimistic concurrency checks, then the presentation tier is responsible for tracking those values and sending them back when it makes updates.</span></span> <span data-ttu-id="d95cc-141">Bunun nedeni, sunum katmanındaki varlıklarda yapılan değişikliklerin Orta katmanda izlenmemesi nedeniyle oluşur.</span><span class="sxs-lookup"><span data-stu-id="d95cc-141">This is because changes that were made to entities on the presentation tier are not tracked on the middle tier.</span></span> <span data-ttu-id="d95cc-142">Aslında, bir varlığın özgün alımı ve kendisine yapılan son güncelleştirme genellikle iki ayrı farklı örnek tarafından gerçekleştirilir <xref:System.Data.Linq.DataContext> .</span><span class="sxs-lookup"><span data-stu-id="d95cc-142">In fact, the original retrieval of an entity, and the eventual update made to it are typically performed by two completely separate instances of the <xref:System.Data.Linq.DataContext>.</span></span>  
  
 <span data-ttu-id="d95cc-143">Sunu katmanının yaptığı değişikliklerin sayısı arttıkça, bu değişiklikleri izlemek ve ortadaki katmana geri paketlemek için de daha karmaşık hale gelir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-143">The greater the number of changes that the presentation tier makes, the more complex it becomes to track those changes and package them back to the middle tier.</span></span> <span data-ttu-id="d95cc-144">Değişiklikleri iletişim için bir mekanizmanın uygulanması, uygulamaya tamamen yöneliktir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-144">The implementation of a mechanism for communicating changes is completely up to the application.</span></span> <span data-ttu-id="d95cc-145">Tek gereksinim, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] iyimser eşzamanlılık denetimleri için gerekli olan özgün değerler verilmelidir.</span><span class="sxs-lookup"><span data-stu-id="d95cc-145">The only requirement is that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] must be given those original values that are required for optimistic concurrency checks.</span></span>  
  
 <span data-ttu-id="d95cc-146">Daha fazla bilgi için, bkz. [N katmanlı uygulamalarda veri alma ve CUD işlemleri (LINQ to SQL)](data-retrieval-and-cud-operations-in-n-tier-applications.md).</span><span class="sxs-lookup"><span data-stu-id="d95cc-146">For more information, see [Data Retrieval and CUD Operations in N-Tier Applications (LINQ to SQL)](data-retrieval-and-cud-operations-in-n-tier-applications.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d95cc-147">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="d95cc-147">See also</span></span>

- [<span data-ttu-id="d95cc-148">LINQ to SQL ile N Katmanı ve Uzak Uygulamalar</span><span class="sxs-lookup"><span data-stu-id="d95cc-148">N-Tier and Remote Applications with LINQ to SQL</span></span>](n-tier-and-remote-applications-with-linq-to-sql.md)
- <span data-ttu-id="d95cc-149">[LinqDataSource Web sunucusu denetimine genel bakış](/previous-versions/aspnet/bb547113(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="d95cc-149">[LinqDataSource Web Server Control Overview](/previous-versions/aspnet/bb547113(v=vs.100))</span></span>
