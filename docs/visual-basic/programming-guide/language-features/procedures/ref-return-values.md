---
description: 'Hakkında daha fazla bilgi edinin: başvuru dönüş değerleri için destek (Visual Basic)'
title: Başvuru dönüş değerleri
ms.date: 04/28/2017
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
ms.openlocfilehash: 215a647c68eb7eadd394a1a7842ceb98c46e04a5
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 02/14/2021
ms.locfileid: "100466555"
---
# <a name="support-for-reference-return-values-visual-basic"></a><span data-ttu-id="9f978-103">Başvuru dönüş değerleri için destek (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="9f978-103">Support for reference return values (Visual Basic)</span></span>

<span data-ttu-id="9f978-104">C# 7,0 ile başlayarak, C# dili *Başvuru dönüş değerlerini* destekler.</span><span class="sxs-lookup"><span data-stu-id="9f978-104">Starting with C# 7.0, the C# language supports *reference return values*.</span></span> <span data-ttu-id="9f978-105">Başvuru dönüş değerlerini anlamanın bir yolu, bir yönteme başvuruya göre geçirilen bağımsız değişkenlerin tersidir.</span><span class="sxs-lookup"><span data-stu-id="9f978-105">One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method.</span></span> <span data-ttu-id="9f978-106">Başvuruya göre geçirilen bir bağımsız değişken değiştirildiğinde, değişiklikler çağıranın değişkeninin değerine yansıtılır.</span><span class="sxs-lookup"><span data-stu-id="9f978-106">When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller.</span></span> <span data-ttu-id="9f978-107">Bir yöntem bir çağırana bir başvuru dönüş değeri sağlıyorsa, çağıran tarafından başvuru dönüş değeri yapılan değişiklikler çağrılan metodun verilerinde yansıtılır.</span><span class="sxs-lookup"><span data-stu-id="9f978-107">When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.</span></span>

<span data-ttu-id="9f978-108">Visual Basic, başvuru dönüş değerleri olan Yöntemler yazmanıza izin vermez, ancak başvuru dönüş değerlerini kullanmanıza izin verir.</span><span class="sxs-lookup"><span data-stu-id="9f978-108">Visual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values.</span></span> <span data-ttu-id="9f978-109">Diğer bir deyişle, başvuru dönüş değeri olan bir yöntemi çağırabilir ve bu dönüş değerini değiştirebilir ve başvuru dönüş değerindeki değişiklikler çağrılan metodun verilerinde yansıtılır.</span><span class="sxs-lookup"><span data-stu-id="9f978-109">In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.</span></span>

## <a name="modifying-the-ref-return-value-directly"></a><span data-ttu-id="9f978-110">Başvuru dönüş değerini doğrudan değiştirme</span><span class="sxs-lookup"><span data-stu-id="9f978-110">Modifying the ref return value directly</span></span>

<span data-ttu-id="9f978-111">Her zaman başarılı olan ve parametresi olmayan yöntemler için `ByRef` Başvuru dönüş değerini doğrudan değiştirebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9f978-111">For methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly.</span></span> <span data-ttu-id="9f978-112">Bunu, başvuru dönüş değeri döndüren deyimlere yeni değeri atayarak yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="9f978-112">You do this by assigning the new value to the expressions that returns the reference return value.</span></span>

<span data-ttu-id="9f978-113">Aşağıdaki C# örneği, bir `NumericValue.IncrementValue` iç değeri artıran ve başvuru dönüş değeri olarak döndüren bir yöntemi tanımlar.</span><span class="sxs-lookup"><span data-stu-id="9f978-113">The following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

<span data-ttu-id="9f978-114">Başvuru dönüş değeri daha sonra aşağıdaki Visual Basic örneğinde çağıran tarafından değiştirilir.</span><span class="sxs-lookup"><span data-stu-id="9f978-114">The reference return value is then modified by the caller in the following Visual Basic example.</span></span> <span data-ttu-id="9f978-115">`NumericValue.IncrementValue`Yöntem çağrısını içeren satırın yöntemine bir değer atamayacağını unutmayın.</span><span class="sxs-lookup"><span data-stu-id="9f978-115">Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method.</span></span> <span data-ttu-id="9f978-116">Bunun yerine, yöntemi tarafından döndürülen başvuru dönüş değerine bir değer atar.</span><span class="sxs-lookup"><span data-stu-id="9f978-116">Instead, it assigns a value to the reference return value returned by the method.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a><span data-ttu-id="9f978-117">Yardımcı yöntemi kullanma</span><span class="sxs-lookup"><span data-stu-id="9f978-117">Using a helper method</span></span>

<span data-ttu-id="9f978-118">Diğer durumlarda, doğrudan yöntem çağrısının başvuru dönüş değerini değiştirmek her zaman istenmeyebilir.</span><span class="sxs-lookup"><span data-stu-id="9f978-118">In other cases, modifying the reference return value of a method call directly may not always be desirable.</span></span> <span data-ttu-id="9f978-119">Örneğin, bir dize döndüren arama yöntemi her zaman bir eşleşme bulmayabilir.</span><span class="sxs-lookup"><span data-stu-id="9f978-119">For example, a search method that returns a string may not always find a match.</span></span> <span data-ttu-id="9f978-120">Bu durumda, başvuru dönüş değerini yalnızca arama başarılı olursa değiştirmek istersiniz.</span><span class="sxs-lookup"><span data-stu-id="9f978-120">In that case, you want to modify the reference return value only if the search is successful.</span></span>

<span data-ttu-id="9f978-121">Aşağıdaki C# örneği bu senaryoyu göstermektedir.</span><span class="sxs-lookup"><span data-stu-id="9f978-121">The following C# example illustrates this scenario.</span></span> <span data-ttu-id="9f978-122">C# dilinde yazılmış bir sınıfı tanımlar, belirtilen bir alt `Sentence` `FindNext` dizeyle başlayan bir tümcede bulunan sonraki kelimeyi bulan bir yöntemi içerir.</span><span class="sxs-lookup"><span data-stu-id="9f978-122">It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring.</span></span> <span data-ttu-id="9f978-123">Dize bir başvuru dönüş değeri olarak döndürülür ve `Boolean` yöntemine başvuruya göre geçirilen bir değişken aramanın başarılı olup olmadığını gösterir.</span><span class="sxs-lookup"><span data-stu-id="9f978-123">The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful.</span></span> <span data-ttu-id="9f978-124">Başvuru dönüş değeri, döndürülen değeri okumayla ilgili ek olarak, çağıranın da değiştiremeyeceğini ve bu değişikliğin sınıfta dahili olarak bulunan verilere yansıtıldığını gösterir `Sentence` .</span><span class="sxs-lookup"><span data-stu-id="9f978-124">The reference return value indicates that in addition to reading the returned value, the caller can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

<span data-ttu-id="9f978-125">Bu durumda başvuru dönüş değerini doğrudan değiştirmek güvenilir değildir, çünkü Yöntem çağrısı bir eşleşme bulamamasına ve tümcedeki ilk sözcüğü döndürmeyebilir.</span><span class="sxs-lookup"><span data-stu-id="9f978-125">Directly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence.</span></span> <span data-ttu-id="9f978-126">Bu durumda, çağıran, tümcenin ilk sözcüğünü yanlışlıkla değiştirmeyecektir.</span><span class="sxs-lookup"><span data-stu-id="9f978-126">In that case, the caller will inadvertently modify the first word of the sentence.</span></span> <span data-ttu-id="9f978-127">Bu, çağıran tarafından `null` (veya Visual Basic) döndürülürken engellenebilir `Nothing` .</span><span class="sxs-lookup"><span data-stu-id="9f978-127">This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic).</span></span> <span data-ttu-id="9f978-128">Ancak bu durumda, değeri bir olan bir dizeyi değiştirme girişimi `Nothing` <xref:System.NullReferenceException> .</span><span class="sxs-lookup"><span data-stu-id="9f978-128">But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>.</span></span> <span data-ttu-id="9f978-129">Çağıran tarafından da engellenebilir <xref:System.String.Empty?displayProperty=nameWithType> , ancak bu, çağıranın değeri olan bir dize değişkeni tanımlamasına gerek duyar <xref:System.String.Empty?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="9f978-129">If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=nameWithType>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span> <span data-ttu-id="9f978-130">Çağıran bu dizeyi değiştire, ancak değiştirilen dizenin sınıf tarafından depolanan tümcedeki sözcüklerle hiçbir ilişkisi olmadığından, değişikliğin kendisi bir amaca hizmet eder `Sentence` .</span><span class="sxs-lookup"><span data-stu-id="9f978-130">While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class.</span></span>

<span data-ttu-id="9f978-131">Bu senaryoyu işlemenin en iyi yolu, başvuru dönüş değerini bir yardımcı yönteme başvuruya göre geçirmektir.</span><span class="sxs-lookup"><span data-stu-id="9f978-131">The best way to handle this scenario is to pass the reference return value by reference to a helper method.</span></span> <span data-ttu-id="9f978-132">Yardımcı yöntemi daha sonra yöntem çağrısının başarılı olup olmadığını ve başvuru dönüş değerini değiştirmek için bir mantığı içerir.</span><span class="sxs-lookup"><span data-stu-id="9f978-132">The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value.</span></span> <span data-ttu-id="9f978-133">Aşağıdaki örnek olası bir uygulama sağlar.</span><span class="sxs-lookup"><span data-stu-id="9f978-133">The following example provides a possible implementation.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a><span data-ttu-id="9f978-134">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="9f978-134">See also</span></span>

- [<span data-ttu-id="9f978-135">Bağımsız değişkenleri değere ve başvuruya göre geçirme</span><span class="sxs-lookup"><span data-stu-id="9f978-135">Passing arguments by value and by reference</span></span>](passing-arguments-by-value-and-by-reference.md)
- [<span data-ttu-id="9f978-136">Visual Basic'te Yordamlar</span><span class="sxs-lookup"><span data-stu-id="9f978-136">Procedures in Visual Basic</span></span>](index.md)
