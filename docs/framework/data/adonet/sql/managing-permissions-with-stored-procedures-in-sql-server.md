---
title: SQL Server'da Saklı Yordam İzinlerini Yönetme
description: Saklı yordamları veya Kullanıcı tanımlı işlevleri kullanarak erişim uygulayarak verilerinize ve veritabanı nesneleriniz için erişimi nasıl kısıtlayacağınızı öğrenin.
ms.date: 03/30/2017
ms.assetid: 08fa34e8-2ffa-470d-ba62-e511a5f8558e
ms.openlocfilehash: 890c1c6dd7003f3abd684d6c827b6a77a3a019c1
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 06/02/2020
ms.locfileid: "84286294"
---
# <a name="managing-permissions-with-stored-procedures-in-sql-server"></a><span data-ttu-id="6eed1-103">SQL Server'da Saklı Yordam İzinlerini Yönetme</span><span class="sxs-lookup"><span data-stu-id="6eed1-103">Managing Permissions with Stored Procedures in SQL Server</span></span>
<span data-ttu-id="6eed1-104">Veritabanınızda birden çok savunma hattı oluşturmanın bir yöntemi, saklı yordamları veya Kullanıcı tanımlı işlevleri kullanarak tüm veri erişimini uygulamaktır.</span><span class="sxs-lookup"><span data-stu-id="6eed1-104">One method of creating multiple lines of defense around your database is to implement all data access using stored procedures or user-defined functions.</span></span> <span data-ttu-id="6eed1-105">Tablolar gibi temeldeki nesneler için tüm izinleri iptal eder veya reddeder ve saklı yordamlarda yürütme izinleri verir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-105">You revoke or deny all permissions to underlying objects, such as tables, and grant EXECUTE permissions on stored procedures.</span></span> <span data-ttu-id="6eed1-106">Bu, veri ve veritabanı nesneleriniz etrafında etkin bir güvenlik çevresi oluşturur.</span><span class="sxs-lookup"><span data-stu-id="6eed1-106">This effectively creates a security perimeter around your data and database objects.</span></span>  
  
## <a name="stored-procedure-benefits"></a><span data-ttu-id="6eed1-107">Saklı yordam avantajları</span><span class="sxs-lookup"><span data-stu-id="6eed1-107">Stored Procedure Benefits</span></span>  
 <span data-ttu-id="6eed1-108">Saklı yordamlar aşağıdaki avantajlara sahiptir:</span><span class="sxs-lookup"><span data-stu-id="6eed1-108">Stored procedures have the following benefits:</span></span>  
  
- <span data-ttu-id="6eed1-109">Veri mantığı ve iş kuralları, kullanıcıların veri ve nesnelere yalnızca geliştiricilerin ve veritabanı yöneticilerinin tarafından istenen şekilde erişebilmeleri için kapsüllenebilir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-109">Data logic and business rules can be encapsulated so that users can access data and objects only in ways that developers and database administrators intend.</span></span>  
  
- <span data-ttu-id="6eed1-110">Tüm Kullanıcı girişlerini doğrulayan parametreli saklı yordamlar, SQL ekleme saldırılarını sağlamak için kullanılabilir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-110">Parameterized stored procedures that validate all user input can be used to thwart SQL injection attacks.</span></span> <span data-ttu-id="6eed1-111">Dinamik SQL kullanıyorsanız, komutlarınızı parametreleştirilediğinizden ve parametre değerlerini hiçbir şekilde doğrudan bir sorgu dizesine eklemeyin.</span><span class="sxs-lookup"><span data-stu-id="6eed1-111">If you use dynamic SQL, be sure to parameterize your commands, and never include parameter values directly into a query string.</span></span>  
  
- <span data-ttu-id="6eed1-112">Geçici sorgulara ve veri değişikliklerine izin verilmez.</span><span class="sxs-lookup"><span data-stu-id="6eed1-112">Ad hoc queries and data modifications can be disallowed.</span></span> <span data-ttu-id="6eed1-113">Bu, kullanıcıların kötü amaçlı veya istenmeden veri yok etmesini ya da sunucu veya ağ üzerindeki performansa zarar veren sorguları yürütmesini engeller.</span><span class="sxs-lookup"><span data-stu-id="6eed1-113">This prevents users from maliciously or inadvertently destroying data or executing queries that impair performance on the server or the network.</span></span>  
  
- <span data-ttu-id="6eed1-114">Hatalar, doğrudan istemci uygulamalarına geçirilmeden yordam kodunda işlenebilir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-114">Errors can be handled in procedure code without being passed directly to client applications.</span></span> <span data-ttu-id="6eed1-115">Bu, bir yoklama saldırısında yardımcı olabilecek hata iletilerinin döndürülmesini önler.</span><span class="sxs-lookup"><span data-stu-id="6eed1-115">This prevents error messages from being returned that could aid in a probing attack.</span></span> <span data-ttu-id="6eed1-116">Hataları günlüğe kaydedin ve sunucuda işleyin.</span><span class="sxs-lookup"><span data-stu-id="6eed1-116">Log errors and handle them on the server.</span></span>  
  
- <span data-ttu-id="6eed1-117">Saklı yordamlar bir kez yazılabilir ve birçok uygulama tarafından erişilebilir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-117">Stored procedures can be written once, and accessed by many applications.</span></span>  
  
- <span data-ttu-id="6eed1-118">İstemci uygulamaların, temel alınan veri yapıları hakkında herhangi bir şeyi bilmeleri gerekmez.</span><span class="sxs-lookup"><span data-stu-id="6eed1-118">Client applications do not need to know anything about the underlying data structures.</span></span> <span data-ttu-id="6eed1-119">Saklı yordam kodu, değişiklikler parametre listelerini veya döndürülen veri türlerini etkilemediği sürece istemci uygulamalarında değişiklik gerektirmeden değiştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-119">Stored procedure code can be changed without requiring changes in client applications as long as the changes do not affect parameter lists or returned data types.</span></span>  
  
- <span data-ttu-id="6eed1-120">Saklı yordamlar, birden çok işlemi tek bir yordam çağrısında birleştirerek ağ trafiğini azaltabilir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-120">Stored procedures can reduce network traffic by combining multiple operations into one procedure call.</span></span>  
  
## <a name="stored-procedure-execution"></a><span data-ttu-id="6eed1-121">Saklı yordam yürütme</span><span class="sxs-lookup"><span data-stu-id="6eed1-121">Stored Procedure Execution</span></span>  
 <span data-ttu-id="6eed1-122">Saklı yordamlar, kullanıcıların veritabanına erişim sağlamak için sahiplik zincirinden yararlanır ve böylece kullanıcılar veritabanı nesnelerine erişim için açık izne sahip olmaları gerekmez.</span><span class="sxs-lookup"><span data-stu-id="6eed1-122">Stored procedures take advantage of ownership chaining to provide access to data so that users do not need to have explicit permission to access database objects.</span></span> <span data-ttu-id="6eed1-123">Bir sahiplik zinciri birbirlerine her ardışık olarak erişen nesneler aynı kullanıcıya ait olduğunda oluşur.</span><span class="sxs-lookup"><span data-stu-id="6eed1-123">An ownership chain exists when objects that access each other sequentially are owned by the same user.</span></span> <span data-ttu-id="6eed1-124">Örneğin, saklı yordam diğer saklı yordamları çağırabilir veya saklı yordam birden fazla tabloya erişebilir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-124">For example, a stored procedure can call other stored procedures, or a stored procedure can access multiple tables.</span></span> <span data-ttu-id="6eed1-125">Yürütme zincirindeki tüm nesneler aynı sahibe sahip ise SQL Server, yalnızca arayan için yürütme iznini denetler, çağıranın diğer nesneler üzerindeki izinleri değildir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-125">If all objects in the chain of execution have the same owner, then SQL Server only checks the EXECUTE permission for the caller, not the caller's permissions on other objects.</span></span> <span data-ttu-id="6eed1-126">Bu nedenle, yalnızca saklı yordamlarda yürütme izinleri vermeniz gerekir; temel alınan tablolardaki tüm izinleri iptal edebilir veya reddedebilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="6eed1-126">Therefore you need to grant only EXECUTE permissions on stored procedures; you can revoke or deny all permissions on the underlying tables.</span></span>  
  
## <a name="best-practices"></a><span data-ttu-id="6eed1-127">En İyi Uygulamalar</span><span class="sxs-lookup"><span data-stu-id="6eed1-127">Best Practices</span></span>  
 <span data-ttu-id="6eed1-128">Saklı yordamları yazmak, uygulamanızı yeterince güvenli hale getirmek için yeterli değildir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-128">Simply writing stored procedures isn't enough to adequately secure your application.</span></span> <span data-ttu-id="6eed1-129">Ayrıca, aşağıdaki olası güvenlik boşluklarını de göz önünde bulundurmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-129">You should also consider the following potential security holes.</span></span>  
  
- <span data-ttu-id="6eed1-130">Verilere erişebilmek istediğiniz veritabanı rollerinin saklı yordamları üzerinde yürütme izinleri verin.</span><span class="sxs-lookup"><span data-stu-id="6eed1-130">Grant EXECUTE permissions on the stored procedures for database roles you want to be able to access the data.</span></span>  
  
- <span data-ttu-id="6eed1-131">Rol dahil olmak üzere veritabanındaki tüm roller ve kullanıcılar için temel alınan tabloların tüm izinlerini iptal edin veya reddedin `public` .</span><span class="sxs-lookup"><span data-stu-id="6eed1-131">Revoke or deny all permissions to the underlying tables for all roles and users in the database, including the `public` role.</span></span> <span data-ttu-id="6eed1-132">Tüm kullanıcılar izinleri herkese devralınır.</span><span class="sxs-lookup"><span data-stu-id="6eed1-132">All users inherit permissions from public.</span></span> <span data-ttu-id="6eed1-133">Bu nedenle, izinleri reddetme, `public` yalnızca sahiplerin ve `sysadmin` üyelerin erişimi olduğu anlamına gelir; diğer tüm kullanıcılar diğer rollerdeki üyelikle izinleri almayacaktır.</span><span class="sxs-lookup"><span data-stu-id="6eed1-133">Therefore denying permissions to `public` means that only owners and `sysadmin` members have access; all other users will be unable to inherit permissions from membership in other roles.</span></span>  
  
- <span data-ttu-id="6eed1-134">Veya rollerine Kullanıcı veya rol eklemeyin `sysadmin` `db_owner` .</span><span class="sxs-lookup"><span data-stu-id="6eed1-134">Do not add users or roles to the `sysadmin` or `db_owner` roles.</span></span> <span data-ttu-id="6eed1-135">Sistem yöneticileri ve veritabanı sahipleri, tüm veritabanı nesnelerine erişebilir.</span><span class="sxs-lookup"><span data-stu-id="6eed1-135">System administrators and database owners can access all database objects.</span></span>  
  
- <span data-ttu-id="6eed1-136">Hesabı devre dışı bırakın `guest` .</span><span class="sxs-lookup"><span data-stu-id="6eed1-136">Disable the `guest` account.</span></span> <span data-ttu-id="6eed1-137">Bu, anonim kullanıcıların veritabanına bağlanmasını engeller.</span><span class="sxs-lookup"><span data-stu-id="6eed1-137">This will prevent anonymous users from connecting to the database.</span></span> <span data-ttu-id="6eed1-138">Yeni veritabanlarında Konuk hesabı varsayılan olarak devre dışıdır.</span><span class="sxs-lookup"><span data-stu-id="6eed1-138">The guest account is disabled by default in new databases.</span></span>  
  
- <span data-ttu-id="6eed1-139">Hata işleme ve günlük hatalarını uygulayın.</span><span class="sxs-lookup"><span data-stu-id="6eed1-139">Implement error handling and log errors.</span></span>  
  
- <span data-ttu-id="6eed1-140">Tüm Kullanıcı girişlerini doğrulayan parametreli saklı yordamlar oluşturun.</span><span class="sxs-lookup"><span data-stu-id="6eed1-140">Create parameterized stored procedures that validate all user input.</span></span> <span data-ttu-id="6eed1-141">Tüm Kullanıcı girişlerini güvenilir değil olarak değerlendirin.</span><span class="sxs-lookup"><span data-stu-id="6eed1-141">Treat all user input as untrusted.</span></span>  
  
- <span data-ttu-id="6eed1-142">Mutlak gerekmedikçe dinamik SQL kullanmaktan kaçının.</span><span class="sxs-lookup"><span data-stu-id="6eed1-142">Avoid dynamic SQL unless absolutely necessary.</span></span> <span data-ttu-id="6eed1-143">Transact-SQL QUOTENAME () işlevini kullanarak bir dize değerini sınırlandırın ve giriş dizesindeki sınırlandırıcının herhangi bir oluşumunu kaçış.</span><span class="sxs-lookup"><span data-stu-id="6eed1-143">Use the Transact-SQL QUOTENAME() function to delimit a string value and escape any occurrence of the delimiter in the input string.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="6eed1-144">Dış Kaynaklar</span><span class="sxs-lookup"><span data-stu-id="6eed1-144">External Resources</span></span>  
 <span data-ttu-id="6eed1-145">Daha fazla bilgi için aşağıdaki kaynaklara bakın.</span><span class="sxs-lookup"><span data-stu-id="6eed1-145">For more information, see the following resources.</span></span>  
  
|<span data-ttu-id="6eed1-146">Kaynak</span><span class="sxs-lookup"><span data-stu-id="6eed1-146">Resource</span></span>|<span data-ttu-id="6eed1-147">Description</span><span class="sxs-lookup"><span data-stu-id="6eed1-147">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="6eed1-148">[Saklı yordamlar](/sql/relational-databases/stored-procedures/stored-procedures-database-engine) ve [SQL ekleme](/sql/relational-databases/security/sql-injection)</span><span class="sxs-lookup"><span data-stu-id="6eed1-148">[Stored Procedures](/sql/relational-databases/stored-procedures/stored-procedures-database-engine) and [SQL Injection](/sql/relational-databases/security/sql-injection)</span></span>|<span data-ttu-id="6eed1-149">Makaleler, saklı yordamların nasıl oluşturulduğunu ve SQL ekleme 'nin nasıl çalıştığını açıklamaktadır.</span><span class="sxs-lookup"><span data-stu-id="6eed1-149">Articles describe how to create stored procedures and how SQL Injection works.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="6eed1-150">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="6eed1-150">See also</span></span>

- [<span data-ttu-id="6eed1-151">ADO.NET Uygulamalarının Güvenliğini Sağlama</span><span class="sxs-lookup"><span data-stu-id="6eed1-151">Securing ADO.NET Applications</span></span>](../securing-ado-net-applications.md)
- [<span data-ttu-id="6eed1-152">SQL Server Güvenliğine Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="6eed1-152">Overview of SQL Server Security</span></span>](overview-of-sql-server-security.md)
- [<span data-ttu-id="6eed1-153">SQL Server'da Uygulama Güvenliği Senaryoları</span><span class="sxs-lookup"><span data-stu-id="6eed1-153">Application Security Scenarios in SQL Server</span></span>](application-security-scenarios-in-sql-server.md)
- [<span data-ttu-id="6eed1-154">SQL Server’da Secure Dynamic SQL Yazma</span><span class="sxs-lookup"><span data-stu-id="6eed1-154">Writing Secure Dynamic SQL in SQL Server</span></span>](writing-secure-dynamic-sql-in-sql-server.md)
- [<span data-ttu-id="6eed1-155">SQL Server'da Saklı Yordam İmzalama</span><span class="sxs-lookup"><span data-stu-id="6eed1-155">Signing Stored Procedures in SQL Server</span></span>](signing-stored-procedures-in-sql-server.md)
- [<span data-ttu-id="6eed1-156">SQL Server'da Kimliğe Bürünme İzinlerini Özelleştirme</span><span class="sxs-lookup"><span data-stu-id="6eed1-156">Customizing Permissions with Impersonation in SQL Server</span></span>](customizing-permissions-with-impersonation-in-sql-server.md)
- [<span data-ttu-id="6eed1-157">Saklı Yordamlarla Verileri Değiştirme</span><span class="sxs-lookup"><span data-stu-id="6eed1-157">Modifying Data with Stored Procedures</span></span>](../modifying-data-with-stored-procedures.md)
- [<span data-ttu-id="6eed1-158">ADO.NET’e Genel Bakış</span><span class="sxs-lookup"><span data-stu-id="6eed1-158">ADO.NET Overview</span></span>](../ado-net-overview.md)
