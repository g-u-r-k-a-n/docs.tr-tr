---
title: Kaynak Yöneticisi uygulama
description: .NET ' te bir Resource Manager uygulayın. Kaynak Yöneticisi işlemlerde kullanılan kaynakları yönetir. İşlem Yöneticisi, Resource Manager eylemlerini koordine eder.
ms.date: 03/30/2017
ms.assetid: d5c153f6-4419-49e3-a5f1-a50ae4c81bf3
ms.openlocfilehash: bf40c6eaee35a5a548c6de4a286e46c4d4a66aca
ms.sourcegitcommit: 6219b1e1feccb16d88656444210fed3297f5611e
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 06/22/2020
ms.locfileid: "85141855"
---
# <a name="implementing-a-resource-manager"></a><span data-ttu-id="3c067-105">Kaynak Yöneticisi uygulama</span><span class="sxs-lookup"><span data-stu-id="3c067-105">Implementing a Resource Manager</span></span>
<span data-ttu-id="3c067-106">Bir işlemde kullanılan her kaynak, eylemleri bir işlem yöneticisi tarafından koordine edilen bir kaynak yöneticisi tarafından yönetilir.</span><span class="sxs-lookup"><span data-stu-id="3c067-106">Each resource used in a transaction is managed by a resource manager, whose actions are coordinated by a transaction manager.</span></span> <span data-ttu-id="3c067-107">Kaynak yöneticileri, uygulamayı kararlılık ve yalıtıma garantisi sağlamak için işlem yöneticisiyle birlikte çalışır.</span><span class="sxs-lookup"><span data-stu-id="3c067-107">Resource managers work in cooperation with the transaction manager to provide the application with a guarantee of atomicity and isolation.</span></span> <span data-ttu-id="3c067-108">Microsoft SQL Server, kalıcı ileti sıraları, bellek içi karma tabloları kaynak yöneticilerinin tüm örnekleri mevcuttur.</span><span class="sxs-lookup"><span data-stu-id="3c067-108">Microsoft SQL Server, durable message queues, in-memory hash tables are all examples of resource managers.</span></span>  
  
 <span data-ttu-id="3c067-109">Kalıcı veya geçici Veri Kaynağı Yöneticisi yönetir.</span><span class="sxs-lookup"><span data-stu-id="3c067-109">A resource manager manages either durable or volatile data.</span></span> <span data-ttu-id="3c067-110">Süreklilik (veya tersine volatility) kaynak yöneticisi kaynak yöneticisi hatası kurtarma destekleyip başvuruyor.</span><span class="sxs-lookup"><span data-stu-id="3c067-110">The durability (or conversely the volatility) of a resource manager refers to whether the resource manager supports failure recovery.</span></span> <span data-ttu-id="3c067-111">Bir Kaynak Yöneticisi hata kurtarmayı destekliyorsa, Aşama 1 sırasında verileri dayanıklı depolamaya (hazırla) devam ettirir. Bu, Resource Manager kapalıysa, kurtarma sonrasında işlemi yeniden listeleme ve işlem yöneticisi 'nden alınan bildirimlere göre uygun eylemleri gerçekleştirmenize olanak sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c067-111">If a resource manager supports failure recovery, it persists data to durable storage during Phase1 (prepare) such that if the resource manager goes down, it can re-enlist in the transaction upon recovery and perform the proper actions based on the notifications received from the transaction manager.</span></span> <span data-ttu-id="3c067-112">Genel olarak, geçici kaynak yöneticileri bellek içi veri yapısı (örneğin, bellek içi bir işlem Hashtable) gibi geçici kaynakları yönetir ve dayanıklı kaynak yöneticileri, daha kalıcı bir yedekleme deposuna sahip kaynakları (örneğin, yedekleme deposu disk olan bir veritabanı) yönetir.</span><span class="sxs-lookup"><span data-stu-id="3c067-112">In general, volatile resource managers manage volatile resources such as an in-memory data structure (for example, an in-memory transacted-hashtable), and durable resource managers manage resources that have a more persistent backing store (for example, a database whose backing store is disk).</span></span>  
  
 <span data-ttu-id="3c067-113">Bir kaynağın bir işleme katılmasını sağlamak için, işlem içinde listelenmesi gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c067-113">In order for a resource to participate in a transaction, it must enlist in the transaction.</span></span> <span data-ttu-id="3c067-114"><xref:System.Transactions.Transaction>Sınıfı, bu işlevselliği sağlayan, adları **Listeleme** ile başlayan bir yöntemler kümesini tanımlar.</span><span class="sxs-lookup"><span data-stu-id="3c067-114">The <xref:System.Transactions.Transaction> class defines a set of methods whose names begin with **Enlist** that provide this functionality.</span></span> <span data-ttu-id="3c067-115">Farklı **Listeleme** yöntemleri, bir kaynak yöneticisi 'nin sahip olabileceği farklı kayıt türlerine karşılık gelir.</span><span class="sxs-lookup"><span data-stu-id="3c067-115">The different **Enlist** methods correspond to the different types of enlistment that a resource manager may have.</span></span> <span data-ttu-id="3c067-116">Özellikle, kullandığınız <xref:System.Transactions.Transaction.EnlistVolatile%2A> geçici kaynaklar için yöntemleri ve <xref:System.Transactions.Transaction.EnlistDurable%2A> kalıcı kaynaklar için yöntem.</span><span class="sxs-lookup"><span data-stu-id="3c067-116">Specifically, you use the <xref:System.Transactions.Transaction.EnlistVolatile%2A> methods for volatile resources, and the <xref:System.Transactions.Transaction.EnlistDurable%2A> method for durable resources.</span></span> <span data-ttu-id="3c067-117">Kullanılacak karar sonra kolaylık <xref:System.Transactions.Transaction.EnlistDurable%2A> veya <xref:System.Transactions.Transaction.EnlistVolatile%2A> , kaynağın süreklilik desteğini tabanlı yöntemi, iki aşaması yürütme içinde (2PC) uygulayarak katılmak için kaynak listeleme <xref:System.Transactions.IEnlistmentNotification> , kaynak yöneticisi için arabirim.</span><span class="sxs-lookup"><span data-stu-id="3c067-117">For simplicity, after deciding whether to use the <xref:System.Transactions.Transaction.EnlistDurable%2A> or <xref:System.Transactions.Transaction.EnlistVolatile%2A> method based on your resource's durability support, you should enlist your resource to participate in Two Phase Commit (2PC) by implementing the <xref:System.Transactions.IEnlistmentNotification> interface for your resource manager.</span></span> <span data-ttu-id="3c067-118">2PC hakkında daha fazla bilgi için bkz. [tek aşamalı ve çok aşamalı bir işlem](committing-a-transaction-in-single-phase-and-multi-phase.md)yürütme.</span><span class="sxs-lookup"><span data-stu-id="3c067-118">For more information on 2PC, see [Committing a Transaction in Single-Phase and Multi-Phase](committing-a-transaction-in-single-phase-and-multi-phase.md).</span></span>  
  
 <span data-ttu-id="3c067-119">Kaynak Yöneticisi, işlem tamamlandığında veya durdurulduğunda işlem yöneticisinden geri çağırmaları almasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c067-119">By enlisting, the resource manager ensures that it gets callbacks from the transaction manager when the transaction commits or aborts.</span></span> <span data-ttu-id="3c067-120">Bir örneği yok <xref:System.Transactions.IEnlistmentNotification> başına liste.</span><span class="sxs-lookup"><span data-stu-id="3c067-120">There is one instance of <xref:System.Transactions.IEnlistmentNotification> per enlistment.</span></span> <span data-ttu-id="3c067-121">Genellikle, işlem başına bir kayıt vardır ancak bir kaynak yöneticisi aynı işlemde birden çok kez Listeleme işlemini seçebilir.</span><span class="sxs-lookup"><span data-stu-id="3c067-121">Typically, there is one enlistment per transaction, but a resource manager can choose to enlist multiple times in the same transaction.</span></span>  
  
 <span data-ttu-id="3c067-122">Kayıt sonrasında, Resource Manager işlemin isteklerine yanıt verir.</span><span class="sxs-lookup"><span data-stu-id="3c067-122">After enlistment, the resource manager responds to the transaction's requests.</span></span> <span data-ttu-id="3c067-123">Dayanıklı bir kaynak yöneticisi, yönettiği kaynaklar üzerinde hareketin işini geri alma veya yeniden yapma izni vermek için yeterli bilgi depolar.</span><span class="sxs-lookup"><span data-stu-id="3c067-123">A durable resource manager stores enough information to allow it to either undo or redo the transaction's work on resources it manages.</span></span> <span data-ttu-id="3c067-124">Bunu yapmak için birçok yolu vardır; Veri sürümlerini saklama veya değişiklikleri bir günlük tutma iki ortak teknikler mevcuttur.</span><span class="sxs-lookup"><span data-stu-id="3c067-124">There are many ways to do this; keeping versions of data or keeping a log of the changes are two common techniques.</span></span>  
  
 <span data-ttu-id="3c067-125">Uygulama işlemi tamamlandığında, işlem Yöneticisi iki aşamalı tamamlama protokolünü başlatır.</span><span class="sxs-lookup"><span data-stu-id="3c067-125">When the application commits the transaction, the transaction manager initiates the two-phase commit protocol.</span></span> <span data-ttu-id="3c067-126">İşlem Yöneticisi önce, kayıt işlemini yürütmek üzere hazırlanmışsa, her bir kayıtlı kaynak yöneticisini önce sorar.</span><span class="sxs-lookup"><span data-stu-id="3c067-126">The transaction manager first asks each enlisted resource manager if it is prepared to commit the transaction.</span></span> <span data-ttu-id="3c067-127">Resource Manager 'ın işlemeye hazırlanması gerekir — işlemi yürütmek veya işlemi iptal etmek için kendisini yeniden hazırlar.</span><span class="sxs-lookup"><span data-stu-id="3c067-127">The resource manager must prepare to commit—it readies itself to either commit or abort the transaction.</span></span>  
  
 <span data-ttu-id="3c067-128">Böylece sistem başarısız olsa bile Kaynak Yöneticisi, kurtarabilirsiniz hazırla aşamasında, eski ve yeni veri kalıcı Kaynak Yöneticisi tutarlı depolama kaydeder.</span><span class="sxs-lookup"><span data-stu-id="3c067-128">During the prepare phase, the durable resource manager records the old and new data in stable storage so that the resource manager can recover it even if the system fails.</span></span> <span data-ttu-id="3c067-129">Resource Manager hazırlanıp, işlem yöneticisine işleme veya işlemin iptal edilip edilmeyeceğini bildiren oya bildirir.</span><span class="sxs-lookup"><span data-stu-id="3c067-129">If the resource manager can prepare, it informs the transaction manager its vote on whether to commit or abort the transaction.</span></span> <span data-ttu-id="3c067-130">Herhangi bir kaynak yöneticisi hazırlanmak üzere bir hata bildirirse, işlem yöneticisi her kaynak yöneticisi için bir geri alma komutu gönderir ve uygulamaya yapılan işleme başarısızlığını gösterir.</span><span class="sxs-lookup"><span data-stu-id="3c067-130">If any resource manager reports a failure to prepare, the transaction manager sends a rollback command to each resource manager and indicates the failure of the commit to the application.</span></span>  
  
 <span data-ttu-id="3c067-131">Hazırlandıktan sonra Kaynak Yöneticisi, Aşama 2 ' de işlem yöneticisi 'nden bir işleme veya iptal geri araması yapana kadar beklemeniz gerekir.</span><span class="sxs-lookup"><span data-stu-id="3c067-131">Once prepared, a resource manager must wait until it gets a commit or abort callback from the transaction manager in phase 2.</span></span> <span data-ttu-id="3c067-132">Genel olarak, bir saniyenin tüm hazırla ve yürütme protokol tamamlar.</span><span class="sxs-lookup"><span data-stu-id="3c067-132">Typically, the entire prepare and commit protocol completes in a fraction of a second.</span></span> <span data-ttu-id="3c067-133">Sistem veya iletişim hatası yoksa, tamamlama veya iptal bildirimi dakika veya saat için gelebilir değil.</span><span class="sxs-lookup"><span data-stu-id="3c067-133">If there are system or communication failures, the commit or abort notification may not arrive for minutes or hours.</span></span> <span data-ttu-id="3c067-134">Bu süre boyunca, Kaynak Yöneticisi işlemin sonucu hakkında şüphedir.</span><span class="sxs-lookup"><span data-stu-id="3c067-134">During this period, the resource manager is in doubt about the outcome of the transaction.</span></span> <span data-ttu-id="3c067-135">İşlemin uygulanıp tamamlanmadığı veya durdurulmadığını bilmez.</span><span class="sxs-lookup"><span data-stu-id="3c067-135">It does not know whether the transaction committed or aborted.</span></span> <span data-ttu-id="3c067-136">Kaynak Yöneticisi bir işlem hakkında şüpheli durumdayken, işlem kilitli tutarak verilerin değiştirilmesini korur, böylece bu değişiklikler diğer işlemlerden de yalıtıyor.</span><span class="sxs-lookup"><span data-stu-id="3c067-136">While the resource manager is in doubt about a transaction, it keeps the data modified by keeping the transaction locked, thereby isolating these changes from any other transactions.</span></span>  
  
 <span data-ttu-id="3c067-137">Bir kaynak yöneticisi başarısız olduğunda, hata öncesinde hazırlananlar veya taahhütler hariç tüm kayıtlı işlemleri iptal edilir.</span><span class="sxs-lookup"><span data-stu-id="3c067-137">When a resource manager fails, all of its enlisted transactions are aborted except for those that are prepared or committed prior to the failure.</span></span> <span data-ttu-id="3c067-138">Kalıcı bir kaynak yöneticisi yeniden başlatıldığında, hazırlama aşamasında yazılan hazırlama bilgilerini alarak yönettiği kaynakların taahhüt durumunu yeniden oluşturur ve bu işlemleri buna göre kaydeder veya iptal eder.</span><span class="sxs-lookup"><span data-stu-id="3c067-138">When a durable resource manager restarts, it reconstructs the committed state of the resources it manages by retrieving the prepare information written in the prepare phase, and commits or aborts these transactions accordingly.</span></span>  
  
 <span data-ttu-id="3c067-139">Özet olarak, iki aşamalı tamamlama Protokolü ve kaynak yöneticileri, işlemleri atomik ve dayanıklı hale getirmek için birleştirir.</span><span class="sxs-lookup"><span data-stu-id="3c067-139">In summary, the two-phase commit protocol and the resource managers combine to make transactions atomic and durable.</span></span>  
  
 <span data-ttu-id="3c067-140"><xref:System.Transactions.Transaction> Sınıfı sağlar <xref:System.Transactions.Transaction.EnlistPromotableSinglePhase%2A> bir Promotable tek aşaması liste'nı (PSPE) listeleme yöntemi.</span><span class="sxs-lookup"><span data-stu-id="3c067-140">The <xref:System.Transactions.Transaction> class also provides the <xref:System.Transactions.Transaction.EnlistPromotableSinglePhase%2A> method to enlist a Promotable Single Phase Enlistment (PSPE).</span></span> <span data-ttu-id="3c067-141">Bu, dayanıklı bir kaynak yöneticisinin (RM), daha sonra gerekirse MSDTC tarafından yönetilmek üzere ilerletilebilecek bir işlem barındırarak "sahip" olmasını sağlar.</span><span class="sxs-lookup"><span data-stu-id="3c067-141">This allows a durable resource manager (RM) to host and "own" a transaction that can later be escalated to be managed by the MSDTC if necessary.</span></span> <span data-ttu-id="3c067-142">Bunun hakkında daha fazla bilgi için bkz. [tek aşamalı tamamlama ve promotable tek aşamalı bildirimi kullanarak iyileştirme](optimization-spc-and-promotable-spn.md).</span><span class="sxs-lookup"><span data-stu-id="3c067-142">For more information on this, see [Optimization using Single Phase Commit and Promotable Single Phase Notification](optimization-spc-and-promotable-spn.md).</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="3c067-143">Bu Bölümde</span><span class="sxs-lookup"><span data-stu-id="3c067-143">In This Section</span></span>  
 <span data-ttu-id="3c067-144">Genel olarak kaynak yöneticisi tarafından izlenen adımları aşağıdaki konulara özetlenmiştir.</span><span class="sxs-lookup"><span data-stu-id="3c067-144">The steps generally followed by a resource manager are outlined in the following topics.</span></span>  
  
 [<span data-ttu-id="3c067-145">Bir İşlemde Kaynakları Katılımcı Olarak Kaydetme</span><span class="sxs-lookup"><span data-stu-id="3c067-145">Enlisting Resources as Participants in a Transaction</span></span>](enlisting-resources-as-participants-in-a-transaction.md)  
  
 <span data-ttu-id="3c067-146">Kalıcı veya geçici bir kaynağın bir işlemde nasıl listelenmesi gerektiğini açıklar.</span><span class="sxs-lookup"><span data-stu-id="3c067-146">Describes how a durable or volatile resource can enlist in a transaction.</span></span>  
  
 [<span data-ttu-id="3c067-147">Tek Aşamalı ve Çok Aşamalı İşlem Gerçekleştirme</span><span class="sxs-lookup"><span data-stu-id="3c067-147">Committing a Transaction in Single-Phase and Multi-Phase</span></span>](committing-a-transaction-in-single-phase-and-multi-phase.md)  
  
 <span data-ttu-id="3c067-148">Bildirim Kaydet ve yürütme hazırlamak için bir kaynak yöneticisi nasıl yanıt vereceğini açıklar.</span><span class="sxs-lookup"><span data-stu-id="3c067-148">Describes how a resource manager responds to commit notification and prepare the commit.</span></span>  
  
 [<span data-ttu-id="3c067-149">Kurtarma Gerçekleştirme</span><span class="sxs-lookup"><span data-stu-id="3c067-149">Performing Recovery</span></span>](performing-recovery.md)  
  
 <span data-ttu-id="3c067-150">Nasıl sürekli Kaynak Yöneticisi hata verdi kurtarır açıklar.</span><span class="sxs-lookup"><span data-stu-id="3c067-150">Describes how a durable resource manager recovers from failure.</span></span>  
  
 [<span data-ttu-id="3c067-151">Kaynaklara Erişimde Güvenlik Güven Düzeyleri</span><span class="sxs-lookup"><span data-stu-id="3c067-151">Security Trust Levels in Accessing Resources</span></span>](security-trust-levels-in-accessing-resources.md)  
  
 <span data-ttu-id="3c067-152">System. Transactions için üç güven düzeyinin, kullanıma sunan kaynak türleri üzerinde erişimi nasıl kısıtlayabileceğini açıklar <xref:System.Transactions> .</span><span class="sxs-lookup"><span data-stu-id="3c067-152">Describes how the three levels of trust for System.Transactions restrict access on the types of resources that <xref:System.Transactions> exposes.</span></span>  
  
 [<span data-ttu-id="3c067-153">Tek Aşamalı İşleme ve Yükseltilebilir Tek Aşamalı Bildirim kullanarak en iyi duruma getirme</span><span class="sxs-lookup"><span data-stu-id="3c067-153">Optimization using Single Phase Commit and Promotable Single Phase Notification</span></span>](optimization-spc-and-promotable-spn.md)  
  
 <span data-ttu-id="3c067-154">Kaynak yöneticileri uygulamalar için kullanılabilir olan en iyi hale getirme yöntemleri açıklar.</span><span class="sxs-lookup"><span data-stu-id="3c067-154">Describes optimization practices available to implementations of resource managers.</span></span>
