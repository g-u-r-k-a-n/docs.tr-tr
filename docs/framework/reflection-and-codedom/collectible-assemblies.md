---
title: Dinamik tür oluşturma için toplanabilir derlemeler
description: .NET ' te dinamik tür oluşturma için toplanabilir derlemeler ile çalışmaya başlayın. Toplanabilir derleme yaşam süreleri ve kısıtlamaları hakkında bilgi edinin.
ms.date: 08/29/2017
helpviewer_keywords:
- reflection, dynamic assembly
- assemblies, collectible
- collectible assemblies, retrieving
ms.openlocfilehash: 4981b93dbd49a6da96740bebed0f2ed7b89036c8
ms.sourcegitcommit: cf5a800a33de64d0aad6d115ffcc935f32375164
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 07/20/2020
ms.locfileid: "86475131"
---
# <a name="collectible-assemblies-for-dynamic-type-generation"></a><span data-ttu-id="41b63-104">Dinamik tür oluşturma için toplanabilir derlemeler</span><span class="sxs-lookup"><span data-stu-id="41b63-104">Collectible assemblies for dynamic type generation</span></span>

<span data-ttu-id="41b63-105">*Toplanabilir derlemeler* , oluşturuldukları uygulama etki alanının kaldırılması gerekmeden bellekten kaldırılabilen dinamik derlemelerdir.</span><span class="sxs-lookup"><span data-stu-id="41b63-105">*Collectible assemblies* are dynamic assemblies that can be unloaded without unloading the application domain in which they were created.</span></span> <span data-ttu-id="41b63-106">Bir toplanabilir derleme tarafından kullanılan tüm yönetilen ve yönetilmeyen bellek ve içerdiği türler geri kazanılır.</span><span class="sxs-lookup"><span data-stu-id="41b63-106">All managed and unmanaged memory used by a collectible assembly and the types it contains can be reclaimed.</span></span> <span data-ttu-id="41b63-107">Derleme adı gibi bilgiler iç tablolardan kaldırılır.</span><span class="sxs-lookup"><span data-stu-id="41b63-107">Information such as the assembly name is removed from internal tables.</span></span>

<span data-ttu-id="41b63-108">Kaldırmayı etkinleştirmek için, <xref:System.Reflection.Emit.AssemblyBuilderAccess.RunAndCollect?displayProperty=nameWithType> dinamik bir derleme oluştururken bayrağını kullanın.</span><span class="sxs-lookup"><span data-stu-id="41b63-108">To enable unloading, use the <xref:System.Reflection.Emit.AssemblyBuilderAccess.RunAndCollect?displayProperty=nameWithType> flag when you create a dynamic assembly.</span></span> <span data-ttu-id="41b63-109">Derleme geçicidir (diğer bir deyişle, kaydedilemez) ve [toplanabilir derlemelerde kısıtlamalar](#restrictions-on-collectible-assemblies) bölümünde açıklanan sınırlamalara tabidir.</span><span class="sxs-lookup"><span data-stu-id="41b63-109">The assembly is transient (that is, it cannot be saved) and is subject to limitations described in the [Restrictions on Collectible Assemblies](#restrictions-on-collectible-assemblies) section.</span></span> <span data-ttu-id="41b63-110">Ortak dil çalışma zamanı (CLR), derlemeyle ilişkili tüm nesneleri serbest bırakırsanız, toplanabilir bir derlemeyi otomatik olarak kaldırır.</span><span class="sxs-lookup"><span data-stu-id="41b63-110">The common language runtime (CLR) unloads a collectible assembly automatically when you release all objects associated with the assembly.</span></span> <span data-ttu-id="41b63-111">Diğer tüm yönden, toplanabilir derlemeler diğer dinamik Derlemelerle aynı şekilde oluşturulur ve kullanılır.</span><span class="sxs-lookup"><span data-stu-id="41b63-111">In all other respects, collectible assemblies are created and used in the same way as other dynamic assemblies.</span></span>

## <a name="lifetime-of-collectible-assemblies"></a><span data-ttu-id="41b63-112">Toplanabilir derlemelerin ömrü</span><span class="sxs-lookup"><span data-stu-id="41b63-112">Lifetime of collectible assemblies</span></span>

<span data-ttu-id="41b63-113">Toplanabilir bir derlemenin ömrü, içerdiği türlere yapılan başvuruların ve bu türlerden oluşturulan nesnelerin varlığı tarafından denetlenir.</span><span class="sxs-lookup"><span data-stu-id="41b63-113">The lifetime of a collectible assembly is controlled by the existence of references to the types it contains and the objects that are created from those types.</span></span> <span data-ttu-id="41b63-114">Ortak dil çalışma zamanı, aşağıdakilerden biri veya daha fazlası mevcut olduğu sürece bir derlemeyi kaldırmaz ( `T` derlemede tanımlı herhangi bir tür):</span><span class="sxs-lookup"><span data-stu-id="41b63-114">The common language runtime does not unload an assembly as long as one or more of the following exist (`T` is any type that is defined in the assembly):</span></span>

- <span data-ttu-id="41b63-115">`T` öğesinin bir örneği.</span><span class="sxs-lookup"><span data-stu-id="41b63-115">An instance of `T`.</span></span>

- <span data-ttu-id="41b63-116">Bir dizisinin örneği `T` .</span><span class="sxs-lookup"><span data-stu-id="41b63-116">An instance of an array of `T`.</span></span>

- <span data-ttu-id="41b63-117">Tür bağımsız değişkenlerinden biri olan bir genel türün örneği `T` .</span><span class="sxs-lookup"><span data-stu-id="41b63-117">An instance of a generic type that has `T` as one of its type arguments.</span></span> <span data-ttu-id="41b63-118">Bu `T` , koleksiyon boş olsa bile genel koleksiyonlarını içerir.</span><span class="sxs-lookup"><span data-stu-id="41b63-118">This includes generic collections of `T`, even if that collection is empty.</span></span>

- <span data-ttu-id="41b63-119">Öğesini <xref:System.Type> <xref:System.Reflection.Emit.TypeBuilder> temsil eden bir örneği `T` .</span><span class="sxs-lookup"><span data-stu-id="41b63-119">An instance of <xref:System.Type> or <xref:System.Reflection.Emit.TypeBuilder> that represents `T`.</span></span>

   > [!IMPORTANT]
   > <span data-ttu-id="41b63-120">Derlemenin parçalarını temsil eden tüm nesneleri serbest bırakmanız gerekir.</span><span class="sxs-lookup"><span data-stu-id="41b63-120">You must release all objects that represent parts of the assembly.</span></span> <span data-ttu-id="41b63-121"><xref:System.Reflection.Emit.ModuleBuilder>Tanımlar `T` öğesine bir başvuru tutar <xref:System.Reflection.Emit.TypeBuilder> ve <xref:System.Reflection.Emit.AssemblyBuilder> nesnesi öğesine bir başvuru tutar, <xref:System.Reflection.Emit.ModuleBuilder> Bu nedenle bu nesnelere yapılan başvuruların serbest bırakılması gerekir.</span><span class="sxs-lookup"><span data-stu-id="41b63-121">The <xref:System.Reflection.Emit.ModuleBuilder> that defines `T` keeps a reference to the <xref:System.Reflection.Emit.TypeBuilder>, and the <xref:System.Reflection.Emit.AssemblyBuilder> object keeps a reference to the <xref:System.Reflection.Emit.ModuleBuilder>, so references to these objects must be released.</span></span> <span data-ttu-id="41b63-122">Bir <xref:System.Reflection.Emit.LocalBuilder> veya <xref:System.Reflection.Emit.ILGenerator> yapımını oluşturma sırasında kullanılması bile, `T` kaldırmayı engeller.</span><span class="sxs-lookup"><span data-stu-id="41b63-122">Even the existence of a <xref:System.Reflection.Emit.LocalBuilder> or an <xref:System.Reflection.Emit.ILGenerator> used in the construction of `T` prevents unloading.</span></span>

- <span data-ttu-id="41b63-123">`T` `T1` Kod yürütülerek hala erişilebilir olan, dinamik olarak tanımlanmış başka bir tür tarafından statik başvuru.</span><span class="sxs-lookup"><span data-stu-id="41b63-123">A static reference to `T` by another dynamically defined type `T1` that is still reachable by executing code.</span></span> <span data-ttu-id="41b63-124">Örneğin, `T1` öğesinden türetilebilir `T` veya `T` bir yöntemindeki parametre türü olabilir `T1` .</span><span class="sxs-lookup"><span data-stu-id="41b63-124">For example, `T1` might derive from `T`, or `T` might be the type of a parameter in a method of `T1`.</span></span>

- <span data-ttu-id="41b63-125">Öğesine ait olan statik bir alana **ByRef** `T` .</span><span class="sxs-lookup"><span data-stu-id="41b63-125">A **ByRef** to a static field that belongs to `T`.</span></span>

- <span data-ttu-id="41b63-126">Bir <xref:System.RuntimeTypeHandle> , veya öğesine başvuran bir, <xref:System.RuntimeFieldHandle> veya bir <xref:System.RuntimeMethodHandle> `T` bileşeni `T` .</span><span class="sxs-lookup"><span data-stu-id="41b63-126">A <xref:System.RuntimeTypeHandle>, <xref:System.RuntimeFieldHandle>, or <xref:System.RuntimeMethodHandle> that refers to `T` or to a component of `T`.</span></span>

- <span data-ttu-id="41b63-127">Dolaylı olarak veya ' i temsil eden nesneye erişmek için doğrudan kullanılabilen herhangi bir yansıma nesnesinin örneği <xref:System.Type> `T` .</span><span class="sxs-lookup"><span data-stu-id="41b63-127">An instance of any reflection object that could be used indirectly or directly to access the <xref:System.Type> object that represents `T`.</span></span> <span data-ttu-id="41b63-128">Örneğin, nesnesi, <xref:System.Type> `T` öğe türü olan bir dizi türünden `T` veya tür bağımsız değişkeni olan genel bir türden elde edilebilir `T` .</span><span class="sxs-lookup"><span data-stu-id="41b63-128">For example, the <xref:System.Type> object for `T` can be obtained from an array type whose element type is `T`, or from a generic type that has `T` as a type argument.</span></span>

- <span data-ttu-id="41b63-129">`M`Herhangi bir iş parçacığının çağrı yığınında bir yöntem, `M` `T` veya derlemede tanımlanan modül düzeyi bir yöntem.</span><span class="sxs-lookup"><span data-stu-id="41b63-129">A method `M` on the call stack of any thread, where `M` is a method of `T` or a module-level method that is defined in the assembly.</span></span>

- <span data-ttu-id="41b63-130">Derlemenin modülünde tanımlanan statik metoda bir temsilci.</span><span class="sxs-lookup"><span data-stu-id="41b63-130">A delegate to a static method that is defined in a module of the assembly.</span></span>

<span data-ttu-id="41b63-131">Bu listedeki yalnızca bir öğe, derlemede yalnızca bir tür veya bir yöntem için mevcutsa, çalışma zamanı derlemeyi kaldıramıyor.</span><span class="sxs-lookup"><span data-stu-id="41b63-131">If only one item from this list exists for only one type or one method in the assembly, the runtime cannot unload the assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="41b63-132">Çalışma zamanı, listedeki tüm öğeler için sonlandırıcılar çalıştırılıncaya kadar derlemeyi gerçekten kaldırmaz.</span><span class="sxs-lookup"><span data-stu-id="41b63-132">The runtime does not actually unload the assembly until finalizers have run for all items in the list.</span></span>

<span data-ttu-id="41b63-133">Kullanım ömrü açısından, `List<int>` bir toplanabilir derleme oluşturmak için oluşturulan ve kullanılan (C# dilinde) veya (Visual Basic) gibi oluşturulmuş bir genel tür, `List(Of Integer)` genel tür tanımını içeren derlemede veya tür bağımsız değişkenlerinden birinin tanımını içeren bir derlemede tanımlanmış olarak değerlendirilir.</span><span class="sxs-lookup"><span data-stu-id="41b63-133">For purposes of tracking lifetime, a constructed generic type such as `List<int>` (in C#) or `List(Of Integer)` (in Visual Basic) that is created and used in the generation of a collectible assembly is considered to have been defined either in the assembly that contains the generic type definition or in an assembly that contains the definition of one of its type arguments.</span></span> <span data-ttu-id="41b63-134">Kullanılan kesin derleme bir uygulama ayrıntısı ve değiştirilebilir.</span><span class="sxs-lookup"><span data-stu-id="41b63-134">The exact assembly that is used is an implementation detail and subject to change.</span></span>

## <a name="restrictions-on-collectible-assemblies"></a><span data-ttu-id="41b63-135">Toplanabilir derlemelerdeki kısıtlamalar</span><span class="sxs-lookup"><span data-stu-id="41b63-135">Restrictions on collectible assemblies</span></span>

<span data-ttu-id="41b63-136">Aşağıdaki kısıtlamalar toplanabilir derlemeler için geçerlidir:</span><span class="sxs-lookup"><span data-stu-id="41b63-136">The following restrictions apply to collectible assemblies:</span></span>

- <span data-ttu-id="41b63-137">**Statik başvurular** Sıradan dinamik bir derlemede bulunan türlerin toplanabilir bir derlemede tanımlanan türlere statik başvuruları olamaz.</span><span class="sxs-lookup"><span data-stu-id="41b63-137">**Static references** Types in an ordinary dynamic assembly cannot have static references to types that are defined in a collectible assembly.</span></span> <span data-ttu-id="41b63-138">Örneğin, toplanabilir derlemedeki bir türden devralan sıradan bir tür tanımlarsanız, bir <xref:System.NotSupportedException> özel durum oluşturulur.</span><span class="sxs-lookup"><span data-stu-id="41b63-138">For example, if you define an ordinary type that inherits from a type in a collectible assembly, a <xref:System.NotSupportedException> exception is thrown.</span></span> <span data-ttu-id="41b63-139">Toplanabilir bir derlemede bulunan bir tür, başka bir toplanabilir derlemede bulunan bir türe statik başvuruları olabilir, ancak bu, başvurulan derlemenin yaşam süresini başvuran derlemenin ömrüne genişletir.</span><span class="sxs-lookup"><span data-stu-id="41b63-139">A type in a collectible assembly can have static references to a type in another collectible assembly, but this extends the lifetime of the referenced assembly to the lifetime of the referencing assembly.</span></span>

- <span data-ttu-id="41b63-140">**Com birlikte çalışma** Toplanabilir bir derlemede hiçbir COM arabirimi tanımlanamaz ve bir toplanabilir derleme içindeki tür örnekleri COM nesnelerine dönüştürülebilirler.</span><span class="sxs-lookup"><span data-stu-id="41b63-140">**COM interop** No COM interfaces can be defined within a collectible assembly, and no instances of types within a collectible assembly can be converted into COM objects.</span></span> <span data-ttu-id="41b63-141">Toplanabilir derlemedeki bir tür, COM çağrılabilir sarmalayıcı (CCW) veya çalışma zamanı çağrılabilir sarmalayıcı (RCW) olarak görev alamaz.</span><span class="sxs-lookup"><span data-stu-id="41b63-141">A type in a collectible assembly cannot serve as a COM callable wrapper (CCW) or runtime callable wrapper (RCW).</span></span> <span data-ttu-id="41b63-142">Ancak, toplanabilir derlemelerdeki türler COM arabirimlerini uygulayan nesneleri kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="41b63-142">However, types in collectible assemblies can use objects that implement COM interfaces.</span></span>

- <span data-ttu-id="41b63-143">**Platform çağırma** Özniteliği olan Yöntemler, <xref:System.Runtime.InteropServices.DllImportAttribute> toplanabilir bir derlemede bildirildiğinde derlenmeyecektir.</span><span class="sxs-lookup"><span data-stu-id="41b63-143">**Platform invoke** Methods that have the <xref:System.Runtime.InteropServices.DllImportAttribute> attribute will not compile when they are declared in a collectible assembly.</span></span> <span data-ttu-id="41b63-144"><xref:System.Reflection.Emit.OpCodes.Calli?displayProperty=nameWithType>Yönerge, toplanabilir bir derlemede bir türün uygulamasında kullanılamaz ve bu tür türler yönetilmeyen koda sıralanamaz.</span><span class="sxs-lookup"><span data-stu-id="41b63-144">The <xref:System.Reflection.Emit.OpCodes.Calli?displayProperty=nameWithType> instruction cannot be used in the implementation of a type in a collectible assembly, and such types cannot be marshaled to unmanaged code.</span></span> <span data-ttu-id="41b63-145">Bununla birlikte, toplanabilir olmayan bir derlemede belirtilen bir giriş noktasını kullanarak yerel koda çağrı yapabilirsiniz.</span><span class="sxs-lookup"><span data-stu-id="41b63-145">However, you can call into native code by using an entry point that is declared in a non-collectible assembly.</span></span>

- <span data-ttu-id="41b63-146">**Sıralama** Toplanabilir derlemelerde tanımlanan nesneler (özellikle de temsilciler) sıralanamaz.</span><span class="sxs-lookup"><span data-stu-id="41b63-146">**Marshaling** Objects (in particular, delegates) that are defined in collectible assemblies cannot be marshaled.</span></span> <span data-ttu-id="41b63-147">Bu, tüm geçici olarak yayınlanan türler için bir kısıtlamadır.</span><span class="sxs-lookup"><span data-stu-id="41b63-147">This is a restriction on all transient emitted types.</span></span>

- <span data-ttu-id="41b63-148">**Derlemeyi yükleme** Yansıma yayma, toplanabilir derlemeleri yüklemek için desteklenen tek mekanizmadır.</span><span class="sxs-lookup"><span data-stu-id="41b63-148">**Assembly loading** Reflection emit is the only mechanism that is supported for loading collectible assemblies.</span></span> <span data-ttu-id="41b63-149">Herhangi bir derleme yükleme formu kullanılarak yüklenen derlemeler kaldırılamıyor.</span><span class="sxs-lookup"><span data-stu-id="41b63-149">Assemblies that are loaded by using any other form of assembly loading cannot be unloaded.</span></span>

- <span data-ttu-id="41b63-150">**Bağlama dayalı nesneler** Bağlam statik değişkenleri desteklenmez.</span><span class="sxs-lookup"><span data-stu-id="41b63-150">**Context-bound objects** Context-static variables are not supported.</span></span> <span data-ttu-id="41b63-151">Toplanabilir bir derlemedeki türler genişletilemiyor <xref:System.ContextBoundObject> .</span><span class="sxs-lookup"><span data-stu-id="41b63-151">Types in a collectible assembly cannot extend <xref:System.ContextBoundObject>.</span></span> <span data-ttu-id="41b63-152">Ancak, toplanabilir derlemelerdeki kod, başka bir yerde tanımlanan bağlama dayalı nesneleri kullanabilir.</span><span class="sxs-lookup"><span data-stu-id="41b63-152">However, code in collectible assemblies can use context-bound objects that are defined elsewhere.</span></span>

- <span data-ttu-id="41b63-153">**Thread-statik veriler** Thread-static değişkenler desteklenmez.</span><span class="sxs-lookup"><span data-stu-id="41b63-153">**Thread-static data** Thread-static variables are not supported.</span></span>

## <a name="see-also"></a><span data-ttu-id="41b63-154">Ayrıca bkz.</span><span class="sxs-lookup"><span data-stu-id="41b63-154">See also</span></span>

- [<span data-ttu-id="41b63-155">Dinamik Yöntemleri ve Derlemeleri Yayma</span><span class="sxs-lookup"><span data-stu-id="41b63-155">Emitting Dynamic Methods and Assemblies</span></span>](emitting-dynamic-methods-and-assemblies.md)
